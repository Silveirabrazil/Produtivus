var tP=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var gre=tP((Sre,tm)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function vv(r){const e=Object.create(null);for(const t of r.split(","))e[t]=1;return t=>t in e}const At={},iu=[],Zs=()=>{},UN=()=>!1,np=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&(r.charCodeAt(2)>122||r.charCodeAt(2)<97),wv=r=>r.startsWith("onUpdate:"),ln=Object.assign,Rv=(r,e)=>{const t=r.indexOf(e);t>-1&&r.splice(t,1)},rP=Object.prototype.hasOwnProperty,wt=(r,e)=>rP.call(r,e),Ue=Array.isArray,ou=r=>Ih(r)==="[object Map]",sp=r=>Ih(r)==="[object Set]",jR=r=>Ih(r)==="[object Date]",ze=r=>typeof r=="function",Er=r=>typeof r=="string",ri=r=>typeof r=="symbol",Pt=r=>r!==null&&typeof r=="object",kN=r=>(Pt(r)||ze(r))&&ze(r.then)&&ze(r.catch),BN=Object.prototype.toString,Ih=r=>BN.call(r),nP=r=>Ih(r).slice(8,-1),WN=r=>Ih(r)==="[object Object]",Sv=r=>Er(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,Dc=vv(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ip=r=>{const e=Object.create(null);return t=>e[t]||(e[t]=r(t))},sP=/-\w/g,na=ip(r=>r.replace(sP,e=>e.slice(1).toUpperCase())),iP=/\B([A-Z])/g,la=ip(r=>r.replace(iP,"-$1").toLowerCase()),$N=ip(r=>r.charAt(0).toUpperCase()+r.slice(1)),ag=ip(r=>r?`on${$N(r)}`:""),qo=(r,e)=>!Object.is(r,e),Sf=(r,...e)=>{for(let t=0;t<r.length;t++)r[t](...e)},GN=(r,e,t,n=!1)=>{Object.defineProperty(r,e,{configurable:!0,enumerable:!1,writable:n,value:t})},rm=r=>{const e=parseFloat(r);return isNaN(e)?r:e};let KR;const op=()=>KR||(KR=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Yn(r){if(Ue(r)){const e={};for(let t=0;t<r.length;t++){const n=r[t],s=Er(n)?uP(n):Yn(n);if(s)for(const i in s)e[i]=s[i]}return e}else if(Er(r)||Pt(r))return r}const oP=/;(?![^(]*\))/g,aP=/:([^]+)/,lP=/\/\*[^]*?\*\//g;function uP(r){const e={};return r.replace(lP,"").split(oP).forEach(t=>{if(t){const n=t.split(aP);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function ap(r){let e="";if(Er(r))e=r;else if(Ue(r))for(let t=0;t<r.length;t++){const n=ap(r[t]);n&&(e+=n+" ")}else if(Pt(r))for(const t in r)r[t]&&(e+=t+" ");return e.trim()}const cP="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",hP=vv(cP);function zN(r){return!!r||r===""}function dP(r,e){if(r.length!==e.length)return!1;let t=!0;for(let n=0;t&&n<r.length;n++)t=lp(r[n],e[n]);return t}function lp(r,e){if(r===e)return!0;let t=jR(r),n=jR(e);if(t||n)return t&&n?r.getTime()===e.getTime():!1;if(t=ri(r),n=ri(e),t||n)return r===e;if(t=Ue(r),n=Ue(e),t||n)return t&&n?dP(r,e):!1;if(t=Pt(r),n=Pt(e),t||n){if(!t||!n)return!1;const s=Object.keys(r).length,i=Object.keys(e).length;if(s!==i)return!1;for(const o in r){const a=r.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!lp(r[o],e[o]))return!1}}return String(r)===String(e)}function fP(r,e){return r.findIndex(t=>lp(t,e))}const YN=r=>!!(r&&r.__v_isRef===!0),Cf=r=>Er(r)?r:r==null?"":Ue(r)||Pt(r)&&(r.toString===BN||!ze(r.toString))?YN(r)?Cf(r.value):JSON.stringify(r,jN,2):String(r),jN=(r,e)=>YN(e)?jN(r,e.value):ou(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[n,s],i)=>(t[lg(n,i)+" =>"]=s,t),{})}:sp(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>lg(t))}:ri(e)?lg(e):Pt(e)&&!Ue(e)&&!WN(e)?String(e):e,lg=(r,e="")=>{var t;return ri(r)?`Symbol(${(t=r.description)!=null?t:e})`:r};function mP(r){return r==null?"initial":typeof r=="string"?r===""?" ":r:String(r)}/**
* @vue/reactivity v3.5.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let On;class pP{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=On,!e&&On&&(this.index=(On.scopes||(On.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=On;try{return On=this,e()}finally{On=t}}}on(){++this._on===1&&(this.prevScope=On,On=this)}off(){this._on>0&&--this._on===0&&(On=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(this.effects.length=0,t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function gP(){return On}let _t;const ug=new WeakSet;class KN{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,On&&On.active&&On.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,ug.has(this)&&(ug.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||qN(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,XR(this),QN(this);const e=_t,t=Js;_t=this,Js=!0;try{return this.fn()}finally{ZN(this),_t=e,Js=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)bv(e);this.deps=this.depsTail=void 0,XR(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?ug.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Gy(this)&&this.run()}get dirty(){return Gy(this)}}let XN=0,Hc,Vc;function qN(r,e=!1){if(r.flags|=8,e){r.next=Vc,Vc=r;return}r.next=Hc,Hc=r}function Cv(){XN++}function Tv(){if(--XN>0)return;if(Vc){let e=Vc;for(Vc=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let r;for(;Hc;){let e=Hc;for(Hc=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){r||(r=n)}e=t}}if(r)throw r}function QN(r){for(let e=r.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function ZN(r){let e,t=r.depsTail,n=t;for(;n;){const s=n.prevDep;n.version===-1?(n===t&&(t=s),bv(n),yP(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=s}r.deps=e,r.depsTail=t}function Gy(r){for(let e=r.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(JN(e.dep.computed)||e.dep.version!==e.version))return!0;return!!r._dirty}function JN(r){if(r.flags&4&&!(r.flags&16)||(r.flags&=-17,r.globalVersion===oh)||(r.globalVersion=oh,!r.isSSR&&r.flags&128&&(!r.deps&&!r._dirty||!Gy(r))))return;r.flags|=2;const e=r.dep,t=_t,n=Js;_t=r,Js=!0;try{QN(r);const s=r.fn(r._value);(e.version===0||qo(s,r._value))&&(r.flags|=128,r._value=s,e.version++)}catch(s){throw e.version++,s}finally{_t=t,Js=n,ZN(r),r.flags&=-3}}function bv(r,e=!1){const{dep:t,prevSub:n,nextSub:s}=r;if(n&&(n.nextSub=s,r.prevSub=void 0),s&&(s.prevSub=n,r.nextSub=void 0),t.subs===r&&(t.subs=n,!n&&t.computed)){t.computed.flags&=-5;for(let i=t.computed.deps;i;i=i.nextDep)bv(i,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function yP(r){const{prevDep:e,nextDep:t}=r;e&&(e.nextDep=t,r.prevDep=void 0),t&&(t.prevDep=e,r.nextDep=void 0)}let Js=!0;const eA=[];function wo(){eA.push(Js),Js=!1}function Ro(){const r=eA.pop();Js=r===void 0?!0:r}function XR(r){const{cleanup:e}=r;if(r.cleanup=void 0,e){const t=_t;_t=void 0;try{e()}finally{_t=t}}}let oh=0;class EP{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Nv{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!_t||!Js||_t===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==_t)t=this.activeLink=new EP(_t,this),_t.deps?(t.prevDep=_t.depsTail,_t.depsTail.nextDep=t,_t.depsTail=t):_t.deps=_t.depsTail=t,tA(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const n=t.nextDep;n.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=n),t.prevDep=_t.depsTail,t.nextDep=void 0,_t.depsTail.nextDep=t,_t.depsTail=t,_t.deps===t&&(_t.deps=n)}return t}trigger(e){this.version++,oh++,this.notify(e)}notify(e){Cv();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{Tv()}}}function tA(r){if(r.dep.sc++,r.sub.flags&4){const e=r.dep.computed;if(e&&!r.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)tA(n)}const t=r.dep.subs;t!==r&&(r.prevSub=t,t&&(t.nextSub=r)),r.dep.subs=r}}const zy=new WeakMap,Xa=Symbol(""),Yy=Symbol(""),ah=Symbol("");function rn(r,e,t){if(Js&&_t){let n=zy.get(r);n||zy.set(r,n=new Map);let s=n.get(t);s||(n.set(t,s=new Nv),s.map=n,s.key=t),s.track()}}function lo(r,e,t,n,s,i){const o=zy.get(r);if(!o){oh++;return}const a=l=>{l&&l.trigger()};if(Cv(),e==="clear")o.forEach(a);else{const l=Ue(r),u=l&&Sv(t);if(l&&t==="length"){const c=Number(n);o.forEach((h,d)=>{(d==="length"||d===ah||!ri(d)&&d>=c)&&a(h)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),u&&a(o.get(ah)),e){case"add":l?u&&a(o.get("length")):(a(o.get(Xa)),ou(r)&&a(o.get(Yy)));break;case"delete":l||(a(o.get(Xa)),ou(r)&&a(o.get(Yy)));break;case"set":ou(r)&&a(o.get(Xa));break}}Tv()}function bl(r){const e=vt(r);return e===r?e:(rn(e,"iterate",ah),Rs(r)?e:e.map($r))}function up(r){return rn(r=vt(r),"iterate",ah),r}const vP={__proto__:null,[Symbol.iterator](){return cg(this,Symbol.iterator,$r)},concat(...r){return bl(this).concat(...r.map(e=>Ue(e)?bl(e):e))},entries(){return cg(this,"entries",r=>(r[1]=$r(r[1]),r))},every(r,e){return Ki(this,"every",r,e,void 0,arguments)},filter(r,e){return Ki(this,"filter",r,e,t=>t.map($r),arguments)},find(r,e){return Ki(this,"find",r,e,$r,arguments)},findIndex(r,e){return Ki(this,"findIndex",r,e,void 0,arguments)},findLast(r,e){return Ki(this,"findLast",r,e,$r,arguments)},findLastIndex(r,e){return Ki(this,"findLastIndex",r,e,void 0,arguments)},forEach(r,e){return Ki(this,"forEach",r,e,void 0,arguments)},includes(...r){return hg(this,"includes",r)},indexOf(...r){return hg(this,"indexOf",r)},join(r){return bl(this).join(r)},lastIndexOf(...r){return hg(this,"lastIndexOf",r)},map(r,e){return Ki(this,"map",r,e,void 0,arguments)},pop(){return Ku(this,"pop")},push(...r){return Ku(this,"push",r)},reduce(r,...e){return qR(this,"reduce",r,e)},reduceRight(r,...e){return qR(this,"reduceRight",r,e)},shift(){return Ku(this,"shift")},some(r,e){return Ki(this,"some",r,e,void 0,arguments)},splice(...r){return Ku(this,"splice",r)},toReversed(){return bl(this).toReversed()},toSorted(r){return bl(this).toSorted(r)},toSpliced(...r){return bl(this).toSpliced(...r)},unshift(...r){return Ku(this,"unshift",r)},values(){return cg(this,"values",$r)}};function cg(r,e,t){const n=up(r),s=n[e]();return n!==r&&!Rs(r)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=t(i.value)),i}),s}const wP=Array.prototype;function Ki(r,e,t,n,s,i){const o=up(r),a=o!==r&&!Rs(r),l=o[e];if(l!==wP[e]){const h=l.apply(r,i);return a?$r(h):h}let u=t;o!==r&&(a?u=function(h,d){return t.call(this,$r(h),d,r)}:t.length>2&&(u=function(h,d){return t.call(this,h,d,r)}));const c=l.call(o,u,n);return a&&s?s(c):c}function qR(r,e,t,n){const s=up(r);let i=t;return s!==r&&(Rs(r)?t.length>3&&(i=function(o,a,l){return t.call(this,o,a,l,r)}):i=function(o,a,l){return t.call(this,o,$r(a),l,r)}),s[e](i,...n)}function hg(r,e,t){const n=vt(r);rn(n,"iterate",ah);const s=n[e](...t);return(s===-1||s===!1)&&Iv(t[0])?(t[0]=vt(t[0]),n[e](...t)):s}function Ku(r,e,t=[]){wo(),Cv();const n=vt(r)[e].apply(r,t);return Tv(),Ro(),n}const RP=vv("__proto__,__v_isRef,__isVue"),rA=new Set(Object.getOwnPropertyNames(Symbol).filter(r=>r!=="arguments"&&r!=="caller").map(r=>Symbol[r]).filter(ri));function SP(r){ri(r)||(r=String(r));const e=vt(this);return rn(e,"has",r),e.hasOwnProperty(r)}class nA{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){if(t==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!s;if(t==="__v_isReadonly")return s;if(t==="__v_isShallow")return i;if(t==="__v_raw")return n===(s?i?xP:aA:i?oA:iA).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const o=Ue(e);if(!s){let l;if(o&&(l=vP[t]))return l;if(t==="hasOwnProperty")return SP}const a=Reflect.get(e,t,on(e)?e:n);return(ri(t)?rA.has(t):RP(t))||(s||rn(e,"get",t),i)?a:on(a)?o&&Sv(t)?a:a.value:Pt(a)?s?lA(a):Ws(a):a}}class sA extends nA{constructor(e=!1){super(!1,e)}set(e,t,n,s){let i=e[t];if(!this._isShallow){const l=sa(i);if(!Rs(n)&&!sa(n)&&(i=vt(i),n=vt(n)),!Ue(e)&&on(i)&&!on(n))return l||(i.value=n),!0}const o=Ue(e)&&Sv(t)?Number(t)<e.length:wt(e,t),a=Reflect.set(e,t,n,on(e)?e:s);return e===vt(s)&&(o?qo(n,i)&&lo(e,"set",t,n):lo(e,"add",t,n)),a}deleteProperty(e,t){const n=wt(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&n&&lo(e,"delete",t,void 0),s}has(e,t){const n=Reflect.has(e,t);return(!ri(t)||!rA.has(t))&&rn(e,"has",t),n}ownKeys(e){return rn(e,"iterate",Ue(e)?"length":Xa),Reflect.ownKeys(e)}}class CP extends nA{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const TP=new sA,bP=new CP,NP=new sA(!0),jy=r=>r,cd=r=>Reflect.getPrototypeOf(r);function AP(r,e,t){return function(...n){const s=this.__v_raw,i=vt(s),o=ou(i),a=r==="entries"||r===Symbol.iterator&&o,l=r==="keys"&&o,u=s[r](...n),c=t?jy:e?nm:$r;return!e&&rn(i,"iterate",l?Yy:Xa),{next(){const{value:h,done:d}=u.next();return d?{value:h,done:d}:{value:a?[c(h[0]),c(h[1])]:c(h),done:d}},[Symbol.iterator](){return this}}}}function hd(r){return function(...e){return r==="delete"?!1:r==="clear"?void 0:this}}function OP(r,e){const t={get(s){const i=this.__v_raw,o=vt(i),a=vt(s);r||(qo(s,a)&&rn(o,"get",s),rn(o,"get",a));const{has:l}=cd(o),u=e?jy:r?nm:$r;if(l.call(o,s))return u(i.get(s));if(l.call(o,a))return u(i.get(a));i!==o&&i.get(s)},get size(){const s=this.__v_raw;return!r&&rn(vt(s),"iterate",Xa),s.size},has(s){const i=this.__v_raw,o=vt(i),a=vt(s);return r||(qo(s,a)&&rn(o,"has",s),rn(o,"has",a)),s===a?i.has(s):i.has(s)||i.has(a)},forEach(s,i){const o=this,a=o.__v_raw,l=vt(a),u=e?jy:r?nm:$r;return!r&&rn(l,"iterate",Xa),a.forEach((c,h)=>s.call(i,u(c),u(h),o))}};return ln(t,r?{add:hd("add"),set:hd("set"),delete:hd("delete"),clear:hd("clear")}:{add(s){!e&&!Rs(s)&&!sa(s)&&(s=vt(s));const i=vt(this);return cd(i).has.call(i,s)||(i.add(s),lo(i,"add",s,s)),this},set(s,i){!e&&!Rs(i)&&!sa(i)&&(i=vt(i));const o=vt(this),{has:a,get:l}=cd(o);let u=a.call(o,s);u||(s=vt(s),u=a.call(o,s));const c=l.call(o,s);return o.set(s,i),u?qo(i,c)&&lo(o,"set",s,i):lo(o,"add",s,i),this},delete(s){const i=vt(this),{has:o,get:a}=cd(i);let l=o.call(i,s);l||(s=vt(s),l=o.call(i,s)),a&&a.call(i,s);const u=i.delete(s);return l&&lo(i,"delete",s,void 0),u},clear(){const s=vt(this),i=s.size!==0,o=s.clear();return i&&lo(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=AP(s,r,e)}),t}function Av(r,e){const t=OP(r,e);return(n,s,i)=>s==="__v_isReactive"?!r:s==="__v_isReadonly"?r:s==="__v_raw"?n:Reflect.get(wt(t,s)&&s in n?t:n,s,i)}const IP={get:Av(!1,!1)},MP={get:Av(!1,!0)},_P={get:Av(!0,!1)},iA=new WeakMap,oA=new WeakMap,aA=new WeakMap,xP=new WeakMap;function LP(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function PP(r){return r.__v_skip||!Object.isExtensible(r)?0:LP(nP(r))}function Ws(r){return sa(r)?r:Ov(r,!1,TP,IP,iA)}function FP(r){return Ov(r,!1,NP,MP,oA)}function lA(r){return Ov(r,!0,bP,_P,aA)}function Ov(r,e,t,n,s){if(!Pt(r)||r.__v_raw&&!(e&&r.__v_isReactive))return r;const i=PP(r);if(i===0)return r;const o=s.get(r);if(o)return o;const a=new Proxy(r,i===2?n:t);return s.set(r,a),a}function au(r){return sa(r)?au(r.__v_raw):!!(r&&r.__v_isReactive)}function sa(r){return!!(r&&r.__v_isReadonly)}function Rs(r){return!!(r&&r.__v_isShallow)}function Iv(r){return r?!!r.__v_raw:!1}function vt(r){const e=r&&r.__v_raw;return e?vt(e):r}function uA(r){return!wt(r,"__v_skip")&&Object.isExtensible(r)&&GN(r,"__v_skip",!0),r}const $r=r=>Pt(r)?Ws(r):r,nm=r=>Pt(r)?lA(r):r;function on(r){return r?r.__v_isRef===!0:!1}function $t(r){return DP(r,!1)}function DP(r,e){return on(r)?r:new HP(r,e)}class HP{constructor(e,t){this.dep=new Nv,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:vt(e),this._value=t?e:$r(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,n=this.__v_isShallow||Rs(e)||sa(e);e=n?e:vt(e),qo(e,t)&&(this._rawValue=e,this._value=n?e:$r(e),this.dep.trigger())}}function cA(r){return on(r)?r.value:r}const VP={get:(r,e,t)=>e==="__v_raw"?r:cA(Reflect.get(r,e,t)),set:(r,e,t,n)=>{const s=r[e];return on(s)&&!on(t)?(s.value=t,!0):Reflect.set(r,e,t,n)}};function hA(r){return au(r)?r:new Proxy(r,VP)}class UP{constructor(e,t,n){this.fn=e,this.setter=t,this._value=void 0,this.dep=new Nv(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=oh-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&_t!==this)return qN(this,!0),!0}get value(){const e=this.dep.track();return JN(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function kP(r,e,t=!1){let n,s;return ze(r)?n=r:(n=r.get,s=r.set),new UP(n,s,t)}const dd={},sm=new WeakMap;let Ba;function BP(r,e=!1,t=Ba){if(t){let n=sm.get(t);n||sm.set(t,n=[]),n.push(r)}}function WP(r,e,t=At){const{immediate:n,deep:s,once:i,scheduler:o,augmentJob:a,call:l}=t,u=H=>s?H:Rs(H)||s===!1||s===0?uo(H,1):uo(H);let c,h,d,m,E=!1,g=!1;if(on(r)?(h=()=>r.value,E=Rs(r)):au(r)?(h=()=>u(r),E=!0):Ue(r)?(g=!0,E=r.some(H=>au(H)||Rs(H)),h=()=>r.map(H=>{if(on(H))return H.value;if(au(H))return u(H);if(ze(H))return l?l(H,2):H()})):ze(r)?e?h=l?()=>l(r,2):r:h=()=>{if(d){wo();try{d()}finally{Ro()}}const H=Ba;Ba=c;try{return l?l(r,3,[m]):r(m)}finally{Ba=H}}:h=Zs,e&&s){const H=h,Q=s===!0?1/0:s;h=()=>uo(H(),Q)}const O=gP(),T=()=>{c.stop(),O&&O.active&&Rv(O.effects,c)};if(i&&e){const H=e;e=(...Q)=>{H(...Q),T()}}let _=g?new Array(r.length).fill(dd):dd;const V=H=>{if(!(!(c.flags&1)||!c.dirty&&!H))if(e){const Q=c.run();if(s||E||(g?Q.some((oe,re)=>qo(oe,_[re])):qo(Q,_))){d&&d();const oe=Ba;Ba=c;try{const re=[Q,_===dd?void 0:g&&_[0]===dd?[]:_,m];_=Q,l?l(e,3,re):e(...re)}finally{Ba=oe}}}else c.run()};return a&&a(V),c=new KN(h),c.scheduler=o?()=>o(V,!1):V,m=H=>BP(H,!1,c),d=c.onStop=()=>{const H=sm.get(c);if(H){if(l)l(H,4);else for(const Q of H)Q();sm.delete(c)}},e?n?V(!0):_=c.run():o?o(V.bind(null,!0),!0):c.run(),T.pause=c.pause.bind(c),T.resume=c.resume.bind(c),T.stop=T,T}function uo(r,e=1/0,t){if(e<=0||!Pt(r)||r.__v_skip||(t=t||new Map,(t.get(r)||0)>=e))return r;if(t.set(r,e),e--,on(r))uo(r.value,e,t);else if(Ue(r))for(let n=0;n<r.length;n++)uo(r[n],e,t);else if(sp(r)||ou(r))r.forEach(n=>{uo(n,e,t)});else if(WN(r)){for(const n in r)uo(r[n],e,t);for(const n of Object.getOwnPropertySymbols(r))Object.prototype.propertyIsEnumerable.call(r,n)&&uo(r[n],e,t)}return r}/**
* @vue/runtime-core v3.5.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Mh(r,e,t,n){try{return n?r(...n):r()}catch(s){cp(s,e,t)}}function Li(r,e,t,n){if(ze(r)){const s=Mh(r,e,t,n);return s&&kN(s)&&s.catch(i=>{cp(i,e,t)}),s}if(Ue(r)){const s=[];for(let i=0;i<r.length;i++)s.push(Li(r[i],e,t,n));return s}}function cp(r,e,t,n=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||At;if(e){let a=e.parent;const l=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const c=a.ec;if(c){for(let h=0;h<c.length;h++)if(c[h](r,l,u)===!1)return}a=a.parent}if(i){wo(),Mh(i,null,10,[r,l,u]),Ro();return}}$P(r,t,s,n,o)}function $P(r,e,t,n=!0,s=!1){if(s)throw r;console.error(r)}const pn=[];let Si=-1;const lu=[];let Vo=null,Wl=0;const dA=Promise.resolve();let im=null;function Mv(r){const e=im||dA;return r?e.then(this?r.bind(this):r):e}function GP(r){let e=Si+1,t=pn.length;for(;e<t;){const n=e+t>>>1,s=pn[n],i=lh(s);i<r||i===r&&s.flags&2?e=n+1:t=n}return e}function _v(r){if(!(r.flags&1)){const e=lh(r),t=pn[pn.length-1];!t||!(r.flags&2)&&e>=lh(t)?pn.push(r):pn.splice(GP(e),0,r),r.flags|=1,fA()}}function fA(){im||(im=dA.then(gA))}function mA(r){Ue(r)?lu.push(...r):Vo&&r.id===-1?Vo.splice(Wl+1,0,r):r.flags&1||(lu.push(r),r.flags|=1),fA()}function QR(r,e,t=Si+1){for(;t<pn.length;t++){const n=pn[t];if(n&&n.flags&2){if(r&&n.id!==r.uid)continue;pn.splice(t,1),t--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function pA(r){if(lu.length){const e=[...new Set(lu)].sort((t,n)=>lh(t)-lh(n));if(lu.length=0,Vo){Vo.push(...e);return}for(Vo=e,Wl=0;Wl<Vo.length;Wl++){const t=Vo[Wl];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}Vo=null,Wl=0}}const lh=r=>r.id==null?r.flags&2?-1:1/0:r.id;function gA(r){try{for(Si=0;Si<pn.length;Si++){const e=pn[Si];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Mh(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Si<pn.length;Si++){const e=pn[Si];e&&(e.flags&=-2)}Si=-1,pn.length=0,pA(),im=null,(pn.length||lu.length)&&gA()}}let sn=null,yA=null;function om(r){const e=sn;return sn=r,yA=r&&r.type.__scopeId||null,e}function zP(r,e=sn,t){if(!e||r._n)return r;const n=(...s)=>{n._d&&lS(-1);const i=om(e);let o;try{o=r(...s)}finally{om(i),n._d&&lS(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function as(r,e){if(sn===null)return r;const t=mp(sn),n=r.dirs||(r.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,a,l=At]=e[s];i&&(ze(i)&&(i={mounted:i,updated:i}),i.deep&&uo(o),n.push({dir:i,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return r}function wa(r,e,t,n){const s=r.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let l=a.dir[n];l&&(wo(),Li(l,t,8,[r.el,a,r,e]),Ro())}}const YP=Symbol("_vte"),jP=r=>r.__isTeleport,KP=Symbol("_leaveCb");function xv(r,e){r.shapeFlag&6&&r.component?(r.transition=e,xv(r.component.subTree,e)):r.shapeFlag&128?(r.ssContent.transition=e.clone(r.ssContent),r.ssFallback.transition=e.clone(r.ssFallback)):r.transition=e}function Lv(r,e){return ze(r)?ln({name:r.name},e,{setup:r}):r}function EA(r){r.ids=[r.ids[0]+r.ids[2]+++"-",0,0]}const am=new WeakMap;function Uc(r,e,t,n,s=!1){if(Ue(r)){r.forEach((E,g)=>Uc(E,e&&(Ue(e)?e[g]:e),t,n,s));return}if(uu(n)&&!s){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Uc(r,e,t,n.component.subTree);return}const i=n.shapeFlag&4?mp(n.component):n.el,o=s?null:i,{i:a,r:l}=r,u=e&&e.r,c=a.refs===At?a.refs={}:a.refs,h=a.setupState,d=vt(h),m=h===At?UN:E=>wt(d,E);if(u!=null&&u!==l){if(ZR(e),Er(u))c[u]=null,m(u)&&(h[u]=null);else if(on(u)){u.value=null;const E=e;E.k&&(c[E.k]=null)}}if(ze(l))Mh(l,a,12,[o,c]);else{const E=Er(l),g=on(l);if(E||g){const O=()=>{if(r.f){const T=E?m(l)?h[l]:c[l]:l.value;if(s)Ue(T)&&Rv(T,i);else if(Ue(T))T.includes(i)||T.push(i);else if(E)c[l]=[i],m(l)&&(h[l]=c[l]);else{const _=[i];l.value=_,r.k&&(c[r.k]=_)}}else E?(c[l]=o,m(l)&&(h[l]=o)):g&&(l.value=o,r.k&&(c[r.k]=o))};if(o){const T=()=>{O(),am.delete(r)};T.id=-1,am.set(r,T),zn(T,t)}else ZR(r),O()}}}function ZR(r){const e=am.get(r);e&&(e.flags|=8,am.delete(r))}op().requestIdleCallback;op().cancelIdleCallback;const uu=r=>!!r.type.__asyncLoader,vA=r=>r.type.__isKeepAlive;function XP(r,e){wA(r,"a",e)}function qP(r,e){wA(r,"da",e)}function wA(r,e,t=yn){const n=r.__wdc||(r.__wdc=()=>{let s=t;for(;s;){if(s.isDeactivated)return;s=s.parent}return r()});if(hp(e,n,t),t){let s=t.parent;for(;s&&s.parent;)vA(s.parent.vnode)&&QP(n,e,t,s),s=s.parent}}function QP(r,e,t,n){const s=hp(e,r,n,!0);Pv(()=>{Rv(n[e],s)},t)}function hp(r,e,t=yn,n=!1){if(t){const s=t[r]||(t[r]=[]),i=e.__weh||(e.__weh=(...o)=>{wo();const a=_h(t),l=Li(e,t,r,o);return a(),Ro(),l});return n?s.unshift(i):s.push(i),i}}const bo=r=>(e,t=yn)=>{(!ch||r==="sp")&&hp(r,(...n)=>e(...n),t)},ZP=bo("bm"),kc=bo("m"),RA=bo("bu"),JP=bo("u"),Nc=bo("bum"),Pv=bo("um"),eF=bo("sp"),tF=bo("rtg"),rF=bo("rtc");function nF(r,e=yn){hp("ec",r,e)}const sF=Symbol.for("v-ndc");function JR(r,e,t,n){let s;const i=t,o=Ue(r);if(o||Er(r)){const a=o&&au(r);let l=!1,u=!1;a&&(l=!Rs(r),u=sa(r),r=up(r)),s=new Array(r.length);for(let c=0,h=r.length;c<h;c++)s[c]=e(l?u?nm($r(r[c])):$r(r[c]):r[c],c,void 0,i)}else if(typeof r=="number"){s=new Array(r);for(let a=0;a<r;a++)s[a]=e(a+1,a,void 0,i)}else if(Pt(r))if(r[Symbol.iterator])s=Array.from(r,(a,l)=>e(a,l,void 0,i));else{const a=Object.keys(r);s=new Array(a.length);for(let l=0,u=a.length;l<u;l++){const c=a[l];s[l]=e(r[c],c,l,i)}}else s=[];return s}function iF(r,e,t={},n,s){if(sn.ce||sn.parent&&uu(sn.parent)&&sn.parent.ce)return pr(),um(gn,null,[_i("slot",t,n)],64);let i=r[e];i&&i._c&&(i._d=!1),pr();const o=i&&SA(i(t)),a=t.key||o&&o.key,l=um(gn,{key:(a&&!ri(a)?a:`_${e}`)+(!o&&n?"_fb":"")},o||[],o&&r._===1?64:-2);return l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),i&&i._c&&(i._d=!0),l}function SA(r){return r.some(e=>Hv(e)?!(e.type===So||e.type===gn&&!SA(e.children)):!0)?r:null}const Ky=r=>r?$A(r)?mp(r):Ky(r.parent):null,Bc=ln(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>Ky(r.parent),$root:r=>Ky(r.root),$host:r=>r.ce,$emit:r=>r.emit,$options:r=>TA(r),$forceUpdate:r=>r.f||(r.f=()=>{_v(r.update)}),$nextTick:r=>r.n||(r.n=Mv.bind(r.proxy)),$watch:r=>AF.bind(r)}),dg=(r,e)=>r!==At&&!r.__isScriptSetup&&wt(r,e),oF={get({_:r},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:n,data:s,props:i,accessCache:o,type:a,appContext:l}=r;let u;if(e[0]!=="$"){const m=o[e];if(m!==void 0)switch(m){case 1:return n[e];case 2:return s[e];case 4:return t[e];case 3:return i[e]}else{if(dg(n,e))return o[e]=1,n[e];if(s!==At&&wt(s,e))return o[e]=2,s[e];if((u=r.propsOptions[0])&&wt(u,e))return o[e]=3,i[e];if(t!==At&&wt(t,e))return o[e]=4,t[e];Xy&&(o[e]=0)}}const c=Bc[e];let h,d;if(c)return e==="$attrs"&&rn(r.attrs,"get",""),c(r);if((h=a.__cssModules)&&(h=h[e]))return h;if(t!==At&&wt(t,e))return o[e]=4,t[e];if(d=l.config.globalProperties,wt(d,e))return d[e]},set({_:r},e,t){const{data:n,setupState:s,ctx:i}=r;return dg(s,e)?(s[e]=t,!0):n!==At&&wt(n,e)?(n[e]=t,!0):wt(r.props,e)||e[0]==="$"&&e.slice(1)in r?!1:(i[e]=t,!0)},has({_:{data:r,setupState:e,accessCache:t,ctx:n,appContext:s,propsOptions:i,type:o}},a){let l,u;return!!(t[a]||r!==At&&a[0]!=="$"&&wt(r,a)||dg(e,a)||(l=i[0])&&wt(l,a)||wt(n,a)||wt(Bc,a)||wt(s.config.globalProperties,a)||(u=o.__cssModules)&&u[a])},defineProperty(r,e,t){return t.get!=null?r._.accessCache[e]=0:wt(t,"value")&&this.set(r,e,t.value,null),Reflect.defineProperty(r,e,t)}};function eS(r){return Ue(r)?r.reduce((e,t)=>(e[t]=null,e),{}):r}let Xy=!0;function aF(r){const e=TA(r),t=r.proxy,n=r.ctx;Xy=!1,e.beforeCreate&&tS(e.beforeCreate,r,"bc");const{data:s,computed:i,methods:o,watch:a,provide:l,inject:u,created:c,beforeMount:h,mounted:d,beforeUpdate:m,updated:E,activated:g,deactivated:O,beforeDestroy:T,beforeUnmount:_,destroyed:V,unmounted:H,render:Q,renderTracked:oe,renderTriggered:re,errorCaptured:ie,serverPrefetch:Fe,expose:Ie,inheritAttrs:_e,components:tt,directives:Ge,filters:ke}=e;if(u&&lF(u,n,null),o)for(const Ne in o){const ue=o[Ne];ze(ue)&&(n[Ne]=ue.bind(t))}if(s){const Ne=s.call(t,t);Pt(Ne)&&(r.data=Ws(Ne))}if(Xy=!0,i)for(const Ne in i){const ue=i[Ne],Ae=ze(ue)?ue.bind(t,t):ze(ue.get)?ue.get.bind(t,t):Zs,bt=!ze(ue)&&ze(ue.set)?ue.set.bind(t):Zs,p=Ri({get:Ae,set:bt});Object.defineProperty(n,Ne,{enumerable:!0,configurable:!0,get:()=>p.value,set:y=>p.value=y})}if(a)for(const Ne in a)CA(a[Ne],n,t,Ne);if(l){const Ne=ze(l)?l.call(t):l;Reflect.ownKeys(Ne).forEach(ue=>{mF(ue,Ne[ue])})}c&&tS(c,r,"c");function je(Ne,ue){Ue(ue)?ue.forEach(Ae=>Ne(Ae.bind(t))):ue&&Ne(ue.bind(t))}if(je(ZP,h),je(kc,d),je(RA,m),je(JP,E),je(XP,g),je(qP,O),je(nF,ie),je(rF,oe),je(tF,re),je(Nc,_),je(Pv,H),je(eF,Fe),Ue(Ie))if(Ie.length){const Ne=r.exposed||(r.exposed={});Ie.forEach(ue=>{Object.defineProperty(Ne,ue,{get:()=>t[ue],set:Ae=>t[ue]=Ae,enumerable:!0})})}else r.exposed||(r.exposed={});Q&&r.render===Zs&&(r.render=Q),_e!=null&&(r.inheritAttrs=_e),tt&&(r.components=tt),Ge&&(r.directives=Ge),Fe&&EA(r)}function lF(r,e,t=Zs){Ue(r)&&(r=qy(r));for(const n in r){const s=r[n];let i;Pt(s)?"default"in s?i=Tf(s.from||n,s.default,!0):i=Tf(s.from||n):i=Tf(s),on(i)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[n]=i}}function tS(r,e,t){Li(Ue(r)?r.map(n=>n.bind(e.proxy)):r.bind(e.proxy),e,t)}function CA(r,e,t,n){let s=n.includes(".")?HA(t,n):()=>t[n];if(Er(r)){const i=e[r];ze(i)&&Wc(s,i)}else if(ze(r))Wc(s,r.bind(t));else if(Pt(r))if(Ue(r))r.forEach(i=>CA(i,e,t,n));else{const i=ze(r.handler)?r.handler.bind(t):e[r.handler];ze(i)&&Wc(s,i,r)}}function TA(r){const e=r.type,{mixins:t,extends:n}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=r.appContext,a=i.get(e);let l;return a?l=a:!s.length&&!t&&!n?l=e:(l={},s.length&&s.forEach(u=>lm(l,u,o,!0)),lm(l,e,o)),Pt(e)&&i.set(e,l),l}function lm(r,e,t,n=!1){const{mixins:s,extends:i}=e;i&&lm(r,i,t,!0),s&&s.forEach(o=>lm(r,o,t,!0));for(const o in e)if(!(n&&o==="expose")){const a=uF[o]||t&&t[o];r[o]=a?a(r[o],e[o]):e[o]}return r}const uF={data:rS,props:nS,emits:nS,methods:Ac,computed:Ac,beforeCreate:fn,created:fn,beforeMount:fn,mounted:fn,beforeUpdate:fn,updated:fn,beforeDestroy:fn,beforeUnmount:fn,destroyed:fn,unmounted:fn,activated:fn,deactivated:fn,errorCaptured:fn,serverPrefetch:fn,components:Ac,directives:Ac,watch:hF,provide:rS,inject:cF};function rS(r,e){return e?r?function(){return ln(ze(r)?r.call(this,this):r,ze(e)?e.call(this,this):e)}:e:r}function cF(r,e){return Ac(qy(r),qy(e))}function qy(r){if(Ue(r)){const e={};for(let t=0;t<r.length;t++)e[r[t]]=r[t];return e}return r}function fn(r,e){return r?[...new Set([].concat(r,e))]:e}function Ac(r,e){return r?ln(Object.create(null),r,e):e}function nS(r,e){return r?Ue(r)&&Ue(e)?[...new Set([...r,...e])]:ln(Object.create(null),eS(r),eS(e??{})):e}function hF(r,e){if(!r)return e;if(!e)return r;const t=ln(Object.create(null),r);for(const n in e)t[n]=fn(r[n],e[n]);return t}function bA(){return{app:null,config:{isNativeTag:UN,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let dF=0;function fF(r,e){return function(n,s=null){ze(n)||(n=ln({},n)),s!=null&&!Pt(s)&&(s=null);const i=bA(),o=new WeakSet,a=[];let l=!1;const u=i.app={_uid:dF++,_component:n,_props:s,_container:null,_context:i,_instance:null,version:KF,get config(){return i.config},set config(c){},use(c,...h){return o.has(c)||(c&&ze(c.install)?(o.add(c),c.install(u,...h)):ze(c)&&(o.add(c),c(u,...h))),u},mixin(c){return i.mixins.includes(c)||i.mixins.push(c),u},component(c,h){return h?(i.components[c]=h,u):i.components[c]},directive(c,h){return h?(i.directives[c]=h,u):i.directives[c]},mount(c,h,d){if(!l){const m=u._ceVNode||_i(n,s);return m.appContext=i,d===!0?d="svg":d===!1&&(d=void 0),r(m,c,d),l=!0,u._container=c,c.__vue_app__=u,mp(m.component)}},onUnmount(c){a.push(c)},unmount(){l&&(Li(a,u._instance,16),r(null,u._container),delete u._container.__vue_app__)},provide(c,h){return i.provides[c]=h,u},runWithContext(c){const h=cu;cu=u;try{return c()}finally{cu=h}}};return u}}let cu=null;function mF(r,e){if(yn){let t=yn.provides;const n=yn.parent&&yn.parent.provides;n===t&&(t=yn.provides=Object.create(n)),t[r]=e}}function Tf(r,e,t=!1){const n=WA();if(n||cu){let s=cu?cu._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(s&&r in s)return s[r];if(arguments.length>1)return t&&ze(e)?e.call(n&&n.proxy):e}}const NA={},AA=()=>Object.create(NA),OA=r=>Object.getPrototypeOf(r)===NA;function pF(r,e,t,n=!1){const s={},i=AA();r.propsDefaults=Object.create(null),IA(r,e,s,i);for(const o in r.propsOptions[0])o in s||(s[o]=void 0);t?r.props=n?s:FP(s):r.type.props?r.props=s:r.props=i,r.attrs=i}function gF(r,e,t,n){const{props:s,attrs:i,vnode:{patchFlag:o}}=r,a=vt(s),[l]=r.propsOptions;let u=!1;if((n||o>0)&&!(o&16)){if(o&8){const c=r.vnode.dynamicProps;for(let h=0;h<c.length;h++){let d=c[h];if(dp(r.emitsOptions,d))continue;const m=e[d];if(l)if(wt(i,d))m!==i[d]&&(i[d]=m,u=!0);else{const E=na(d);s[E]=Qy(l,a,E,m,r,!1)}else m!==i[d]&&(i[d]=m,u=!0)}}}else{IA(r,e,s,i)&&(u=!0);let c;for(const h in a)(!e||!wt(e,h)&&((c=la(h))===h||!wt(e,c)))&&(l?t&&(t[h]!==void 0||t[c]!==void 0)&&(s[h]=Qy(l,a,h,void 0,r,!0)):delete s[h]);if(i!==a)for(const h in i)(!e||!wt(e,h))&&(delete i[h],u=!0)}u&&lo(r.attrs,"set","")}function IA(r,e,t,n){const[s,i]=r.propsOptions;let o=!1,a;if(e)for(let l in e){if(Dc(l))continue;const u=e[l];let c;s&&wt(s,c=na(l))?!i||!i.includes(c)?t[c]=u:(a||(a={}))[c]=u:dp(r.emitsOptions,l)||(!(l in n)||u!==n[l])&&(n[l]=u,o=!0)}if(i){const l=vt(t),u=a||At;for(let c=0;c<i.length;c++){const h=i[c];t[h]=Qy(s,l,h,u[h],r,!wt(u,h))}}return o}function Qy(r,e,t,n,s,i){const o=r[t];if(o!=null){const a=wt(o,"default");if(a&&n===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&ze(l)){const{propsDefaults:u}=s;if(t in u)n=u[t];else{const c=_h(s);n=u[t]=l.call(null,e),c()}}else n=l;s.ce&&s.ce._setProp(t,n)}o[0]&&(i&&!a?n=!1:o[1]&&(n===""||n===la(t))&&(n=!0))}return n}const yF=new WeakMap;function MA(r,e,t=!1){const n=t?yF:e.propsCache,s=n.get(r);if(s)return s;const i=r.props,o={},a=[];let l=!1;if(!ze(r)){const c=h=>{l=!0;const[d,m]=MA(h,e,!0);ln(o,d),m&&a.push(...m)};!t&&e.mixins.length&&e.mixins.forEach(c),r.extends&&c(r.extends),r.mixins&&r.mixins.forEach(c)}if(!i&&!l)return Pt(r)&&n.set(r,iu),iu;if(Ue(i))for(let c=0;c<i.length;c++){const h=na(i[c]);sS(h)&&(o[h]=At)}else if(i)for(const c in i){const h=na(c);if(sS(h)){const d=i[c],m=o[h]=Ue(d)||ze(d)?{type:d}:ln({},d),E=m.type;let g=!1,O=!0;if(Ue(E))for(let T=0;T<E.length;++T){const _=E[T],V=ze(_)&&_.name;if(V==="Boolean"){g=!0;break}else V==="String"&&(O=!1)}else g=ze(E)&&E.name==="Boolean";m[0]=g,m[1]=O,(g||wt(m,"default"))&&a.push(h)}}const u=[o,a];return Pt(r)&&n.set(r,u),u}function sS(r){return r[0]!=="$"&&!Dc(r)}const Fv=r=>r==="_"||r==="_ctx"||r==="$stable",Dv=r=>Ue(r)?r.map(Ti):[Ti(r)],EF=(r,e,t)=>{if(e._n)return e;const n=zP((...s)=>Dv(e(...s)),t);return n._c=!1,n},_A=(r,e,t)=>{const n=r._ctx;for(const s in r){if(Fv(s))continue;const i=r[s];if(ze(i))e[s]=EF(s,i,n);else if(i!=null){const o=Dv(i);e[s]=()=>o}}},xA=(r,e)=>{const t=Dv(e);r.slots.default=()=>t},LA=(r,e,t)=>{for(const n in e)(t||!Fv(n))&&(r[n]=e[n])},vF=(r,e,t)=>{const n=r.slots=AA();if(r.vnode.shapeFlag&32){const s=e._;s?(LA(n,e,t),t&&GN(n,"_",s,!0)):_A(e,n)}else e&&xA(r,e)},wF=(r,e,t)=>{const{vnode:n,slots:s}=r;let i=!0,o=At;if(n.shapeFlag&32){const a=e._;a?t&&a===1?i=!1:LA(s,e,t):(i=!e.$stable,_A(e,s)),o=e}else e&&(xA(r,e),o={default:1});if(i)for(const a in s)!Fv(a)&&o[a]==null&&delete s[a]},zn=FF;function RF(r){return SF(r)}function SF(r,e){const t=op();t.__VUE__=!0;const{insert:n,remove:s,patchProp:i,createElement:o,createText:a,createComment:l,setText:u,setElementText:c,parentNode:h,nextSibling:d,setScopeId:m=Zs,insertStaticContent:E}=r,g=(b,M,D,W=null,k=null,$=null,K=void 0,Y=null,z=!!M.dynamicChildren)=>{if(b===M)return;b&&!Xu(b,M)&&(W=G(b),y(b,k,$,!0),b=null),M.patchFlag===-2&&(z=!1,M.dynamicChildren=null);const{type:B,ref:ae,shapeFlag:se}=M;switch(B){case fp:O(b,M,D,W);break;case So:T(b,M,D,W);break;case bf:b==null&&_(M,D,W,K);break;case gn:tt(b,M,D,W,k,$,K,Y,z);break;default:se&1?Q(b,M,D,W,k,$,K,Y,z):se&6?Ge(b,M,D,W,k,$,K,Y,z):(se&64||se&128)&&B.process(b,M,D,W,k,$,K,Y,z,me)}ae!=null&&k?Uc(ae,b&&b.ref,$,M||b,!M):ae==null&&b&&b.ref!=null&&Uc(b.ref,null,$,b,!0)},O=(b,M,D,W)=>{if(b==null)n(M.el=a(M.children),D,W);else{const k=M.el=b.el;M.children!==b.children&&u(k,M.children)}},T=(b,M,D,W)=>{b==null?n(M.el=l(M.children||""),D,W):M.el=b.el},_=(b,M,D,W)=>{[b.el,b.anchor]=E(b.children,M,D,W,b.el,b.anchor)},V=({el:b,anchor:M},D,W)=>{let k;for(;b&&b!==M;)k=d(b),n(b,D,W),b=k;n(M,D,W)},H=({el:b,anchor:M})=>{let D;for(;b&&b!==M;)D=d(b),s(b),b=D;s(M)},Q=(b,M,D,W,k,$,K,Y,z)=>{M.type==="svg"?K="svg":M.type==="math"&&(K="mathml"),b==null?oe(M,D,W,k,$,K,Y,z):Fe(b,M,k,$,K,Y,z)},oe=(b,M,D,W,k,$,K,Y)=>{let z,B;const{props:ae,shapeFlag:se,transition:ye,dirs:Se}=b;if(z=b.el=o(b.type,$,ae&&ae.is,ae),se&8?c(z,b.children):se&16&&ie(b.children,z,null,W,k,fg(b,$),K,Y),Se&&wa(b,null,W,"created"),re(z,b,b.scopeId,K,W),ae){for(const De in ae)De!=="value"&&!Dc(De)&&i(z,De,null,ae[De],$,W);"value"in ae&&i(z,"value",null,ae.value,$),(B=ae.onVnodeBeforeMount)&&di(B,W,b)}Se&&wa(b,null,W,"beforeMount");const xe=CF(k,ye);xe&&ye.beforeEnter(z),n(z,M,D),((B=ae&&ae.onVnodeMounted)||xe||Se)&&zn(()=>{B&&di(B,W,b),xe&&ye.enter(z),Se&&wa(b,null,W,"mounted")},k)},re=(b,M,D,W,k)=>{if(D&&m(b,D),W)for(let $=0;$<W.length;$++)m(b,W[$]);if(k){let $=k.subTree;if(M===$||UA($.type)&&($.ssContent===M||$.ssFallback===M)){const K=k.vnode;re(b,K,K.scopeId,K.slotScopeIds,k.parent)}}},ie=(b,M,D,W,k,$,K,Y,z=0)=>{for(let B=z;B<b.length;B++){const ae=b[B]=Y?Uo(b[B]):Ti(b[B]);g(null,ae,M,D,W,k,$,K,Y)}},Fe=(b,M,D,W,k,$,K)=>{const Y=M.el=b.el;let{patchFlag:z,dynamicChildren:B,dirs:ae}=M;z|=b.patchFlag&16;const se=b.props||At,ye=M.props||At;let Se;if(D&&Ra(D,!1),(Se=ye.onVnodeBeforeUpdate)&&di(Se,D,M,b),ae&&wa(M,b,D,"beforeUpdate"),D&&Ra(D,!0),(se.innerHTML&&ye.innerHTML==null||se.textContent&&ye.textContent==null)&&c(Y,""),B?Ie(b.dynamicChildren,B,Y,D,W,fg(M,k),$):K||ue(b,M,Y,null,D,W,fg(M,k),$,!1),z>0){if(z&16)_e(Y,se,ye,D,k);else if(z&2&&se.class!==ye.class&&i(Y,"class",null,ye.class,k),z&4&&i(Y,"style",se.style,ye.style,k),z&8){const xe=M.dynamicProps;for(let De=0;De<xe.length;De++){const Le=xe[De],Kt=se[Le],Ht=ye[Le];(Ht!==Kt||Le==="value")&&i(Y,Le,Kt,Ht,k,D)}}z&1&&b.children!==M.children&&c(Y,M.children)}else!K&&B==null&&_e(Y,se,ye,D,k);((Se=ye.onVnodeUpdated)||ae)&&zn(()=>{Se&&di(Se,D,M,b),ae&&wa(M,b,D,"updated")},W)},Ie=(b,M,D,W,k,$,K)=>{for(let Y=0;Y<M.length;Y++){const z=b[Y],B=M[Y],ae=z.el&&(z.type===gn||!Xu(z,B)||z.shapeFlag&198)?h(z.el):D;g(z,B,ae,null,W,k,$,K,!0)}},_e=(b,M,D,W,k)=>{if(M!==D){if(M!==At)for(const $ in M)!Dc($)&&!($ in D)&&i(b,$,M[$],null,k,W);for(const $ in D){if(Dc($))continue;const K=D[$],Y=M[$];K!==Y&&$!=="value"&&i(b,$,Y,K,k,W)}"value"in D&&i(b,"value",M.value,D.value,k)}},tt=(b,M,D,W,k,$,K,Y,z)=>{const B=M.el=b?b.el:a(""),ae=M.anchor=b?b.anchor:a("");let{patchFlag:se,dynamicChildren:ye,slotScopeIds:Se}=M;Se&&(Y=Y?Y.concat(Se):Se),b==null?(n(B,D,W),n(ae,D,W),ie(M.children||[],D,ae,k,$,K,Y,z)):se>0&&se&64&&ye&&b.dynamicChildren?(Ie(b.dynamicChildren,ye,D,k,$,K,Y),(M.key!=null||k&&M===k.subTree)&&PA(b,M,!0)):ue(b,M,D,ae,k,$,K,Y,z)},Ge=(b,M,D,W,k,$,K,Y,z)=>{M.slotScopeIds=Y,b==null?M.shapeFlag&512?k.ctx.activate(M,D,W,K,z):ke(M,D,W,k,$,K,z):nt(b,M,z)},ke=(b,M,D,W,k,$,K)=>{const Y=b.component=WF(b,W,k);if(vA(b)&&(Y.ctx.renderer=me),$F(Y,!1,K),Y.asyncDep){if(k&&k.registerDep(Y,je,K),!b.el){const z=Y.subTree=_i(So);T(null,z,M,D),b.placeholder=z.el}}else je(Y,b,M,D,k,$,K)},nt=(b,M,D)=>{const W=M.component=b.component;if(LF(b,M,D))if(W.asyncDep&&!W.asyncResolved){Ne(W,M,D);return}else W.next=M,W.update();else M.el=b.el,W.vnode=M},je=(b,M,D,W,k,$,K)=>{const Y=()=>{if(b.isMounted){let{next:se,bu:ye,u:Se,parent:xe,vnode:De}=b;{const It=FA(b);if(It){se&&(se.el=De.el,Ne(b,se,K)),It.asyncDep.then(()=>{b.isUnmounted||Y()});return}}let Le=se,Kt;Ra(b,!1),se?(se.el=De.el,Ne(b,se,K)):se=De,ye&&Sf(ye),(Kt=se.props&&se.props.onVnodeBeforeUpdate)&&di(Kt,xe,se,De),Ra(b,!0);const Ht=oS(b),Rr=b.subTree;b.subTree=Ht,g(Rr,Ht,h(Rr.el),G(Rr),b,k,$),se.el=Ht.el,Le===null&&PF(b,Ht.el),Se&&zn(Se,k),(Kt=se.props&&se.props.onVnodeUpdated)&&zn(()=>di(Kt,xe,se,De),k)}else{let se;const{el:ye,props:Se}=M,{bm:xe,m:De,parent:Le,root:Kt,type:Ht}=b,Rr=uu(M);Ra(b,!1),xe&&Sf(xe),!Rr&&(se=Se&&Se.onVnodeBeforeMount)&&di(se,Le,M),Ra(b,!0);{Kt.ce&&Kt.ce._def.shadowRoot!==!1&&Kt.ce._injectChildStyle(Ht);const It=b.subTree=oS(b);g(null,It,D,W,b,k,$),M.el=It.el}if(De&&zn(De,k),!Rr&&(se=Se&&Se.onVnodeMounted)){const It=M;zn(()=>di(se,Le,It),k)}(M.shapeFlag&256||Le&&uu(Le.vnode)&&Le.vnode.shapeFlag&256)&&b.a&&zn(b.a,k),b.isMounted=!0,M=D=W=null}};b.scope.on();const z=b.effect=new KN(Y);b.scope.off();const B=b.update=z.run.bind(z),ae=b.job=z.runIfDirty.bind(z);ae.i=b,ae.id=b.uid,z.scheduler=()=>_v(ae),Ra(b,!0),B()},Ne=(b,M,D)=>{M.component=b;const W=b.vnode.props;b.vnode=M,b.next=null,gF(b,M.props,W,D),wF(b,M.children,D),wo(),QR(b),Ro()},ue=(b,M,D,W,k,$,K,Y,z=!1)=>{const B=b&&b.children,ae=b?b.shapeFlag:0,se=M.children,{patchFlag:ye,shapeFlag:Se}=M;if(ye>0){if(ye&128){bt(B,se,D,W,k,$,K,Y,z);return}else if(ye&256){Ae(B,se,D,W,k,$,K,Y,z);return}}Se&8?(ae&16&&U(B,k,$),se!==B&&c(D,se)):ae&16?Se&16?bt(B,se,D,W,k,$,K,Y,z):U(B,k,$,!0):(ae&8&&c(D,""),Se&16&&ie(se,D,W,k,$,K,Y,z))},Ae=(b,M,D,W,k,$,K,Y,z)=>{b=b||iu,M=M||iu;const B=b.length,ae=M.length,se=Math.min(B,ae);let ye;for(ye=0;ye<se;ye++){const Se=M[ye]=z?Uo(M[ye]):Ti(M[ye]);g(b[ye],Se,D,null,k,$,K,Y,z)}B>ae?U(b,k,$,!0,!1,se):ie(M,D,W,k,$,K,Y,z,se)},bt=(b,M,D,W,k,$,K,Y,z)=>{let B=0;const ae=M.length;let se=b.length-1,ye=ae-1;for(;B<=se&&B<=ye;){const Se=b[B],xe=M[B]=z?Uo(M[B]):Ti(M[B]);if(Xu(Se,xe))g(Se,xe,D,null,k,$,K,Y,z);else break;B++}for(;B<=se&&B<=ye;){const Se=b[se],xe=M[ye]=z?Uo(M[ye]):Ti(M[ye]);if(Xu(Se,xe))g(Se,xe,D,null,k,$,K,Y,z);else break;se--,ye--}if(B>se){if(B<=ye){const Se=ye+1,xe=Se<ae?M[Se].el:W;for(;B<=ye;)g(null,M[B]=z?Uo(M[B]):Ti(M[B]),D,xe,k,$,K,Y,z),B++}}else if(B>ye)for(;B<=se;)y(b[B],k,$,!0),B++;else{const Se=B,xe=B,De=new Map;for(B=xe;B<=ye;B++){const gt=M[B]=z?Uo(M[B]):Ti(M[B]);gt.key!=null&&De.set(gt.key,B)}let Le,Kt=0;const Ht=ye-xe+1;let Rr=!1,It=0;const Sr=new Array(Ht);for(B=0;B<Ht;B++)Sr[B]=0;for(B=Se;B<=se;B++){const gt=b[B];if(Kt>=Ht){y(gt,k,$,!0);continue}let rt;if(gt.key!=null)rt=De.get(gt.key);else for(Le=xe;Le<=ye;Le++)if(Sr[Le-xe]===0&&Xu(gt,M[Le])){rt=Le;break}rt===void 0?y(gt,k,$,!0):(Sr[rt-xe]=B+1,rt>=It?It=rt:Rr=!0,g(gt,M[rt],D,null,k,$,K,Y,z),Kt++)}const cr=Rr?TF(Sr):iu;for(Le=cr.length-1,B=Ht-1;B>=0;B--){const gt=xe+B,rt=M[gt],Nt=M[gt+1],Sn=gt+1<ae?Nt.el||Nt.placeholder:W;Sr[B]===0?g(null,rt,D,Sn,k,$,K,Y,z):Rr&&(Le<0||B!==cr[Le]?p(rt,D,Sn,2):Le--)}}},p=(b,M,D,W,k=null)=>{const{el:$,type:K,transition:Y,children:z,shapeFlag:B}=b;if(B&6){p(b.component.subTree,M,D,W);return}if(B&128){b.suspense.move(M,D,W);return}if(B&64){K.move(b,M,D,me);return}if(K===gn){n($,M,D);for(let se=0;se<z.length;se++)p(z[se],M,D,W);n(b.anchor,M,D);return}if(K===bf){V(b,M,D);return}if(W!==2&&B&1&&Y)if(W===0)Y.beforeEnter($),n($,M,D),zn(()=>Y.enter($),k);else{const{leave:se,delayLeave:ye,afterLeave:Se}=Y,xe=()=>{b.ctx.isUnmounted?s($):n($,M,D)},De=()=>{$._isLeaving&&$[KP](!0),se($,()=>{xe(),Se&&Se()})};ye?ye($,xe,De):De()}else n($,M,D)},y=(b,M,D,W=!1,k=!1)=>{const{type:$,props:K,ref:Y,children:z,dynamicChildren:B,shapeFlag:ae,patchFlag:se,dirs:ye,cacheIndex:Se}=b;if(se===-2&&(k=!1),Y!=null&&(wo(),Uc(Y,null,D,b,!0),Ro()),Se!=null&&(M.renderCache[Se]=void 0),ae&256){M.ctx.deactivate(b);return}const xe=ae&1&&ye,De=!uu(b);let Le;if(De&&(Le=K&&K.onVnodeBeforeUnmount)&&di(Le,M,b),ae&6)P(b.component,D,W);else{if(ae&128){b.suspense.unmount(D,W);return}xe&&wa(b,null,M,"beforeUnmount"),ae&64?b.type.remove(b,M,D,me,W):B&&!B.hasOnce&&($!==gn||se>0&&se&64)?U(B,M,D,!1,!0):($===gn&&se&384||!k&&ae&16)&&U(z,M,D),W&&R(b)}(De&&(Le=K&&K.onVnodeUnmounted)||xe)&&zn(()=>{Le&&di(Le,M,b),xe&&wa(b,null,M,"unmounted")},D)},R=b=>{const{type:M,el:D,anchor:W,transition:k}=b;if(M===gn){x(D,W);return}if(M===bf){H(b);return}const $=()=>{s(D),k&&!k.persisted&&k.afterLeave&&k.afterLeave()};if(b.shapeFlag&1&&k&&!k.persisted){const{leave:K,delayLeave:Y}=k,z=()=>K(D,$);Y?Y(b.el,$,z):z()}else $()},x=(b,M)=>{let D;for(;b!==M;)D=d(b),s(b),b=D;s(M)},P=(b,M,D)=>{const{bum:W,scope:k,job:$,subTree:K,um:Y,m:z,a:B}=b;iS(z),iS(B),W&&Sf(W),k.stop(),$&&($.flags|=8,y(K,b,M,D)),Y&&zn(Y,M),zn(()=>{b.isUnmounted=!0},M)},U=(b,M,D,W=!1,k=!1,$=0)=>{for(let K=$;K<b.length;K++)y(b[K],M,D,W,k)},G=b=>{if(b.shapeFlag&6)return G(b.component.subTree);if(b.shapeFlag&128)return b.suspense.next();const M=d(b.anchor||b.el),D=M&&M[YP];return D?d(D):M};let j=!1;const fe=(b,M,D)=>{b==null?M._vnode&&y(M._vnode,null,null,!0):g(M._vnode||null,b,M,null,null,null,D),M._vnode=b,j||(j=!0,QR(),pA(),j=!1)},me={p:g,um:y,m:p,r:R,mt:ke,mc:ie,pc:ue,pbc:Ie,n:G,o:r};return{render:fe,hydrate:void 0,createApp:fF(fe)}}function fg({type:r,props:e},t){return t==="svg"&&r==="foreignObject"||t==="mathml"&&r==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function Ra({effect:r,job:e},t){t?(r.flags|=32,e.flags|=4):(r.flags&=-33,e.flags&=-5)}function CF(r,e){return(!r||r&&!r.pendingBranch)&&e&&!e.persisted}function PA(r,e,t=!1){const n=r.children,s=e.children;if(Ue(n)&&Ue(s))for(let i=0;i<n.length;i++){const o=n[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=Uo(s[i]),a.el=o.el),!t&&a.patchFlag!==-2&&PA(o,a)),a.type===fp&&a.patchFlag!==-1&&(a.el=o.el),a.type===So&&!a.el&&(a.el=o.el)}}function TF(r){const e=r.slice(),t=[0];let n,s,i,o,a;const l=r.length;for(n=0;n<l;n++){const u=r[n];if(u!==0){if(s=t[t.length-1],r[s]<u){e[n]=s,t.push(n);continue}for(i=0,o=t.length-1;i<o;)a=i+o>>1,r[t[a]]<u?i=a+1:o=a;u<r[t[i]]&&(i>0&&(e[n]=t[i-1]),t[i]=n)}}for(i=t.length,o=t[i-1];i-- >0;)t[i]=o,o=e[o];return t}function FA(r){const e=r.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:FA(e)}function iS(r){if(r)for(let e=0;e<r.length;e++)r[e].flags|=8}const bF=Symbol.for("v-scx"),NF=()=>Tf(bF);function Wc(r,e,t){return DA(r,e,t)}function DA(r,e,t=At){const{immediate:n,deep:s,flush:i,once:o}=t,a=ln({},t),l=e&&n||!e&&i!=="post";let u;if(ch){if(i==="sync"){const m=NF();u=m.__watcherHandles||(m.__watcherHandles=[])}else if(!l){const m=()=>{};return m.stop=Zs,m.resume=Zs,m.pause=Zs,m}}const c=yn;a.call=(m,E,g)=>Li(m,c,E,g);let h=!1;i==="post"?a.scheduler=m=>{zn(m,c&&c.suspense)}:i!=="sync"&&(h=!0,a.scheduler=(m,E)=>{E?m():_v(m)}),a.augmentJob=m=>{e&&(m.flags|=4),h&&(m.flags|=2,c&&(m.id=c.uid,m.i=c))};const d=WP(r,e,a);return ch&&(u?u.push(d):l&&d()),d}function AF(r,e,t){const n=this.proxy,s=Er(r)?r.includes(".")?HA(n,r):()=>n[r]:r.bind(n,n);let i;ze(e)?i=e:(i=e.handler,t=e);const o=_h(this),a=DA(s,i.bind(n),t);return o(),a}function HA(r,e){const t=e.split(".");return()=>{let n=r;for(let s=0;s<t.length&&n;s++)n=n[t[s]];return n}}const OF=(r,e)=>e==="modelValue"||e==="model-value"?r.modelModifiers:r[`${e}Modifiers`]||r[`${na(e)}Modifiers`]||r[`${la(e)}Modifiers`];function IF(r,e,...t){if(r.isUnmounted)return;const n=r.vnode.props||At;let s=t;const i=e.startsWith("update:"),o=i&&OF(n,e.slice(7));o&&(o.trim&&(s=t.map(c=>Er(c)?c.trim():c)),o.number&&(s=t.map(rm)));let a,l=n[a=ag(e)]||n[a=ag(na(e))];!l&&i&&(l=n[a=ag(la(e))]),l&&Li(l,r,6,s);const u=n[a+"Once"];if(u){if(!r.emitted)r.emitted={};else if(r.emitted[a])return;r.emitted[a]=!0,Li(u,r,6,s)}}const MF=new WeakMap;function VA(r,e,t=!1){const n=t?MF:e.emitsCache,s=n.get(r);if(s!==void 0)return s;const i=r.emits;let o={},a=!1;if(!ze(r)){const l=u=>{const c=VA(u,e,!0);c&&(a=!0,ln(o,c))};!t&&e.mixins.length&&e.mixins.forEach(l),r.extends&&l(r.extends),r.mixins&&r.mixins.forEach(l)}return!i&&!a?(Pt(r)&&n.set(r,null),null):(Ue(i)?i.forEach(l=>o[l]=null):ln(o,i),Pt(r)&&n.set(r,o),o)}function dp(r,e){return!r||!np(e)?!1:(e=e.slice(2).replace(/Once$/,""),wt(r,e[0].toLowerCase()+e.slice(1))||wt(r,la(e))||wt(r,e))}function oS(r){const{type:e,vnode:t,proxy:n,withProxy:s,propsOptions:[i],slots:o,attrs:a,emit:l,render:u,renderCache:c,props:h,data:d,setupState:m,ctx:E,inheritAttrs:g}=r,O=om(r);let T,_;try{if(t.shapeFlag&4){const H=s||n,Q=H;T=Ti(u.call(Q,H,c,h,m,d,E)),_=a}else{const H=e;T=Ti(H.length>1?H(h,{attrs:a,slots:o,emit:l}):H(h,null)),_=e.props?a:_F(a)}}catch(H){$c.length=0,cp(H,r,1),T=_i(So)}let V=T;if(_&&g!==!1){const H=Object.keys(_),{shapeFlag:Q}=V;H.length&&Q&7&&(i&&H.some(wv)&&(_=xF(_,i)),V=Cu(V,_,!1,!0))}return t.dirs&&(V=Cu(V,null,!1,!0),V.dirs=V.dirs?V.dirs.concat(t.dirs):t.dirs),t.transition&&xv(V,t.transition),T=V,om(O),T}const _F=r=>{let e;for(const t in r)(t==="class"||t==="style"||np(t))&&((e||(e={}))[t]=r[t]);return e},xF=(r,e)=>{const t={};for(const n in r)(!wv(n)||!(n.slice(9)in e))&&(t[n]=r[n]);return t};function LF(r,e,t){const{props:n,children:s,component:i}=r,{props:o,children:a,patchFlag:l}=e,u=i.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return n?aS(n,o,u):!!o;if(l&8){const c=e.dynamicProps;for(let h=0;h<c.length;h++){const d=c[h];if(o[d]!==n[d]&&!dp(u,d))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:n===o?!1:n?o?aS(n,o,u):!0:!!o;return!1}function aS(r,e,t){const n=Object.keys(e);if(n.length!==Object.keys(r).length)return!0;for(let s=0;s<n.length;s++){const i=n[s];if(e[i]!==r[i]&&!dp(t,i))return!0}return!1}function PF({vnode:r,parent:e},t){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===r&&(n.el=r.el),n===r)(r=e.vnode).el=t,e=e.parent;else break}}const UA=r=>r.__isSuspense;function FF(r,e){e&&e.pendingBranch?Ue(r)?e.effects.push(...r):e.effects.push(r):mA(r)}const gn=Symbol.for("v-fgt"),fp=Symbol.for("v-txt"),So=Symbol.for("v-cmt"),bf=Symbol.for("v-stc"),$c=[];let jn=null;function pr(r=!1){$c.push(jn=r?null:[])}function DF(){$c.pop(),jn=$c[$c.length-1]||null}let uh=1;function lS(r,e=!1){uh+=r,r<0&&jn&&e&&(jn.hasOnce=!0)}function kA(r){return r.dynamicChildren=uh>0?jn||iu:null,DF(),uh>0&&jn&&jn.push(r),r}function Zr(r,e,t,n,s,i){return kA(F(r,e,t,n,s,i,!0))}function um(r,e,t,n,s){return kA(_i(r,e,t,n,s,!0))}function Hv(r){return r?r.__v_isVNode===!0:!1}function Xu(r,e){return r.type===e.type&&r.key===e.key}const BA=({key:r})=>r??null,Nf=({ref:r,ref_key:e,ref_for:t})=>(typeof r=="number"&&(r=""+r),r!=null?Er(r)||on(r)||ze(r)?{i:sn,r,k:e,f:!!t}:r:null);function F(r,e=null,t=null,n=0,s=null,i=r===gn?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:r,props:e,key:e&&BA(e),ref:e&&Nf(e),scopeId:yA,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:sn};return a?(Vv(l,t),i&128&&r.normalize(l)):t&&(l.shapeFlag|=Er(t)?8:16),uh>0&&!o&&jn&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&jn.push(l),l}const _i=HF;function HF(r,e=null,t=null,n=0,s=null,i=!1){if((!r||r===sF)&&(r=So),Hv(r)){const a=Cu(r,e,!0);return t&&Vv(a,t),uh>0&&!i&&jn&&(a.shapeFlag&6?jn[jn.indexOf(r)]=a:jn.push(a)),a.patchFlag=-2,a}if(jF(r)&&(r=r.__vccOpts),e){e=VF(e);let{class:a,style:l}=e;a&&!Er(a)&&(e.class=ap(a)),Pt(l)&&(Iv(l)&&!Ue(l)&&(l=ln({},l)),e.style=Yn(l))}const o=Er(r)?1:UA(r)?128:jP(r)?64:Pt(r)?4:ze(r)?2:0;return F(r,e,t,n,s,o,i,!0)}function VF(r){return r?Iv(r)||OA(r)?ln({},r):r:null}function Cu(r,e,t=!1,n=!1){const{props:s,ref:i,patchFlag:o,children:a,transition:l}=r,u=e?UF(s||{},e):s,c={__v_isVNode:!0,__v_skip:!0,type:r.type,props:u,key:u&&BA(u),ref:e&&e.ref?t&&i?Ue(i)?i.concat(Nf(e)):[i,Nf(e)]:Nf(e):i,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:a,target:r.target,targetStart:r.targetStart,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:e&&r.type!==gn?o===-1?16:o|16:o,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:l,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&Cu(r.ssContent),ssFallback:r.ssFallback&&Cu(r.ssFallback),placeholder:r.placeholder,el:r.el,anchor:r.anchor,ctx:r.ctx,ce:r.ce};return l&&n&&xv(c,l.clone(c)),c}function Zy(r=" ",e=0){return _i(fp,null,r,e)}function hi(r="",e=!1){return e?(pr(),um(So,null,r)):_i(So,null,r)}function Ti(r){return r==null||typeof r=="boolean"?_i(So):Ue(r)?_i(gn,null,r.slice()):Hv(r)?Uo(r):_i(fp,null,String(r))}function Uo(r){return r.el===null&&r.patchFlag!==-1||r.memo?r:Cu(r)}function Vv(r,e){let t=0;const{shapeFlag:n}=r;if(e==null)e=null;else if(Ue(e))t=16;else if(typeof e=="object")if(n&65){const s=e.default;s&&(s._c&&(s._d=!1),Vv(r,s()),s._c&&(s._d=!0));return}else{t=32;const s=e._;!s&&!OA(e)?e._ctx=sn:s===3&&sn&&(sn.slots._===1?e._=1:(e._=2,r.patchFlag|=1024))}else ze(e)?(e={default:e,_ctx:sn},t=32):(e=String(e),n&64?(t=16,e=[Zy(e)]):t=8);r.children=e,r.shapeFlag|=t}function UF(...r){const e={};for(let t=0;t<r.length;t++){const n=r[t];for(const s in n)if(s==="class")e.class!==n.class&&(e.class=ap([e.class,n.class]));else if(s==="style")e.style=Yn([e.style,n.style]);else if(np(s)){const i=e[s],o=n[s];o&&i!==o&&!(Ue(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=n[s])}return e}function di(r,e,t,n=null){Li(r,e,7,[t,n])}const kF=bA();let BF=0;function WF(r,e,t){const n=r.type,s=(e?e.appContext:r.appContext)||kF,i={uid:BF++,vnode:r,type:n,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new pP(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:MA(n,s),emitsOptions:VA(n,s),emit:null,emitted:null,propsDefaults:At,inheritAttrs:n.inheritAttrs,ctx:At,data:At,props:At,attrs:At,slots:At,refs:At,setupState:At,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=IF.bind(null,i),r.ce&&r.ce(i),i}let yn=null;const WA=()=>yn||sn;let cm,Jy;{const r=op(),e=(t,n)=>{let s;return(s=r[t])||(s=r[t]=[]),s.push(n),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};cm=e("__VUE_INSTANCE_SETTERS__",t=>yn=t),Jy=e("__VUE_SSR_SETTERS__",t=>ch=t)}const _h=r=>{const e=yn;return cm(r),r.scope.on(),()=>{r.scope.off(),cm(e)}},uS=()=>{yn&&yn.scope.off(),cm(null)};function $A(r){return r.vnode.shapeFlag&4}let ch=!1;function $F(r,e=!1,t=!1){e&&Jy(e);const{props:n,children:s}=r.vnode,i=$A(r);pF(r,n,i,e),vF(r,s,t||e);const o=i?GF(r,e):void 0;return e&&Jy(!1),o}function GF(r,e){const t=r.type;r.accessCache=Object.create(null),r.proxy=new Proxy(r.ctx,oF);const{setup:n}=t;if(n){wo();const s=r.setupContext=n.length>1?YF(r):null,i=_h(r),o=Mh(n,r,0,[r.props,s]),a=kN(o);if(Ro(),i(),(a||r.sp)&&!uu(r)&&EA(r),a){if(o.then(uS,uS),e)return o.then(l=>{cS(r,l)}).catch(l=>{cp(l,r,0)});r.asyncDep=o}else cS(r,o)}else GA(r)}function cS(r,e,t){ze(e)?r.type.__ssrInlineRender?r.ssrRender=e:r.render=e:Pt(e)&&(r.setupState=hA(e)),GA(r)}function GA(r,e,t){const n=r.type;r.render||(r.render=n.render||Zs);{const s=_h(r);wo();try{aF(r)}finally{Ro(),s()}}}const zF={get(r,e){return rn(r,"get",""),r[e]}};function YF(r){const e=t=>{r.exposed=t||{}};return{attrs:new Proxy(r.attrs,zF),slots:r.slots,emit:r.emit,expose:e}}function mp(r){return r.exposed?r.exposeProxy||(r.exposeProxy=new Proxy(hA(uA(r.exposed)),{get(e,t){if(t in e)return e[t];if(t in Bc)return Bc[t](r)},has(e,t){return t in e||t in Bc}})):r.proxy}function jF(r){return ze(r)&&"__vccOpts"in r}const Ri=(r,e)=>kP(r,e,ch),KF="3.5.21";/**
* @vue/runtime-dom v3.5.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let eE;const hS=typeof window<"u"&&window.trustedTypes;if(hS)try{eE=hS.createPolicy("vue",{createHTML:r=>r})}catch{}const zA=eE?r=>eE.createHTML(r):r=>r,XF="http://www.w3.org/2000/svg",qF="http://www.w3.org/1998/Math/MathML",so=typeof document<"u"?document:null,dS=so&&so.createElement("template"),QF={insert:(r,e,t)=>{e.insertBefore(r,t||null)},remove:r=>{const e=r.parentNode;e&&e.removeChild(r)},createElement:(r,e,t,n)=>{const s=e==="svg"?so.createElementNS(XF,r):e==="mathml"?so.createElementNS(qF,r):t?so.createElement(r,{is:t}):so.createElement(r);return r==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:r=>so.createTextNode(r),createComment:r=>so.createComment(r),setText:(r,e)=>{r.nodeValue=e},setElementText:(r,e)=>{r.textContent=e},parentNode:r=>r.parentNode,nextSibling:r=>r.nextSibling,querySelector:r=>so.querySelector(r),setScopeId(r,e){r.setAttribute(e,"")},insertStaticContent(r,e,t,n,s,i){const o=t?t.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),t),!(s===i||!(s=s.nextSibling)););else{dS.innerHTML=zA(n==="svg"?`<svg>${r}</svg>`:n==="mathml"?`<math>${r}</math>`:r);const a=dS.content;if(n==="svg"||n==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},ZF=Symbol("_vtc");function JF(r,e,t){const n=r[ZF];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?r.removeAttribute("class"):t?r.setAttribute("class",e):r.className=e}const fS=Symbol("_vod"),eD=Symbol("_vsh"),YA=Symbol("");function tD(r){const e=WA();if(!e)return;const t=e.ut=(s=r(e.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${e.uid}"]`)).forEach(i=>hm(i,s))},n=()=>{const s=r(e.proxy);e.ce?hm(e.ce,s):tE(e.subTree,s),t(s)};RA(()=>{mA(n)}),kc(()=>{Wc(n,Zs,{flush:"post"});const s=new MutationObserver(n);s.observe(e.subTree.el.parentNode,{childList:!0}),Pv(()=>s.disconnect())})}function tE(r,e){if(r.shapeFlag&128){const t=r.suspense;r=t.activeBranch,t.pendingBranch&&!t.isHydrating&&t.effects.push(()=>{tE(t.activeBranch,e)})}for(;r.component;)r=r.component.subTree;if(r.shapeFlag&1&&r.el)hm(r.el,e);else if(r.type===gn)r.children.forEach(t=>tE(t,e));else if(r.type===bf){let{el:t,anchor:n}=r;for(;t&&(hm(t,e),t!==n);)t=t.nextSibling}}function hm(r,e){if(r.nodeType===1){const t=r.style;let n="";for(const s in e){const i=mP(e[s]);t.setProperty(`--${s}`,i),n+=`--${s}: ${i};`}t[YA]=n}}const rD=/(?:^|;)\s*display\s*:/;function nD(r,e,t){const n=r.style,s=Er(t);let i=!1;if(t&&!s){if(e)if(Er(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&Af(n,a,"")}else for(const o in e)t[o]==null&&Af(n,o,"");for(const o in t)o==="display"&&(i=!0),Af(n,o,t[o])}else if(s){if(e!==t){const o=n[YA];o&&(t+=";"+o),n.cssText=t,i=rD.test(t)}}else e&&r.removeAttribute("style");fS in r&&(r[fS]=i?n.display:"",r[eD]&&(n.display="none"))}const mS=/\s*!important$/;function Af(r,e,t){if(Ue(t))t.forEach(n=>Af(r,e,n));else if(t==null&&(t=""),e.startsWith("--"))r.setProperty(e,t);else{const n=sD(r,e);mS.test(t)?r.setProperty(la(n),t.replace(mS,""),"important"):r[n]=t}}const pS=["Webkit","Moz","ms"],mg={};function sD(r,e){const t=mg[e];if(t)return t;let n=na(e);if(n!=="filter"&&n in r)return mg[e]=n;n=$N(n);for(let s=0;s<pS.length;s++){const i=pS[s]+n;if(i in r)return mg[e]=i}return e}const gS="http://www.w3.org/1999/xlink";function yS(r,e,t,n,s,i=hP(e)){n&&e.startsWith("xlink:")?t==null?r.removeAttributeNS(gS,e.slice(6,e.length)):r.setAttributeNS(gS,e,t):t==null||i&&!zN(t)?r.removeAttribute(e):r.setAttribute(e,i?"":ri(t)?String(t):t)}function ES(r,e,t,n,s){if(e==="innerHTML"||e==="textContent"){t!=null&&(r[e]=e==="innerHTML"?zA(t):t);return}const i=r.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?r.getAttribute("value")||"":r.value,l=t==null?r.type==="checkbox"?"on":"":String(t);(a!==l||!("_value"in r))&&(r.value=l),t==null&&r.removeAttribute(e),r._value=t;return}let o=!1;if(t===""||t==null){const a=typeof r[e];a==="boolean"?t=zN(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{r[e]=t}catch{}o&&r.removeAttribute(s||e)}function $a(r,e,t,n){r.addEventListener(e,t,n)}function iD(r,e,t,n){r.removeEventListener(e,t,n)}const vS=Symbol("_vei");function oD(r,e,t,n,s=null){const i=r[vS]||(r[vS]={}),o=i[e];if(n&&o)o.value=n;else{const[a,l]=aD(e);if(n){const u=i[e]=cD(n,s);$a(r,a,u,l)}else o&&(iD(r,a,o,l),i[e]=void 0)}}const wS=/(?:Once|Passive|Capture)$/;function aD(r){let e;if(wS.test(r)){e={};let n;for(;n=r.match(wS);)r=r.slice(0,r.length-n[0].length),e[n[0].toLowerCase()]=!0}return[r[2]===":"?r.slice(3):la(r.slice(2)),e]}let pg=0;const lD=Promise.resolve(),uD=()=>pg||(lD.then(()=>pg=0),pg=Date.now());function cD(r,e){const t=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=t.attached)return;Li(hD(n,t.value),e,5,[n])};return t.value=r,t.attached=uD(),t}function hD(r,e){if(Ue(e)){const t=r.stopImmediatePropagation;return r.stopImmediatePropagation=()=>{t.call(r),r._stopped=!0},e.map(n=>s=>!s._stopped&&n&&n(s))}else return e}const RS=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&r.charCodeAt(2)>96&&r.charCodeAt(2)<123,dD=(r,e,t,n,s,i)=>{const o=s==="svg";e==="class"?JF(r,n,o):e==="style"?nD(r,t,n):np(e)?wv(e)||oD(r,e,t,n,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):fD(r,e,n,o))?(ES(r,e,n),!r.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&yS(r,e,n,o,i,e!=="value")):r._isVueCE&&(/[A-Z]/.test(e)||!Er(n))?ES(r,na(e),n,i,e):(e==="true-value"?r._trueValue=n:e==="false-value"&&(r._falseValue=n),yS(r,e,n,o))};function fD(r,e,t,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in r&&RS(e)&&ze(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&r.tagName==="INPUT"||e==="type"&&r.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=r.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return RS(e)&&Er(t)?!1:e in r}const dm=r=>{const e=r.props["onUpdate:modelValue"]||!1;return Ue(e)?t=>Sf(e,t):e};function mD(r){r.target.composing=!0}function SS(r){const e=r.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const hu=Symbol("_assign"),Sa={created(r,{modifiers:{lazy:e,trim:t,number:n}},s){r[hu]=dm(s);const i=n||s.props&&s.props.type==="number";$a(r,e?"change":"input",o=>{if(o.target.composing)return;let a=r.value;t&&(a=a.trim()),i&&(a=rm(a)),r[hu](a)}),t&&$a(r,"change",()=>{r.value=r.value.trim()}),e||($a(r,"compositionstart",mD),$a(r,"compositionend",SS),$a(r,"change",SS))},mounted(r,{value:e}){r.value=e??""},beforeUpdate(r,{value:e,oldValue:t,modifiers:{lazy:n,trim:s,number:i}},o){if(r[hu]=dm(o),r.composing)return;const a=(i||r.type==="number")&&!/^0\d/.test(r.value)?rm(r.value):r.value,l=e??"";a!==l&&(document.activeElement===r&&r.type!=="range"&&(n&&e===t||s&&r.value.trim()===l)||(r.value=l))}},qu={deep:!0,created(r,{value:e,modifiers:{number:t}},n){const s=sp(e);$a(r,"change",()=>{const i=Array.prototype.filter.call(r.options,o=>o.selected).map(o=>t?rm(fm(o)):fm(o));r[hu](r.multiple?s?new Set(i):i:i[0]),r._assigning=!0,Mv(()=>{r._assigning=!1})}),r[hu]=dm(n)},mounted(r,{value:e}){CS(r,e)},beforeUpdate(r,e,t){r[hu]=dm(t)},updated(r,{value:e}){r._assigning||CS(r,e)}};function CS(r,e){const t=r.multiple,n=Ue(e);if(!(t&&!n&&!sp(e))){for(let s=0,i=r.options.length;s<i;s++){const o=r.options[s],a=fm(o);if(t)if(n){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(u=>String(u)===String(a)):o.selected=fP(e,a)>-1}else o.selected=e.has(a);else if(lp(fm(o),e)){r.selectedIndex!==s&&(r.selectedIndex=s);return}}!t&&r.selectedIndex!==-1&&(r.selectedIndex=-1)}}function fm(r){return"_value"in r?r._value:r.value}const pD=["ctrl","shift","alt","meta"],gD={stop:r=>r.stopPropagation(),prevent:r=>r.preventDefault(),self:r=>r.target!==r.currentTarget,ctrl:r=>!r.ctrlKey,shift:r=>!r.shiftKey,alt:r=>!r.altKey,meta:r=>!r.metaKey,left:r=>"button"in r&&r.button!==0,middle:r=>"button"in r&&r.button!==1,right:r=>"button"in r&&r.button!==2,exact:(r,e)=>pD.some(t=>r[`${t}Key`]&&!e.includes(t))},Qu=(r,e)=>{const t=r._withMods||(r._withMods={}),n=e.join(".");return t[n]||(t[n]=(s,...i)=>{for(let o=0;o<e.length;o++){const a=gD[e[o]];if(a&&a(s,e))return}return r(s,...i)})},yD={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},fd=(r,e)=>{const t=r._withKeys||(r._withKeys={}),n=e.join(".");return t[n]||(t[n]=s=>{if(!("key"in s))return;const i=la(s.key);if(e.some(o=>o===i||yD[o]===i))return r(s)})},ED=ln({patchProp:dD},QF);let TS;function vD(){return TS||(TS=RF(ED))}const wD=(...r)=>{const e=vD().createApp(...r),{mount:t}=e;return e.mount=n=>{const s=SD(n);if(!s)return;const i=e._component;!ze(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=t(s,!1,RD(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function RD(r){if(r instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&r instanceof MathMLElement)return"mathml"}function SD(r){return Er(r)?document.querySelector(r):r}var Oc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Zu=function(r){return r&&r.Math===Math&&r},Vr=Zu(typeof globalThis=="object"&&globalThis)||Zu(typeof window=="object"&&window)||Zu(typeof self=="object"&&self)||Zu(typeof Oc=="object"&&Oc)||Zu(typeof Oc=="object"&&Oc)||function(){return this}()||Function("return this")(),Uv={},un=function(r){try{return!!r()}catch{return!0}},CD=un,Vi=!CD(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),TD=un,pp=!TD(function(){var r=(function(){}).bind();return typeof r!="function"||r.hasOwnProperty("prototype")}),bD=pp,md=Function.prototype.call,No=bD?md.bind(md):function(){return md.apply(md,arguments)},jA={},KA={}.propertyIsEnumerable,XA=Object.getOwnPropertyDescriptor,ND=XA&&!KA.call({1:2},1);jA.f=ND?function(e){var t=XA(this,e);return!!t&&t.enumerable}:KA;var kv=function(r,e){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:e}},qA=pp,QA=Function.prototype,rE=QA.call,AD=qA&&QA.bind.bind(rE,rE),vr=qA?AD:function(r){return function(){return rE.apply(r,arguments)}},ZA=vr,OD=ZA({}.toString),ID=ZA("".slice),ul=function(r){return ID(OD(r),8,-1)},MD=vr,_D=un,xD=ul,gg=Object,LD=MD("".split),PD=_D(function(){return!gg("z").propertyIsEnumerable(0)})?function(r){return xD(r)==="String"?LD(r,""):gg(r)}:gg,JA=function(r){return r==null},FD=JA,DD=TypeError,xh=function(r){if(FD(r))throw new DD("Can't call method on "+r);return r},HD=PD,VD=xh,gp=function(r){return HD(VD(r))},yg=typeof document=="object"&&document.all,jr=typeof yg>"u"&&yg!==void 0?function(r){return typeof r=="function"||r===yg}:function(r){return typeof r=="function"},UD=jr,Ui=function(r){return typeof r=="object"?r!==null:UD(r)},Eg=Vr,kD=jr,BD=function(r){return kD(r)?r:void 0},xu=function(r,e){return arguments.length<2?BD(Eg[r]):Eg[r]&&Eg[r][e]},WD=vr,Bv=WD({}.isPrototypeOf),$D=Vr,bS=$D.navigator,NS=bS&&bS.userAgent,yp=NS?String(NS):"",eO=Vr,vg=yp,AS=eO.process,OS=eO.Deno,IS=AS&&AS.versions||OS&&OS.version,MS=IS&&IS.v8,zs,mm;MS&&(zs=MS.split("."),mm=zs[0]>0&&zs[0]<4?1:+(zs[0]+zs[1]));!mm&&vg&&(zs=vg.match(/Edge\/(\d+)/),(!zs||zs[1]>=74)&&(zs=vg.match(/Chrome\/(\d+)/),zs&&(mm=+zs[1])));var GD=mm,_S=GD,zD=un,YD=Vr,jD=YD.String,Wv=!!Object.getOwnPropertySymbols&&!zD(function(){var r=Symbol("symbol detection");return!jD(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&_S&&_S<41}),KD=Wv,tO=KD&&!Symbol.sham&&typeof Symbol.iterator=="symbol",XD=xu,qD=jr,QD=Bv,ZD=tO,JD=Object,$v=ZD?function(r){return typeof r=="symbol"}:function(r){var e=XD("Symbol");return qD(e)&&QD(e.prototype,JD(r))},eH=String,tH=function(r){try{return eH(r)}catch{return"Object"}},rH=jr,nH=tH,sH=TypeError,Ep=function(r){if(rH(r))return r;throw new sH(nH(r)+" is not a function")},iH=Ep,oH=JA,Gv=function(r,e){var t=r[e];return oH(t)?void 0:iH(t)},wg=No,Rg=jr,Sg=Ui,aH=TypeError,lH=function(r,e){var t,n;if(e==="string"&&Rg(t=r.toString)&&!Sg(n=wg(t,r))||Rg(t=r.valueOf)&&!Sg(n=wg(t,r))||e!=="string"&&Rg(t=r.toString)&&!Sg(n=wg(t,r)))return n;throw new aH("Can't convert object to primitive value")},rO={exports:{}},xS=Vr,uH=Object.defineProperty,zv=function(r,e){try{uH(xS,r,{value:e,configurable:!0,writable:!0})}catch{xS[r]=e}return e},cH=Vr,hH=zv,LS="__core-js_shared__",PS=rO.exports=cH[LS]||hH(LS,{});(PS.versions||(PS.versions=[])).push({version:"3.45.1",mode:"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.45.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Yv=rO.exports,FS=Yv,nO=function(r,e){return FS[r]||(FS[r]=e||{})},dH=xh,fH=Object,vp=function(r){return fH(dH(r))},mH=vr,pH=vp,gH=mH({}.hasOwnProperty),ki=Object.hasOwn||function(e,t){return gH(pH(e),t)},yH=vr,EH=0,vH=Math.random(),wH=yH(1.1.toString),sO=function(r){return"Symbol("+(r===void 0?"":r)+")_"+wH(++EH+vH,36)},RH=Vr,SH=nO,DS=ki,CH=sO,TH=Wv,bH=tO,ql=RH.Symbol,Cg=SH("wks"),NH=bH?ql.for||ql:ql&&ql.withoutSetter||CH,Lu=function(r){return DS(Cg,r)||(Cg[r]=TH&&DS(ql,r)?ql[r]:NH("Symbol."+r)),Cg[r]},AH=No,HS=Ui,VS=$v,OH=Gv,IH=lH,MH=Lu,_H=TypeError,xH=MH("toPrimitive"),LH=function(r,e){if(!HS(r)||VS(r))return r;var t=OH(r,xH),n;if(t){if(e===void 0&&(e="default"),n=AH(t,r,e),!HS(n)||VS(n))return n;throw new _H("Can't convert object to primitive value")}return e===void 0&&(e="number"),IH(r,e)},PH=LH,FH=$v,iO=function(r){var e=PH(r,"string");return FH(e)?e:e+""},DH=Vr,US=Ui,nE=DH.document,HH=US(nE)&&US(nE.createElement),jv=function(r){return HH?nE.createElement(r):{}},VH=Vi,UH=un,kH=jv,oO=!VH&&!UH(function(){return Object.defineProperty(kH("div"),"a",{get:function(){return 7}}).a!==7}),BH=Vi,WH=No,$H=jA,GH=kv,zH=gp,YH=iO,jH=ki,KH=oO,kS=Object.getOwnPropertyDescriptor;Uv.f=BH?kS:function(e,t){if(e=zH(e),t=YH(t),KH)try{return kS(e,t)}catch{}if(jH(e,t))return GH(!WH($H.f,e,t),e[t])};var cl={},XH=Vi,qH=un,aO=XH&&qH(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),QH=Ui,ZH=String,JH=TypeError,hl=function(r){if(QH(r))return r;throw new JH(ZH(r)+" is not an object")},eV=Vi,tV=oO,rV=aO,pd=hl,BS=iO,nV=TypeError,Tg=Object.defineProperty,sV=Object.getOwnPropertyDescriptor,bg="enumerable",Ng="configurable",Ag="writable";cl.f=eV?rV?function(e,t,n){if(pd(e),t=BS(t),pd(n),typeof e=="function"&&t==="prototype"&&"value"in n&&Ag in n&&!n[Ag]){var s=sV(e,t);s&&s[Ag]&&(e[t]=n.value,n={configurable:Ng in n?n[Ng]:s[Ng],enumerable:bg in n?n[bg]:s[bg],writable:!1})}return Tg(e,t,n)}:Tg:function(e,t,n){if(pd(e),t=BS(t),pd(n),tV)try{return Tg(e,t,n)}catch{}if("get"in n||"set"in n)throw new nV("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var iV=Vi,oV=cl,aV=kv,Lh=iV?function(r,e,t){return oV.f(r,e,aV(1,t))}:function(r,e,t){return r[e]=t,r},lO={exports:{}},sE=Vi,lV=ki,uO=Function.prototype,uV=sE&&Object.getOwnPropertyDescriptor,cV=lV(uO,"name"),hV=cV&&(!sE||sE&&uV(uO,"name").configurable),dV={CONFIGURABLE:hV},fV=vr,mV=jr,iE=Yv,pV=fV(Function.toString);mV(iE.inspectSource)||(iE.inspectSource=function(r){return pV(r)});var gV=iE.inspectSource,yV=Vr,EV=jr,WS=yV.WeakMap,vV=EV(WS)&&/native code/.test(String(WS)),wV=nO,RV=sO,$S=wV("keys"),cO=function(r){return $S[r]||($S[r]=RV(r))},Kv={},SV=vV,hO=Vr,CV=Lh,Og=ki,Ig=Yv,TV=cO,bV=Kv,GS="Object already initialized",zS=hO.TypeError,NV=hO.WeakMap,oE,pm,aE,AV=function(r){return aE(r)?pm(r):oE(r,{})};if(SV||Ig.state){var fi=Ig.state||(Ig.state=new NV);fi.get=fi.get,fi.has=fi.has,fi.set=fi.set,oE=function(r,e){if(fi.has(r))throw new zS(GS);return e.facade=r,fi.set(r,e),e},pm=function(r){return fi.get(r)||{}},aE=function(r){return fi.has(r)}}else{var Nl=TV("state");bV[Nl]=!0,oE=function(r,e){if(Og(r,Nl))throw new zS(GS);return e.facade=r,CV(r,Nl,e),e},pm=function(r){return Og(r,Nl)?r[Nl]:{}},aE=function(r){return Og(r,Nl)}}var OV={get:pm,enforce:AV},Xv=vr,IV=un,MV=jr,gd=ki,lE=Vi,_V=dV.CONFIGURABLE,xV=gV,dO=OV,LV=dO.enforce,PV=dO.get,YS=String,Of=Object.defineProperty,FV=Xv("".slice),DV=Xv("".replace),HV=Xv([].join),VV=lE&&!IV(function(){return Of(function(){},"length",{value:8}).length!==8}),UV=String(String).split("String"),kV=lO.exports=function(r,e,t){FV(YS(e),0,7)==="Symbol("&&(e="["+DV(YS(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),t&&t.getter&&(e="get "+e),t&&t.setter&&(e="set "+e),(!gd(r,"name")||_V&&r.name!==e)&&(lE?Of(r,"name",{value:e,configurable:!0}):r.name=e),VV&&t&&gd(t,"arity")&&r.length!==t.arity&&Of(r,"length",{value:t.arity});try{t&&gd(t,"constructor")&&t.constructor?lE&&Of(r,"prototype",{writable:!1}):r.prototype&&(r.prototype=void 0)}catch{}var n=LV(r);return gd(n,"source")||(n.source=HV(UV,typeof e=="string"?e:"")),r};Function.prototype.toString=kV(function(){return MV(this)&&PV(this).source||xV(this)},"toString");var BV=lO.exports,WV=jr,$V=cl,GV=BV,zV=zv,YV=function(r,e,t,n){n||(n={});var s=n.enumerable,i=n.name!==void 0?n.name:e;if(WV(t)&&GV(t,i,n),n.global)s?r[e]=t:zV(e,t);else{try{n.unsafe?r[e]&&(s=!0):delete r[e]}catch{}s?r[e]=t:$V.f(r,e,{value:t,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return r},fO={},jV=Math.ceil,KV=Math.floor,XV=Math.trunc||function(e){var t=+e;return(t>0?KV:jV)(t)},qV=XV,Ph=function(r){var e=+r;return e!==e||e===0?0:qV(e)},QV=Ph,ZV=Math.max,JV=Math.min,eU=function(r,e){var t=QV(r);return t<0?ZV(t+e,0):JV(t,e)},tU=Ph,rU=Math.min,nU=function(r){var e=tU(r);return e>0?rU(e,9007199254740991):0},sU=nU,qv=function(r){return sU(r.length)},iU=gp,oU=eU,aU=qv,lU=function(r){return function(e,t,n){var s=iU(e),i=aU(s);if(i===0)return!r&&-1;var o=oU(n,i),a;if(r&&t!==t){for(;i>o;)if(a=s[o++],a!==a)return!0}else for(;i>o;o++)if((r||o in s)&&s[o]===t)return r||o||0;return!r&&-1}},uU={indexOf:lU(!1)},cU=vr,Mg=ki,hU=gp,dU=uU.indexOf,fU=Kv,jS=cU([].push),mO=function(r,e){var t=hU(r),n=0,s=[],i;for(i in t)!Mg(fU,i)&&Mg(t,i)&&jS(s,i);for(;e.length>n;)Mg(t,i=e[n++])&&(~dU(s,i)||jS(s,i));return s},Qv=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],mU=mO,pU=Qv,gU=pU.concat("length","prototype");fO.f=Object.getOwnPropertyNames||function(e){return mU(e,gU)};var pO={};pO.f=Object.getOwnPropertySymbols;var yU=xu,EU=vr,vU=fO,wU=pO,RU=hl,SU=EU([].concat),CU=yU("Reflect","ownKeys")||function(e){var t=vU.f(RU(e)),n=wU.f;return n?SU(t,n(e)):t},KS=ki,TU=CU,bU=Uv,NU=cl,gO=function(r,e,t){for(var n=TU(e),s=NU.f,i=bU.f,o=0;o<n.length;o++){var a=n[o];!KS(r,a)&&!(t&&KS(t,a))&&s(r,a,i(e,a))}},AU=un,OU=jr,IU=/#|\.prototype\./,Fh=function(r,e){var t=_U[MU(r)];return t===LU?!0:t===xU?!1:OU(e)?AU(e):!!e},MU=Fh.normalize=function(r){return String(r).replace(IU,".").toLowerCase()},_U=Fh.data={},xU=Fh.NATIVE="N",LU=Fh.POLYFILL="P",PU=Fh,yd=Vr,FU=Uv.f,DU=Lh,HU=YV,VU=zv,UU=gO,kU=PU,Rn=function(r,e){var t=r.target,n=r.global,s=r.stat,i,o,a,l,u,c;if(n?o=yd:s?o=yd[t]||VU(t,{}):o=yd[t]&&yd[t].prototype,o)for(a in e){if(u=e[a],r.dontCallGetSet?(c=FU(o,a),l=c&&c.value):l=o[a],i=kU(n?a:t+(s?".":"#")+a,r.forced),!i&&l!==void 0){if(typeof u==typeof l)continue;UU(u,l)}(r.sham||l&&l.sham)&&DU(u,"sham",!0),HU(o,a,u,r)}},BU=pp,yO=Function.prototype,XS=yO.apply,qS=yO.call,wp=typeof Reflect=="object"&&Reflect.apply||(BU?qS.bind(XS):function(){return qS.apply(XS,arguments)}),WU=vr,$U=Ep,EO=function(r,e,t){try{return WU($U(Object.getOwnPropertyDescriptor(r,e)[t]))}catch{}},GU=Ui,zU=function(r){return GU(r)||r===null},YU=zU,jU=String,KU=TypeError,XU=function(r){if(YU(r))return r;throw new KU("Can't set "+jU(r)+" as a prototype")},qU=EO,QU=Ui,ZU=xh,JU=XU,vO=Object.setPrototypeOf||("__proto__"in{}?function(){var r=!1,e={},t;try{t=qU(Object.prototype,"__proto__","set"),t(e,[]),r=e instanceof Array}catch{}return function(s,i){return ZU(s),JU(i),QU(s)&&(r?t(s,i):s.__proto__=i),s}}():void 0),ek=cl.f,tk=function(r,e,t){t in r||ek(r,t,{configurable:!0,get:function(){return e[t]},set:function(n){e[t]=n}})},rk=jr,nk=Ui,QS=vO,sk=function(r,e,t){var n,s;return QS&&rk(n=e.constructor)&&n!==t&&nk(s=n.prototype)&&s!==t.prototype&&QS(r,s),r},ik=Lu,ok=ik("toStringTag"),wO={};wO[ok]="z";var ak=String(wO)==="[object z]",lk=ak,uk=jr,If=ul,ck=Lu,hk=ck("toStringTag"),dk=Object,fk=If(function(){return arguments}())==="Arguments",mk=function(r,e){try{return r[e]}catch{}},pk=lk?If:function(r){var e,t,n;return r===void 0?"Undefined":r===null?"Null":typeof(t=mk(e=dk(r),hk))=="string"?t:fk?If(e):(n=If(e))==="Object"&&uk(e.callee)?"Arguments":n},gk=pk,yk=String,Rp=function(r){if(gk(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return yk(r)},Ek=Rp,vk=function(r,e){return r===void 0?arguments.length<2?"":e:Ek(r)},wk=Ui,Rk=Lh,Sk=function(r,e){wk(e)&&"cause"in e&&Rk(r,"cause",e.cause)},Ck=vr,RO=Error,Tk=Ck("".replace),bk=function(r){return String(new RO(r).stack)}("zxcasd"),SO=/\n\s*at [^:]*:[^\n]*/,Nk=SO.test(bk),Ak=function(r,e){if(Nk&&typeof r=="string"&&!RO.prepareStackTrace)for(;e--;)r=Tk(r,SO,"");return r},Ok=un,Ik=kv,Mk=!Ok(function(){var r=new Error("a");return"stack"in r?(Object.defineProperty(r,"stack",Ik(1,7)),r.stack!==7):!0}),_k=Lh,xk=Ak,Lk=Mk,ZS=Error.captureStackTrace,Pk=function(r,e,t,n){Lk&&(ZS?ZS(r,e):_k(r,"stack",xk(t,n)))},JS=xu,Fk=ki,eC=Lh,Dk=Bv,tC=vO,rC=gO,nC=tk,Hk=sk,Vk=vk,Uk=Sk,kk=Pk,Bk=Vi,Wk=function(r,e,t,n){var s="stackTraceLimit",i=n?2:1,o=r.split("."),a=o[o.length-1],l=JS.apply(null,o);if(l){var u=l.prototype;if(Fk(u,"cause")&&delete u.cause,!t)return l;var c=JS("Error"),h=e(function(d,m){var E=Vk(n?m:d,void 0),g=n?new l(d):new l;return E!==void 0&&eC(g,"message",E),kk(g,h,g.stack,2),this&&Dk(u,this)&&Hk(g,this,h),arguments.length>i&&Uk(g,arguments[i]),g});h.prototype=u,a!=="Error"?tC?tC(h,c):rC(h,c,{name:!0}):Bk&&s in l&&(nC(h,l,s),nC(h,l,"prepareStackTrace")),rC(h,l);try{u.name!==a&&eC(u,"name",a),u.constructor=h}catch{}return h}},CO=Rn,$k=Vr,Bi=wp,TO=Wk,uE="WebAssembly",sC=$k[uE],gm=new Error("e",{cause:7}).cause!==7,dl=function(r,e){var t={};t[r]=TO(r,e,gm),CO({global:!0,constructor:!0,arity:1,forced:gm},t)},Zv=function(r,e){if(sC&&sC[r]){var t={};t[r]=TO(uE+"."+r,e,gm),CO({target:uE,stat:!0,constructor:!0,arity:1,forced:gm},t)}};dl("Error",function(r){return function(t){return Bi(r,this,arguments)}});dl("EvalError",function(r){return function(t){return Bi(r,this,arguments)}});dl("RangeError",function(r){return function(t){return Bi(r,this,arguments)}});dl("ReferenceError",function(r){return function(t){return Bi(r,this,arguments)}});dl("SyntaxError",function(r){return function(t){return Bi(r,this,arguments)}});dl("TypeError",function(r){return function(t){return Bi(r,this,arguments)}});dl("URIError",function(r){return function(t){return Bi(r,this,arguments)}});Zv("CompileError",function(r){return function(t){return Bi(r,this,arguments)}});Zv("LinkError",function(r){return function(t){return Bi(r,this,arguments)}});Zv("RuntimeError",function(r){return function(t){return Bi(r,this,arguments)}});var Gk=ul,bO=Array.isArray||function(e){return Gk(e)==="Array"},zk=Vi,Yk=bO,jk=TypeError,Kk=Object.getOwnPropertyDescriptor,Xk=zk&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(r){return r instanceof TypeError}}(),qk=Xk?function(r,e){if(Yk(r)&&!Kk(r,"length").writable)throw new jk("Cannot set read only .length");return r.length=e}:function(r,e){return r.length=e},Qk=TypeError,Zk=9007199254740991,Jk=function(r){if(r>Zk)throw Qk("Maximum allowed index exceeded");return r},eB=Rn,tB=vp,rB=qv,nB=qk,sB=Jk,iB=un,oB=iB(function(){return[].push.call({length:4294967296},1)!==4294967297}),aB=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(r){return r instanceof TypeError}},lB=oB||!aB();eB({target:"Array",proto:!0,arity:1,forced:lB},{push:function(e){var t=tB(this),n=rB(t),s=arguments.length;sB(n+s);for(var i=0;i<s;i++)t[n]=arguments[i],n++;return nB(t,n),n}});var _g=vr,Ed=Set.prototype,Wi={Set,add:_g(Ed.add),has:_g(Ed.has),remove:_g(Ed.delete),proto:Ed},uB=Wi.has,fl=function(r){return uB(r),r},cB=No,ml=function(r,e,t){for(var n=t?r:r.iterator,s=r.next,i,o;!(i=cB(s,n)).done;)if(o=e(i.value),o!==void 0)return o},NO=vr,hB=ml,AO=Wi,dB=AO.Set,OO=AO.proto,fB=NO(OO.forEach),IO=NO(OO.keys),mB=IO(new dB).next,Dh=function(r,e,t){return t?hB({iterator:IO(r),next:mB},e):fB(r,e)},MO=Wi,pB=Dh,gB=MO.Set,yB=MO.add,Jv=function(r){var e=new gB;return pB(r,function(t){yB(e,t)}),e},EB=EO,vB=Wi,Hh=EB(vB.proto,"size","get")||function(r){return r.size},wB=function(r){return{iterator:r,next:r.next,done:!1}},iC=Ep,_O=hl,oC=No,RB=Ph,SB=wB,aC="Invalid size",CB=RangeError,TB=TypeError,bB=Math.max,xO=function(r,e){this.set=r,this.size=bB(e,0),this.has=iC(r.has),this.keys=iC(r.keys)};xO.prototype={getIterator:function(){return SB(_O(oC(this.keys,this.set)))},includes:function(r){return oC(this.has,this.set,r)}};var pl=function(r){_O(r);var e=+r.size;if(e!==e)throw new TB(aC);var t=RB(e);if(t<0)throw new CB(aC);return new xO(r,t)},NB=fl,LO=Wi,AB=Jv,OB=Hh,IB=pl,MB=Dh,_B=ml,xB=LO.has,lC=LO.remove,LB=function(e){var t=NB(this),n=IB(e),s=AB(t);return OB(t)<=n.size?MB(t,function(i){n.includes(i)&&lC(s,i)}):_B(n.getIterator(),function(i){xB(s,i)&&lC(s,i)}),s},PB=xu,uC=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},cC=function(r){return{size:r,has:function(){return!0},keys:function(){throw new Error("e")}}},gl=function(r,e){var t=PB("Set");try{new t()[r](uC(0));try{return new t()[r](uC(-1)),!1}catch{if(!e)return!0;try{return new t()[r](cC(-1/0)),!1}catch{var n=new t;return n.add(1),n.add(2),e(n[r](cC(1/0)))}}}catch{return!1}},FB=Rn,DB=LB,HB=un,VB=gl,UB=!VB("difference",function(r){return r.size===0}),kB=UB||HB(function(){var r={size:1,has:function(){return!0},keys:function(){var t=0;return{next:function(){var n=t++>1;return e.has(1)&&e.clear(),{done:n,value:2}}}}},e=new Set([1,2,3,4]);return e.difference(r).size!==3});FB({target:"Set",proto:!0,real:!0,forced:kB},{difference:DB});var BB=fl,ew=Wi,WB=Hh,$B=pl,GB=Dh,zB=ml,YB=ew.Set,hC=ew.add,jB=ew.has,KB=function(e){var t=BB(this),n=$B(e),s=new YB;return WB(t)>n.size?zB(n.getIterator(),function(i){jB(t,i)&&hC(s,i)}):GB(t,function(i){n.includes(i)&&hC(s,i)}),s},XB=Rn,qB=un,QB=KB,ZB=gl,JB=!ZB("intersection",function(r){return r.size===2&&r.has(1)&&r.has(2)})||qB(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});XB({target:"Set",proto:!0,real:!0,forced:JB},{intersection:QB});var eW=No,dC=hl,tW=Gv,PO=function(r,e,t){var n,s;dC(r);try{if(n=tW(r,"return"),!n){if(e==="throw")throw t;return t}n=eW(n,r)}catch(i){s=!0,n=i}if(e==="throw")throw t;if(s)throw n;return dC(n),t},rW=fl,nW=Wi.has,sW=Hh,iW=pl,oW=Dh,aW=ml,lW=PO,uW=function(e){var t=rW(this),n=iW(e);if(sW(t)<=n.size)return oW(t,function(i){if(n.includes(i))return!1},!0)!==!1;var s=n.getIterator();return aW(s,function(i){if(nW(t,i))return lW(s,"normal",!1)})!==!1},cW=Rn,hW=uW,dW=gl,fW=!dW("isDisjointFrom",function(r){return!r});cW({target:"Set",proto:!0,real:!0,forced:fW},{isDisjointFrom:hW});var mW=fl,pW=Hh,gW=Dh,yW=pl,EW=function(e){var t=mW(this),n=yW(e);return pW(t)>n.size?!1:gW(t,function(s){if(!n.includes(s))return!1},!0)!==!1},vW=Rn,wW=EW,RW=gl,SW=!RW("isSubsetOf",function(r){return r});vW({target:"Set",proto:!0,real:!0,forced:SW},{isSubsetOf:wW});var CW=fl,TW=Wi.has,bW=Hh,NW=pl,AW=ml,OW=PO,IW=function(e){var t=CW(this),n=NW(e);if(bW(t)<n.size)return!1;var s=n.getIterator();return AW(s,function(i){if(!TW(t,i))return OW(s,"normal",!1)})!==!1},MW=Rn,_W=IW,xW=gl,LW=!xW("isSupersetOf",function(r){return!r});MW({target:"Set",proto:!0,real:!0,forced:LW},{isSupersetOf:_W});var PW=fl,tw=Wi,FW=Jv,DW=pl,HW=ml,VW=tw.add,UW=tw.has,kW=tw.remove,BW=function(e){var t=PW(this),n=DW(e).getIterator(),s=FW(t);return HW(n,function(i){UW(t,i)?kW(s,i):VW(s,i)}),s},FO=function(r){try{var e=new Set,t={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},n=e[r](t);return n.size===1&&n.values().next().value===4}catch{return!1}},WW=Rn,$W=BW,GW=FO,zW=gl,YW=!zW("symmetricDifference")||!GW("symmetricDifference");WW({target:"Set",proto:!0,real:!0,forced:YW},{symmetricDifference:$W});var jW=fl,KW=Wi.add,XW=Jv,qW=pl,QW=ml,ZW=function(e){var t=jW(this),n=qW(e).getIterator(),s=XW(t);return QW(n,function(i){KW(s,i)}),s},JW=Rn,e$=ZW,t$=FO,r$=gl,n$=!r$("union")||!t$("union");JW({target:"Set",proto:!0,real:!0,forced:n$},{union:e$});var s$=ul,i$=vr,o$=function(r){if(s$(r)==="Function")return i$(r)},fC=o$,a$=Ep,l$=pp,u$=fC(fC.bind),c$=function(r,e){return a$(r),e===void 0?r:l$?u$(r,e):function(){return r.apply(e,arguments)}},h$=xu,DO=h$("document","documentElement"),d$=vr,rw=d$([].slice),f$=TypeError,HO=function(r,e){if(r<e)throw new f$("Not enough arguments");return r},m$=yp,p$=/(?:ipad|iphone|ipod).*applewebkit/i.test(m$),Ju=Vr,g$=yp,y$=ul,vd=function(r){return g$.slice(0,r.length)===r},VO=function(){return vd("Bun/")?"BUN":vd("Cloudflare-Workers")?"CLOUDFLARE":vd("Deno/")?"DENO":vd("Node.js/")?"NODE":Ju.Bun&&typeof Bun.version=="string"?"BUN":Ju.Deno&&typeof Deno.version=="object"?"DENO":y$(Ju.process)==="process"?"NODE":Ju.window&&Ju.document?"BROWSER":"REST"}(),E$=VO,v$=E$==="NODE",Kn=Vr,w$=wp,R$=c$,mC=jr,S$=ki,UO=un,pC=DO,C$=rw,gC=jv,T$=HO,b$=p$,N$=v$,cE=Kn.setImmediate,hE=Kn.clearImmediate,A$=Kn.process,xg=Kn.Dispatch,O$=Kn.Function,yC=Kn.MessageChannel,I$=Kn.String,Lg=0,Gc={},EC="onreadystatechange",hh,Ca,Pg,Fg;UO(function(){hh=Kn.location});var nw=function(r){if(S$(Gc,r)){var e=Gc[r];delete Gc[r],e()}},Dg=function(r){return function(){nw(r)}},vC=function(r){nw(r.data)},wC=function(r){Kn.postMessage(I$(r),hh.protocol+"//"+hh.host)};(!cE||!hE)&&(cE=function(e){T$(arguments.length,1);var t=mC(e)?e:O$(e),n=C$(arguments,1);return Gc[++Lg]=function(){w$(t,void 0,n)},Ca(Lg),Lg},hE=function(e){delete Gc[e]},N$?Ca=function(r){A$.nextTick(Dg(r))}:xg&&xg.now?Ca=function(r){xg.now(Dg(r))}:yC&&!b$?(Pg=new yC,Fg=Pg.port2,Pg.port1.onmessage=vC,Ca=R$(Fg.postMessage,Fg)):Kn.addEventListener&&mC(Kn.postMessage)&&!Kn.importScripts&&hh&&hh.protocol!=="file:"&&!UO(wC)?(Ca=wC,Kn.addEventListener("message",vC,!1)):EC in gC("script")?Ca=function(r){pC.appendChild(gC("script"))[EC]=function(){pC.removeChild(this),nw(r)}}:Ca=function(r){setTimeout(Dg(r),0)});var kO={set:cE,clear:hE},M$=Rn,_$=Vr,RC=kO.clear;M$({global:!0,bind:!0,enumerable:!0,forced:_$.clearImmediate!==RC},{clearImmediate:RC});var BO=Vr,x$=wp,L$=jr,P$=VO,F$=yp,D$=rw,H$=HO,V$=BO.Function,U$=/MSIE .\./.test(F$)||P$==="BUN"&&function(){var r=BO.Bun.version.split(".");return r.length<3||r[0]==="0"&&(r[1]<3||r[1]==="3"&&r[2]==="0")}(),k$=function(r,e){var t=e?2:1;return U$?function(n,s){var i=H$(arguments.length,1)>t,o=L$(n)?n:V$(n),a=i?D$(arguments,t):[],l=i?function(){x$(o,this,a)}:o;return e?r(l,s):r(l)}:r},B$=Rn,WO=Vr,SC=kO.set,W$=k$,CC=WO.setImmediate?W$(SC,!1):SC;B$({global:!0,bind:!0,enumerable:!0,forced:WO.setImmediate!==CC},{setImmediate:CC});/*! @license DOMPurify 2.5.8 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.8/LICENSE */function Go(r){"@babel/helpers - typeof";return Go=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Go(r)}function dE(r,e){return dE=Object.setPrototypeOf||function(n,s){return n.__proto__=s,n},dE(r,e)}function $$(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mf(r,e,t){return $$()?Mf=Reflect.construct:Mf=function(s,i,o){var a=[null];a.push.apply(a,i);var l=Function.bind.apply(s,a),u=new l;return o&&dE(u,o.prototype),u},Mf.apply(null,arguments)}function Bs(r){return G$(r)||z$(r)||Y$(r)||j$()}function G$(r){if(Array.isArray(r))return fE(r)}function z$(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Y$(r,e){if(r){if(typeof r=="string")return fE(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return fE(r,e)}}function fE(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function j$(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var K$=Object.hasOwnProperty,TC=Object.setPrototypeOf,X$=Object.isFrozen,q$=Object.getPrototypeOf,Q$=Object.getOwnPropertyDescriptor,wn=Object.freeze,Ts=Object.seal,Z$=Object.create,$O=typeof Reflect<"u"&&Reflect,ym=$O.apply,mE=$O.construct;ym||(ym=function(e,t,n){return e.apply(t,n)});wn||(wn=function(e){return e});Ts||(Ts=function(e){return e});mE||(mE=function(e,t){return Mf(e,Bs(t))});var J$=bs(Array.prototype.forEach),bC=bs(Array.prototype.pop),ec=bs(Array.prototype.push),_f=bs(String.prototype.toLowerCase),Hg=bs(String.prototype.toString),NC=bs(String.prototype.match),Ps=bs(String.prototype.replace),e2=bs(String.prototype.indexOf),t2=bs(String.prototype.trim),Ur=bs(RegExp.prototype.test),Vg=r2(TypeError);function bs(r){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return ym(r,e,n)}}function r2(r){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return mE(r,t)}}function qe(r,e,t){var n;t=(n=t)!==null&&n!==void 0?n:_f,TC&&TC(r,null);for(var s=e.length;s--;){var i=e[s];if(typeof i=="string"){var o=t(i);o!==i&&(X$(e)||(e[s]=o),i=o)}r[i]=!0}return r}function Ta(r){var e=Z$(null),t;for(t in r)ym(K$,r,[t])===!0&&(e[t]=r[t]);return e}function wd(r,e){for(;r!==null;){var t=Q$(r,e);if(t){if(t.get)return bs(t.get);if(typeof t.value=="function")return bs(t.value)}r=q$(r)}function n(s){return console.warn("fallback value for",s),null}return n}var AC=wn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ug=wn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),kg=wn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),n2=wn(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Bg=wn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),s2=wn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),OC=wn(["#text"]),IC=wn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Wg=wn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),MC=wn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Rd=wn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),i2=Ts(/\{\{[\w\W]*|[\w\W]*\}\}/gm),o2=Ts(/<%[\w\W]*|[\w\W]*%>/gm),a2=Ts(/\${[\w\W]*}/gm),l2=Ts(/^data-[\-\w.\u00B7-\uFFFF]+$/),u2=Ts(/^aria-[\-\w]+$/),c2=Ts(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),h2=Ts(/^(?:\w+script|data):/i),d2=Ts(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),f2=Ts(/^html$/i),m2=Ts(/^[a-z][.\w]*(-[.\w]+)+$/i),p2=function(){return typeof window>"u"?null:window},g2=function(e,t){if(Go(e)!=="object"||typeof e.createPolicy!="function")return null;var n=null,s="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(s)&&(n=t.currentScript.getAttribute(s));var i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function GO(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:p2(),e=function(L){return GO(L)};if(e.version="2.5.8",e.removed=[],!r||!r.document||r.document.nodeType!==9)return e.isSupported=!1,e;var t=r.document,n=r.document,s=r.DocumentFragment,i=r.HTMLTemplateElement,o=r.Node,a=r.Element,l=r.NodeFilter,u=r.NamedNodeMap,c=u===void 0?r.NamedNodeMap||r.MozNamedAttrMap:u,h=r.HTMLFormElement,d=r.DOMParser,m=r.trustedTypes,E=a.prototype,g=wd(E,"cloneNode"),O=wd(E,"nextSibling"),T=wd(E,"childNodes"),_=wd(E,"parentNode");if(typeof i=="function"){var V=n.createElement("template");V.content&&V.content.ownerDocument&&(n=V.content.ownerDocument)}var H=g2(m,t),Q=H?H.createHTML(""):"",oe=n,re=oe.implementation,ie=oe.createNodeIterator,Fe=oe.createDocumentFragment,Ie=oe.getElementsByTagName,_e=t.importNode,tt={};try{tt=Ta(n).documentMode?n.documentMode:{}}catch{}var Ge={};e.isSupported=typeof _=="function"&&re&&re.createHTMLDocument!==void 0&&tt!==9;var ke=i2,nt=o2,je=a2,Ne=l2,ue=u2,Ae=h2,bt=d2,p=m2,y=c2,R=null,x=qe({},[].concat(Bs(AC),Bs(Ug),Bs(kg),Bs(Bg),Bs(OC))),P=null,U=qe({},[].concat(Bs(IC),Bs(Wg),Bs(MC),Bs(Rd))),G=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),j=null,fe=null,me=!0,ne=!0,b=!1,M=!0,D=!1,W=!0,k=!1,$=!1,K=!1,Y=!1,z=!1,B=!1,ae=!0,se=!1,ye="user-content-",Se=!0,xe=!1,De={},Le=null,Kt=qe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ht=null,Rr=qe({},["audio","video","img","source","image","track"]),It=null,Sr=qe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),cr="http://www.w3.org/1998/Math/MathML",gt="http://www.w3.org/2000/svg",rt="http://www.w3.org/1999/xhtml",Nt=rt,Sn=!1,Lo=null,ng=qe({},[cr,gt,rt],Hg),Cn,td=["application/xhtml+xml","text/html"],sg="text/html",hr,Po=null,ns=n.createElement("form"),Kr=function(L){return L instanceof RegExp||L instanceof Function},Bu=function(L){Po&&Po===L||((!L||Go(L)!=="object")&&(L={}),L=Ta(L),Cn=td.indexOf(L.PARSER_MEDIA_TYPE)===-1?Cn=sg:Cn=L.PARSER_MEDIA_TYPE,hr=Cn==="application/xhtml+xml"?Hg:_f,R="ALLOWED_TAGS"in L?qe({},L.ALLOWED_TAGS,hr):x,P="ALLOWED_ATTR"in L?qe({},L.ALLOWED_ATTR,hr):U,Lo="ALLOWED_NAMESPACES"in L?qe({},L.ALLOWED_NAMESPACES,Hg):ng,It="ADD_URI_SAFE_ATTR"in L?qe(Ta(Sr),L.ADD_URI_SAFE_ATTR,hr):Sr,Ht="ADD_DATA_URI_TAGS"in L?qe(Ta(Rr),L.ADD_DATA_URI_TAGS,hr):Rr,Le="FORBID_CONTENTS"in L?qe({},L.FORBID_CONTENTS,hr):Kt,j="FORBID_TAGS"in L?qe({},L.FORBID_TAGS,hr):{},fe="FORBID_ATTR"in L?qe({},L.FORBID_ATTR,hr):{},De="USE_PROFILES"in L?L.USE_PROFILES:!1,me=L.ALLOW_ARIA_ATTR!==!1,ne=L.ALLOW_DATA_ATTR!==!1,b=L.ALLOW_UNKNOWN_PROTOCOLS||!1,M=L.ALLOW_SELF_CLOSE_IN_ATTR!==!1,D=L.SAFE_FOR_TEMPLATES||!1,W=L.SAFE_FOR_XML!==!1,k=L.WHOLE_DOCUMENT||!1,Y=L.RETURN_DOM||!1,z=L.RETURN_DOM_FRAGMENT||!1,B=L.RETURN_TRUSTED_TYPE||!1,K=L.FORCE_BODY||!1,ae=L.SANITIZE_DOM!==!1,se=L.SANITIZE_NAMED_PROPS||!1,Se=L.KEEP_CONTENT!==!1,xe=L.IN_PLACE||!1,y=L.ALLOWED_URI_REGEXP||y,Nt=L.NAMESPACE||rt,G=L.CUSTOM_ELEMENT_HANDLING||{},L.CUSTOM_ELEMENT_HANDLING&&Kr(L.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(G.tagNameCheck=L.CUSTOM_ELEMENT_HANDLING.tagNameCheck),L.CUSTOM_ELEMENT_HANDLING&&Kr(L.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(G.attributeNameCheck=L.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),L.CUSTOM_ELEMENT_HANDLING&&typeof L.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(G.allowCustomizedBuiltInElements=L.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),D&&(ne=!1),z&&(Y=!0),De&&(R=qe({},Bs(OC)),P=[],De.html===!0&&(qe(R,AC),qe(P,IC)),De.svg===!0&&(qe(R,Ug),qe(P,Wg),qe(P,Rd)),De.svgFilters===!0&&(qe(R,kg),qe(P,Wg),qe(P,Rd)),De.mathMl===!0&&(qe(R,Bg),qe(P,MC),qe(P,Rd))),L.ADD_TAGS&&(R===x&&(R=Ta(R)),qe(R,L.ADD_TAGS,hr)),L.ADD_ATTR&&(P===U&&(P=Ta(P)),qe(P,L.ADD_ATTR,hr)),L.ADD_URI_SAFE_ATTR&&qe(It,L.ADD_URI_SAFE_ATTR,hr),L.FORBID_CONTENTS&&(Le===Kt&&(Le=Ta(Le)),qe(Le,L.FORBID_CONTENTS,hr)),Se&&(R["#text"]=!0),k&&qe(R,["html","head","body"]),R.table&&(qe(R,["tbody"]),delete j.tbody),wn&&wn(L),Po=L)},rd=qe({},["mi","mo","mn","ms","mtext"]),nd=qe({},["annotation-xml"]),ma=qe({},["title","style","font","a","script"]),li=qe({},Ug);qe(li,kg),qe(li,n2);var Wu=qe({},Bg);qe(Wu,s2);var ig=function(L){var q=_(L);(!q||!q.tagName)&&(q={namespaceURI:Nt,tagName:"template"});var ce=_f(L.tagName),Pe=_f(q.tagName);return Lo[L.namespaceURI]?L.namespaceURI===gt?q.namespaceURI===rt?ce==="svg":q.namespaceURI===cr?ce==="svg"&&(Pe==="annotation-xml"||rd[Pe]):!!li[ce]:L.namespaceURI===cr?q.namespaceURI===rt?ce==="math":q.namespaceURI===gt?ce==="math"&&nd[Pe]:!!Wu[ce]:L.namespaceURI===rt?q.namespaceURI===gt&&!nd[Pe]||q.namespaceURI===cr&&!rd[Pe]?!1:!Wu[ce]&&(ma[ce]||!li[ce]):!!(Cn==="application/xhtml+xml"&&Lo[L.namespaceURI]):!1},cn=function(L){ec(e.removed,{element:L});try{L.parentNode.removeChild(L)}catch{try{L.outerHTML=Q}catch{L.remove()}}},pa=function(L,q){try{ec(e.removed,{attribute:q.getAttributeNode(L),from:q})}catch{ec(e.removed,{attribute:null,from:q})}if(q.removeAttribute(L),L==="is"&&!P[L])if(Y||z)try{cn(q)}catch{}else try{q.setAttribute(L,"")}catch{}},$u=function(L){var q,ce;if(K)L="<remove></remove>"+L;else{var Pe=NC(L,/^[\r\n\t ]+/);ce=Pe&&Pe[0]}Cn==="application/xhtml+xml"&&Nt===rt&&(L='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+L+"</body></html>");var dr=H?H.createHTML(L):L;if(Nt===rt)try{q=new d().parseFromString(dr,Cn)}catch{}if(!q||!q.documentElement){q=re.createDocument(Nt,"template",null);try{q.documentElement.innerHTML=Sn?Q:dr}catch{}}var fr=q.body||q.documentElement;return L&&ce&&fr.insertBefore(n.createTextNode(ce),fr.childNodes[0]||null),Nt===rt?Ie.call(q,k?"html":"body")[0]:k?q.documentElement:fr},Fo=function(L){return ie.call(L.ownerDocument||L,L,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null,!1)},ga=function(L){return L instanceof h&&(typeof L.nodeName!="string"||typeof L.textContent!="string"||typeof L.removeChild!="function"||!(L.attributes instanceof c)||typeof L.removeAttribute!="function"||typeof L.setAttribute!="function"||typeof L.namespaceURI!="string"||typeof L.insertBefore!="function"||typeof L.hasChildNodes!="function")},ss=function(L){return Go(o)==="object"?L instanceof o:L&&Go(L)==="object"&&typeof L.nodeType=="number"&&typeof L.nodeName=="string"},Xr=function(L,q,ce){Ge[L]&&J$(Ge[L],function(Pe){Pe.call(e,q,ce,Po)})},ya=function(L){var q;if(Xr("beforeSanitizeElements",L,null),ga(L)||Ur(/[\u0080-\uFFFF]/,L.nodeName))return cn(L),!0;var ce=hr(L.nodeName);if(Xr("uponSanitizeElement",L,{tagName:ce,allowedTags:R}),L.hasChildNodes()&&!ss(L.firstElementChild)&&(!ss(L.content)||!ss(L.content.firstElementChild))&&Ur(/<[/\w]/g,L.innerHTML)&&Ur(/<[/\w]/g,L.textContent)||ce==="select"&&Ur(/<template/i,L.innerHTML)||L.nodeType===7||W&&L.nodeType===8&&Ur(/<[/\w]/g,L.data))return cn(L),!0;if(!R[ce]||j[ce]){if(!j[ce]&&id(ce)&&(G.tagNameCheck instanceof RegExp&&Ur(G.tagNameCheck,ce)||G.tagNameCheck instanceof Function&&G.tagNameCheck(ce)))return!1;if(Se&&!Le[ce]){var Pe=_(L)||L.parentNode,dr=T(L)||L.childNodes;if(dr&&Pe)for(var fr=dr.length,Xt=fr-1;Xt>=0;--Xt){var hn=g(dr[Xt],!0);hn.__removalCount=(L.__removalCount||0)+1,Pe.insertBefore(hn,O(L))}}return cn(L),!0}return L instanceof a&&!ig(L)||(ce==="noscript"||ce==="noembed"||ce==="noframes")&&Ur(/<\/no(script|embed|frames)/i,L.innerHTML)?(cn(L),!0):(D&&L.nodeType===3&&(q=L.textContent,q=Ps(q,ke," "),q=Ps(q,nt," "),q=Ps(q,je," "),L.textContent!==q&&(ec(e.removed,{element:L.cloneNode()}),L.textContent=q)),Xr("afterSanitizeElements",L,null),!1)},sd=function(L,q,ce){if(ae&&(q==="id"||q==="name")&&(ce in n||ce in ns))return!1;if(!(ne&&!fe[q]&&Ur(Ne,q))){if(!(me&&Ur(ue,q))){if(!P[q]||fe[q]){if(!(id(L)&&(G.tagNameCheck instanceof RegExp&&Ur(G.tagNameCheck,L)||G.tagNameCheck instanceof Function&&G.tagNameCheck(L))&&(G.attributeNameCheck instanceof RegExp&&Ur(G.attributeNameCheck,q)||G.attributeNameCheck instanceof Function&&G.attributeNameCheck(q))||q==="is"&&G.allowCustomizedBuiltInElements&&(G.tagNameCheck instanceof RegExp&&Ur(G.tagNameCheck,ce)||G.tagNameCheck instanceof Function&&G.tagNameCheck(ce))))return!1}else if(!It[q]){if(!Ur(y,Ps(ce,bt,""))){if(!((q==="src"||q==="xlink:href"||q==="href")&&L!=="script"&&e2(ce,"data:")===0&&Ht[L])){if(!(b&&!Ur(Ae,Ps(ce,bt,"")))){if(ce)return!1}}}}}}return!0},id=function(L){return L!=="annotation-xml"&&NC(L,p)},Ea=function(L){var q,ce,Pe,dr;Xr("beforeSanitizeAttributes",L,null);var fr=L.attributes;if(!(!fr||ga(L))){var Xt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:P};for(dr=fr.length;dr--;){q=fr[dr];var hn=q,rr=hn.name,zu=hn.namespaceURI;if(ce=rr==="value"?q.value:t2(q.value),Pe=hr(rr),Xt.attrName=Pe,Xt.attrValue=ce,Xt.keepAttr=!0,Xt.forceKeepAttr=void 0,Xr("uponSanitizeAttribute",L,Xt),ce=Xt.attrValue,!Xt.forceKeepAttr&&(pa(rr,L),!!Xt.keepAttr)){if(!M&&Ur(/\/>/i,ce)){pa(rr,L);continue}D&&(ce=Ps(ce,ke," "),ce=Ps(ce,nt," "),ce=Ps(ce,je," "));var od=hr(L.nodeName);if(sd(od,Pe,ce)){if(se&&(Pe==="id"||Pe==="name")&&(pa(rr,L),ce=ye+ce),W&&Ur(/((--!?|])>)|<\/(style|title)/i,ce)){pa(rr,L);continue}if(H&&Go(m)==="object"&&typeof m.getAttributeType=="function"&&!zu)switch(m.getAttributeType(od,Pe)){case"TrustedHTML":{ce=H.createHTML(ce);break}case"TrustedScriptURL":{ce=H.createScriptURL(ce);break}}try{zu?L.setAttributeNS(zu,rr,ce):L.setAttribute(rr,ce),ga(L)?cn(L):bC(e.removed)}catch{}}}}Xr("afterSanitizeAttributes",L,null)}},Gu=function Ce(L){var q,ce=Fo(L);for(Xr("beforeSanitizeShadowDOM",L,null);q=ce.nextNode();)Xr("uponSanitizeShadowNode",q,null),ya(q),Ea(q),q.content instanceof s&&Ce(q.content);Xr("afterSanitizeShadowDOM",L,null)};return e.sanitize=function(Ce){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},q,ce,Pe,dr,fr;if(Sn=!Ce,Sn&&(Ce="<!-->"),typeof Ce!="string"&&!ss(Ce))if(typeof Ce.toString=="function"){if(Ce=Ce.toString(),typeof Ce!="string")throw Vg("dirty is not a string, aborting")}else throw Vg("toString is not a function");if(!e.isSupported){if(Go(r.toStaticHTML)==="object"||typeof r.toStaticHTML=="function"){if(typeof Ce=="string")return r.toStaticHTML(Ce);if(ss(Ce))return r.toStaticHTML(Ce.outerHTML)}return Ce}if($||Bu(L),e.removed=[],typeof Ce=="string"&&(xe=!1),xe){if(Ce.nodeName){var Xt=hr(Ce.nodeName);if(!R[Xt]||j[Xt])throw Vg("root node is forbidden and cannot be sanitized in-place")}}else if(Ce instanceof o)q=$u("<!---->"),ce=q.ownerDocument.importNode(Ce,!0),ce.nodeType===1&&ce.nodeName==="BODY"||ce.nodeName==="HTML"?q=ce:q.appendChild(ce);else{if(!Y&&!D&&!k&&Ce.indexOf("<")===-1)return H&&B?H.createHTML(Ce):Ce;if(q=$u(Ce),!q)return Y?null:B?Q:""}q&&K&&cn(q.firstChild);for(var hn=Fo(xe?Ce:q);Pe=hn.nextNode();)Pe.nodeType===3&&Pe===dr||(ya(Pe),Ea(Pe),Pe.content instanceof s&&Gu(Pe.content),dr=Pe);if(dr=null,xe)return Ce;if(Y){if(z)for(fr=Fe.call(q.ownerDocument);q.firstChild;)fr.appendChild(q.firstChild);else fr=q;return(P.shadowroot||P.shadowrootmod)&&(fr=_e.call(t,fr,!0)),fr}var rr=k?q.outerHTML:q.innerHTML;return k&&R["!doctype"]&&q.ownerDocument&&q.ownerDocument.doctype&&q.ownerDocument.doctype.name&&Ur(f2,q.ownerDocument.doctype.name)&&(rr="<!DOCTYPE "+q.ownerDocument.doctype.name+`>
`+rr),D&&(rr=Ps(rr,ke," "),rr=Ps(rr,nt," "),rr=Ps(rr,je," ")),H&&B?H.createHTML(rr):rr},e.setConfig=function(Ce){Bu(Ce),$=!0},e.clearConfig=function(){Po=null,$=!1},e.isValidAttribute=function(Ce,L,q){Po||Bu({});var ce=hr(Ce),Pe=hr(L);return sd(ce,Pe,q)},e.addHook=function(Ce,L){typeof L=="function"&&(Ge[Ce]=Ge[Ce]||[],ec(Ge[Ce],L))},e.removeHook=function(Ce){if(Ge[Ce])return bC(Ge[Ce])},e.removeHooks=function(Ce){Ge[Ce]&&(Ge[Ce]=[])},e.removeAllHooks=function(){Ge={}},e}var y2=GO();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var zO;function de(){return zO.apply(null,arguments)}function E2(r){zO=r}function ni(r){return r instanceof Array||Object.prototype.toString.call(r)==="[object Array]"}function qa(r){return r!=null&&Object.prototype.toString.call(r)==="[object Object]"}function ft(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function sw(r){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(r).length===0;var e;for(e in r)if(ft(r,e))return!1;return!0}function An(r){return r===void 0}function Co(r){return typeof r=="number"||Object.prototype.toString.call(r)==="[object Number]"}function Vh(r){return r instanceof Date||Object.prototype.toString.call(r)==="[object Date]"}function YO(r,e){var t=[],n,s=r.length;for(n=0;n<s;++n)t.push(e(r[n],n));return t}function Yo(r,e){for(var t in e)ft(e,t)&&(r[t]=e[t]);return ft(e,"toString")&&(r.toString=e.toString),ft(e,"valueOf")&&(r.valueOf=e.valueOf),r}function $i(r,e,t,n){return pI(r,e,t,n,!0).utc()}function v2(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ke(r){return r._pf==null&&(r._pf=v2()),r._pf}var pE;Array.prototype.some?pE=Array.prototype.some:pE=function(r){var e=Object(this),t=e.length>>>0,n;for(n=0;n<t;n++)if(n in e&&r.call(this,e[n],n,e))return!0;return!1};function iw(r){var e=null,t=!1,n=r._d&&!isNaN(r._d.getTime());if(n&&(e=Ke(r),t=pE.call(e.parsedDateParts,function(s){return s!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&t),r._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(r))r._isValid=n;else return n;return r._isValid}function Sp(r){var e=$i(NaN);return r!=null?Yo(Ke(e),r):Ke(e).userInvalidated=!0,e}var _C=de.momentProperties=[],$g=!1;function ow(r,e){var t,n,s,i=_C.length;if(An(e._isAMomentObject)||(r._isAMomentObject=e._isAMomentObject),An(e._i)||(r._i=e._i),An(e._f)||(r._f=e._f),An(e._l)||(r._l=e._l),An(e._strict)||(r._strict=e._strict),An(e._tzm)||(r._tzm=e._tzm),An(e._isUTC)||(r._isUTC=e._isUTC),An(e._offset)||(r._offset=e._offset),An(e._pf)||(r._pf=Ke(e)),An(e._locale)||(r._locale=e._locale),i>0)for(t=0;t<i;t++)n=_C[t],s=e[n],An(s)||(r[n]=s);return r}function Uh(r){ow(this,r),this._d=new Date(r._d!=null?r._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),$g===!1&&($g=!0,de.updateOffset(this),$g=!1)}function si(r){return r instanceof Uh||r!=null&&r._isAMomentObject!=null}function jO(r){de.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+r)}function Ms(r,e){var t=!0;return Yo(function(){if(de.deprecationHandler!=null&&de.deprecationHandler(null,r),t){var n=[],s,i,o,a=arguments.length;for(i=0;i<a;i++){if(s="",typeof arguments[i]=="object"){s+=`
[`+i+"] ";for(o in arguments[0])ft(arguments[0],o)&&(s+=o+": "+arguments[0][o]+", ");s=s.slice(0,-2)}else s=arguments[i];n.push(s)}jO(r+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),t=!1}return e.apply(this,arguments)},e)}var xC={};function KO(r,e){de.deprecationHandler!=null&&de.deprecationHandler(r,e),xC[r]||(jO(e),xC[r]=!0)}de.suppressDeprecationWarnings=!1;de.deprecationHandler=null;function Gi(r){return typeof Function<"u"&&r instanceof Function||Object.prototype.toString.call(r)==="[object Function]"}function w2(r){var e,t;for(t in r)ft(r,t)&&(e=r[t],Gi(e)?this[t]=e:this["_"+t]=e);this._config=r,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function gE(r,e){var t=Yo({},r),n;for(n in e)ft(e,n)&&(qa(r[n])&&qa(e[n])?(t[n]={},Yo(t[n],r[n]),Yo(t[n],e[n])):e[n]!=null?t[n]=e[n]:delete t[n]);for(n in r)ft(r,n)&&!ft(e,n)&&qa(r[n])&&(t[n]=Yo({},t[n]));return t}function aw(r){r!=null&&this.set(r)}var yE;Object.keys?yE=Object.keys:yE=function(r){var e,t=[];for(e in r)ft(r,e)&&t.push(e);return t};var R2={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function S2(r,e,t){var n=this._calendar[r]||this._calendar.sameElse;return Gi(n)?n.call(e,t):n}function Pi(r,e,t){var n=""+Math.abs(r),s=e-n.length,i=r>=0;return(i?t?"+":"":"-")+Math.pow(10,Math.max(0,s)).toString().substr(1)+n}var lw=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Sd=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Gg={},du={};function Oe(r,e,t,n){var s=n;typeof n=="string"&&(s=function(){return this[n]()}),r&&(du[r]=s),e&&(du[e[0]]=function(){return Pi(s.apply(this,arguments),e[1],e[2])}),t&&(du[t]=function(){return this.localeData().ordinal(s.apply(this,arguments),r)})}function C2(r){return r.match(/\[[\s\S]/)?r.replace(/^\[|\]$/g,""):r.replace(/\\/g,"")}function T2(r){var e=r.match(lw),t,n;for(t=0,n=e.length;t<n;t++)du[e[t]]?e[t]=du[e[t]]:e[t]=C2(e[t]);return function(s){var i="",o;for(o=0;o<n;o++)i+=Gi(e[o])?e[o].call(s,r):e[o];return i}}function xf(r,e){return r.isValid()?(e=XO(e,r.localeData()),Gg[e]=Gg[e]||T2(e),Gg[e](r)):r.localeData().invalidDate()}function XO(r,e){var t=5;function n(s){return e.longDateFormat(s)||s}for(Sd.lastIndex=0;t>=0&&Sd.test(r);)r=r.replace(Sd,n),Sd.lastIndex=0,t-=1;return r}var b2={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function N2(r){var e=this._longDateFormat[r],t=this._longDateFormat[r.toUpperCase()];return e||!t?e:(this._longDateFormat[r]=t.match(lw).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[r])}var A2="Invalid date";function O2(){return this._invalidDate}var I2="%d",M2=/\d{1,2}/;function _2(r){return this._ordinal.replace("%d",r)}var x2={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function L2(r,e,t,n){var s=this._relativeTime[t];return Gi(s)?s(r,e,t,n):s.replace(/%d/i,r)}function P2(r,e){var t=this._relativeTime[r>0?"future":"past"];return Gi(t)?t(e):t.replace(/%s/i,e)}var LC={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function _s(r){return typeof r=="string"?LC[r]||LC[r.toLowerCase()]:void 0}function uw(r){var e={},t,n;for(n in r)ft(r,n)&&(t=_s(n),t&&(e[t]=r[n]));return e}var F2={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function D2(r){var e=[],t;for(t in r)ft(r,t)&&e.push({unit:t,priority:F2[t]});return e.sort(function(n,s){return n.priority-s.priority}),e}var qO=/\d/,rs=/\d\d/,QO=/\d{3}/,cw=/\d{4}/,Cp=/[+-]?\d{6}/,Dt=/\d\d?/,ZO=/\d\d\d\d?/,JO=/\d\d\d\d\d\d?/,Tp=/\d{1,3}/,hw=/\d{1,4}/,bp=/[+-]?\d{1,6}/,Pu=/\d+/,Np=/[+-]?\d+/,H2=/Z|[+-]\d\d:?\d\d/gi,Ap=/Z|[+-]\d\d(?::?\d\d)?/gi,V2=/[+-]?\d+(\.\d{1,3})?/,kh=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Fu=/^[1-9]\d?/,dw=/^([1-9]\d|\d)/,Em;Em={};function ve(r,e,t){Em[r]=Gi(e)?e:function(n,s){return n&&t?t:e}}function U2(r,e){return ft(Em,r)?Em[r](e._strict,e._locale):new RegExp(k2(r))}function k2(r){return go(r.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,s,i){return t||n||s||i}))}function go(r){return r.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function ys(r){return r<0?Math.ceil(r)||0:Math.floor(r)}function it(r){var e=+r,t=0;return e!==0&&isFinite(e)&&(t=ys(e)),t}var EE={};function Tt(r,e){var t,n=e,s;for(typeof r=="string"&&(r=[r]),Co(e)&&(n=function(i,o){o[e]=it(i)}),s=r.length,t=0;t<s;t++)EE[r[t]]=n}function Bh(r,e){Tt(r,function(t,n,s,i){s._w=s._w||{},e(t,s._w,s,i)})}function B2(r,e,t){e!=null&&ft(EE,r)&&EE[r](e,t._a,t,r)}function Op(r){return r%4===0&&r%100!==0||r%400===0}var an=0,ho=1,Ai=2,Ar=3,Xs=4,fo=5,ja=6,W2=7,$2=8;Oe("Y",0,0,function(){var r=this.year();return r<=9999?Pi(r,4):"+"+r});Oe(0,["YY",2],0,function(){return this.year()%100});Oe(0,["YYYY",4],0,"year");Oe(0,["YYYYY",5],0,"year");Oe(0,["YYYYYY",6,!0],0,"year");ve("Y",Np);ve("YY",Dt,rs);ve("YYYY",hw,cw);ve("YYYYY",bp,Cp);ve("YYYYYY",bp,Cp);Tt(["YYYYY","YYYYYY"],an);Tt("YYYY",function(r,e){e[an]=r.length===2?de.parseTwoDigitYear(r):it(r)});Tt("YY",function(r,e){e[an]=de.parseTwoDigitYear(r)});Tt("Y",function(r,e){e[an]=parseInt(r,10)});function zc(r){return Op(r)?366:365}de.parseTwoDigitYear=function(r){return it(r)+(it(r)>68?1900:2e3)};var eI=Du("FullYear",!0);function G2(){return Op(this.year())}function Du(r,e){return function(t){return t!=null?(tI(this,r,t),de.updateOffset(this,e),this):dh(this,r)}}function dh(r,e){if(!r.isValid())return NaN;var t=r._d,n=r._isUTC;switch(e){case"Milliseconds":return n?t.getUTCMilliseconds():t.getMilliseconds();case"Seconds":return n?t.getUTCSeconds():t.getSeconds();case"Minutes":return n?t.getUTCMinutes():t.getMinutes();case"Hours":return n?t.getUTCHours():t.getHours();case"Date":return n?t.getUTCDate():t.getDate();case"Day":return n?t.getUTCDay():t.getDay();case"Month":return n?t.getUTCMonth():t.getMonth();case"FullYear":return n?t.getUTCFullYear():t.getFullYear();default:return NaN}}function tI(r,e,t){var n,s,i,o,a;if(!(!r.isValid()||isNaN(t))){switch(n=r._d,s=r._isUTC,e){case"Milliseconds":return void(s?n.setUTCMilliseconds(t):n.setMilliseconds(t));case"Seconds":return void(s?n.setUTCSeconds(t):n.setSeconds(t));case"Minutes":return void(s?n.setUTCMinutes(t):n.setMinutes(t));case"Hours":return void(s?n.setUTCHours(t):n.setHours(t));case"Date":return void(s?n.setUTCDate(t):n.setDate(t));case"FullYear":break;default:return}i=t,o=r.month(),a=r.date(),a=a===29&&o===1&&!Op(i)?28:a,s?n.setUTCFullYear(i,o,a):n.setFullYear(i,o,a)}}function z2(r){return r=_s(r),Gi(this[r])?this[r]():this}function Y2(r,e){if(typeof r=="object"){r=uw(r);var t=D2(r),n,s=t.length;for(n=0;n<s;n++)this[t[n].unit](r[t[n].unit])}else if(r=_s(r),Gi(this[r]))return this[r](e);return this}function j2(r,e){return(r%e+e)%e}var ir;Array.prototype.indexOf?ir=Array.prototype.indexOf:ir=function(r){var e;for(e=0;e<this.length;++e)if(this[e]===r)return e;return-1};function fw(r,e){if(isNaN(r)||isNaN(e))return NaN;var t=j2(e,12);return r+=(e-t)/12,t===1?Op(r)?29:28:31-t%7%2}Oe("M",["MM",2],"Mo",function(){return this.month()+1});Oe("MMM",0,0,function(r){return this.localeData().monthsShort(this,r)});Oe("MMMM",0,0,function(r){return this.localeData().months(this,r)});ve("M",Dt,Fu);ve("MM",Dt,rs);ve("MMM",function(r,e){return e.monthsShortRegex(r)});ve("MMMM",function(r,e){return e.monthsRegex(r)});Tt(["M","MM"],function(r,e){e[ho]=it(r)-1});Tt(["MMM","MMMM"],function(r,e,t,n){var s=t._locale.monthsParse(r,n,t._strict);s!=null?e[ho]=s:Ke(t).invalidMonth=r});var K2="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),rI="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),nI=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,X2=kh,q2=kh;function Q2(r,e){return r?ni(this._months)?this._months[r.month()]:this._months[(this._months.isFormat||nI).test(e)?"format":"standalone"][r.month()]:ni(this._months)?this._months:this._months.standalone}function Z2(r,e){return r?ni(this._monthsShort)?this._monthsShort[r.month()]:this._monthsShort[nI.test(e)?"format":"standalone"][r.month()]:ni(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function J2(r,e,t){var n,s,i,o=r.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=$i([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return t?e==="MMM"?(s=ir.call(this._shortMonthsParse,o),s!==-1?s:null):(s=ir.call(this._longMonthsParse,o),s!==-1?s:null):e==="MMM"?(s=ir.call(this._shortMonthsParse,o),s!==-1?s:(s=ir.call(this._longMonthsParse,o),s!==-1?s:null)):(s=ir.call(this._longMonthsParse,o),s!==-1?s:(s=ir.call(this._shortMonthsParse,o),s!==-1?s:null))}function eG(r,e,t){var n,s,i;if(this._monthsParseExact)return J2.call(this,r,e,t);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(s=$i([2e3,n]),t&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),!t&&!this._monthsParse[n]&&(i="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),t&&e==="MMMM"&&this._longMonthsParse[n].test(r))return n;if(t&&e==="MMM"&&this._shortMonthsParse[n].test(r))return n;if(!t&&this._monthsParse[n].test(r))return n}}function sI(r,e){if(!r.isValid())return r;if(typeof e=="string"){if(/^\d+$/.test(e))e=it(e);else if(e=r.localeData().monthsParse(e),!Co(e))return r}var t=e,n=r.date();return n=n<29?n:Math.min(n,fw(r.year(),t)),r._isUTC?r._d.setUTCMonth(t,n):r._d.setMonth(t,n),r}function iI(r){return r!=null?(sI(this,r),de.updateOffset(this,!0),this):dh(this,"Month")}function tG(){return fw(this.year(),this.month())}function rG(r){return this._monthsParseExact?(ft(this,"_monthsRegex")||oI.call(this),r?this._monthsShortStrictRegex:this._monthsShortRegex):(ft(this,"_monthsShortRegex")||(this._monthsShortRegex=X2),this._monthsShortStrictRegex&&r?this._monthsShortStrictRegex:this._monthsShortRegex)}function nG(r){return this._monthsParseExact?(ft(this,"_monthsRegex")||oI.call(this),r?this._monthsStrictRegex:this._monthsRegex):(ft(this,"_monthsRegex")||(this._monthsRegex=q2),this._monthsStrictRegex&&r?this._monthsStrictRegex:this._monthsRegex)}function oI(){function r(l,u){return u.length-l.length}var e=[],t=[],n=[],s,i,o,a;for(s=0;s<12;s++)i=$i([2e3,s]),o=go(this.monthsShort(i,"")),a=go(this.months(i,"")),e.push(o),t.push(a),n.push(a),n.push(o);e.sort(r),t.sort(r),n.sort(r),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function sG(r,e,t,n,s,i,o){var a;return r<100&&r>=0?(a=new Date(r+400,e,t,n,s,i,o),isFinite(a.getFullYear())&&a.setFullYear(r)):a=new Date(r,e,t,n,s,i,o),a}function fh(r){var e,t;return r<100&&r>=0?(t=Array.prototype.slice.call(arguments),t[0]=r+400,e=new Date(Date.UTC.apply(null,t)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(r)):e=new Date(Date.UTC.apply(null,arguments)),e}function vm(r,e,t){var n=7+e-t,s=(7+fh(r,0,n).getUTCDay()-e)%7;return-s+n-1}function aI(r,e,t,n,s){var i=(7+t-n)%7,o=vm(r,n,s),a=1+7*(e-1)+i+o,l,u;return a<=0?(l=r-1,u=zc(l)+a):a>zc(r)?(l=r+1,u=a-zc(r)):(l=r,u=a),{year:l,dayOfYear:u}}function mh(r,e,t){var n=vm(r.year(),e,t),s=Math.floor((r.dayOfYear()-n-1)/7)+1,i,o;return s<1?(o=r.year()-1,i=s+yo(o,e,t)):s>yo(r.year(),e,t)?(i=s-yo(r.year(),e,t),o=r.year()+1):(o=r.year(),i=s),{week:i,year:o}}function yo(r,e,t){var n=vm(r,e,t),s=vm(r+1,e,t);return(zc(r)-n+s)/7}Oe("w",["ww",2],"wo","week");Oe("W",["WW",2],"Wo","isoWeek");ve("w",Dt,Fu);ve("ww",Dt,rs);ve("W",Dt,Fu);ve("WW",Dt,rs);Bh(["w","ww","W","WW"],function(r,e,t,n){e[n.substr(0,1)]=it(r)});function iG(r){return mh(r,this._week.dow,this._week.doy).week}var oG={dow:0,doy:6};function aG(){return this._week.dow}function lG(){return this._week.doy}function uG(r){var e=this.localeData().week(this);return r==null?e:this.add((r-e)*7,"d")}function cG(r){var e=mh(this,1,4).week;return r==null?e:this.add((r-e)*7,"d")}Oe("d",0,"do","day");Oe("dd",0,0,function(r){return this.localeData().weekdaysMin(this,r)});Oe("ddd",0,0,function(r){return this.localeData().weekdaysShort(this,r)});Oe("dddd",0,0,function(r){return this.localeData().weekdays(this,r)});Oe("e",0,0,"weekday");Oe("E",0,0,"isoWeekday");ve("d",Dt);ve("e",Dt);ve("E",Dt);ve("dd",function(r,e){return e.weekdaysMinRegex(r)});ve("ddd",function(r,e){return e.weekdaysShortRegex(r)});ve("dddd",function(r,e){return e.weekdaysRegex(r)});Bh(["dd","ddd","dddd"],function(r,e,t,n){var s=t._locale.weekdaysParse(r,n,t._strict);s!=null?e.d=s:Ke(t).invalidWeekday=r});Bh(["d","e","E"],function(r,e,t,n){e[n]=it(r)});function hG(r,e){return typeof r!="string"?r:isNaN(r)?(r=e.weekdaysParse(r),typeof r=="number"?r:null):parseInt(r,10)}function dG(r,e){return typeof r=="string"?e.weekdaysParse(r)%7||7:isNaN(r)?null:r}function mw(r,e){return r.slice(e,7).concat(r.slice(0,e))}var fG="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),lI="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),mG="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),pG=kh,gG=kh,yG=kh;function EG(r,e){var t=ni(this._weekdays)?this._weekdays:this._weekdays[r&&r!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return r===!0?mw(t,this._week.dow):r?t[r.day()]:t}function vG(r){return r===!0?mw(this._weekdaysShort,this._week.dow):r?this._weekdaysShort[r.day()]:this._weekdaysShort}function wG(r){return r===!0?mw(this._weekdaysMin,this._week.dow):r?this._weekdaysMin[r.day()]:this._weekdaysMin}function RG(r,e,t){var n,s,i,o=r.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=$i([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return t?e==="dddd"?(s=ir.call(this._weekdaysParse,o),s!==-1?s:null):e==="ddd"?(s=ir.call(this._shortWeekdaysParse,o),s!==-1?s:null):(s=ir.call(this._minWeekdaysParse,o),s!==-1?s:null):e==="dddd"?(s=ir.call(this._weekdaysParse,o),s!==-1||(s=ir.call(this._shortWeekdaysParse,o),s!==-1)?s:(s=ir.call(this._minWeekdaysParse,o),s!==-1?s:null)):e==="ddd"?(s=ir.call(this._shortWeekdaysParse,o),s!==-1||(s=ir.call(this._weekdaysParse,o),s!==-1)?s:(s=ir.call(this._minWeekdaysParse,o),s!==-1?s:null)):(s=ir.call(this._minWeekdaysParse,o),s!==-1||(s=ir.call(this._weekdaysParse,o),s!==-1)?s:(s=ir.call(this._shortWeekdaysParse,o),s!==-1?s:null))}function SG(r,e,t){var n,s,i;if(this._weekdaysParseExact)return RG.call(this,r,e,t);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(s=$i([2e3,1]).day(n),t&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(s,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(s,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(s,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(s,"")+"|^"+this.weekdaysShort(s,"")+"|^"+this.weekdaysMin(s,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),t&&e==="dddd"&&this._fullWeekdaysParse[n].test(r))return n;if(t&&e==="ddd"&&this._shortWeekdaysParse[n].test(r))return n;if(t&&e==="dd"&&this._minWeekdaysParse[n].test(r))return n;if(!t&&this._weekdaysParse[n].test(r))return n}}function CG(r){if(!this.isValid())return r!=null?this:NaN;var e=dh(this,"Day");return r!=null?(r=hG(r,this.localeData()),this.add(r-e,"d")):e}function TG(r){if(!this.isValid())return r!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return r==null?e:this.add(r-e,"d")}function bG(r){if(!this.isValid())return r!=null?this:NaN;if(r!=null){var e=dG(r,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function NG(r){return this._weekdaysParseExact?(ft(this,"_weekdaysRegex")||pw.call(this),r?this._weekdaysStrictRegex:this._weekdaysRegex):(ft(this,"_weekdaysRegex")||(this._weekdaysRegex=pG),this._weekdaysStrictRegex&&r?this._weekdaysStrictRegex:this._weekdaysRegex)}function AG(r){return this._weekdaysParseExact?(ft(this,"_weekdaysRegex")||pw.call(this),r?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(ft(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=gG),this._weekdaysShortStrictRegex&&r?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function OG(r){return this._weekdaysParseExact?(ft(this,"_weekdaysRegex")||pw.call(this),r?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(ft(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=yG),this._weekdaysMinStrictRegex&&r?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function pw(){function r(c,h){return h.length-c.length}var e=[],t=[],n=[],s=[],i,o,a,l,u;for(i=0;i<7;i++)o=$i([2e3,1]).day(i),a=go(this.weekdaysMin(o,"")),l=go(this.weekdaysShort(o,"")),u=go(this.weekdays(o,"")),e.push(a),t.push(l),n.push(u),s.push(a),s.push(l),s.push(u);e.sort(r),t.sort(r),n.sort(r),s.sort(r),this._weekdaysRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function gw(){return this.hours()%12||12}function IG(){return this.hours()||24}Oe("H",["HH",2],0,"hour");Oe("h",["hh",2],0,gw);Oe("k",["kk",2],0,IG);Oe("hmm",0,0,function(){return""+gw.apply(this)+Pi(this.minutes(),2)});Oe("hmmss",0,0,function(){return""+gw.apply(this)+Pi(this.minutes(),2)+Pi(this.seconds(),2)});Oe("Hmm",0,0,function(){return""+this.hours()+Pi(this.minutes(),2)});Oe("Hmmss",0,0,function(){return""+this.hours()+Pi(this.minutes(),2)+Pi(this.seconds(),2)});function uI(r,e){Oe(r,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}uI("a",!0);uI("A",!1);function cI(r,e){return e._meridiemParse}ve("a",cI);ve("A",cI);ve("H",Dt,dw);ve("h",Dt,Fu);ve("k",Dt,Fu);ve("HH",Dt,rs);ve("hh",Dt,rs);ve("kk",Dt,rs);ve("hmm",ZO);ve("hmmss",JO);ve("Hmm",ZO);ve("Hmmss",JO);Tt(["H","HH"],Ar);Tt(["k","kk"],function(r,e,t){var n=it(r);e[Ar]=n===24?0:n});Tt(["a","A"],function(r,e,t){t._isPm=t._locale.isPM(r),t._meridiem=r});Tt(["h","hh"],function(r,e,t){e[Ar]=it(r),Ke(t).bigHour=!0});Tt("hmm",function(r,e,t){var n=r.length-2;e[Ar]=it(r.substr(0,n)),e[Xs]=it(r.substr(n)),Ke(t).bigHour=!0});Tt("hmmss",function(r,e,t){var n=r.length-4,s=r.length-2;e[Ar]=it(r.substr(0,n)),e[Xs]=it(r.substr(n,2)),e[fo]=it(r.substr(s)),Ke(t).bigHour=!0});Tt("Hmm",function(r,e,t){var n=r.length-2;e[Ar]=it(r.substr(0,n)),e[Xs]=it(r.substr(n))});Tt("Hmmss",function(r,e,t){var n=r.length-4,s=r.length-2;e[Ar]=it(r.substr(0,n)),e[Xs]=it(r.substr(n,2)),e[fo]=it(r.substr(s))});function MG(r){return(r+"").toLowerCase().charAt(0)==="p"}var _G=/[ap]\.?m?\.?/i,xG=Du("Hours",!0);function LG(r,e,t){return r>11?t?"pm":"PM":t?"am":"AM"}var hI={calendar:R2,longDateFormat:b2,invalidDate:A2,ordinal:I2,dayOfMonthOrdinalParse:M2,relativeTime:x2,months:K2,monthsShort:rI,week:oG,weekdays:fG,weekdaysMin:mG,weekdaysShort:lI,meridiemParse:_G},kt={},tc={},ph;function PG(r,e){var t,n=Math.min(r.length,e.length);for(t=0;t<n;t+=1)if(r[t]!==e[t])return t;return n}function PC(r){return r&&r.toLowerCase().replace("_","-")}function FG(r){for(var e=0,t,n,s,i;e<r.length;){for(i=PC(r[e]).split("-"),t=i.length,n=PC(r[e+1]),n=n?n.split("-"):null;t>0;){if(s=Ip(i.slice(0,t).join("-")),s)return s;if(n&&n.length>=t&&PG(i,n)>=t-1)break;t--}e++}return ph}function DG(r){return!!(r&&r.match("^[^/\\\\]*$"))}function Ip(r){var e=null,t;if(kt[r]===void 0&&typeof tm<"u"&&tm&&tm.exports&&DG(r))try{e=ph._abbr,t=require,t("./locale/"+r),Qo(e)}catch{kt[r]=null}return kt[r]}function Qo(r,e){var t;return r&&(An(e)?t=Ao(r):t=yw(r,e),t?ph=t:typeof console<"u"&&console.warn&&console.warn("Locale "+r+" not found. Did you forget to load it?")),ph._abbr}function yw(r,e){if(e!==null){var t,n=hI;if(e.abbr=r,kt[r]!=null)KO("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=kt[r]._config;else if(e.parentLocale!=null)if(kt[e.parentLocale]!=null)n=kt[e.parentLocale]._config;else if(t=Ip(e.parentLocale),t!=null)n=t._config;else return tc[e.parentLocale]||(tc[e.parentLocale]=[]),tc[e.parentLocale].push({name:r,config:e}),null;return kt[r]=new aw(gE(n,e)),tc[r]&&tc[r].forEach(function(s){yw(s.name,s.config)}),Qo(r),kt[r]}else return delete kt[r],null}function HG(r,e){if(e!=null){var t,n,s=hI;kt[r]!=null&&kt[r].parentLocale!=null?kt[r].set(gE(kt[r]._config,e)):(n=Ip(r),n!=null&&(s=n._config),e=gE(s,e),n==null&&(e.abbr=r),t=new aw(e),t.parentLocale=kt[r],kt[r]=t),Qo(r)}else kt[r]!=null&&(kt[r].parentLocale!=null?(kt[r]=kt[r].parentLocale,r===Qo()&&Qo(r)):kt[r]!=null&&delete kt[r]);return kt[r]}function Ao(r){var e;if(r&&r._locale&&r._locale._abbr&&(r=r._locale._abbr),!r)return ph;if(!ni(r)){if(e=Ip(r),e)return e;r=[r]}return FG(r)}function VG(){return yE(kt)}function Ew(r){var e,t=r._a;return t&&Ke(r).overflow===-2&&(e=t[ho]<0||t[ho]>11?ho:t[Ai]<1||t[Ai]>fw(t[an],t[ho])?Ai:t[Ar]<0||t[Ar]>24||t[Ar]===24&&(t[Xs]!==0||t[fo]!==0||t[ja]!==0)?Ar:t[Xs]<0||t[Xs]>59?Xs:t[fo]<0||t[fo]>59?fo:t[ja]<0||t[ja]>999?ja:-1,Ke(r)._overflowDayOfYear&&(e<an||e>Ai)&&(e=Ai),Ke(r)._overflowWeeks&&e===-1&&(e=W2),Ke(r)._overflowWeekday&&e===-1&&(e=$2),Ke(r).overflow=e),r}var UG=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,kG=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,BG=/Z|[+-]\d\d(?::?\d\d)?/,Cd=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],zg=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],WG=/^\/?Date\((-?\d+)/i,$G=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,GG={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function dI(r){var e,t,n=r._i,s=UG.exec(n)||kG.exec(n),i,o,a,l,u=Cd.length,c=zg.length;if(s){for(Ke(r).iso=!0,e=0,t=u;e<t;e++)if(Cd[e][1].exec(s[1])){o=Cd[e][0],i=Cd[e][2]!==!1;break}if(o==null){r._isValid=!1;return}if(s[3]){for(e=0,t=c;e<t;e++)if(zg[e][1].exec(s[3])){a=(s[2]||" ")+zg[e][0];break}if(a==null){r._isValid=!1;return}}if(!i&&a!=null){r._isValid=!1;return}if(s[4])if(BG.exec(s[4]))l="Z";else{r._isValid=!1;return}r._f=o+(a||"")+(l||""),ww(r)}else r._isValid=!1}function zG(r,e,t,n,s,i){var o=[YG(r),rI.indexOf(e),parseInt(t,10),parseInt(n,10),parseInt(s,10)];return i&&o.push(parseInt(i,10)),o}function YG(r){var e=parseInt(r,10);return e<=49?2e3+e:e<=999?1900+e:e}function jG(r){return r.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function KG(r,e,t){if(r){var n=lI.indexOf(r),s=new Date(e[0],e[1],e[2]).getDay();if(n!==s)return Ke(t).weekdayMismatch=!0,t._isValid=!1,!1}return!0}function XG(r,e,t){if(r)return GG[r];if(e)return 0;var n=parseInt(t,10),s=n%100,i=(n-s)/100;return i*60+s}function fI(r){var e=$G.exec(jG(r._i)),t;if(e){if(t=zG(e[4],e[3],e[2],e[5],e[6],e[7]),!KG(e[1],t,r))return;r._a=t,r._tzm=XG(e[8],e[9],e[10]),r._d=fh.apply(null,r._a),r._d.setUTCMinutes(r._d.getUTCMinutes()-r._tzm),Ke(r).rfc2822=!0}else r._isValid=!1}function qG(r){var e=WG.exec(r._i);if(e!==null){r._d=new Date(+e[1]);return}if(dI(r),r._isValid===!1)delete r._isValid;else return;if(fI(r),r._isValid===!1)delete r._isValid;else return;r._strict?r._isValid=!1:de.createFromInputFallback(r)}de.createFromInputFallback=Ms("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(r){r._d=new Date(r._i+(r._useUTC?" UTC":""))});function $l(r,e,t){return r??e??t}function QG(r){var e=new Date(de.now());return r._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function vw(r){var e,t,n=[],s,i,o;if(!r._d){for(s=QG(r),r._w&&r._a[Ai]==null&&r._a[ho]==null&&ZG(r),r._dayOfYear!=null&&(o=$l(r._a[an],s[an]),(r._dayOfYear>zc(o)||r._dayOfYear===0)&&(Ke(r)._overflowDayOfYear=!0),t=fh(o,0,r._dayOfYear),r._a[ho]=t.getUTCMonth(),r._a[Ai]=t.getUTCDate()),e=0;e<3&&r._a[e]==null;++e)r._a[e]=n[e]=s[e];for(;e<7;e++)r._a[e]=n[e]=r._a[e]==null?e===2?1:0:r._a[e];r._a[Ar]===24&&r._a[Xs]===0&&r._a[fo]===0&&r._a[ja]===0&&(r._nextDay=!0,r._a[Ar]=0),r._d=(r._useUTC?fh:sG).apply(null,n),i=r._useUTC?r._d.getUTCDay():r._d.getDay(),r._tzm!=null&&r._d.setUTCMinutes(r._d.getUTCMinutes()-r._tzm),r._nextDay&&(r._a[Ar]=24),r._w&&typeof r._w.d<"u"&&r._w.d!==i&&(Ke(r).weekdayMismatch=!0)}}function ZG(r){var e,t,n,s,i,o,a,l,u;e=r._w,e.GG!=null||e.W!=null||e.E!=null?(i=1,o=4,t=$l(e.GG,r._a[an],mh(Ft(),1,4).year),n=$l(e.W,1),s=$l(e.E,1),(s<1||s>7)&&(l=!0)):(i=r._locale._week.dow,o=r._locale._week.doy,u=mh(Ft(),i,o),t=$l(e.gg,r._a[an],u.year),n=$l(e.w,u.week),e.d!=null?(s=e.d,(s<0||s>6)&&(l=!0)):e.e!=null?(s=e.e+i,(e.e<0||e.e>6)&&(l=!0)):s=i),n<1||n>yo(t,i,o)?Ke(r)._overflowWeeks=!0:l!=null?Ke(r)._overflowWeekday=!0:(a=aI(t,n,s,i,o),r._a[an]=a.year,r._dayOfYear=a.dayOfYear)}de.ISO_8601=function(){};de.RFC_2822=function(){};function ww(r){if(r._f===de.ISO_8601){dI(r);return}if(r._f===de.RFC_2822){fI(r);return}r._a=[],Ke(r).empty=!0;var e=""+r._i,t,n,s,i,o,a=e.length,l=0,u,c;for(s=XO(r._f,r._locale).match(lw)||[],c=s.length,t=0;t<c;t++)i=s[t],n=(e.match(U2(i,r))||[])[0],n&&(o=e.substr(0,e.indexOf(n)),o.length>0&&Ke(r).unusedInput.push(o),e=e.slice(e.indexOf(n)+n.length),l+=n.length),du[i]?(n?Ke(r).empty=!1:Ke(r).unusedTokens.push(i),B2(i,n,r)):r._strict&&!n&&Ke(r).unusedTokens.push(i);Ke(r).charsLeftOver=a-l,e.length>0&&Ke(r).unusedInput.push(e),r._a[Ar]<=12&&Ke(r).bigHour===!0&&r._a[Ar]>0&&(Ke(r).bigHour=void 0),Ke(r).parsedDateParts=r._a.slice(0),Ke(r).meridiem=r._meridiem,r._a[Ar]=JG(r._locale,r._a[Ar],r._meridiem),u=Ke(r).era,u!==null&&(r._a[an]=r._locale.erasConvertYear(u,r._a[an])),vw(r),Ew(r)}function JG(r,e,t){var n;return t==null?e:r.meridiemHour!=null?r.meridiemHour(e,t):(r.isPM!=null&&(n=r.isPM(t),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function ez(r){var e,t,n,s,i,o,a=!1,l=r._f.length;if(l===0){Ke(r).invalidFormat=!0,r._d=new Date(NaN);return}for(s=0;s<l;s++)i=0,o=!1,e=ow({},r),r._useUTC!=null&&(e._useUTC=r._useUTC),e._f=r._f[s],ww(e),iw(e)&&(o=!0),i+=Ke(e).charsLeftOver,i+=Ke(e).unusedTokens.length*10,Ke(e).score=i,a?i<n&&(n=i,t=e):(n==null||i<n||o)&&(n=i,t=e,o&&(a=!0));Yo(r,t||e)}function tz(r){if(!r._d){var e=uw(r._i),t=e.day===void 0?e.date:e.day;r._a=YO([e.year,e.month,t,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),vw(r)}}function rz(r){var e=new Uh(Ew(mI(r)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function mI(r){var e=r._i,t=r._f;return r._locale=r._locale||Ao(r._l),e===null||t===void 0&&e===""?Sp({nullInput:!0}):(typeof e=="string"&&(r._i=e=r._locale.preparse(e)),si(e)?new Uh(Ew(e)):(Vh(e)?r._d=e:ni(t)?ez(r):t?ww(r):nz(r),iw(r)||(r._d=null),r))}function nz(r){var e=r._i;An(e)?r._d=new Date(de.now()):Vh(e)?r._d=new Date(e.valueOf()):typeof e=="string"?qG(r):ni(e)?(r._a=YO(e.slice(0),function(t){return parseInt(t,10)}),vw(r)):qa(e)?tz(r):Co(e)?r._d=new Date(e):de.createFromInputFallback(r)}function pI(r,e,t,n,s){var i={};return(e===!0||e===!1)&&(n=e,e=void 0),(t===!0||t===!1)&&(n=t,t=void 0),(qa(r)&&sw(r)||ni(r)&&r.length===0)&&(r=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=s,i._l=t,i._i=r,i._f=e,i._strict=n,rz(i)}function Ft(r,e,t,n){return pI(r,e,t,n,!1)}var sz=Ms("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var r=Ft.apply(null,arguments);return this.isValid()&&r.isValid()?r<this?this:r:Sp()}),iz=Ms("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var r=Ft.apply(null,arguments);return this.isValid()&&r.isValid()?r>this?this:r:Sp()});function gI(r,e){var t,n;if(e.length===1&&ni(e[0])&&(e=e[0]),!e.length)return Ft();for(t=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][r](t))&&(t=e[n]);return t}function oz(){var r=[].slice.call(arguments,0);return gI("isBefore",r)}function az(){var r=[].slice.call(arguments,0);return gI("isAfter",r)}var lz=function(){return Date.now?Date.now():+new Date},rc=["year","quarter","month","week","day","hour","minute","second","millisecond"];function uz(r){var e,t=!1,n,s=rc.length;for(e in r)if(ft(r,e)&&!(ir.call(rc,e)!==-1&&(r[e]==null||!isNaN(r[e]))))return!1;for(n=0;n<s;++n)if(r[rc[n]]){if(t)return!1;parseFloat(r[rc[n]])!==it(r[rc[n]])&&(t=!0)}return!0}function cz(){return this._isValid}function hz(){return ii(NaN)}function Mp(r){var e=uw(r),t=e.year||0,n=e.quarter||0,s=e.month||0,i=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=uz(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+o+i*7,this._months=+s+n*3+t*12,this._data={},this._locale=Ao(),this._bubble()}function Lf(r){return r instanceof Mp}function vE(r){return r<0?Math.round(-1*r)*-1:Math.round(r)}function dz(r,e,t){var n=Math.min(r.length,e.length),s=Math.abs(r.length-e.length),i=0,o;for(o=0;o<n;o++)it(r[o])!==it(e[o])&&i++;return i+s}function yI(r,e){Oe(r,0,0,function(){var t=this.utcOffset(),n="+";return t<0&&(t=-t,n="-"),n+Pi(~~(t/60),2)+e+Pi(~~t%60,2)})}yI("Z",":");yI("ZZ","");ve("Z",Ap);ve("ZZ",Ap);Tt(["Z","ZZ"],function(r,e,t){t._useUTC=!0,t._tzm=Rw(Ap,r)});var fz=/([\+\-]|\d\d)/gi;function Rw(r,e){var t=(e||"").match(r),n,s,i;return t===null?null:(n=t[t.length-1]||[],s=(n+"").match(fz)||["-",0,0],i=+(s[1]*60)+it(s[2]),i===0?0:s[0]==="+"?i:-i)}function Sw(r,e){var t,n;return e._isUTC?(t=e.clone(),n=(si(r)||Vh(r)?r.valueOf():Ft(r).valueOf())-t.valueOf(),t._d.setTime(t._d.valueOf()+n),de.updateOffset(t,!1),t):Ft(r).local()}function wE(r){return-Math.round(r._d.getTimezoneOffset())}de.updateOffset=function(){};function mz(r,e,t){var n=this._offset||0,s;if(!this.isValid())return r!=null?this:NaN;if(r!=null){if(typeof r=="string"){if(r=Rw(Ap,r),r===null)return this}else Math.abs(r)<16&&!t&&(r=r*60);return!this._isUTC&&e&&(s=wE(this)),this._offset=r,this._isUTC=!0,s!=null&&this.add(s,"m"),n!==r&&(!e||this._changeInProgress?wI(this,ii(r-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,de.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:wE(this)}function pz(r,e){return r!=null?(typeof r!="string"&&(r=-r),this.utcOffset(r,e),this):-this.utcOffset()}function gz(r){return this.utcOffset(0,r)}function yz(r){return this._isUTC&&(this.utcOffset(0,r),this._isUTC=!1,r&&this.subtract(wE(this),"m")),this}function Ez(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var r=Rw(H2,this._i);r!=null?this.utcOffset(r):this.utcOffset(0,!0)}return this}function vz(r){return this.isValid()?(r=r?Ft(r).utcOffset():0,(this.utcOffset()-r)%60===0):!1}function wz(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Rz(){if(!An(this._isDSTShifted))return this._isDSTShifted;var r={},e;return ow(r,this),r=mI(r),r._a?(e=r._isUTC?$i(r._a):Ft(r._a),this._isDSTShifted=this.isValid()&&dz(r._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Sz(){return this.isValid()?!this._isUTC:!1}function Cz(){return this.isValid()?this._isUTC:!1}function EI(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Tz=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,bz=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ii(r,e){var t=r,n=null,s,i,o;return Lf(r)?t={ms:r._milliseconds,d:r._days,M:r._months}:Co(r)||!isNaN(+r)?(t={},e?t[e]=+r:t.milliseconds=+r):(n=Tz.exec(r))?(s=n[1]==="-"?-1:1,t={y:0,d:it(n[Ai])*s,h:it(n[Ar])*s,m:it(n[Xs])*s,s:it(n[fo])*s,ms:it(vE(n[ja]*1e3))*s}):(n=bz.exec(r))?(s=n[1]==="-"?-1:1,t={y:ba(n[2],s),M:ba(n[3],s),w:ba(n[4],s),d:ba(n[5],s),h:ba(n[6],s),m:ba(n[7],s),s:ba(n[8],s)}):t==null?t={}:typeof t=="object"&&("from"in t||"to"in t)&&(o=Nz(Ft(t.from),Ft(t.to)),t={},t.ms=o.milliseconds,t.M=o.months),i=new Mp(t),Lf(r)&&ft(r,"_locale")&&(i._locale=r._locale),Lf(r)&&ft(r,"_isValid")&&(i._isValid=r._isValid),i}ii.fn=Mp.prototype;ii.invalid=hz;function ba(r,e){var t=r&&parseFloat(r.replace(",","."));return(isNaN(t)?0:t)*e}function FC(r,e){var t={};return t.months=e.month()-r.month()+(e.year()-r.year())*12,r.clone().add(t.months,"M").isAfter(e)&&--t.months,t.milliseconds=+e-+r.clone().add(t.months,"M"),t}function Nz(r,e){var t;return r.isValid()&&e.isValid()?(e=Sw(e,r),r.isBefore(e)?t=FC(r,e):(t=FC(e,r),t.milliseconds=-t.milliseconds,t.months=-t.months),t):{milliseconds:0,months:0}}function vI(r,e){return function(t,n){var s,i;return n!==null&&!isNaN(+n)&&(KO(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=t,t=n,n=i),s=ii(t,n),wI(this,s,r),this}}function wI(r,e,t,n){var s=e._milliseconds,i=vE(e._days),o=vE(e._months);r.isValid()&&(n=n??!0,o&&sI(r,dh(r,"Month")+o*t),i&&tI(r,"Date",dh(r,"Date")+i*t),s&&r._d.setTime(r._d.valueOf()+s*t),n&&de.updateOffset(r,i||o))}var Az=vI(1,"add"),Oz=vI(-1,"subtract");function RI(r){return typeof r=="string"||r instanceof String}function Iz(r){return si(r)||Vh(r)||RI(r)||Co(r)||_z(r)||Mz(r)||r===null||r===void 0}function Mz(r){var e=qa(r)&&!sw(r),t=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],s,i,o=n.length;for(s=0;s<o;s+=1)i=n[s],t=t||ft(r,i);return e&&t}function _z(r){var e=ni(r),t=!1;return e&&(t=r.filter(function(n){return!Co(n)&&RI(r)}).length===0),e&&t}function xz(r){var e=qa(r)&&!sw(r),t=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],s,i;for(s=0;s<n.length;s+=1)i=n[s],t=t||ft(r,i);return e&&t}function Lz(r,e){var t=r.diff(e,"days",!0);return t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse"}function Pz(r,e){arguments.length===1&&(arguments[0]?Iz(arguments[0])?(r=arguments[0],e=void 0):xz(arguments[0])&&(e=arguments[0],r=void 0):(r=void 0,e=void 0));var t=r||Ft(),n=Sw(t,this).startOf("day"),s=de.calendarFormat(this,n)||"sameElse",i=e&&(Gi(e[s])?e[s].call(this,t):e[s]);return this.format(i||this.localeData().calendar(s,this,Ft(t)))}function Fz(){return new Uh(this)}function Dz(r,e){var t=si(r)?r:Ft(r);return this.isValid()&&t.isValid()?(e=_s(e)||"millisecond",e==="millisecond"?this.valueOf()>t.valueOf():t.valueOf()<this.clone().startOf(e).valueOf()):!1}function Hz(r,e){var t=si(r)?r:Ft(r);return this.isValid()&&t.isValid()?(e=_s(e)||"millisecond",e==="millisecond"?this.valueOf()<t.valueOf():this.clone().endOf(e).valueOf()<t.valueOf()):!1}function Vz(r,e,t,n){var s=si(r)?r:Ft(r),i=si(e)?e:Ft(e);return this.isValid()&&s.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(s,t):!this.isBefore(s,t))&&(n[1]===")"?this.isBefore(i,t):!this.isAfter(i,t))):!1}function Uz(r,e){var t=si(r)?r:Ft(r),n;return this.isValid()&&t.isValid()?(e=_s(e)||"millisecond",e==="millisecond"?this.valueOf()===t.valueOf():(n=t.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function kz(r,e){return this.isSame(r,e)||this.isAfter(r,e)}function Bz(r,e){return this.isSame(r,e)||this.isBefore(r,e)}function Wz(r,e,t){var n,s,i;if(!this.isValid())return NaN;if(n=Sw(r,this),!n.isValid())return NaN;switch(s=(n.utcOffset()-this.utcOffset())*6e4,e=_s(e),e){case"year":i=Pf(this,n)/12;break;case"month":i=Pf(this,n);break;case"quarter":i=Pf(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-s)/864e5;break;case"week":i=(this-n-s)/6048e5;break;default:i=this-n}return t?i:ys(i)}function Pf(r,e){if(r.date()<e.date())return-Pf(e,r);var t=(e.year()-r.year())*12+(e.month()-r.month()),n=r.clone().add(t,"months"),s,i;return e-n<0?(s=r.clone().add(t-1,"months"),i=(e-n)/(n-s)):(s=r.clone().add(t+1,"months"),i=(e-n)/(s-n)),-(t+i)||0}de.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";de.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function $z(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Gz(r){if(!this.isValid())return null;var e=r!==!0,t=e?this.clone().utc():this;return t.year()<0||t.year()>9999?xf(t,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Gi(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",xf(t,"Z")):xf(t,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function zz(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var r="moment",e="",t,n,s,i;return this.isLocal()||(r=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),t="["+r+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",s="-MM-DD[T]HH:mm:ss.SSS",i=e+'[")]',this.format(t+n+s+i)}function Yz(r){r||(r=this.isUtc()?de.defaultFormatUtc:de.defaultFormat);var e=xf(this,r);return this.localeData().postformat(e)}function jz(r,e){return this.isValid()&&(si(r)&&r.isValid()||Ft(r).isValid())?ii({to:this,from:r}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Kz(r){return this.from(Ft(),r)}function Xz(r,e){return this.isValid()&&(si(r)&&r.isValid()||Ft(r).isValid())?ii({from:this,to:r}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function qz(r){return this.to(Ft(),r)}function SI(r){var e;return r===void 0?this._locale._abbr:(e=Ao(r),e!=null&&(this._locale=e),this)}var CI=Ms("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(r){return r===void 0?this.localeData():this.locale(r)});function TI(){return this._locale}var wm=1e3,fu=60*wm,Rm=60*fu,bI=(365*400+97)*24*Rm;function mu(r,e){return(r%e+e)%e}function NI(r,e,t){return r<100&&r>=0?new Date(r+400,e,t)-bI:new Date(r,e,t).valueOf()}function AI(r,e,t){return r<100&&r>=0?Date.UTC(r+400,e,t)-bI:Date.UTC(r,e,t)}function Qz(r){var e,t;if(r=_s(r),r===void 0||r==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?AI:NI,r){case"year":e=t(this.year(),0,1);break;case"quarter":e=t(this.year(),this.month()-this.month()%3,1);break;case"month":e=t(this.year(),this.month(),1);break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=t(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=mu(e+(this._isUTC?0:this.utcOffset()*fu),Rm);break;case"minute":e=this._d.valueOf(),e-=mu(e,fu);break;case"second":e=this._d.valueOf(),e-=mu(e,wm);break}return this._d.setTime(e),de.updateOffset(this,!0),this}function Zz(r){var e,t;if(r=_s(r),r===void 0||r==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?AI:NI,r){case"year":e=t(this.year()+1,0,1)-1;break;case"quarter":e=t(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=t(this.year(),this.month()+1,1)-1;break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=t(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Rm-mu(e+(this._isUTC?0:this.utcOffset()*fu),Rm)-1;break;case"minute":e=this._d.valueOf(),e+=fu-mu(e,fu)-1;break;case"second":e=this._d.valueOf(),e+=wm-mu(e,wm)-1;break}return this._d.setTime(e),de.updateOffset(this,!0),this}function Jz(){return this._d.valueOf()-(this._offset||0)*6e4}function eY(){return Math.floor(this.valueOf()/1e3)}function tY(){return new Date(this.valueOf())}function rY(){var r=this;return[r.year(),r.month(),r.date(),r.hour(),r.minute(),r.second(),r.millisecond()]}function nY(){var r=this;return{years:r.year(),months:r.month(),date:r.date(),hours:r.hours(),minutes:r.minutes(),seconds:r.seconds(),milliseconds:r.milliseconds()}}function sY(){return this.isValid()?this.toISOString():null}function iY(){return iw(this)}function oY(){return Yo({},Ke(this))}function aY(){return Ke(this).overflow}function lY(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Oe("N",0,0,"eraAbbr");Oe("NN",0,0,"eraAbbr");Oe("NNN",0,0,"eraAbbr");Oe("NNNN",0,0,"eraName");Oe("NNNNN",0,0,"eraNarrow");Oe("y",["y",1],"yo","eraYear");Oe("y",["yy",2],0,"eraYear");Oe("y",["yyy",3],0,"eraYear");Oe("y",["yyyy",4],0,"eraYear");ve("N",Cw);ve("NN",Cw);ve("NNN",Cw);ve("NNNN",vY);ve("NNNNN",wY);Tt(["N","NN","NNN","NNNN","NNNNN"],function(r,e,t,n){var s=t._locale.erasParse(r,n,t._strict);s?Ke(t).era=s:Ke(t).invalidEra=r});ve("y",Pu);ve("yy",Pu);ve("yyy",Pu);ve("yyyy",Pu);ve("yo",RY);Tt(["y","yy","yyy","yyyy"],an);Tt(["yo"],function(r,e,t,n){var s;t._locale._eraYearOrdinalRegex&&(s=r.match(t._locale._eraYearOrdinalRegex)),t._locale.eraYearOrdinalParse?e[an]=t._locale.eraYearOrdinalParse(r,s):e[an]=parseInt(r,10)});function uY(r,e){var t,n,s,i=this._eras||Ao("en")._eras;for(t=0,n=i.length;t<n;++t){switch(typeof i[t].since){case"string":s=de(i[t].since).startOf("day"),i[t].since=s.valueOf();break}switch(typeof i[t].until){case"undefined":i[t].until=1/0;break;case"string":s=de(i[t].until).startOf("day").valueOf(),i[t].until=s.valueOf();break}}return i}function cY(r,e,t){var n,s,i=this.eras(),o,a,l;for(r=r.toUpperCase(),n=0,s=i.length;n<s;++n)if(o=i[n].name.toUpperCase(),a=i[n].abbr.toUpperCase(),l=i[n].narrow.toUpperCase(),t)switch(e){case"N":case"NN":case"NNN":if(a===r)return i[n];break;case"NNNN":if(o===r)return i[n];break;case"NNNNN":if(l===r)return i[n];break}else if([o,a,l].indexOf(r)>=0)return i[n]}function hY(r,e){var t=r.since<=r.until?1:-1;return e===void 0?de(r.since).year():de(r.since).year()+(e-r.offset)*t}function dY(){var r,e,t,n=this.localeData().eras();for(r=0,e=n.length;r<e;++r)if(t=this.clone().startOf("day").valueOf(),n[r].since<=t&&t<=n[r].until||n[r].until<=t&&t<=n[r].since)return n[r].name;return""}function fY(){var r,e,t,n=this.localeData().eras();for(r=0,e=n.length;r<e;++r)if(t=this.clone().startOf("day").valueOf(),n[r].since<=t&&t<=n[r].until||n[r].until<=t&&t<=n[r].since)return n[r].narrow;return""}function mY(){var r,e,t,n=this.localeData().eras();for(r=0,e=n.length;r<e;++r)if(t=this.clone().startOf("day").valueOf(),n[r].since<=t&&t<=n[r].until||n[r].until<=t&&t<=n[r].since)return n[r].abbr;return""}function pY(){var r,e,t,n,s=this.localeData().eras();for(r=0,e=s.length;r<e;++r)if(t=s[r].since<=s[r].until?1:-1,n=this.clone().startOf("day").valueOf(),s[r].since<=n&&n<=s[r].until||s[r].until<=n&&n<=s[r].since)return(this.year()-de(s[r].since).year())*t+s[r].offset;return this.year()}function gY(r){return ft(this,"_erasNameRegex")||Tw.call(this),r?this._erasNameRegex:this._erasRegex}function yY(r){return ft(this,"_erasAbbrRegex")||Tw.call(this),r?this._erasAbbrRegex:this._erasRegex}function EY(r){return ft(this,"_erasNarrowRegex")||Tw.call(this),r?this._erasNarrowRegex:this._erasRegex}function Cw(r,e){return e.erasAbbrRegex(r)}function vY(r,e){return e.erasNameRegex(r)}function wY(r,e){return e.erasNarrowRegex(r)}function RY(r,e){return e._eraYearOrdinalRegex||Pu}function Tw(){var r=[],e=[],t=[],n=[],s,i,o,a,l,u=this.eras();for(s=0,i=u.length;s<i;++s)o=go(u[s].name),a=go(u[s].abbr),l=go(u[s].narrow),e.push(o),r.push(a),t.push(l),n.push(o),n.push(a),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+t.join("|")+")","i")}Oe(0,["gg",2],0,function(){return this.weekYear()%100});Oe(0,["GG",2],0,function(){return this.isoWeekYear()%100});function _p(r,e){Oe(0,[r,r.length],0,e)}_p("gggg","weekYear");_p("ggggg","weekYear");_p("GGGG","isoWeekYear");_p("GGGGG","isoWeekYear");ve("G",Np);ve("g",Np);ve("GG",Dt,rs);ve("gg",Dt,rs);ve("GGGG",hw,cw);ve("gggg",hw,cw);ve("GGGGG",bp,Cp);ve("ggggg",bp,Cp);Bh(["gggg","ggggg","GGGG","GGGGG"],function(r,e,t,n){e[n.substr(0,2)]=it(r)});Bh(["gg","GG"],function(r,e,t,n){e[n]=de.parseTwoDigitYear(r)});function SY(r){return OI.call(this,r,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function CY(r){return OI.call(this,r,this.isoWeek(),this.isoWeekday(),1,4)}function TY(){return yo(this.year(),1,4)}function bY(){return yo(this.isoWeekYear(),1,4)}function NY(){var r=this.localeData()._week;return yo(this.year(),r.dow,r.doy)}function AY(){var r=this.localeData()._week;return yo(this.weekYear(),r.dow,r.doy)}function OI(r,e,t,n,s){var i;return r==null?mh(this,n,s).year:(i=yo(r,n,s),e>i&&(e=i),OY.call(this,r,e,t,n,s))}function OY(r,e,t,n,s){var i=aI(r,e,t,n,s),o=fh(i.year,0,i.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}Oe("Q",0,"Qo","quarter");ve("Q",qO);Tt("Q",function(r,e){e[ho]=(it(r)-1)*3});function IY(r){return r==null?Math.ceil((this.month()+1)/3):this.month((r-1)*3+this.month()%3)}Oe("D",["DD",2],"Do","date");ve("D",Dt,Fu);ve("DD",Dt,rs);ve("Do",function(r,e){return r?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Tt(["D","DD"],Ai);Tt("Do",function(r,e){e[Ai]=it(r.match(Dt)[0])});var II=Du("Date",!0);Oe("DDD",["DDDD",3],"DDDo","dayOfYear");ve("DDD",Tp);ve("DDDD",QO);Tt(["DDD","DDDD"],function(r,e,t){t._dayOfYear=it(r)});function MY(r){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return r==null?e:this.add(r-e,"d")}Oe("m",["mm",2],0,"minute");ve("m",Dt,dw);ve("mm",Dt,rs);Tt(["m","mm"],Xs);var _Y=Du("Minutes",!1);Oe("s",["ss",2],0,"second");ve("s",Dt,dw);ve("ss",Dt,rs);Tt(["s","ss"],fo);var xY=Du("Seconds",!1);Oe("S",0,0,function(){return~~(this.millisecond()/100)});Oe(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Oe(0,["SSS",3],0,"millisecond");Oe(0,["SSSS",4],0,function(){return this.millisecond()*10});Oe(0,["SSSSS",5],0,function(){return this.millisecond()*100});Oe(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Oe(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Oe(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Oe(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ve("S",Tp,qO);ve("SS",Tp,rs);ve("SSS",Tp,QO);var jo,MI;for(jo="SSSS";jo.length<=9;jo+="S")ve(jo,Pu);function LY(r,e){e[ja]=it(("0."+r)*1e3)}for(jo="S";jo.length<=9;jo+="S")Tt(jo,LY);MI=Du("Milliseconds",!1);Oe("z",0,0,"zoneAbbr");Oe("zz",0,0,"zoneName");function PY(){return this._isUTC?"UTC":""}function FY(){return this._isUTC?"Coordinated Universal Time":""}var ee=Uh.prototype;ee.add=Az;ee.calendar=Pz;ee.clone=Fz;ee.diff=Wz;ee.endOf=Zz;ee.format=Yz;ee.from=jz;ee.fromNow=Kz;ee.to=Xz;ee.toNow=qz;ee.get=z2;ee.invalidAt=aY;ee.isAfter=Dz;ee.isBefore=Hz;ee.isBetween=Vz;ee.isSame=Uz;ee.isSameOrAfter=kz;ee.isSameOrBefore=Bz;ee.isValid=iY;ee.lang=CI;ee.locale=SI;ee.localeData=TI;ee.max=iz;ee.min=sz;ee.parsingFlags=oY;ee.set=Y2;ee.startOf=Qz;ee.subtract=Oz;ee.toArray=rY;ee.toObject=nY;ee.toDate=tY;ee.toISOString=Gz;ee.inspect=zz;typeof Symbol<"u"&&Symbol.for!=null&&(ee[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ee.toJSON=sY;ee.toString=$z;ee.unix=eY;ee.valueOf=Jz;ee.creationData=lY;ee.eraName=dY;ee.eraNarrow=fY;ee.eraAbbr=mY;ee.eraYear=pY;ee.year=eI;ee.isLeapYear=G2;ee.weekYear=SY;ee.isoWeekYear=CY;ee.quarter=ee.quarters=IY;ee.month=iI;ee.daysInMonth=tG;ee.week=ee.weeks=uG;ee.isoWeek=ee.isoWeeks=cG;ee.weeksInYear=NY;ee.weeksInWeekYear=AY;ee.isoWeeksInYear=TY;ee.isoWeeksInISOWeekYear=bY;ee.date=II;ee.day=ee.days=CG;ee.weekday=TG;ee.isoWeekday=bG;ee.dayOfYear=MY;ee.hour=ee.hours=xG;ee.minute=ee.minutes=_Y;ee.second=ee.seconds=xY;ee.millisecond=ee.milliseconds=MI;ee.utcOffset=mz;ee.utc=gz;ee.local=yz;ee.parseZone=Ez;ee.hasAlignedHourOffset=vz;ee.isDST=wz;ee.isLocal=Sz;ee.isUtcOffset=Cz;ee.isUtc=EI;ee.isUTC=EI;ee.zoneAbbr=PY;ee.zoneName=FY;ee.dates=Ms("dates accessor is deprecated. Use date instead.",II);ee.months=Ms("months accessor is deprecated. Use month instead",iI);ee.years=Ms("years accessor is deprecated. Use year instead",eI);ee.zone=Ms("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",pz);ee.isDSTShifted=Ms("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Rz);function DY(r){return Ft(r*1e3)}function HY(){return Ft.apply(null,arguments).parseZone()}function _I(r){return r}var mt=aw.prototype;mt.calendar=S2;mt.longDateFormat=N2;mt.invalidDate=O2;mt.ordinal=_2;mt.preparse=_I;mt.postformat=_I;mt.relativeTime=L2;mt.pastFuture=P2;mt.set=w2;mt.eras=uY;mt.erasParse=cY;mt.erasConvertYear=hY;mt.erasAbbrRegex=yY;mt.erasNameRegex=gY;mt.erasNarrowRegex=EY;mt.months=Q2;mt.monthsShort=Z2;mt.monthsParse=eG;mt.monthsRegex=nG;mt.monthsShortRegex=rG;mt.week=iG;mt.firstDayOfYear=lG;mt.firstDayOfWeek=aG;mt.weekdays=EG;mt.weekdaysMin=wG;mt.weekdaysShort=vG;mt.weekdaysParse=SG;mt.weekdaysRegex=NG;mt.weekdaysShortRegex=AG;mt.weekdaysMinRegex=OG;mt.isPM=MG;mt.meridiem=LG;function Sm(r,e,t,n){var s=Ao(),i=$i().set(n,e);return s[t](i,r)}function xI(r,e,t){if(Co(r)&&(e=r,r=void 0),r=r||"",e!=null)return Sm(r,e,t,"month");var n,s=[];for(n=0;n<12;n++)s[n]=Sm(r,n,t,"month");return s}function bw(r,e,t,n){typeof r=="boolean"?(Co(e)&&(t=e,e=void 0),e=e||""):(e=r,t=e,r=!1,Co(e)&&(t=e,e=void 0),e=e||"");var s=Ao(),i=r?s._week.dow:0,o,a=[];if(t!=null)return Sm(e,(t+i)%7,n,"day");for(o=0;o<7;o++)a[o]=Sm(e,(o+i)%7,n,"day");return a}function VY(r,e){return xI(r,e,"months")}function UY(r,e){return xI(r,e,"monthsShort")}function kY(r,e,t){return bw(r,e,t,"weekdays")}function BY(r,e,t){return bw(r,e,t,"weekdaysShort")}function WY(r,e,t){return bw(r,e,t,"weekdaysMin")}Qo("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(r){var e=r%10,t=it(r%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return r+t}});de.lang=Ms("moment.lang is deprecated. Use moment.locale instead.",Qo);de.langData=Ms("moment.langData is deprecated. Use moment.localeData instead.",Ao);var Xi=Math.abs;function $Y(){var r=this._data;return this._milliseconds=Xi(this._milliseconds),this._days=Xi(this._days),this._months=Xi(this._months),r.milliseconds=Xi(r.milliseconds),r.seconds=Xi(r.seconds),r.minutes=Xi(r.minutes),r.hours=Xi(r.hours),r.months=Xi(r.months),r.years=Xi(r.years),this}function LI(r,e,t,n){var s=ii(e,t);return r._milliseconds+=n*s._milliseconds,r._days+=n*s._days,r._months+=n*s._months,r._bubble()}function GY(r,e){return LI(this,r,e,1)}function zY(r,e){return LI(this,r,e,-1)}function DC(r){return r<0?Math.floor(r):Math.ceil(r)}function YY(){var r=this._milliseconds,e=this._days,t=this._months,n=this._data,s,i,o,a,l;return r>=0&&e>=0&&t>=0||r<=0&&e<=0&&t<=0||(r+=DC(RE(t)+e)*864e5,e=0,t=0),n.milliseconds=r%1e3,s=ys(r/1e3),n.seconds=s%60,i=ys(s/60),n.minutes=i%60,o=ys(i/60),n.hours=o%24,e+=ys(o/24),l=ys(PI(e)),t+=l,e-=DC(RE(l)),a=ys(t/12),t%=12,n.days=e,n.months=t,n.years=a,this}function PI(r){return r*4800/146097}function RE(r){return r*146097/4800}function jY(r){if(!this.isValid())return NaN;var e,t,n=this._milliseconds;if(r=_s(r),r==="month"||r==="quarter"||r==="year")switch(e=this._days+n/864e5,t=this._months+PI(e),r){case"month":return t;case"quarter":return t/3;case"year":return t/12}else switch(e=this._days+Math.round(RE(this._months)),r){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+r)}}function Oo(r){return function(){return this.as(r)}}var FI=Oo("ms"),KY=Oo("s"),XY=Oo("m"),qY=Oo("h"),QY=Oo("d"),ZY=Oo("w"),JY=Oo("M"),ej=Oo("Q"),tj=Oo("y"),rj=FI;function nj(){return ii(this)}function sj(r){return r=_s(r),this.isValid()?this[r+"s"]():NaN}function yl(r){return function(){return this.isValid()?this._data[r]:NaN}}var ij=yl("milliseconds"),oj=yl("seconds"),aj=yl("minutes"),lj=yl("hours"),uj=yl("days"),cj=yl("months"),hj=yl("years");function dj(){return ys(this.days()/7)}var io=Math.round,Ql={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function fj(r,e,t,n,s){return s.relativeTime(e||1,!!t,r,n)}function mj(r,e,t,n){var s=ii(r).abs(),i=io(s.as("s")),o=io(s.as("m")),a=io(s.as("h")),l=io(s.as("d")),u=io(s.as("M")),c=io(s.as("w")),h=io(s.as("y")),d=i<=t.ss&&["s",i]||i<t.s&&["ss",i]||o<=1&&["m"]||o<t.m&&["mm",o]||a<=1&&["h"]||a<t.h&&["hh",a]||l<=1&&["d"]||l<t.d&&["dd",l];return t.w!=null&&(d=d||c<=1&&["w"]||c<t.w&&["ww",c]),d=d||u<=1&&["M"]||u<t.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+r>0,d[4]=n,fj.apply(null,d)}function pj(r){return r===void 0?io:typeof r=="function"?(io=r,!0):!1}function gj(r,e){return Ql[r]===void 0?!1:e===void 0?Ql[r]:(Ql[r]=e,r==="s"&&(Ql.ss=e-1),!0)}function yj(r,e){if(!this.isValid())return this.localeData().invalidDate();var t=!1,n=Ql,s,i;return typeof r=="object"&&(e=r,r=!1),typeof r=="boolean"&&(t=r),typeof e=="object"&&(n=Object.assign({},Ql,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),s=this.localeData(),i=mj(this,!t,n,s),t&&(i=s.pastFuture(+this,i)),s.postformat(i)}var Yg=Math.abs;function Al(r){return(r>0)-(r<0)||+r}function xp(){if(!this.isValid())return this.localeData().invalidDate();var r=Yg(this._milliseconds)/1e3,e=Yg(this._days),t=Yg(this._months),n,s,i,o,a=this.asSeconds(),l,u,c,h;return a?(n=ys(r/60),s=ys(n/60),r%=60,n%=60,i=ys(t/12),t%=12,o=r?r.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Al(this._months)!==Al(a)?"-":"",c=Al(this._days)!==Al(a)?"-":"",h=Al(this._milliseconds)!==Al(a)?"-":"",l+"P"+(i?u+i+"Y":"")+(t?u+t+"M":"")+(e?c+e+"D":"")+(s||n||r?"T":"")+(s?h+s+"H":"")+(n?h+n+"M":"")+(r?h+o+"S":"")):"P0D"}var ht=Mp.prototype;ht.isValid=cz;ht.abs=$Y;ht.add=GY;ht.subtract=zY;ht.as=jY;ht.asMilliseconds=FI;ht.asSeconds=KY;ht.asMinutes=XY;ht.asHours=qY;ht.asDays=QY;ht.asWeeks=ZY;ht.asMonths=JY;ht.asQuarters=ej;ht.asYears=tj;ht.valueOf=rj;ht._bubble=YY;ht.clone=nj;ht.get=sj;ht.milliseconds=ij;ht.seconds=oj;ht.minutes=aj;ht.hours=lj;ht.days=uj;ht.weeks=dj;ht.months=cj;ht.years=hj;ht.humanize=yj;ht.toISOString=xp;ht.toString=xp;ht.toJSON=xp;ht.locale=SI;ht.localeData=TI;ht.toIsoString=Ms("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",xp);ht.lang=CI;Oe("X",0,0,"unix");Oe("x",0,0,"valueOf");ve("x",Np);ve("X",V2);Tt("X",function(r,e,t){t._d=new Date(parseFloat(r)*1e3)});Tt("x",function(r,e,t){t._d=new Date(it(r))});//! moment.js
de.version="2.30.1";E2(Ft);de.fn=ee;de.min=oz;de.max=az;de.now=lz;de.utc=$i;de.unix=DY;de.months=VY;de.isDate=Vh;de.locale=Qo;de.invalid=Sp;de.duration=ii;de.isMoment=si;de.weekdays=kY;de.parseZone=HY;de.localeData=Ao;de.isDuration=Lf;de.monthsShort=UY;de.weekdaysMin=WY;de.defineLocale=yw;de.updateLocale=HG;de.locales=VG;de.weekdaysShort=BY;de.normalizeUnits=_s;de.relativeTimeRounding=pj;de.relativeTimeThreshold=gj;de.calendarFormat=Lz;de.prototype=ee;de.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function Ej(r){const e=r.length;let t=0;for(;t<e;)r[t]=[r[t]],t+=1}function HC(r,e){const t=e.length;let n=0;for(;n<t;)r.push(e[n]),n+=1}function jg(r){const e=[];if(!r||r.length===0||!r[0]||r[0].length===0)return e;const t=r.length,n=r[0].length;for(let s=0;s<t;s++)for(let i=0;i<n;i++)e[i]||(e[i]=[]),e[i][s]=r[s][i];return e}function Lp(r,e,t,n){let s=-1,i=r,o=t;Array.isArray(r)||(i=Array.from(r));const a=i.length;for(s+=1;s<a;)o=e(o,i[s],s,i),s+=1;return o}function Nw(r,e){let t=0,n=r;Array.isArray(r)||(n=Array.from(r));const s=n.length,i=[];let o=-1;for(;t<s;){const a=n[t];e(a,t,n)&&(o+=1,i[o]=a),t+=1}return i}function Ja(r,e){let t=0,n=r;Array.isArray(r)||(n=Array.from(r));const s=n.length,i=[];let o=-1;for(;t<s;){const a=n[t];o+=1,i[o]=e(a,t,n),t+=1}return i}function Je(r,e){let t=0,n=r;Array.isArray(r)||(n=Array.from(r));const s=n.length;for(;t<s&&e(n[t],t,n)!==!1;)t+=1;return r}function VC(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];const[n,...s]=[...e];let i=n;return Je(s,o=>{i=i.filter(a=>!o.includes(a))}),i}function UC(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return r.split(e)}function Qn(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return Lp(r,(i,o,a)=>{const l=o.replace(/\r?\n\s*/g,""),u=t[a]?t[a]:"";return i+l+u},"").trim()}function DI(r){let e;switch(typeof r){case"string":case"number":e=`${r}`;break;case"object":e=r===null?"":r.toString();break;case"undefined":e="";break;default:e=r.toString();break}return e}function at(r){return typeof r<"u"}function Ln(r){return typeof r>"u"}function Tu(r){return r===null||r===""||Ln(r)}function vj(r){return Object.prototype.toString.call(r)==="[object RegExp]"}const Ic="length",Yc=r=>parseInt(r,16),kC=r=>parseInt(r,10),Cm=(r,e,t)=>r.substr(e,t),jc=r=>r.codePointAt(0)-65,SE=r=>`${r}`.replace(/\-/g,""),wj=r=>Yc(Cm(SE(r),Yc("12"),jc("F")))/(Yc(Cm(SE(r),jc("B"),~~![][Ic]))||9),Rj=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let BC=!1;const WC={invalid:()=>Qn`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:r=>{let{keyValidityDate:e,hotVersion:t}=r;return Qn`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Qn`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},$C={invalid:()=>Qn`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:r=>{let{keyValidityDate:e,hotVersion:t}=r;return Qn`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Qn`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function Sj(r,e){const t=!Tu(r),n=typeof r=="string"&&r.toLowerCase()==="non-commercial-and-evaluation",s="14.6.2";let i,o="invalid",a="invalid";r=SE(r||"");const l=Cj(r);if(t||n||l)if(l){const u=de("10/02/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=wj(r);i=de((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(o="expired",a="expired"):(o="valid",a="valid")}else n?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(Rj()&&(o="valid",a="valid"),!BC&&o!=="valid"&&(WC[o]({keyValidityDate:i,hotVersion:s})&&console[o==="non_commercial"?"info":"warn"](WC[o]({keyValidityDate:i,hotVersion:s})),BC=!0),a!=="valid"&&e.parentNode&&$C[a]({keyValidityDate:i,hotVersion:s})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=$C[a]({keyValidityDate:i,hotVersion:s}),e.parentNode.insertBefore(c,e.nextSibling)}}function Cj(r){let e=[][Ic],t=e;if(r[Ic]!==jc("Z"))return!1;for(let n="",s="B<H4P+".split(""),i=jc(s.shift());i;i=jc(s.shift()||"A"))--i<""[Ic]?t=t|(kC(`${kC(Yc(n)+(Yc(Cm(r,Math.abs(i),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=Cm(r,i,i?s[Ic]===1?9:8:6);return t===e}function Aw(r){return r[0].toUpperCase()+r.substr(1)}function HI(){function r(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return r()+r()+r()+r()}function Tj(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${r}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,n)=>t.charAt(0)==="\\"?t.substr(1,t.length-1):e[n]===void 0?"":e[n])}function bj(r,e){return y2.sanitize(r,e)}const Pp=r=>["tabindex",r],Nj=()=>["role","treegrid"],mo=()=>["role","presentation"],Aj=()=>["role","gridcell"],Oj=()=>["role","rowheader"],VI=()=>["role","rowgroup"],Ij=()=>["role","columnheader"],CE=()=>["role","row"],Mj=()=>["scope","col"],_j=()=>["scope","row"],xj=()=>["aria-hidden","true"],Lj=()=>["aria-multiselectable","true"],UI=r=>["aria-rowcount",r],Fp=r=>["aria-colcount",r],kI=r=>["aria-rowindex",r],Ow=r=>["aria-colindex",r],GC=()=>["aria-readonly","true"],zC=()=>["aria-invalid","true"],BI=()=>["aria-selected","true"];function Pj(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=-1,n=null,s=r;for(;s!==null;){if(t===e){n=s;break}s.host&&s.nodeType===Node.DOCUMENT_FRAGMENT_NODE?s=s.host:(t+=1,s=s.parentNode)}return n}function Fj(r,e){const t=r.closest(".handsontable");return!!t&&(t.parentNode===e||t===e)}function Dj(r){return Object.getPrototypeOf(r.parent)&&r.frameElement}function Tm(r){return Dj(r)&&r.parent}function WI(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:s}=Node;let i=r;for(;i!=null&&i!==t;){const{nodeType:o,nodeName:a}=i;if(o===n&&(e.includes(a)||e.includes(i)))return i;const{host:l}=i;l&&o===s?i=l:i=i.parentNode}return null}function Td(r,e,t){const n=[];let s=r;for(;s&&(s=WI(s,e,t),!(!s||t&&!t.contains(s)));)n.push(s),s.host&&s.nodeType===Node.DOCUMENT_FRAGMENT_NODE?s=s.host:s=s.parentNode;const i=n.length;return i?n[i-1]:null}function TE(r,e){let t=r.parentNode,n=[];for(typeof e=="string"?r.defaultView?n=Array.prototype.slice.call(r.querySelectorAll(e),0):n=Array.prototype.slice.call(r.ownerDocument.querySelectorAll(e),0):n.push(e);t!==null;){if(n.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function Hj(r){let e=0,t=r;if(t.previousSibling)for(;t=t.previousSibling;)e+=1;return e}function Na(r,e,t){const n=t.parentElement.querySelector(`.ht_clone_${r}`);return n?n.contains(e):null}function $I(r){return!r||!r.length?[]:r.filter(e=>!!e)}function GI(r,e){if(!r||!r.length)return{regexFree:[],regexes:[]};const t=[],n=[];return n.push(...r.filter(s=>{const i=s instanceof RegExp;return i&&e&&t.push(s),!i})),{regexFree:n,regexes:t}}function zt(r,e){return r.classList===void 0||typeof e!="string"||e===""?!1:r.classList.contains(e)}function dt(r,e){typeof e=="string"&&(e=e.split(" ")),e=$I(e),e.length>0&&r.classList.add(...e)}function Nr(r,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:t,regexes:n}=GI(e,!0);t=$I(t),t.length>0&&r.classList.remove(...t),n.forEach(s=>{r.classList.forEach(i=>{s.test(i)&&r.classList.remove(i)})})}function Yt(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,t]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&r.setAttribute(...n)})}function Wh(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:t,regexes:n}=GI(e,!0);t.forEach(s=>{s!==""&&r.removeAttribute(s)}),n.forEach(s=>{r.getAttributeNames().forEach(i=>{s.test(i)&&r.removeAttribute(i)})})}function zI(r){if(r.nodeType===3)r.parentNode.removeChild(r);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(r.nodeName)>-1){const e=r.childNodes;for(let t=e.length-1;t>=0;t--)zI(e[t])}}function bu(r){let e;for(;e=r.lastChild;)r.removeChild(e)}const Vj=/(<(.*)>|&(.*);)/;function Uj(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Vj.test(e)?r.innerHTML=t?bj(e):e:$h(r,e)}function $h(r,e){const t=r.firstChild;t&&t.nodeType===3&&t.nextSibling===null?t.textContent=e:(bu(r),r.appendChild(r.ownerDocument.createTextNode(e)))}function gh(r){const e=r.ownerDocument.documentElement;let t=r;for(;t!==e;){if(t===null)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(t.host){if(t.host.impl)return gh(t.host.impl);if(t.host)return gh(t.host);throw new Error("Lost in Web Components world")}else return!1;else if(ia(t).display==="none")return!1;t=t.parentNode}return!0}function Es(r){const e=r.ownerDocument,t=e.defaultView,n=e.documentElement;let s=r,i,o,a;for(i=s.offsetLeft,o=s.offsetTop,a=s;(s=s.offsetParent)&&!(s===e.body||!("offsetLeft"in s));)i+=s.offsetLeft,o+=s.offsetTop,a=s;return a&&a.style.position==="fixed"&&(i+=t.pageXOffset||n.scrollLeft,o+=t.pageYOffset||n.scrollTop),{left:i,top:o}}function YI(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Iw(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Mw(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return r===e?YI(e):r.scrollTop}function jI(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return r===e?Iw(e):r.scrollLeft}function bm(r){let e=r.ownerDocument,t=e?e.defaultView:void 0;e||(e=r.document?r.document:r,t=e.defaultView);const n=["auto","scroll"];let s=r.parentNode;for(;s&&s.style&&e.body!==s;){let{overflow:i,overflowX:o,overflowY:a}=s.style;if([i,o,a].includes("scroll"))return s;if({overflow:i,overflowX:o,overflowY:a}=t.getComputedStyle(s),n.includes(i)||n.includes(o)||n.includes(a)||s.clientHeight<=s.scrollHeight+1&&(n.includes(a)||n.includes(i))||s.clientWidth<=s.scrollWidth+1&&(n.includes(o)||n.includes(i)))return s;s=s.parentNode}return t}function kj(r){return r.scrollHeight-r.clientHeight}function Bj(r){return r.scrollWidth-r.clientWidth}function Nm(r){const e=r.ownerDocument,t=e.defaultView;let n=r.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const s=ia(n,t),i=["scroll","hidden","auto"],o=s.getPropertyValue("overflow"),a=s.getPropertyValue("overflow-y"),l=s.getPropertyValue("overflow-x");if(i.includes(o)||i.includes(a)||i.includes(l))return n;n=n.parentNode}return t}function bE(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(r){if(r===t)return e==="width"?`${t.innerWidth}px`:e==="height"?`${t.innerHeight}px`:void 0}else return;const n=r.style[e];if(n!==""&&n!==void 0)return n;const s=ia(r,t);if(s[e]!==""&&s[e]!==void 0)return s[e]}function ia(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return r.currentStyle||e.getComputedStyle(r)}function Fr(r){return r.offsetWidth}function Ss(r){return r.offsetHeight}function Zl(r){return r.clientHeight||r.innerHeight}function KI(r){return r.clientWidth||r.innerWidth}function Wj(r){return r.selectionStart?r.selectionStart:0}function YC(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;r.getSelection&&(r.getSelection().empty?r.getSelection().empty():r.getSelection().removeAllRanges&&r.getSelection().removeAllRanges())}function XI(r,e,t){if(t===void 0&&(t=e),r.setSelectionRange){r.focus();try{r.setSelectionRange(e,t)}catch{const s=r.parentNode,i=s.style.display;s.style.display="block",r.setSelectionRange(e,t),s.style.display=i}}}let Kg;function $j(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=r.createElement("div");e.style.height="200px",e.style.width="100%";const t=r.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(r.body||r.documentElement).appendChild(t);const n=e.offsetWidth;t.style.overflow="scroll";let s=e.offsetWidth;return n===s&&(s=t.clientWidth),(r.body||r.documentElement).removeChild(t),n-s}function vn(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Kg===void 0&&(Kg=$j(r)),Kg}function Gj(r){return r.offsetWidth!==r.clientWidth}function zj(r){return r.offsetHeight!==r.clientHeight}function _w(r,e,t){r.style.transform=`translate3d(${e},${t},0)`}function Dp(r){r.style.transform&&r.style.transform!==""&&(r.style.transform="")}function Ff(r){return r&&(["INPUT","SELECT","TEXTAREA"].indexOf(r.nodeName)>-1||r.contentEditable==="true")}function qI(r){return Ff(r)&&r.hasAttribute("data-hot-input")===!1}function Yj(r,e){new IntersectionObserver((n,s)=>{n.forEach(i=>{i.isIntersecting&&r.offsetParent!==null&&(e(),s.unobserve(r))})},{root:r.ownerDocument.body}).observe(r)}function Bt(r){return typeof r=="function"}function jj(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=null,n;function s(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t&&clearTimeout(t),t=setTimeout(()=>{n=r.apply(this,o)},e),n}return s}function Kj(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r.apply(this,t.concat(o))}}function NE(r,e,t,n,s,i,o,a){return at(a)?r.call(e,t,n,s,i,o,a):at(o)?r.call(e,t,n,s,i,o):at(i)?r.call(e,t,n,s,i):at(s)?r.call(e,t,n,s):at(n)?r.call(e,t,n):at(t)?r.call(e,t):r.call(e)}var Xj=vr,jC=bO,qj=jr,KC=ul,Qj=Rp,XC=Xj([].push),Zj=function(r){if(qj(r))return r;if(jC(r)){for(var e=r.length,t=[],n=0;n<e;n++){var s=r[n];typeof s=="string"?XC(t,s):(typeof s=="number"||KC(s)==="Number"||KC(s)==="String")&&XC(t,Qj(s))}var i=t.length,o=!0;return function(a,l){if(o)return o=!1,l;if(jC(this))return l;for(var u=0;u<i;u++)if(t[u]===a)return l}}},Jj=Rn,QI=xu,ZI=wp,e3=No,Gh=vr,JI=un,qC=jr,QC=$v,eM=rw,t3=Zj,r3=Wv,n3=String,Zo=QI("JSON","stringify"),bd=Gh(/./.exec),ZC=Gh("".charAt),s3=Gh("".charCodeAt),i3=Gh("".replace),o3=Gh(1.1.toString),a3=/[\uD800-\uDFFF]/g,JC=/^[\uD800-\uDBFF]$/,eT=/^[\uDC00-\uDFFF]$/,tT=!r3||JI(function(){var r=QI("Symbol")("stringify detection");return Zo([r])!=="[null]"||Zo({a:r})!=="{}"||Zo(Object(r))!=="{}"}),rT=JI(function(){return Zo("\uDF06\uD834")!=='"\\udf06\\ud834"'||Zo("\uDEAD")!=='"\\udead"'}),l3=function(r,e){var t=eM(arguments),n=t3(e);if(!(!qC(n)&&(r===void 0||QC(r))))return t[1]=function(s,i){if(qC(n)&&(i=e3(n,this,n3(s),i)),!QC(i))return i},ZI(Zo,null,t)},u3=function(r,e,t){var n=ZC(t,e-1),s=ZC(t,e+1);return bd(JC,r)&&!bd(eT,s)||bd(eT,r)&&!bd(JC,n)?"\\u"+o3(s3(r,0),16):r};Zo&&Jj({target:"JSON",stat:!0,arity:3,forced:tT||rT},{stringify:function(e,t,n){var s=eM(arguments),i=ZI(tT?l3:Zo,null,s);return rT&&typeof i=="string"?i3(i,a3,u3):i}});function yh(r){let e;return Array.isArray(r)?e=r.length?new Array(r.length).fill(null):[]:(e={},Lt(r,(t,n)=>{n!=="__children"&&(t&&typeof t=="object"&&!Array.isArray(t)?e[n]=yh(t):Array.isArray(t)?t.length&&typeof t[0]=="object"&&!Array.isArray(t[0])?e[n]=[yh(t[0])]:e[n]=[]:e[n]=null)})),e}function c3(r,e){return e.prototype.constructor=e,r.prototype=new e,r.prototype.constructor=r,r}function Nu(r,e,t){const n=Array.isArray(t);return Lt(e,(s,i)=>{(n===!1||t.includes(i))&&(r[i]=s)}),r}function tM(r,e){Lt(e,(t,n)=>{e[n]&&typeof e[n]=="object"?(r[n]||(Array.isArray(e[n])?r[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?r[n]=e[n]:r[n]={}),tM(r[n],e[n])):r[n]=e[n]})}function oa(r){return typeof r=="object"?JSON.parse(JSON.stringify(r)):r}function ur(r){r.MIXINS||(r.MIXINS=[]);for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return Je(t,s=>{r.MIXINS.push(s.MIXIN_NAME),Lt(s,(i,o)=>{if(r.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof i=="function")r.prototype[o]=i;else{const a=function(c,h){const d=`_${c}`,m=E=>{let g=E;return(Array.isArray(g)||Fi(g))&&(g=oa(g)),g};return function(){return this[d]===void 0&&(this[d]=m(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(r.prototype,o,{get:a(o,i),set:l(o),configurable:!0})}})}),r}function rM(r,e){return JSON.stringify(r)===JSON.stringify(e)}function Fi(r){return Object.prototype.toString.call(r)==="[object Object]"}function ua(r,e,t,n){n.value=t,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(r,e,n)}function Lt(r,e){for(const t in r)if((!r.hasOwnProperty||r.hasOwnProperty&&Object.prototype.hasOwnProperty.call(r,t))&&e(r[t],t,r)===!1)break;return r}function h3(r,e){const t=e.split(".");let n=r;return Lt(t,s=>{if(n=n[s],n===void 0)return n=void 0,!1}),n}function Xg(r,e,t){const n=e.split(".");let s=r;n.forEach((i,o)=>{o!==n.length-1?(Au(s,i)||(s[i]={}),s=s[i]):s[i]=t})}function xw(r){if(!Fi(r))return 0;const e=function(t){let n=0;return Fi(t)?Lt(t,(s,i)=>{i!=="__children"&&(n+=e(s))}):n+=1,n};return e(r)}function qs(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const t=`_${e}`,n={_touched:!1,[t]:r,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[t]},set(s){this._touched=!0,this[t]=s},enumerable:!0,configurable:!0}),n}function Au(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function d3(r){return window.requestAnimationFrame(r)}function f3(){return"ontouchstart"in window}function m3(){return typeof window<"u"}const ps=r=>{const e={value:!1};return e.test=(t,n)=>{e.value=r(t,n)},e},El={chrome:ps((r,e)=>/Chrome/.test(r)&&/Google/.test(e)),chromeWebKit:ps(r=>/CriOS/.test(r)),edge:ps(r=>/Edge/.test(r)),edgeWebKit:ps(r=>/EdgiOS/.test(r)),firefox:ps(r=>/Firefox/.test(r)),firefoxWebKit:ps(r=>/FxiOS/.test(r)),mobile:ps(r=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(r)),safari:ps((r,e)=>/Safari/.test(r)&&/Apple Computer/.test(e))},Hp={mac:ps(r=>/^Mac/.test(r)),win:ps(r=>/^Win/.test(r)),linux:ps(r=>/^Linux/.test(r)),ios:ps(r=>/iPhone|iPad|iPod/i.test(r))};function p3(){let{userAgent:r=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Lt(El,t=>{let{test:n}=t;return void n(r,e)})}function g3(){let{platform:r=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Lt(Hp,e=>{let{test:t}=e;return void t(r)})}m3()&&(p3(),g3());function y3(){return El.chrome.value}function E3(){return El.chromeWebKit.value}function qg(){return El.firefox.value}function v3(){return El.firefoxWebKit.value}function w3(){return El.edge.value}function Jl(){return El.mobile.value}function nM(){return Hp.ios.value}function R3(){let{maxTouchPoints:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return r>2&&Hp.mac.value}function nT(){return Hp.mac.value}const Me={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:qg()?182:174,AUDIO_MUTE:qg()?181:173,AUDIO_UP:qg()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},S3=[Me.ALT,Me.ARROW_DOWN,Me.ARROW_LEFT,Me.ARROW_RIGHT,Me.ARROW_UP,Me.AUDIO_DOWN,Me.AUDIO_MUTE,Me.AUDIO_UP,Me.BACKSPACE,Me.CAPS_LOCK,Me.DELETE,Me.END,Me.ENTER,Me.ESCAPE,Me.F1,Me.F2,Me.F3,Me.F4,Me.F5,Me.F6,Me.F7,Me.F8,Me.F9,Me.F10,Me.F11,Me.F12,Me.F13,Me.F14,Me.F15,Me.F16,Me.F17,Me.F18,Me.F19,Me.HOME,Me.INSERT,Me.MEDIA_NEXT,Me.MEDIA_PLAY_PAUSE,Me.MEDIA_PREV,Me.MEDIA_STOP,Me.NULL,Me.NUM_LOCK,Me.PAGE_DOWN,Me.PAGE_UP,Me.PAUSE,Me.SCROLL_LOCK,Me.SHIFT,Me.TAB];function C3(r){return S3.includes(r)}function T3(r){return[Me.CONTROL,Me.COMMAND_LEFT,Me.COMMAND_RIGHT,Me.COMMAND_FIREFOX].includes(r)}function b3(r,e){const t=e.split("|");let n=!1;return Je(t,s=>{if(r===Me[s])return n=!0,!1}),n}function Vp(r){r.isImmediatePropagationEnabled=!1,r.cancelBubble=!0}function Ga(r){return r.isImmediatePropagationEnabled===!1}function AE(r){return r.button===2}function sM(r){return r.button===0}var iM={},N3=mO,A3=Qv,O3=Object.keys||function(e){return N3(e,A3)},I3=Vi,M3=aO,_3=cl,x3=hl,L3=gp,P3=O3;iM.f=I3&&!M3?Object.defineProperties:function(e,t){x3(e);for(var n=L3(t),s=P3(t),i=s.length,o=0,a;i>o;)_3.f(e,a=s[o++],n[a]);return e};var F3=hl,D3=iM,sT=Qv,H3=Kv,V3=DO,U3=jv,k3=cO,iT=">",oT="<",OE="prototype",IE="script",oM=k3("IE_PROTO"),Qg=function(){},aM=function(r){return oT+IE+iT+r+oT+"/"+IE+iT},aT=function(r){r.write(aM("")),r.close();var e=r.parentWindow.Object;return r=null,e},B3=function(){var r=U3("iframe"),e="java"+IE+":",t;return r.style.display="none",V3.appendChild(r),r.src=String(e),t=r.contentWindow.document,t.open(),t.write(aM("document.F=Object")),t.close(),t.F},Nd,Df=function(){try{Nd=new ActiveXObject("htmlfile")}catch{}Df=typeof document<"u"?document.domain&&Nd?aT(Nd):B3():aT(Nd);for(var r=sT.length;r--;)delete Df[OE][sT[r]];return Df()};H3[oM]=!0;var W3=Object.create||function(e,t){var n;return e!==null?(Qg[OE]=F3(e),n=new Qg,Qg[OE]=null,n[oM]=e):n=Df(),t===void 0?n:D3.f(n,t)},$3=Lu,G3=W3,z3=cl.f,ME=$3("unscopables"),_E=Array.prototype;_E[ME]===void 0&&z3(_E,ME,{configurable:!0,value:G3(null)});var Lw=function(r){_E[ME][r]=!0},Y3=Lw;Y3("flatMap");function el(){at(console)&&console.warn(...arguments)}function j3(){at(console)&&console.error(...arguments)}function K3(r,e,t){return(e=X3(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function X3(r){var e=q3(r,"string");return typeof e=="symbol"?e:e+""}function q3(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const Ol=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Q3=Qn`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Zg=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Jg=new Map([[]]),Ad=new WeakMap;class In{static getSingleton(){return J3()}constructor(){K3(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return Je(Ol,t=>{e[t]=[],this.initOrderMap(e,t)}),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3?arguments[3]:void 0;if(Array.isArray(t))Je(t,i=>this.add(e,i,n));else{Zg.has(e)&&el(Tj(Q3,{hookName:e,removedInVersion:Zg.get(e)})),Jg.has(e)&&el(Jg.get(e));const i=this.getBucket(n);if(typeof i[e]>"u"&&(this.register(e),i[e]=[],this.initOrderMap(i,e)),t.skip=!1,i[e].indexOf(t)===-1){let o=!1;t.initialHook&&Je(i[e],(a,l)=>{if(a.initialHook)return i[e][l]=t,o=!0,!1}),o||i[e].push(t)}this.setCallbackOrderIndex(i,e,t,s),this.orderBucketByOrderIndex(i,e)}return this}once(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3?arguments[3]:void 0;Array.isArray(t)?Je(t,i=>this.once(e,i,n)):(t.runOnce=!0,this.add(e,t,n,s))}remove(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const s=this.getBucket(n);return typeof s[e]<"u"&&s[e].indexOf(t)>=0?(t.skip=!0,!0):!1}has(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const n=this.getBucket(t);return!!(n[e]!==void 0&&n[e].length)}run(e,t,n,s,i,o,a,l){{const u=this.globalBucket[t],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=NE(u[h],e,n,s,i,o,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(t,u[h]),h+=1}}{const u=this.getBucket(e)[t],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=NE(u[h],e,n,s,i,o,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(t,u[h],e),h+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Lt(this.getBucket(e),(t,n,s)=>s[n].length=0)}register(e){this.isRegistered(e)||Ol.push(e)}deregister(e){this.isRegistered(e)&&Ol.splice(Ol.indexOf(e),1)}isDeprecated(e){return Jg.has(e)||Zg.has(e)}isRegistered(e){return Ol.indexOf(e)>=0}getRegistered(){return Ol}setCallbackOrderIndex(e,t,n,s){const i=Number.isInteger(s)?s:0,o=this.getCallbackOrderMap(e,t);o.set(i,[...o.get(i)||[],n])}orderBucketByOrderIndex(e,t){const n=this.getCallbackOrderMap(e,t);n===void 0||n.size===0||n.size===1&&n.has(0)||(e[t]=[...n].sort((s,i)=>s[0]-i[0]).flatMap(s=>{let[,i]=s;return i}))}initOrderMap(e,t){Ad.has(e)||Ad.set(e,[]),Ad.get(e)[t]=new Map}getCallbackOrderMap(e,t){return Ad.get(e)[t]}}const Z3=new In;function J3(){return Z3}const ey=new Map;function Hu(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";ey.has(r)||ey.set(r,new Map);const e=ey.get(r);function t(a,l){e.set(a,l)}function n(a){return e.get(a)}function s(a){return e.has(a)}function i(){return[...e.keys()]}function o(){return[...e.values()]}return{register:t,getItem:n,hasItem:s,getNames:i,getValues:o}}const xE=new WeakMap,{register:e4,getItem:lM,hasItem:t4}=Hu("editors");function r4(r){const e={},t=r;this.getConstructor=function(){return r},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new t(n)),e[n.guid]},In.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function n4(r,e){let t;if(typeof r=="function")xE.get(r)||uM(null,r),t=xE.get(r);else if(typeof r=="string")t=lM(r);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!t)throw Error(`No editor registered under name "${r}"`);return t.getInstance(e)}function lT(r){if(typeof r=="function")return r;if(!t4(r))throw Error(`No registered editor found under "${r}" name`);return lM(r).getConstructor()}function uM(r,e){r&&typeof r!="string"&&(e=r,r=e.EDITOR_TYPE);const t=new r4(e);typeof r=="string"&&e4(r,t),xE.set(e,t)}function s4(r,e,t){return(e=i4(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function i4(r){var e=o4(r,"string");return typeof e=="symbol"?e:e+""}function o4(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Ou{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;s4(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function i(o){n.call(this,a4(o))}return this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:i,options:s,eventManager:this}),e.addEventListener(t,i,s),()=>{this.removeEventListener(e,t,n)}}removeEventListener(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=this.context.eventListeners.length,o;for(;i;)if(i-=1,o=this.context.eventListeners[i],o.event===t&&o.element===e){if(n&&n!==o.callback||s&&o.eventManager!==this)continue;this.context.eventListeners.splice(i,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const n=this.context.eventListeners[t];e&&n.eventManager!==this||(this.context.eventListeners.splice(t,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let n=e.document,s=e;n||(n=e.ownerDocument?e.ownerDocument:e,s=n.defaultView);const i={bubbles:!0,cancelable:t!=="mousemove",view:s,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let o;n.createEvent?(o=n.createEvent("MouseEvents"),o.initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,n.body.parentNode)):o=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${t}`,o)}}function a4(r){const e=r.stopImmediatePropagation;return r.stopImmediatePropagation=function(){e.apply(this),Vp(this)},r}function l4(r,e){u4(r,e),e.add(r)}function u4(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Aa(r,e,t){return(e=c4(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function c4(r){var e=h4(r,"string");return typeof e=="symbol"?e:e+""}function h4(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function uT(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ty=new WeakSet;class LE{constructor(e,t,n){l4(this,ty),Aa(this,"hot",void 0),Aa(this,"tableMeta",void 0),Aa(this,"selection",void 0),Aa(this,"eventManager",void 0),Aa(this,"destroyed",!1),Aa(this,"activeEditor",void 0),Aa(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=n,this.eventManager=new Ou(e),this.hot.addHook("afterDocumentKeyDown",s=>uT(ty,this,d4).call(this,s)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",s=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",s)}),this.hot.view._wt.update("onCellDblClick",(s,i,o)=>uT(ty,this,f4).call(this,s,i,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||t.isHeader())return;const{row:n,col:s}=t,i=this.hot.runHooks("modifyGetCellCoords",n,s);let o=n,a=s;if(Array.isArray(i)&&([o,a]=i),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(n,s,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=n4(u,this.hot),this.activeEditor.prepare(n,s,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const s=this.hot.getSelectedRangeLast();let i=this.hot.runHooks("beforeBeginEditing",s.highlight.row,s.highlight.col,e,t,n);if(t instanceof MouseEvent&&typeof i!="boolean"&&(i=this.hot.selection.getLayerLevel()===0&&s.isSingle()),i===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:n,col:s}=e.highlight,{rowIndexMapper:i,columnIndexMapper:o}=this.hot,a=i.isHidden(this.hot.toPhysicalRow(n))||o.isHidden(this.hot.toPhysicalColumn(s));return!(this.cellProperties.readOnly||!t||a)}moveSelectionAfterEnter(e){const t={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function d4(r){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Ga(r))return;const{keyCode:t}=r,n=(r.ctrlKey||r.metaKey)&&!r.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!C3(t)&&!T3(t)&&!n&&!this.isEditorOpened()&&this.openEditor("",r)}function f4(r,e){e.isCell()&&this.openEditor(null,r,!0)}const cT=new WeakMap;LE.getInstance=function(r,e,t){let n=cT.get(r);return n||(n=new LE(r,e,t),cT.set(r,n)),n};function m4(r,e){cM(r,e),e.add(r)}function nc(r,e,t){cM(r,e),e.set(r,t)}function cM(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vt(r,e){return r.get(co(r,e))}function sc(r,e,t){return r.set(co(r,e),t),t}function co(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const pu=Object.freeze({CELL:"cell",MIXED:"mixed"});var xr=new WeakMap,Od=new WeakMap,Id=new WeakMap,Md=new WeakMap,_d=new WeakMap,ko=new WeakSet;class p4{constructor(e){var t=this;m4(this,ko),nc(this,xr,void 0),nc(this,Od,void 0),nc(this,Id,1),nc(this,Md,null),nc(this,_d,new Map);const n=e.getSettings();sc(xr,this,e),sc(Od,this,n.imeFastEdit?pu.MIXED:pu.CELL),Vt(xr,this).addHook("afterUpdateSettings",function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return co(ko,t,y4).call(t,...i)}),Vt(xr,this).addHook("afterSelection",function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return co(ko,t,hT).call(t,...i)}),Vt(xr,this).addHook("afterSelectionFocusSet",function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return co(ko,t,hT).call(t,...i)}),Vt(xr,this).addHook("afterSelectionEnd",function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return co(ko,t,g4).call(t,...i)})}getFocusMode(){return Vt(Od,this)}setFocusMode(e){Object.values(pu).includes(e)?sc(Od,this,e):el(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Vt(Id,this)}setRefocusDelay(e){sc(Id,this,e)}setRefocusElementGetter(e){sc(Md,this,e)}getRefocusElement(){if(typeof Vt(Md,this)=="function")return Vt(Md,this).call(this);var e;return(e=Vt(xr,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=n=>{var s,i;const o=(s=Vt(xr,this).getSelectedRangeLast())===null||s===void 0?void 0:s.highlight;if(!o)return;let a=Vt(xr,this).runHooks("modifyFocusedElement",o.row,o.col,n);a instanceof HTMLElement||(a=n),a&&!((i=Vt(xr,this).getActiveEditor())!==null&&i!==void 0&&i.isOpened())&&a.focus({preventScroll:!0})};e?t(e):co(ko,this,Pw).call(this,n=>t(n))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Vt(Id,this);const n=this.getRefocusElement();Vt(xr,this).getSettings().imeFastEdit&&!((e=Vt(xr,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&n&&(Vt(_d,this).has(t)||Vt(_d,this).set(t,jj(()=>{n.select()},t)),Vt(_d,this).get(t)())}}function Pw(r){var e;const t=(e=Vt(xr,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||!Vt(xr,this).selection.isCellVisible(t)){r(null);return}const n=Vt(xr,this).getCell(t.row,t.col,!0);n===null?Vt(xr,this).addHookOnce("afterScroll",()=>{r(Vt(xr,this).getCell(t.row,t.col,!0))}):r(n)}function hT(){co(ko,this,Pw).call(this,r=>{const{activeElement:e}=Vt(xr,this).rootDocument;e&&qI(e)&&e.blur(),this.focusOnHighlightedCell(r)})}function g4(){co(ko,this,Pw).call(this,r=>{this.getFocusMode()===pu.MIXED&&r.nodeName==="TD"&&this.refocusToEditorTextarea()})}function y4(r){typeof r.imeFastEdit=="boolean"&&this.setFocusMode(r.imeFastEdit?pu.MIXED:pu.CELL)}var E4=Ui,v4=ul,w4=Lu,R4=w4("match"),S4=function(r){var e;return E4(r)&&((e=r[R4])!==void 0?!!e:v4(r)==="RegExp")},C4=Vr,T4=un,dT=C4.RegExp,b4=!T4(function(){var r=!0;try{dT(".","d")}catch{r=!1}var e={},t="",n=r?"dgimsy":"gimsy",s=function(l,u){Object.defineProperty(e,l,{get:function(){return t+=u,!0}})},i={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};r&&(i.hasIndices="d");for(var o in i)s(o,i[o]);var a=Object.getOwnPropertyDescriptor(dT.prototype,"flags").get.call(e);return a!==n||t!==n}),N4={correct:b4},A4=hl,O4=function(){var r=A4(this),e="";return r.hasIndices&&(e+="d"),r.global&&(e+="g"),r.ignoreCase&&(e+="i"),r.multiline&&(e+="m"),r.dotAll&&(e+="s"),r.unicode&&(e+="u"),r.unicodeSets&&(e+="v"),r.sticky&&(e+="y"),e},I4=No,M4=ki,_4=Bv,fT=N4,x4=O4,L4=RegExp.prototype,P4=fT.correct?function(r){return r.flags}:function(r){return!fT.correct&&_4(L4,r)&&!M4(r,"flags")?I4(x4,r):r.flags},Fw=vr,F4=vp,D4=Math.floor,ry=Fw("".charAt),H4=Fw("".replace),ny=Fw("".slice),V4=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,U4=/\$([$&'`]|\d{1,2})/g,k4=function(r,e,t,n,s,i){var o=t+r.length,a=n.length,l=U4;return s!==void 0&&(s=F4(s),l=V4),H4(i,l,function(u,c){var h;switch(ry(c,0)){case"$":return"$";case"&":return r;case"`":return ny(e,0,t);case"'":return ny(e,o);case"<":h=s[ny(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>a){var m=D4(d/10);return m===0?u:m<=a?n[m-1]===void 0?ry(c,1):n[m-1]+ry(c,1):u}h=n[d-1]}return h===void 0?"":h})},B4=Rn,W4=No,Dw=vr,mT=xh,$4=jr,G4=Ui,z4=S4,ic=Rp,Y4=Gv,j4=P4,K4=k4,X4=Lu,q4=X4("replace"),Q4=TypeError,sy=Dw("".indexOf);Dw("".replace);var pT=Dw("".slice),Z4=Math.max;B4({target:"String",proto:!0},{replaceAll:function(e,t){var n=mT(this),s,i,o,a,l,u,c,h,d,m,E=0,g="";if(G4(e)){if(s=z4(e),s&&(i=ic(mT(j4(e))),!~sy(i,"g")))throw new Q4("`.replaceAll` does not allow non-global regexes");if(o=Y4(e,q4),o)return W4(o,e,n,t)}for(a=ic(n),l=ic(e),u=$4(t),u||(t=ic(t)),c=l.length,h=Z4(1,c),d=sy(a,l);d!==-1;)m=u?ic(t(l,d,a)):K4(l,a,d,[],void 0,t),g+=pT(a,E,d)+m,E=d+c,d=d+h>a.length?-1:sy(a,l,d+h);return E<a.length&&(g+=pT(a,E)),g}});const J4={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"};new RegExp(Object.keys(J4).map(r=>`(${r})`).join("|"),"gi");function gT(r){const e=r.hasColHeaders(),t=r.hasRowHeaders(),n=[e?-1:0,t?-1:0,r.countRows()-1,r.countCols()-1],s=r.getData(...n),i=s.length,o=i>0?s[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=t?1:0,h=e?1:0;for(let d=0;d<i;d+=1){const m=e&&d===0,E=[];for(let O=0;O<o;O+=1){const T=!m&&t&&O===0;let _="";if(m)_=`<th>${r.getColHeader(O-c)}</th>`;else if(T)_=`<th>${r.getRowHeader(d-h)}</th>`;else{const V=s[d][O],{hidden:H,rowspan:Q,colspan:oe}=r.getCellMeta(d-h,O-c);if(!H){const re=[];if(Q&&re.push(`rowspan="${Q}"`),oe&&re.push(`colspan="${oe}"`),Tu(V))_=`<td ${re.join(" ")}></td>`;else{const ie=V.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");_=`<td ${re.join(" ")}>${ie}</td>`}}}E.push(_)}const g=["<tr>",...E,"</tr>"].join("");m?l.splice(1,0,g):u.splice(-1,0,g)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function hM(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=typeof r;if(t==="number")return!isNaN(r)&&isFinite(r);if(t==="string"){if(r.length===0)return!1;if(r.length===1)return/\d/.test(r);const n=Array.from(new Set([".",...e])).map(s=>`\\${s}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(r.trim())}else if(t==="object")return!!r&&typeof r.valueOf()=="number"&&!(r instanceof Date);return!1}function e6(r){return hM(r,[","])}function vs(r,e,t){let n=-1;for(typeof e=="function"?(t=e,e=r):n=r-1;++n<=e&&t(n)!==!1;);}function yT(r,e,t){let n=r+1;for(typeof e=="function"&&(t=e,e=0);--n>=e&&t(n)!==!1;);}function qt(r,e,t){return Math.min(r,e)===r?e:Math.max(r,t)===r?t:r}const PE="asc",t6="desc",ET=new Map([[PE,[-1,1]],[t6,[1,-1]]]),r6=r=>`The priority '${r}' is already declared in a map.`,n6=r=>`The priority '${r}' is not a number.`;function s6(){let{errorPriorityExists:r,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=new Map;r=Bt(r)?r:r6,e=Bt(e)?e:n6;function n(i,o){if(!hM(i))throw new Error(e(i));if(t.has(i))throw new Error(r(i));t.set(i,o)}function s(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:PE;const[o,a]=ET.get(i)||ET.get(PE);return[...t].sort((l,u)=>l[0]<u[0]?o:a).map(l=>l[1])}return{addItem:n,getItems:s}}const i6=r=>`The id '${r}' is already declared in a map.`;function Up(){let{errorIdExists:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;r=Bt(r)?r:i6;function t(u,c){if(l(u))throw new Error(r(u));e.set(u,c)}function n(u){return e.delete(u)}function s(){e.clear()}function i(u){const[c]=a().find(h=>{let[d,m]=h;return u===m?d:!1})||[null];return c}function o(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:t,clear:s,getId:i,getItem:o,getItems:a,hasItem:l,removeItem:n}}const o6=r=>`'${r}' value is already declared in a unique set.`;function a6(){let{errorItemExists:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;r=Bt(r)?r:o6;function t(i){if(e.has(i))throw new Error(r(i));e.add(i)}function n(){return[...e]}function s(){e.clear()}return{addItem:t,clear:s,getItems:n}}const dM=r=>`There is already registered "${r}" plugin.`,l6=r=>`There is already registered plugin on priority "${r}".`,u6=r=>`The priority "${r}" is not a number.`,c6=s6({errorPriorityExists:l6,errorPriorityNaN:u6}),h6=a6({errorItemExists:dM}),d6=Up({errorIdExists:dM});function f6(){return[...c6.getItems(),...h6.getItems()]}function m6(r){const e=Aw(r);return d6.getItem(e)}const{register:p6,getItem:g6,hasItem:y6}=Hu("renderers");function vT(r){if(typeof r=="function")return r;if(!y6(r))throw Error(`No registered renderer found under "${r}" name`);return g6(r)}function E6(r,e){typeof r!="string"&&(e=r,r=e.RENDERER_TYPE),p6(r,e)}const{register:v6,getItem:w6,hasItem:R6}=Hu("validators");function S6(r){if(typeof r=="function")return r;if(!R6(r))throw Error(`No registered validator found under "${r}" name`);return w6(r)}function C6(r,e){typeof r!="string"&&(e=r,r=e.VALIDATOR_TYPE),v6(r,e)}var T6=Rn,b6=vp,N6=qv,A6=Ph,O6=Lw;T6({target:"Array",proto:!0},{at:function(e){var t=b6(this),n=N6(t),s=A6(e),i=s>=0?s:n+s;return i<0||i>=n?void 0:t[i]}});O6("at");var I6=Rn,M6=vr,_6=xh,x6=Ph,L6=Rp,P6=un,F6=M6("".charAt),D6=P6(function(){return"".at(-2)!=="\uD842"});I6({target:"String",proto:!0,forced:D6},{at:function(e){var t=L6(_6(this)),n=t.length,s=x6(e),i=s>=0?s:n+s;return i<0||i>=n?void 0:F6(t,i)}});function oc(r,e,t){return(e=H6(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function H6(r){var e=V6(r,"string");return typeof e=="symbol"?e:e+""}function V6(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class U6{constructor(){oc(this,"count",0),oc(this,"startColumn",null),oc(this,"endColumn",null),oc(this,"startPosition",null),oc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:n,zeroBasedScrollOffset:s,viewportWidth:i,columnWidth:o}=t,a=s>0?i+1:i;n>=s&&n+o<=s+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var t;const{scrollOffset:n,viewportWidth:s,inlineStartOffset:i,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const E=u[this.endColumn]+c-u[this.startColumn-1];if(E<=s&&(this.startColumn-=1),E>=s)break}this.startPosition=(t=u[this.startColumn])!==null&&t!==void 0?t:null;const h=o>0?s+1:s,d=n+s-h,m=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*i||n>u.at(-1)||-1*n-s>-1*m?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function ac(r,e,t){return(e=k6(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function k6(r){var e=B6(r,"string");return typeof e=="symbol"?e:e+""}function B6(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class W6{constructor(){ac(this,"count",0),ac(this,"startRow",null),ac(this,"endRow",null),ac(this,"startPosition",null),ac(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:n,zeroBasedScrollOffset:s,innerViewportHeight:i,rowHeight:o}=t;n>=s&&n+o<=i&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var t;const{scrollOffset:n,viewportHeight:s,horizontalScrollbarHeight:i,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=s-i&&(this.startRow-=1),d>=s-i)break}this.startPosition=(t=l[this.startRow])!==null&&t!==void 0?t:null;const c=n+s-i,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function lc(r,e,t){return(e=$6(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function $6(r){var e=G6(r,"string");return typeof e=="symbol"?e:e+""}function G6(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class fM{constructor(){lc(this,"count",0),lc(this,"startColumn",null),lc(this,"endColumn",null),lc(this,"startPosition",null),lc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:n,zeroBasedScrollOffset:s,viewportWidth:i}=t;n<=s&&(this.startColumn=e);const o=s>0?i+1:i;n>=s&&n<=s+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var t;const{scrollOffset:n,viewportWidth:s,inlineStartOffset:i,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,m>s)break}this.startPosition=(t=u[this.startColumn])!==null&&t!==void 0?t:null;const h=o>0?s+1:s;n+s-h<-1*i||n>u.at(-1)+c||-1*n-s>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function uc(r,e,t){return(e=z6(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function z6(r){var e=Y6(r,"string");return typeof e=="symbol"?e:e+""}function Y6(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class mM{constructor(){uc(this,"count",0),uc(this,"startRow",null),uc(this,"endRow",null),uc(this,"startPosition",null),uc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:n,zeroBasedScrollOffset:s,innerViewportHeight:i}=t;n<=s&&(this.startRow=e),n>=s&&n<=i&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var t;const{scrollOffset:n,viewportHeight:s,horizontalScrollbarHeight:i,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=s-i)break}this.startPosition=(t=l[this.startRow])!==null&&t!==void 0?t:null,n+s-i<0||n>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function cc(r,e,t){return(e=j6(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function j6(r){var e=K6(r,"string");return typeof e=="symbol"?e:e+""}function K6(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class X6{constructor(){cc(this,"count",0),cc(this,"startColumn",0),cc(this,"endColumn",0),cc(this,"startPosition",0),cc(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}}function hc(r,e,t){return(e=q6(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function q6(r){var e=Q6(r,"string");return typeof e=="symbol"?e:e+""}function Q6(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Z6{constructor(){hc(this,"count",0),hc(this,"startRow",0),hc(this,"endRow",0),hc(this,"startPosition",0),hc(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}}class J6 extends fM{finalize(e){var t;super.finalize(e);const{overrideFn:n,totalColumns:s,startPositions:i}=e;this.startColumn!==null&&typeof n=="function"&&n(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=(t=i[this.startColumn])!==null&&t!==void 0?t:null,s<this.endColumn&&(this.endColumn=s-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}class eK extends mM{finalize(e){var t;super.finalize(e);const{overrideFn:n,totalRows:s,startPositions:i}=e;this.startRow!==null&&typeof n=="function"&&n(this),this.startRow<0&&(this.startRow=0),this.startPosition=(t=i[this.startRow])!==null&&t!==void 0?t:null,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function wT(r,e,t){return(e=tK(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function tK(r){var e=rK(r,"string");return typeof e=="symbol"?e:e+""}function rK(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class pM{constructor(e){wT(this,"calculationTypes",[]),wT(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(t=>{let[n,s]=t;this.calculationResults.set(n,s),s.initialize(e)})}_process(e,t){this.calculationTypes.forEach(n=>{let[,s]=n;return s.process(e,t)})}_finalize(e){this.calculationTypes.forEach(t=>{let[,n]=t;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Fs(r,e,t){return(e=nK(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function nK(r){var e=sK(r,"string");return typeof e=="symbol"?e:e+""}function sK(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const Hw=50;class iK extends pM{constructor(e){let{calculationTypes:t,viewportWidth:n,scrollOffset:s,totalColumns:i,columnWidthFn:o,overrideFn:a,inlineStartOffset:l}=e;super(t),Fs(this,"viewportWidth",0),Fs(this,"scrollOffset",0),Fs(this,"zeroBasedScrollOffset",0),Fs(this,"totalColumns",0),Fs(this,"columnWidthFn",null),Fs(this,"columnWidth",0),Fs(this,"overrideFn",null),Fs(this,"inlineStartOffset",0),Fs(this,"totalCalculatedWidth",0),Fs(this,"startPositions",[]),Fs(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=s,this.zeroBasedScrollOffset=Math.max(s,0),this.totalColumns=i,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const t=this.columnWidthFn(e);return isNaN(t)?Hw:t}}function ls(r,e,t){return(e=oK(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function oK(r){var e=aK(r,"string");return typeof e=="symbol"?e:e+""}function aK(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const lK=23;class uK extends pM{constructor(e){let{calculationTypes:t,viewportHeight:n,scrollOffset:s,totalRows:i,rowHeightFn:o,overrideFn:a,horizontalScrollbarHeight:l}=e;super(t),ls(this,"viewportHeight",0),ls(this,"scrollOffset",0),ls(this,"zeroBasedScrollOffset",0),ls(this,"totalRows",0),ls(this,"rowHeightFn",null),ls(this,"rowHeight",0),ls(this,"overrideFn",null),ls(this,"horizontalScrollbarHeight",0),ls(this,"innerViewportHeight",0),ls(this,"totalCalculatedHeight",0),ls(this,"startPositions",[]),ls(this,"needReverse",!0),this.viewportHeight=n,this.scrollOffset=s,this.zeroBasedScrollOffset=Math.max(s,0),this.totalRows=i,this.rowHeightFn=o,this.overrideFn=a,this.horizontalScrollbarHeight=l??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const t=this.rowHeightFn(e);return isNaN(t)?lK:t}}function cK(r,e,t){hK(r,e),e.set(r,t)}function hK(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RT(r,e,t){return(e=dK(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function dK(r){var e=fK(r,"string");return typeof e=="symbol"?e:e+""}function fK(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Il(r,e){return r.get(gM(r,e))}function ST(r,e,t){return r.set(gM(r,e),t),t}function gM(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var qi=new WeakMap;class tl{constructor(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;RT(this,"row",null),RT(this,"col",null),cK(this,qi,!1),ST(qi,this,n),typeof e<"u"&&typeof t<"u"&&(this.row=e,this.col=t)}isValid(e){const{countRows:t,countCols:n,countRowHeaders:s,countColHeaders:i}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-i||this.col<-s||this.row>=t||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Il(qi,this)}isSouthEastOf(e){return this.row>=e.row&&(Il(qi,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Il(qi,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Il(qi,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Il(qi,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof tl&&ST(qi,this,e.isRtl()),this}clone(){return new tl(this.row,this.col,Il(qi,this))}toObject(){return{row:this.row,col:this.col}}}function mK(r,e,t){pK(r,e),e.set(r,t)}function pK(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iy(r,e,t){return(e=gK(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function gK(r){var e=yK(r,"string");return typeof e=="symbol"?e:e+""}function yK(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function us(r,e){return r.get(yM(r,e))}function EK(r,e,t){return r.set(yM(r,e),t),t}function yM(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Tn=new WeakMap;class zh{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;iy(this,"highlight",null),iy(this,"from",null),iy(this,"to",null),mK(this,Tn,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=n.clone(),EK(Tn,this,s)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:n}=e,s=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return s.row<=t&&i.row>=t&&s.col<=n&&i.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(n.row,o.row),u=Math.min(n.col,o.col),c=Math.max(s.row,a.row),h=Math.max(s.col,a.col),d=this._createCellCoords(l,u),m=this._createCellCoords(c,h);return this.from=d,this.to=m,this.setDirection(i),t&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return us(Tn,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return us(Tn,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return us(Tn,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return us(Tn,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return us(Tn,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return us(Tn,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return us(Tn,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return us(Tn,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof tl))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},s=[];return t.top===n.top&&s.push("top"),t.right===n.right&&s.push(us(Tn,this)?"left":"right"),t.bottom===n.bottom&&s.push("bottom"),t.left===n.left&&s.push(us(Tn,this)?"right":"left"),s}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[];for(let s=e.row;s<=t.row;s++)for(let i=e.col;i<=t.col;i++)!(this.from.row===s&&this.from.col===i)&&!(this.to.row===s&&this.to.col===i)&&n.push(this._createCellCoords(s,i));return n}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[];for(let s=e.row;s<=t.row;s++)for(let i=e.col;i<=t.col;i++)e.row===s&&e.col===i?n.push(e):t.row===s&&t.col===i?n.push(t):n.push(this._createCellCoords(s,i));return n}forAll(e){const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let s=t.row;s<=n.row;s++)for(let i=t.col;i<=n.col;i++)if(e(s,i)===!1)return}clone(){return new zh(this.highlight,this.from,this.to,us(Tn,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new tl(e,t,us(Tn,this))}}function mi(r,e,t){vK(r,e),e.set(r,t)}function vK(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Re(r,e){return r.get(EM(r,e))}function Do(r,e,t){return r.set(EM(r,e),t),t}function EM(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var cs=new WeakMap,oy=new WeakMap,Ir=new WeakMap,Ml=new WeakMap,xd=new WeakMap,Ds=new WeakMap,ay=new WeakMap,dc=new WeakMap,Oa=new WeakMap,pi=new WeakMap;let vM=class{constructor(e,t,n,s,i,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;mi(this,cs,void 0),mi(this,oy,void 0),mi(this,Ir,void 0),mi(this,Ml,void 0),mi(this,xd,void 0),mi(this,Ds,void 0),mi(this,ay,void 0),mi(this,dc,void 0),mi(this,Oa,[null,null]),mi(this,pi,[null,null]),Do(cs,this,n),Do(oy,this,t),Do(Ir,this,i),Do(Ml,this,o),Do(xd,this,a),Do(Ds,this,s),Do(ay,this,e),this.registerEvents()}registerEvents(){Re(Ds,this).addEventListener(Re(Ir,this).holder,"contextmenu",n=>this.onContextMenu(n)),Re(Ds,this).addEventListener(Re(Ir,this).TABLE,"mouseover",n=>this.onMouseOver(n)),Re(Ds,this).addEventListener(Re(Ir,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{Re(Ds,this).addEventListener(Re(Ir,this).holder,"touchstart",n=>this.onTouchStart(n)),Re(Ds,this).addEventListener(Re(Ir,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),Re(Ds,this).addEventListener(Re(Ir,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Re(cs,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Re(cs,this).getSetting("onAfterMomentumScroll"))},200)})},t=()=>{Re(Ds,this).addEventListener(Re(Ir,this).holder,"mouseup",n=>this.onMouseUp(n)),Re(Ds,this).addEventListener(Re(Ir,this).holder,"mousedown",n=>this.onMouseDown(n))};Jl()?e():(f3()&&e(),t())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(Re(dc,this)&&n){const[s,i]=[n.row,Re(dc,this).from.row],[o,a]=[n.col,Re(dc,this).from.col];return s===i&&o===a}return!1}parentCell(e){const t={},n=Re(Ir,this).TABLE,s=Td(e,["TD","TH"],n);return s?(t.coords=Re(Ir,this).getCoords(s),t.TD=s):zt(e,"wtBorder")&&zt(e,"current")?(t.coords=Re(Ml,this).getFocusSelection().cellRange.highlight,t.TD=Re(Ir,this).getCell(t.coords)):zt(e,"wtBorder")&&zt(e,"area")&&Re(Ml,this).getAreaSelection().cellRange&&(t.coords=Re(Ml,this).getAreaSelection().cellRange.to,t.TD=Re(Ir,this).getCell(t.coords)),t}onMouseDown(e){const t=Re(oy,this).rootDocument.activeElement,n=Kj(Pj,e.target),s=e.target;if(!["TD","TH"].includes(t.nodeName)&&(s===t||n(0)===t||n(1)===t))return;const i=this.parentCell(s);zt(s,"corner")?Re(cs,this).getSetting("onCellCornerMouseDown",e,s):i.TD&&Re(cs,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,i.coords,i.TD),(e.button===0||this.touchApplied)&&i.TD&&(Re(pi,this)[0]=i.TD,clearTimeout(Re(Oa,this)[0]),Re(Oa,this)[0]=setTimeout(()=>{Re(pi,this)[0]=null},1e3))}onContextMenu(e){if(Re(cs,this).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!Re(cs,this).has("onCellMouseOver"))return;const t=Re(Ir,this).TABLE,n=Td(e.target,["TD","TH"],t),s=Re(xd,this)||this;n&&n!==s.lastMouseOver&&TE(n,t)&&(s.lastMouseOver=n,this.callListener("onCellMouseOver",e,Re(Ir,this).getCoords(n),n))}onMouseOut(e){if(!Re(cs,this).has("onCellMouseOut"))return;const t=Re(Ir,this).TABLE,n=Td(e.target,["TD","TH"],t),s=Td(e.relatedTarget,["TD","TH"],t),i=Re(xd,this)||this;n&&n!==s&&TE(n,t)&&(this.callListener("onCellMouseOut",e,Re(Ir,this).getCoords(n),n),s===null&&(i.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&Re(cs,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),!(e.button!==0&&!this.touchApplied)&&(t.TD===Re(pi,this)[0]&&t.TD===Re(pi,this)[1]?(zt(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),Re(pi,this)[0]=null,Re(pi,this)[1]=null):t.TD===Re(pi,this)[0]&&(Re(pi,this)[1]=t.TD,clearTimeout(Re(Oa,this)[1]),Re(Oa,this)[1]=setTimeout(()=>{Re(pi,this)[1]=null},500)))}onTouchStart(e){Do(dc,this,Re(Ml,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const n=e.target,s=(t=this.parentCell(n))===null||t===void 0?void 0:t.coords,i=at(s)&&s.row>=0&&s.col>=0;if(e.cancelable&&i&&Re(cs,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];nM()&&(E3()||v3())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,n,s){const i=Re(cs,this).getSettingPure(e);i&&i(t,n,s,Re(ay,this).call(this))}destroy(){clearTimeout(Re(Oa,this)[0]),clearTimeout(Re(Oa,this)[1]),Re(Ds,this).destroy()}};function ly(r,e,t){return(e=wK(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function wK(r){var e=RK(r,"string");return typeof e=="symbol"?e:e+""}function RK(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class SK{constructor(e,t,n){ly(this,"offset",void 0),ly(this,"total",void 0),ly(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function uy(r,e,t){return(e=CK(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function CK(r){var e=TK(r,"string");return typeof e=="symbol"?e:e+""}function TK(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class bK{constructor(e,t,n){uy(this,"offset",void 0),uy(this,"total",void 0),uy(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const NK=0,Am=1,Om=2;function Ld(r,e,t){return(e=AK(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function AK(r){var e=OK(r,"string");return typeof e=="symbol"?e:e+""}function OK(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class CT{constructor(){Ld(this,"currentSize",0),Ld(this,"nextSize",0),Ld(this,"currentOffset",0),Ld(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function cy(r,e,t){return(e=IK(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function IK(r){var e=MK(r,"string");return typeof e=="symbol"?e:e+""}function MK(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class _K{constructor(){cy(this,"size",new CT),cy(this,"workingSpace",NK),cy(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof CT}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=Am,e.workingSpace=Om,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Om,e.workingSpace=Am,this.sharedSize=e.getViewSize()}}function _l(r,e,t){return(e=xK(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function xK(r){var e=LK(r,"string");return typeof e=="symbol"?e:e+""}function LK(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class wM{constructor(e,t,n){_l(this,"rootNode",void 0),_l(this,"nodesPool",void 0),_l(this,"sizeSet",new _K),_l(this,"childNodeType",void 0),_l(this,"visualIndex",0),_l(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=t,this.childNodeType=n.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let n=0;if(this.isSharedViewSet()){let s=e.firstElementChild;for(;s;){if(s.tagName===this.childNodeType)n+=1;else if(t.isPlaceOn(Am))break;s=s.nextElementSibling}}else n=e.childElementCount;return n}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,n=this.isSharedViewSet(),{nextSize:s}=t.getViewSize();let i=this.getRenderedChildCount();for(;i<s;){const a=this.nodesPool();!n||n&&t.isPlaceOn(Om)?e.appendChild(a):e.insertBefore(a,e.firstChild),i+=1}const o=n&&t.isPlaceOn(Am);for(;i>s;)e.removeChild(o?e.firstChild:e.lastChild),i-=1}render(){const{rootNode:e,sizeSet:t}=this;let n=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(Om)&&(n+=t.sharedSize.nextSize);let s=e.childNodes[n];if(s.tagName!==this.childNodeType){const i=this.nodesPool();e.replaceChild(i,s),s=i}this.collectedNodes.push(s),this.visualIndex+=1}end(){}}class RM extends wM{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function PK(r,e,t){return(e=FK(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function FK(r){var e=DK(r,"string");return typeof e=="symbol"?e:e+""}function DK(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class HK{constructor(e){PK(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function fc(r,e,t){return(e=VK(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function VK(r){var e=UK(r,"string");return typeof e=="symbol"?e:e+""}function UK(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Yh{constructor(e,t){fc(this,"nodesPool",null),fc(this,"nodeType",void 0),fc(this,"rootNode",void 0),fc(this,"table",null),fc(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new HK(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function TT(r,e,t){return(e=kK(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function kK(r){var e=BK(r,"string");return typeof e=="symbol"?e:e+""}function BK(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class WK extends Yh{constructor(){super("TH"),TT(this,"orderViews",new WeakMap),TT(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new RM(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:n,rows:s,cells:i}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),l=s.getRenderedNode(o);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=i.obtainOrderView(l);u.appendView(c).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<n;h++){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Wh(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Yt(d,[Oj(),_j(),Ow(h+1),Pp(-1)]),t[h](a,d,h)}u.end()}}}class $K extends Yh{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:s}=this.table,i=s+t;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<i;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)n.removeChild(n.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&bu(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Yt(this.rootNode,[VI()]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:n,columnsToRender:s,rowHeadersCount:i}=this.table,o=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&Yt(o,[CE(),kI(t+1)]);for(let a=-1*i;a<s;a+=1){const l=this.table.renderedColumnToSource(a),u=o.childNodes[a+i];u.className="",u.removeAttribute("style"),Wh(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Yt(u,[Ow(a+1+this.table.rowHeadersCount),Pp(-1),Ij(),...a>=0?[Mj()]:[CE()]]),n[t](l,u,t)}}}}let bT=!1;class GK extends Yh{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,n=e+t;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!bT&&e>1e3&&(bT=!0,el(Qn`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let s=0;s<t;s++){const i=this.table.renderedColumnToSource(s),o=this.table.columnUtils.getHeaderWidth(i);this.rootNode.childNodes[s].style.width=`${o}px`}for(let s=0;s<e;s++){const i=this.table.renderedColumnToSource(s),o=this.table.columnUtils.getStretchedColumnWidth(i);this.rootNode.childNodes[s+t].style.width=`${o}px`}const n=this.rootNode.firstChild;n&&dt(n,"rowHeader")}}function zK(r,e,t){return(e=YK(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function YK(r){var e=jK(r,"string");return typeof e=="symbol"?e:e+""}function jK(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const Pd={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let NT=!1;class KK extends Yh{constructor(e){super("TR",e),zK(this,"orderView",void 0),this.orderView=new wM(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!NT&&e>1e3&&(NT=!0,el(Qn`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Yt(this.rootNode,[VI()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let s=0;s<e;s++){this.orderView.render();const i=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(s);if(this.table.isAriaEnabled()){var t,n;Yt(i,[CE(),kI(o+((t=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&t!==void 0?t:0)+1)])}Nr(i,[Pd.rowEven,Pd.rowOdd]),(o+1)%2===0?dt(i,Pd.rowEven):dt(i,Pd.rowOdd)}this.orderView.end()}}function AT(r,e,t){return(e=XK(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function XK(r){var e=qK(r,"string");return typeof e=="symbol"?e:e+""}function qK(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class QK extends Yh{constructor(){super("TD"),AT(this,"orderViews",new WeakMap),AT(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new RM(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:n,rowHeaders:s}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=s.obtainOrderView(u);c.prependView(h).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<t;d++){c.render();const m=c.getCurrentNode(),E=this.table.renderedColumnToSource(d);if(zt(m,"hide")||(m.className=""),m.removeAttribute("style"),m.removeAttribute("dir"),Wh(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,E,m),this.table.isAriaEnabled()){var i,o;Yt(m,[...m.hasAttribute("role")?[]:[Aj()],Pp(-1),Ow(E+((i=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&i!==void 0?i:0)+1)])}}c.end()}}}function Cr(r,e,t){return(e=ZK(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function ZK(r){var e=JK(r,"string");return typeof e=="symbol"?e:e+""}function JK(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class e5{constructor(e){let{cellRenderer:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Cr(this,"rootNode",void 0),Cr(this,"rootDocument",void 0),Cr(this,"rowHeaders",null),Cr(this,"columnHeaders",null),Cr(this,"colGroup",null),Cr(this,"rows",null),Cr(this,"cells",null),Cr(this,"rowFilter",null),Cr(this,"columnFilter",null),Cr(this,"rowUtils",null),Cr(this,"columnUtils",null),Cr(this,"rowsToRender",0),Cr(this,"columnsToRender",0),Cr(this,"rowHeaderFunctions",[]),Cr(this,"rowHeadersCount",0),Cr(this,"columnHeaderFunctions",[]),Cr(this,"columnHeadersCount",0),Cr(this,"cellRenderer",void 0),Cr(this,"activeOverlayName",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:n,rows:s,cells:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),n.setTable(this),s.setTable(this),i.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=n,this.rows=s,this.cells=i}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let n=0;n<e;n++){const s=t.getRenderedNode(n);if(s.firstChild){const i=this.renderedRowToSource(n),o=this.rowUtils.getHeightByOverlayName(i,this.activeOverlayName);o?s.firstChild.style.height=`${o-1}px`:s.firstChild.style.height=""}}}}class t5{constructor(){let{TABLE:e,THEAD:t,COLGROUP:n,TBODY:s,rowUtils:i,columnUtils:o,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new e5(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new WK,columnHeaders:new $K(t),colGroup:new GK(n),rows:new KK(s),cells:new QK}),this.renderer.setAxisUtils(i,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function mc(r,e,t){r5(r,e),e.set(r,t)}function r5(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fd(r,e,t){return(e=n5(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function n5(r){var e=s5(r,"string");return typeof e=="symbol"?e:e+""}function s5(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function qr(r,e){return r.get(SM(r,e))}function pc(r,e,t){return r.set(SM(r,e),t),t}function SM(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Dd=new WeakMap,xl=new WeakMap,gc=new WeakMap,Hd=new WeakMap,Ia=new WeakMap;class i5{constructor(e){let{totalColumns:t,stretchMode:n,stretchingColumnWidthFn:s,columnWidthFn:i}=e;Fd(this,"stretchAllRatio",0),Fd(this,"stretchLastWidth",0),Fd(this,"stretchAllColumnsWidth",[]),mc(this,Dd,0),Fd(this,"needVerifyLastColumnWidth",!0),mc(this,xl,()=>0),mc(this,gc,o=>o),mc(this,Hd,o=>o),mc(this,Ia,()=>"none"),pc(xl,this,t),pc(Ia,this,n),pc(gc,this,s??qr(gc,this)),pc(Hd,this,i??qr(Hd,this))}refreshStretching(e){if(qr(Ia,this).call(this)==="none")return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,pc(Dd,this,e);let t=0;for(let s=0;s<qr(xl,this).call(this);s++){const i=this._getColumnWidth(s),o=qr(gc,this).call(this,void 0,s);typeof o=="number"?e-=o:t+=i}const n=e-t;if(qr(Ia,this).call(this)==="all"&&n>0)this.stretchAllRatio=e/t,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(qr(Ia,this).call(this)==="last"&&e!==1/0){const s=this._getColumnWidth(qr(xl,this).call(this)-1),i=n+s;this.stretchLastWidth=i>=0?i:s}}getStretchedColumnWidth(e,t){let n=null;return qr(Ia,this).call(this)==="all"&&this.stretchAllRatio!==0?n=this._getStretchedAllColumnWidth(e,t):qr(Ia,this).call(this)==="last"&&this.stretchLastWidth!==0&&(n=this._getStretchedLastColumnWidth(e)),n}_getStretchedAllColumnWidth(e,t){let n=0;if(!this.stretchAllColumnsWidth[e]){const s=Math.round(t*this.stretchAllRatio),i=qr(gc,this).call(this,s,e);i===void 0?this.stretchAllColumnsWidth[e]=s:this.stretchAllColumnsWidth[e]=isNaN(i)?this._getColumnWidth(e):i}if(this.stretchAllColumnsWidth.length===qr(xl,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let s=0;s<this.stretchAllColumnsWidth.length;s++)n+=this.stretchAllColumnsWidth[s];n!==qr(Dd,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=qr(Dd,this)-n)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===qr(xl,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=qr(Hd,this).call(this,e);return isNaN(t)&&(t=Hw),t}}function Vd(r,e,t){return(e=o5(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function o5(r){var e=a5(r,"string");return typeof e=="symbol"?e:e+""}function a5(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class l5{constructor(e,t){Vd(this,"dataAccessObject",void 0),Vd(this,"wtSettings",void 0),Vd(this,"headerWidths",new Map),Vd(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=t,this.stretching=new i5({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(n,s)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",n,s),columnWidthFn:n=>this.dataAccessObject.wtTable.getColumnWidth(n)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let t=this.getWidth(e);const n=this.stretching.getStretchedColumnWidth(e,t);return n&&(t=n),t}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(t=t?Math.max(t,n):n),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:t,cloneSource:n}=this.dataAccessObject,s=n?n.wtTable.holder:e.holder,i=s.offsetHeight<s.scrollHeight?vn():0;this.stretching.refreshStretching(t.getViewportWidth()-i)}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),t=e.getSetting("onModifyRowHeaderWidth",t),t!=null){const n=e.getSetting("rowHeaders").length,s=e.getSetting("defaultColumnWidth");for(let i=0;i<n;i++){let o=Array.isArray(t)?t[i]:t;o=o??s,this.headerWidths.set(i,o)}}}}function OT(r,e,t){return(e=u5(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function u5(r){var e=c5(r,"string");return typeof e=="symbol"?e:e+""}function c5(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class h5{constructor(e,t){OT(this,"dataAccessObject",void 0),OT(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(t=t===void 0?n:Math.max(t,n)),t}getHeightByOverlayName(e,t){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);const s=this.dataAccessObject.wtViewport.oversizedRows[e];return s!==void 0&&(n=n===void 0?s:Math.max(n,s)),n}}function gi(r,e,t){return(e=d5(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function d5(r){var e=f5(r,"string");return typeof e=="symbol"?e:e+""}function f5(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Vu{constructor(e,t,n,s,i){gi(this,"wtSettings",null),gi(this,"domBindings",void 0),gi(this,"TBODY",null),gi(this,"THEAD",null),gi(this,"COLGROUP",null),gi(this,"hasTableHeight",!0),gi(this,"hasTableWidth",!0),gi(this,"isTableVisible",!1),gi(this,"tableOffset",0),gi(this,"holderOffset",0),this.domBindings=n,this.isMaster=i==="master",this.name=i,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=s,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,zI(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new h5(this.dataAccessObject,this.wtSettings),this.columnUtils=new l5(this.dataAccessObject,this.wtSettings),this.tableRenderer=new t5({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let n;return(!t||t.nodeType!==Node.ELEMENT_NODE||!zt(t,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",t&&t.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Yt(n,[mo()]),n}createHider(e){const t=e.parentNode;let n;return(!t||t.nodeType!==Node.ELEMENT_NODE||!zt(t,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",t&&t.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Yt(n,[mo()]),n}createHolder(e){const t=e.parentNode;let n;return(!t||t.nodeType!==Node.ELEMENT_NODE||!zt(t,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",t&&t.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Yt(n.parentNode,[mo()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Yt(n,[mo()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,{wtOverlays:n,wtViewport:s}=this.dataAccessObject,i=t.getSetting("totalRows"),o=t.getSetting("totalColumns"),a=t.getSetting("rowHeaders"),l=a.length,u=t.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=Es(this.holder),h=s.createCalculators(h),l&&!t.getSetting("fixedColumnsStart"))){const m=n.inlineStartOverlay.getScrollPosition(),E=this.correctHeaderWidth;this.correctHeaderWidth=m!==0,E!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=Es(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const m=i>0?this.getFirstRenderedRow():0,E=o>0?this.getFirstRenderedColumn():0;this.rowFilter=new bK(m,i,c),this.columnFilter=new SK(E,o,l);let g=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const O={};this.wtSettings.getSetting("beforeDraw",!0,O),g=O.skipRender!==!0}if(g){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Oi)||this.is(Jo))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let O;if(this.isMaster&&(O=this.dataAccessObject.workspaceWidth,s.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Oi))&&this.markOversizedRows(),this.isMaster){this.wtSettings.getSetting("externalRowCalculator")||s.createVisibleCalculators(),n.refresh(!1),n.applyToDOM();const T=Fr(this.hider),_=Fr(this.TABLE);T!==0&&_!==T&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),O!==s.getWorkspaceWidth()&&(s.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Oi)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let d=!1;return this.isMaster&&(d=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(d=n.bottomOverlay.resetFixedPosition()||d),d=n.inlineStartOverlay.resetFixedPosition()||d,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const s=this.wtSettings.getSetting("defaultRowHeight");let i,o,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,i=this.getColumnHeaderHeight(n),o=this.getColumnHeader(t,n),o&&(a=Zl(o),(!i&&s<a||i<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,s=e.getSetting("columnHeaders");for(let i=0,o=s.length;i<o;i++)if(n[i]){if(!t[i]||t[i].childNodes.length===0)return;t[i].childNodes[0].style.height=`${n[i]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Oi))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let s=0;s<n;s++){const i=this.rowFilter.renderedToSource(s);t.oversizedRows&&t.oversizedRows[i]&&(t.oversizedRows[i]=void 0)}}}getCell(e){let t=e.row,n=e.col;const s=this.wtSettings.getSetting("onModifyGetCellCoords",t,n);if(s&&Array.isArray(s)&&([t,n]=s),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const i=this.getRow(t);if(!i&&t>=0)throw new Error("TR was expected to be rendered but is not");const o=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!o&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let t=null,n=null;if(e<0){var s;t=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var i;t=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceToRendered(e),n=this.TBODY}return t!==void 0&&n!==void 0?n.childNodes.length<t+1?!1:n.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[t];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(s=>{const i=s.childNodes[n];i&&t.push(i)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(t>=n)return;const s=this.rowFilter.sourceToRendered(e),i=s<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):s,a=(s<0?this.THEAD:this.TBODY).childNodes[i];return a==null?void 0:a.childNodes[t]}getRowHeaders(e){const t=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let s=0;s<n;s++){const i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=i==null?void 0:i.childNodes[s];o&&t.push(o)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=WI(t,["TD","TH"])),t===null)return null;const n=t.parentNode,s=n.parentNode;let i=Hj(n),o=t.cellIndex;return Na(sl,t,this.wtRootElement)||Na(rl,t,this.wtRootElement)?s.nodeName==="THEAD"&&(i-=s.childNodes.length):Na(Jo,t,this.wtRootElement)||Na(Oi,t,this.wtRootElement)?i=this.wtSettings.getSetting("totalRows")-s.childNodes.length+i:s===this.THEAD?i=this.rowFilter.visibleColHeadedRowToSourceRow(i):i=this.rowFilter.renderedToSource(i),Na(sl,t,this.wtRootElement)||Na(nl,t,this.wtRootElement)||Na(Jo,t,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o),this.wot.createCellCoords(i,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.wtSettings.getSetting("defaultRowHeight"),n=Zl(this.TBODY)-1;let s,i,o,a,l;if(!(t===n&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,o=this.rowFilter.renderedToSource(e),s=this.getRowHeight(o),a=this.getTrForRow(o),l=a.querySelector("th"),l?i=Zl(l):i=Zl(a)-1,(!s&&this.wtSettings.getSetting("defaultRowHeight")<i||s<i)&&(i+=1,this.dataAccessObject.wtViewport.oversizedRows[o]=i)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Fr(this.TABLE)}getHeight(){return Ss(this.TABLE)}getTotalWidth(){const e=Fr(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Ss(this.hider);return e!==0?e:this.getHeight()}isVisible(){return gh(this.TABLE)}_modifyRowHeaderWidth(e){let t=Bt(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}const m5="stickyRowsBottom",Vw={getFirstRenderedRow(){const r=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),t=r-e;return r===0||e===0?-1:t<0?0:t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const r=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),r)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ua(Vw,"MIXIN_NAME",m5,{writable:!1,enumerable:!1});const p5="stickyColumnsStart",kp={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const r=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),r)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ua(kp,"MIXIN_NAME",p5,{writable:!1,enumerable:!1});class Uw extends Vu{constructor(e,t,n,s){super(e,t,n,s,Jo)}}ur(Uw,Vw);ur(Uw,kp);const rl="top",Oi="bottom",nl="inline_start",sl="top_inline_start_corner",Jo="bottom_inline_start_corner",CM=[rl,Oi,nl,sl,Jo],g5=new Map([[rl,`ht_clone_${rl}`],[Oi,`ht_clone_${Oi}`],[nl,`ht_clone_${nl} ht_clone_left`],[sl,`ht_clone_${sl} ht_clone_top_left_corner`],[Jo,`ht_clone_${Jo} ht_clone_bottom_left_corner`]]);function y5(r,e){E5(r,e),e.add(r)}function E5(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function v5(r,e,t){return(e=w5(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function w5(r){var e=R5(r,"string");return typeof e=="symbol"?e:e+""}function R5(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Ud(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var yc=new WeakSet;class S5{constructor(e){y5(this,yc),v5(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,n,s,i){const o=this.scrollViewportHorizontally(e.col,n,i),a=this.scrollViewportVertically(e.row,t,s);return o||a}scrollViewportHorizontally(e,t,n){const{drawn:s,totalColumns:i}=this.dataAccessObject;if(!s||!Number.isInteger(e)||e<0||e>i)return!1;const o=t===void 0&&n===void 0,{fixedColumnsStart:a,inlineStartOverlay:l}=this.dataAccessObject;if(o&&e<a||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),!Number.isInteger(e)||e<0||e>i))return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(o&&(e<u||e>c)||!o)&&(h=l.scrollTo(e,o?e>=this.getLastPartiallyVisibleColumn():t)),h}scrollViewportVertically(e,t,n){const{drawn:s,totalRows:i}=this.dataAccessObject;if(!s||!Number.isInteger(e)||e<0||e>i)return!1;const o=t===void 0&&n===void 0,{fixedRowsBottom:a,fixedRowsTop:l,topOverlay:u}=this.dataAccessObject;if(o&&(e<l||e>i-a-1)||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),!Number.isInteger(e)||e<0||e>i))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(o&&(e<c||e>h)||!o)&&(d=u.scrollTo(e,o?e>=this.getLastPartiallyVisibleRow():n)),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Ud(yc,this,MT).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Ud(yc,this,MT).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Ud(yc,this,IT).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Ud(yc,this,IT).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function IT(r){const{wtSettings:e,inlineStartOverlay:t,wtTable:n,wtViewport:s,totalColumns:i,rootWindow:o}=this.dataAccessObject;if(t.mainTableScrollableElement===o){const a=e.getSetting("rtlMode");let l=null;if(a){const c=n.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Es(n.wtRootElement).left;const u=Math.abs(jI(o,o));if(l>u){const c=KI(o);let h=s.getRowHeaderWidth();for(let d=1;d<=i;d++)if(h+=t.sumCellSizes(d-1,d),l+h-u>=c){r=d-2;break}}}return r}function MT(r){const{topOverlay:e,wtTable:t,wtViewport:n,totalRows:s,rootWindow:i}=this.dataAccessObject;if(e.mainTableScrollableElement===i){const o=Es(t.wtRootElement),a=Mw(i,i);if(o.top>a){const l=Zl(i);let u=n.getColumnHeaderHeight();for(let c=1;c<=s;c++)if(u+=e.sumCellSizes(c-1,c),o.top+u-a>=l){r=c-2;break}}}return r}function Hs(r,e,t){return(e=C5(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function C5(r){var e=T5(r,"string");return typeof e=="symbol"?e:e+""}function T5(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class kw{get eventManager(){return new Ou(this)}constructor(e,t){Hs(this,"wtTable",void 0),Hs(this,"wtScroll",void 0),Hs(this,"wtViewport",void 0),Hs(this,"wtOverlays",void 0),Hs(this,"selectionManager",void 0),Hs(this,"wtEvent",void 0),Hs(this,"guid",`wt_${HI()}`),Hs(this,"drawInterrupted",!1),Hs(this,"drawn",!1),Hs(this,"domBindings",void 0),Hs(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new S5(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;t<n;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,n){$h(n,e[t])}])}}createCellCoords(e,t){return new tl(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,n){return new zh(e,t,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),s=this.wtSettings.getSetting("fixedRowsTop"),i=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<s&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<s)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=n-i){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-i&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,n,s,i){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,t,n,s,i)}scrollViewportHorizontally(e,t,n){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,t,n)}scrollViewportVertically(e,t,n){return e<0?!1:this.wtScroll.scrollViewportVertically(e,t,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function _T(r,e,t){return(e=b5(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function b5(r){var e=N5(r,"string");return typeof e=="symbol"?e:e+""}function N5(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class A5 extends kw{constructor(e,t,n){super(e,t),_T(this,"cloneSource",void 0),_T(this,"cloneOverlay",void 0);const s=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),s,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new vM(s,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function O5(r,e,t){return(e=I5(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function I5(r){var e=M5(r,"string");return typeof e=="symbol"?e:e+""}function M5(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class jh{constructor(e,t,n,s,i){O5(this,"wtSettings",null),ua(this,"wot",e,{writable:!1}),this.domBindings=i,this.facadeGetter=t,this.wtSettings=s;const{TABLE:o,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Nm(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Nm(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=bm(e.TABLE)}getRelativeCellPosition(e,t,n){if(this.clone.wtTable.holder.contains(e)===!1){el(`The provided element is not a child of the ${this.type} overlay`);return}const s=this.mainTableScrollableElement===this.domBindings.rootWindow,i=n<this.wtSettings.getSetting("fixedColumnsStart"),o=t<this.wtSettings.getSetting("fixedRowsTop"),a=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return s?h=this.getRelativeCellPositionWithinWindow(o,i,c,u):h=this.getRelativeCellPositionWithinHolder(o,a,i,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,n,s){const i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!t)o=s.start;else{let l=i.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(i.left+i.width+vn())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top:a=s.top,{start:n.start+o,top:n.top+a}}getRelativeCellPositionWithinHolder(e,t,n,s,i){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=o.horizontal-i.start),t){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=o.vertical-i.top);return{start:s.start-a,top:s.top-l}}makeClone(){if(CM.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:n,rootWindow:s}=this.domBindings,i=n.createElement("div"),o=n.createElement("table"),a=e.wtRootElement.parentNode;i.className=`${g5.get(this.type)} handsontable`,i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,t.getSetting("ariaTags")&&Yt(i,[mo()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),i.appendChild(o),a.appendChild(i);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===rl||u==="vertical"&&this.type===nl?this.mainTableScrollableElement=s:s.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=bm(e.TABLE),new A5(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.needFullRender&&this.clone.draw(e)}reset(){const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,n=e.style,s=t.style,i=e.parentNode.style;[n,s,i].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class _5 extends jh{constructor(e,t,n,s,i,o){super(e,t,Jo,n,s),this.bottomOverlay=i,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Uw(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${i}px`,t.style.bottom=`${o}px`}else Dp(t),this.repositionOverlay();let n=Ss(this.clone.wtTable.TABLE);const s=Fr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),t.style.height=`${n}px`,t.style.width=`${s}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,s=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=vn(n)),s.style.bottom=`${i}px`}}const x5="calculatedColumns",Bp={getFirstRenderedColumn(){const r=this.dataAccessObject.startColumnRendered;return r===null?-1:r},getFirstVisibleColumn(){const r=this.dataAccessObject.startColumnVisible;return r===null?-1:r},getFirstPartiallyVisibleColumn(){const r=this.dataAccessObject.startColumnPartiallyVisible;return r===null?-1:r},getLastRenderedColumn(){const r=this.dataAccessObject.endColumnRendered;return r===null?-1:r},getLastVisibleColumn(){const r=this.dataAccessObject.endColumnVisible;return r===null?-1:r},getLastPartiallyVisibleColumn(){const r=this.dataAccessObject.endColumnPartiallyVisible;return r===null?-1:r},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ua(Bp,"MIXIN_NAME",x5,{writable:!1,enumerable:!1});class Bw extends Vu{constructor(e,t,n,s){super(e,t,n,s,Oi)}}ur(Bw,Vw);ur(Bw,Bp);function L5(r,e,t){return(e=P5(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function P5(r){var e=F5(r,"string");return typeof e=="symbol"?e:e+""}function F5(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class D5 extends jh{constructor(e,t,n,s){super(e,t,Oi,n,s),L5(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Bw(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let n=0;const s=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!s||s!=="vertical")?(n=this.getOverlayOffset(),t.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const i=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),i}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,s=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=vn(n)),s.style.bottom=`${i}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let n=!1;return this.mainTableScrollableElement===t?(t.scrollTo(Iw(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:n,wtSettings:s}=this.wot,i=s.getSetting("defaultRowHeight");let o=e,a=0;for(;o<t;){const l=n.getRowHeight(o);a+=l===void 0?i:l,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:s}=this.domBindings,i=vn(n),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||l==="horizontal"){let c=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=i),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Ss(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let n=this.getTableParentOffset();const i=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;t&&i.offsetHeight!==i.clientHeight&&(o=vn(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=o,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Mw(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const s=this.wot.wtTable.getTotalHeight(),i=this.clone.wtTable.getTotalHeight(),o=s-i,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+s,0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,s=this.wtSettings.getSetting("columnHeaders");let i=!1;if((n||t===0)&&s.length>0){const o=this.wot.wtTable.holder.parentNode,a=zt(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(dt(o,"innerBorderBottom"),i=!a):(Nr(o,"innerBorderBottom"),i=a)}return i}}const H5="calculatedRows",Ww={getFirstRenderedRow(){const r=this.dataAccessObject.startRowRendered;return r===null?-1:r},getFirstVisibleRow(){const r=this.dataAccessObject.startRowVisible;return r===null?-1:r},getFirstPartiallyVisibleRow(){const r=this.dataAccessObject.startRowPartiallyVisible;return r===null?-1:r},getLastRenderedRow(){const r=this.dataAccessObject.endRowRendered;return r===null?-1:r},getLastVisibleRow(){const r=this.dataAccessObject.endRowVisible;return r===null?-1:r},getLastPartiallyVisibleRow(){const r=this.dataAccessObject.endRowPartiallyVisible;return r===null?-1:r},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ua(Ww,"MIXIN_NAME",H5,{writable:!1,enumerable:!1});class $w extends Vu{constructor(e,t,n,s){super(e,t,n,s,nl)}}ur($w,Ww);ur($w,kp);const V5="localHooks",Io={_localHooks:Object.create(null),addLocalHook(r,e){return this._localHooks[r]||(this._localHooks[r]=[]),this._localHooks[r].push(e),this},runLocalHooks(r,e,t,n,s,i,o){if(this._localHooks[r]){const a=this._localHooks[r].length;for(let l=0;l<a;l++)NE(this._localHooks[r][l],this,e,t,n,s,i,o)}},clearLocalHooks(){return this._localHooks={},this}};ua(Io,"MIXIN_NAME",V5,{writable:!1,enumerable:!1});let TM=class{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}};ur(TM,Io);const U5="active-header",bM="header",Gw="area",zw="focus",k5="fill",B5="row",W5="column",$5="custom-selection",Yw=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var G5=Lw;G5("flat");function z5(r,e){NM(r,e),e.add(r)}function xT(r,e,t){NM(r,e),e.set(r,t)}function NM(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sr(r,e){return r.get(Kc(r,e))}function LT(r,e,t){return r.set(Kc(r,e),t),t}function Kc(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Vs=new WeakMap,Nn=new WeakMap,kd=new WeakSet;class Y5{constructor(){z5(this,kd),xT(this,Vs,void 0),xT(this,Nn,void 0)}setActiveOverlay(e){return LT(Nn,this,e),this}setActiveSelection(e){return LT(Vs,this,e),this}scan(){const e=sr(Vs,this).settings.selectionType,t=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>t.add(n)),this.scanRowsInHeadersRange(n=>t.add(n))):e==="area"?this.scanCellsRange(n=>t.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>t.add(n)),this.scanRowsInHeadersRange(n=>t.add(n)),this.scanCellsRange(n=>t.add(n))):e==="fill"?this.scanCellsRange(n=>t.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>t.add(n)),this.scanRowsInHeadersRange(n=>t.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>t.add(n)),this.scanRowsInCellsRange(n=>t.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>t.add(n)),this.scanColumnsInCellsRange(n=>t.add(n))),t}scanColumnsInHeadersRange(e){const[t,n,s,i]=sr(Vs,this).getCorners(),{wtTable:o}=sr(Nn,this),a=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount();let u=0;for(let c=-o.getRowHeadersCount();c<a;c++){const h=o.columnFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<t||d>s)continue;const m=d+l;let E=o.getColumnHeader(h,m);const g=sr(Nn,this).getSetting("onBeforeHighlightingColumnHeader",h,m,{selectionType:sr(Vs,this).settings.selectionType,columnCursor:u,selectionWidth:i-n+1});g!==null&&(g!==h&&(E=o.getColumnHeader(g,m)),e(E))}u+=1}}}scanRowsInHeadersRange(e){const[t,n,s,i]=sr(Vs,this).getCorners(),{wtTable:o}=sr(Nn,this),a=o.getRenderedRowsCount(),l=o.getRowHeadersCount();let u=0;for(let c=-o.getColumnHeadersCount();c<a;c++){const h=o.rowFilter.renderedToSource(c);if(!(h<t||h>s)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const m=d+l;let E=o.getRowHeader(h,m);const g=sr(Nn,this).getSetting("onBeforeHighlightingRowHeader",h,m,{selectionType:sr(Vs,this).settings.selectionType,rowCursor:u,selectionHeight:s-t+1});g!==null&&(g!==h&&(E=o.getRowHeader(g,m)),e(E))}u+=1}}}scanCellsRange(e){const[t,n,s,i]=sr(Vs,this).getCorners(),{wtTable:o}=sr(Nn,this);Kc(kd,this,hy).call(this,(a,l)=>{if(a>=t&&a<=s&&l>=n&&l<=i){const u=o.getCell(sr(Nn,this).createCellCoords(a,l)),c=sr(Nn,this).getSetting("onAfterDrawSelection",a,l,sr(Vs,this).settings.layerLevel);typeof c=="string"&&dt(u,c),e(u)}})}scanRowsInCellsRange(e){const[t,,n]=sr(Vs,this).getCorners(),{wtTable:s}=sr(Nn,this);Kc(kd,this,hy).call(this,(i,o)=>{if(i>=t&&i<=n){const a=s.getCell(sr(Nn,this).createCellCoords(i,o));e(a)}})}scanColumnsInCellsRange(e){const[,t,,n]=sr(Vs,this).getCorners(),{wtTable:s}=sr(Nn,this);Kc(kd,this,hy).call(this,(i,o)=>{if(o>=t&&o<=n){const a=s.getCell(sr(Nn,this).createCellCoords(i,o));e(a)}})}}function hy(r){const{wtTable:e}=sr(Nn,this),t=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let s=0;s<t;s+=1){const i=e.rowFilter.renderedToSource(s);for(let o=0;o<n;o+=1)r(i,e.columnFilter.renderedToSource(o))}}class PT{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Yw,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,n=this.main.childNodes.length;t<n;t++){const s=this.main.childNodes[t];this.eventManager.addEventListener(s,"mouseenter",i=>this.onMouseEnter(i,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Vp(e);const n=this,s=this.wot.rootDocument.body,i=t.getBoundingClientRect();t.style.display="none";function o(l){if(l.clientY<Math.floor(i.top)||l.clientY>Math.ceil(i.top+i.height)||l.clientX<Math.floor(i.left)||l.clientX>Math.ceil(i.left+i.width))return!0}function a(l){o(l)&&(n.eventManager.removeEventListener(s,"mousemove",a),t.style.display="block")}this.eventManager.addEventListener(s,"mousemove",a)}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const n=["top","start","bottom","end","corner"];let s=this.main.style;s.position="absolute",s.top=0,s.left=0;for(let a=0;a<5;a++){const l=n[a],u=t.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),s=u.style,s.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,s.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,s.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Jl()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:i}=this.wot;let o=i.bordersHolder;o||(o=t.createElement("div"),o.className="htBorders",i.bordersHolder=o,i.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const t=10,n=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const s={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`};Lt(s,(o,a)=>{this.selectionHandles.styles.bottomHitArea[a]=o,this.selectionHandles.styles.topHitArea[a]=o});const i={position:"absolute",height:`${t}px`,width:`${t}px`,"border-radius":`${parseInt(t/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Lt(i,(o,a)=>{this.selectionHandles.styles.bottom[a]=o,this.selectionHandles.styles.top[a]=o}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||t!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,n,s,i,o){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,m=parseInt(u.borderWidth,10),E=parseInt(u.width,10),g=parseInt(c.width,10),O=this.wot.wtTable.getWidth(),T=this.wot.wtTable.getHeight();u.top=`${parseInt(n-E-1,10)}px`,u[l]=`${parseInt(s-E-1,10)}px`,c.top=`${parseInt(n-g/4*3,10)}px`,c[l]=`${parseInt(s-g/4*3,10)}px`;const _=Math.min(parseInt(s+i,10),O-E-m*2),V=Math.min(parseInt(s+i-g/4,10),O-g-m*2);h[l]=`${_}px`,d[l]=`${V}px`;const H=Math.min(parseInt(n+o,10),T-E-m*2),Q=Math.min(parseInt(n+o-g/4,10),T-g-m*2);h.top=`${H}px`,d.top=`${Q}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,t)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:t,rootDocument:n,rootWindow:s}=this.wot;let i,o,a,l,u,c;const h=t.getRenderedRowsCount();for(let ue=0;ue<h;ue+=1){const Ae=t.rowFilter.renderedToSource(ue);if(Ae>=e[0]&&Ae<=e[2]){i=Ae,u=e[0];break}}for(let ue=h-1;ue>=0;ue-=1){const Ae=t.rowFilter.renderedToSource(ue);if(Ae>=e[0]&&Ae<=e[2]){o=Ae;break}}const d=t.getRenderedColumnsCount();for(let ue=0;ue<d;ue+=1){const Ae=t.columnFilter.renderedToSource(ue);if(Ae>=e[1]&&Ae<=e[3]){a=Ae,c=e[1];break}}for(let ue=d-1;ue>=0;ue-=1){const Ae=t.columnFilter.renderedToSource(ue);if(Ae>=e[1]&&Ae<=e[3]){l=Ae;break}}if(i===void 0||a===void 0){this.disappear();return}let m=t.getCell(this.wot.createCellCoords(i,a));const E=i!==o||a!==l,g=E?t.getCell(this.wot.createCellCoords(o,l)):m,O=Es(m),T=E?Es(g):O,_=Es(t.TABLE),V=Fr(t.TABLE),H=O.top,Q=O.left,oe=this.wot.wtSettings.getSetting("rtlMode");let re=0,ie=0;if(oe){const ue=Fr(m),Ae=s.innerWidth-_.left-V;ie=Q+ue-T.left,re=s.innerWidth-Q-ue-Ae-1}else ie=T.left+Fr(g)-Q,re=Q-_.left-1;if(this.isEntireColumnSelected(i,o)){const ue=this.getDimensionsFromHeader("columns",a,l,u,_);let Ae=null;ue&&([Ae,re,ie]=ue),Ae&&(m=Ae)}let Fe=H-_.top-1,Ie=T.top+Ss(g)-H;if(this.isEntireRowSelected(a,l)){const ue=this.getDimensionsFromHeader("rows",i,o,c,_);let Ae=null;ue&&([Ae,Fe,Ie]=ue),Ae&&(m=Ae)}const _e=ia(m,s);parseInt(_e.borderTopWidth,10)>0&&(Fe+=1,Ie=Ie>0?Ie-1:0),parseInt(_e[oe?"borderRightWidth":"borderLeftWidth"],10)>0&&(re+=1,ie=ie>0?ie-1:0);const tt=oe?"right":"left";this.topStyle.top=`${Fe}px`,this.topStyle[tt]=`${re}px`,this.topStyle.width=`${ie}px`,this.topStyle.display="block",this.startStyle.top=`${Fe}px`,this.startStyle[tt]=`${re}px`,this.startStyle.height=`${Ie}px`,this.startStyle.display="block";const Ge=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${Fe+Ie-Ge}px`,this.bottomStyle[tt]=`${re}px`,this.bottomStyle.width=`${ie}px`,this.bottomStyle.display="block",this.endStyle.top=`${Fe}px`,this.endStyle[tt]=`${re+ie-Ge}px`,this.endStyle.height=`${Ie+1}px`,this.endStyle.display="block";let ke=this.settings.border.cornerVisible;ke=typeof ke=="function"?ke(this.settings.layerLevel):ke;const nt=this.wot.getSetting("onModifyGetCellCoords",o,l);let[je,Ne]=[o,l];if(nt&&Array.isArray(nt)&&([,,je,Ne]=nt),Jl()||!ke||this.isPartRange(je,Ne))this.cornerStyle.display="none";else{this.cornerStyle.top=`${Fe+Ie+this.cornerCenterPointOffset-1}px`,this.cornerStyle[tt]=`${re+ie+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let ue=Nm(t.TABLE);const Ae=ue===s;Ae&&(ue=n.documentElement);const bt=parseInt(this.cornerDefaultStyle.width,10)/2,p=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const y=Ae?g.getBoundingClientRect().left:g.offsetLeft;let R=!1,x=0;oe?(x=y-parseInt(this.cornerDefaultStyle.width,10)/2,R=x<0):(x=y+Fr(g)+parseInt(this.cornerDefaultStyle.width,10)/2,R=x>=KI(ue)),R&&(this.cornerStyle[tt]=`${Math.floor(re+ie+this.cornerCenterPointOffset-bt)}px`,this.cornerStyle[oe?"borderLeftWidth":"borderRightWidth"]=0)}o===this.wot.getSetting("totalRows")-1&&(Ae?g.getBoundingClientRect().top:g.offsetTop)+Ss(g)+parseInt(this.cornerDefaultStyle.height,10)/2>=Zl(ue)&&(this.cornerStyle.top=`${Math.floor(Fe+Ie+this.cornerCenterPointOffset-p)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Jl()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(o,l,Fe,re,ie,Ie)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,n,s,i){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,m=null,E=null,g=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},u=function(){return Ss(...arguments)},c="ht__selection--rows",m="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},u=function(){return Fr(...arguments)},c="ht__selection--columns",m="left";break}if(a.classList.contains(c)){const O=this.wot.getSetting("columnHeaders").length;if(E=l(t,O-s),g=l(n,O-s),!E||!g)return!1;const T=Es(E),_=Es(g);return E&&g&&(h=T[m]-i[m]-1,d=_[m]+u(g)-T[m]),[E,h,d]}return!1}changeBorderStyle(e,t){const n=this[e].style,s=t[e];!s||s.hide?dt(this[e],"hidden"):(zt(this[e],"hidden")&&Nr(this[e],"hidden"),n.backgroundColor=s.color,(e==="top"||e==="bottom")&&(n.height=`${s.width}px`),(e==="start"||e==="end")&&(n.width=`${s.width}px`))}changeBorderToDefaultStyle(e){const t={width:1,color:"#000"},n=this[e].style;n.backgroundColor=t.color,n.width=`${t.width}px`,n.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?dt(this[e],"hidden"):Nr(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Jl()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function j5(r,e){AM(r,e),e.add(r)}function Ll(r,e,t){AM(r,e),e.set(r,t)}function AM(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qe(r,e){return r.get(jw(r,e))}function FT(r,e,t){return r.set(jw(r,e),t),t}function jw(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Jr=new WeakMap,Mn=new WeakMap,dy=new WeakMap,Mc=new WeakMap,fy=new WeakMap,Ma=new WeakMap,DT=new WeakSet;class K5{constructor(e){j5(this,DT),Ll(this,Jr,void 0),Ll(this,Mn,void 0),Ll(this,dy,new Y5),Ll(this,Mc,new WeakMap),Ll(this,fy,new WeakSet),Ll(this,Ma,new Map),FT(Mn,this,e)}setActiveOverlay(e){return FT(Jr,this,e),Qe(dy,this).setActiveOverlay(Qe(Jr,this)),Qe(Mc,this).has(Qe(Jr,this))||Qe(Mc,this).set(Qe(Jr,this),new Set),this}getFocusSelection(){return Qe(Mn,this)!==null?Qe(Mn,this).getFocus():null}getAreaSelection(){return Qe(Mn,this)!==null?Qe(Mn,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Qe(Ma,this).has(e)){const n=Qe(Ma,this).get(e);if(n.has(Qe(Jr,this)))return n.get(Qe(Jr,this));const s=new PT(Qe(Jr,this),e.settings);return n.set(Qe(Jr,this),s),s}const t=new PT(Qe(Jr,this),e.settings);return Qe(Ma,this).set(e,new Map([[Qe(Jr,this),t]])),t}getBorderInstances(e){var t,n;return Array.from((t=(n=Qe(Ma,this).get(e))===null||n===void 0?void 0:n.values())!==null&&t!==void 0?t:[])}destroyBorders(e){Qe(Ma,this).get(e).forEach(t=>t.destroy()),Qe(Ma,this).delete(e)}render(e){if(Qe(Mn,this)===null)return;e&&jw(DT,this,X5).call(this);const t=Array.from(Qe(Mn,this)),n=new Map,s=new Map;for(let i=0;i<t.length;i++){const o=t[i],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=o.settings;Qe(fy,this).has(o)||(Qe(fy,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const h=this.getBorderInstance(o);if(o.isEmpty()){h==null||h.disappear();continue}a&&Qe(dy,this).setActiveSelection(o).scan().forEach(E=>{if(n.has(E)){const g=n.get(E);g.has(a)&&u===!0?g.set(a,g.get(a)+1):g.set(a,1)}else n.set(E,new Map([[a,1]]));l&&(s.has(E)||s.set(E,[]),E.nodeName==="TH"&&s.get(E).push(...l))});const d=o.getCorners();Qe(Jr,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}n.forEach((i,o)=>{var a;const l=Array.from(i).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,m)=>`${c}-${m+1}`)]}).flat();l.forEach(u=>Qe(Mc,this).get(Qe(Jr,this)).add(u)),dt(o,l),o.nodeName==="TD"&&Array.isArray((a=Qe(Mn,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Yt(o,Qe(Mn,this).options.cellAttributes)}),Array.from(s.keys()).forEach(i=>{Yt(i,[...s.get(i)])})}}function X5(){const r=Qe(Mc,this).get(Qe(Jr,this)),e=Qe(Jr,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let t=0;t<e.length;t++)r.add(e[t]);r.forEach(t=>{var n,s;const i=Qe(Jr,this).wtTable.TABLE.querySelectorAll(`.${t}`);let o=[];Array.isArray((n=Qe(Mn,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(o=Qe(Mn,this).options.cellAttributes.map(a=>a[0])),Array.isArray((s=Qe(Mn,this).options)===null||s===void 0?void 0:s.headerAttributes)&&(o=[...o,...Qe(Mn,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=i.length;a<l;a++)Nr(i[a],t),Wh(i[a],o)}),r.clear()}class q5 extends jh{constructor(e,t,n,s){super(e,t,nl,n,s)}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new $w(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,n=this.clone.wtTable.holder.parentNode,s=this.wtSettings.getSetting("preventOverflow");let i=0;this.trimmingContainer===t&&(!s||s!=="horizontal")?(i=this.getOverlayOffset()*(this.isRtl()?-1:1),_w(n,`${i}px`,"0px")):(i=this.getScrollPosition(),Dp(n));const o=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,YI(t)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const n=this.wtSettings.getSetting("defaultColumnWidth");let s=e,i=0;for(;s<t;)i+=this.wot.wtTable.getStretchedColumnWidth(s)||n,s+=1;return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:n}=this.domBindings,s=vn(t),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=s),u=Math.min(u,e.wtRootElement.scrollHeight),o.height=`${u}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const l=Fr(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(Yw.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){const{wtSettings:n}=this,s=n.getSetting("rowHeaders"),i=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=i===0&&s.length>0&&!zt(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(t){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(t=!1)}return t&&a.offsetWidth!==a.clientWidth&&(c=vn(this.domBindings.rootDocument)),t?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,Bj(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(jI(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const s=this.wot.wtTable.getTotalWidth(),i=this.clone.wtTable.getTotalWidth(),o=s-i;n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:t}=this,n=this.wot.wtTable.holder.parentNode,s=t.getSetting("rowHeaders"),i=t.getSetting("fixedColumnsStart"),o=t.getSetting("totalRows"),a=t.getSetting("preventOverflow")==="vertical";o?Nr(n,"emptyRows"):dt(n,"emptyRows");let l=!1;if(!a){if(i&&!s.length)dt(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&s.length){const u=zt(n,"innerBorderInlineStart");e?(dt(n,"innerBorderLeft innerBorderInlineStart"),l=!u):(Nr(n,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const Q5="stickyRowsTop",Kw={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const r=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),r)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ua(Kw,"MIXIN_NAME",Q5,{writable:!1,enumerable:!1});class Xw extends Vu{constructor(e,t,n,s){super(e,t,n,s,sl)}}ur(Xw,Kw);ur(Xw,kp);function HT(r,e,t){return(e=Z5(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Z5(r){var e=J5(r,"string");return typeof e=="symbol"?e:e+""}function J5(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class e9 extends jh{constructor(e,t,n,s,i,o){super(e,t,sl,n,s),HT(this,"topOverlay",void 0),HT(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Xw(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),i=this.topOverlay.getOverlayOffset();_w(e,`${s}px`,`${i}px`)}else Dp(e);let t=Ss(this.clone.wtTable.TABLE);const n=Fr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${n}px`,!1}}class qw extends Vu{constructor(e,t,n,s){super(e,t,n,s,rl)}}ur(qw,Kw);ur(qw,Bp);function t9(r,e,t){return(e=r9(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function r9(r){var e=n9(r,"string");return typeof e=="symbol"?e:e+""}function n9(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class s9 extends jh{constructor(e,t,n,s){super(e,t,rl,n,s),t9(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new qw(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let s=0,i=!1;if(this.trimmingContainer===t&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;i=u===c,s=this.getOverlayOffset(),_w(e,"0px",`${s}px`)}else s=this.getScrollPosition(),Dp(e);const o=this.adjustHeaderBordersPosition(s,i);return this.adjustElementsSize(),o}setScrollPosition(e){const t=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(Iw(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const n=this.wtSettings.getSetting("defaultRowHeight");let s=e,i=0;for(;s<t;){const o=this.wot.wtTable.getRowHeight(s);i+=o===void 0?n:o,s+=1}return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:n}=this.domBindings,s=vn(t),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=s),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=Ss(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(Yw.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:n,wtSettings:s}=this,o=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=s.getSetting("columnHeaders"),u=s.getSetting("fixedRowsTop")===0&&a.length>0&&!zt(o.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(t){const d=this.wot.wtTable.getRowHeight(e),m=this.wot.wtViewport.getViewportHeight();d>m&&(t=!1)}if(t&&o.offsetHeight!==o.clientHeight&&(h=vn(this.domBindings.rootDocument)),t){const d=s.getSetting("fixedRowsBottom"),m=s.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=n.wtViewport.getViewportHeight()-this.sumCellSizes(m-d,m),c+=1,c+=u}else c+=this.sumCellSizes(s.getSetting("fixedRowsTop"),e);return c+=h,kj(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Mw(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const s=this.wot.wtTable.getTotalHeight(),i=this.clone.wtTable.getTotalHeight(),o=s-i;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,s=this.wot.wtTable.holder.parentNode,i=n.getSetting("totalColumns"),o=n.getSetting("preventOverflow")==="horizontal";i?Nr(s,"emptyColumns"):dt(s,"emptyColumns");let a=!1;if(!t&&!o){const l=n.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=n.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=zt(s,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(dt(s,"innerBorderTop"),a=!h):(Nr(s,"innerBorderTop"),a=h)}}return a}}function Bd(r,e,t){i9(r,e),e.set(r,t)}function i9(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qi(r,e,t){return(e=o9(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function o9(r){var e=a9(r,"string");return typeof e=="symbol"?e:e+""}function a9(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function _a(r,e,t){return r.set(OM(r,e),t),t}function Zi(r,e){return r.get(OM(r,e))}function OM(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Pl=new WeakMap,Wd=new WeakMap,Fl=new WeakMap,$d=new WeakMap;class l9{constructor(e,t,n,s,i,o){Qi(this,"wot",null),Bd(this,Pl,[]),Qi(this,"topOverlay",null),Qi(this,"bottomOverlay",null),Qi(this,"inlineStartOverlay",null),Qi(this,"topInlineStartCornerOverlay",null),Qi(this,"bottomInlineStartCornerOverlay",null),Qi(this,"browserLineHeight",void 0),Qi(this,"wtSettings",null),Bd(this,Wd,!1),Bd(this,Fl,0),Bd(this,$d,null),Qi(this,"resizeObserver",new ResizeObserver(c=>{d3(()=>{!Array.isArray(c)||!c.length||(_a(Fl,this,Zi(Fl,this)+1),Zi(Fl,this)===100&&(el("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Zi($d,this)!==null&&clearTimeout(Zi($d,this)),_a($d,this,setTimeout(()=>{_a(Fl,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=s,this.domBindings=n,this.facadeGetter=t,this.wtTable=o;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=vn(a);const u=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?o.holder:bm(o.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=[...Zi(Pl,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,n=e.getComputedStyle(t.body),s=parseInt(n.lineHeight,10),i=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=s||i}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new s9(...e),this.bottomOverlay=new D5(...e),this.inlineStartOverlay=new q5(...e),this.topInlineStartCornerOverlay=new e9(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new _5(...e,this.bottomOverlay,this.inlineStartOverlay),_a(Pl,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){_a(Wd,this,Zi(Pl,this).reduce((e,t)=>t.hasRenderingStateChanged()||e,!1)),Zi(Pl,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Zi(Pl,this).forEach(e=>{const t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:s}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",h=>this.onTableScroll(h),{passive:!0}),n!==s&&this.eventManager.addEventListener(s,"scroll",h=>this.onTableScroll(h),{passive:!0});const i=t.devicePixelRatio&&t.devicePixelRatio>1,o=this.scrollableElement===t,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||i||!y3())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:d}=h.clone.wtTable;this.eventManager.addEventListener(d,"wheel",m=>this.onCloneWheel(m,a),l)}});let c;this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize"),_a(Fl,this,0)},200)}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,i=e.target;this.keyPressed&&(s!==t&&i!==t&&!e.target.contains(s)||n!==t&&i!==t&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:n}=this.domBindings,s=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target,a=i!==n&&o!==n&&!o.contains(i),l=s!==n&&o!==n&&!o.contains(s);if(this.keyPressed&&(a||l)||this.scrollableElement===n)return;const u=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=b3(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,t+=t*this.browserLineHeight);const s=this.scrollVertically(t),i=this.scrollHorizontally(n);return s||i}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,[s,i]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==s||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==i||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=s;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=s)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!Zi(Wd,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),_a(Wd,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=bm(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,n=e.clientHeight,s=t!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return s&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=n),s}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:n}=this.domBindings,s=this.scrollableElement===n,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,i),d=t.hider.style,m=()=>s?!1:this.scrollableElement.scrollTop>Math.max(0,u-t.holder.clientHeight),E=()=>s?!1:this.scrollableElement.scrollLeft>Math.max(0,c-t.holder.clientWidth),g=m()?1:0,O=E()?1:0;if(d.width=`${c+O}px`,d.height=`${u+g}px`,this.scrollbarSize>0){const{scrollHeight:T,scrollWidth:_}=t.wtRootElement,{scrollHeight:V,scrollWidth:H}=t.holder;this.hasScrollbarRight=T<V,this.hasScrollbarBottom=_<H,this.hasScrollbarRight&&t.hider.scrollWidth+this.scrollbarSize>_?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&t.hider.scrollHeight+this.scrollbarSize>T&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return Je(t,s=>{s&&s.clone&&s.clone.wtTable.TABLE.contains(e)&&(n=s.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];Je(t,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function VT(r,e,t){return(e=u9(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function u9(r){var e=c9(r,"string");return typeof e=="symbol"?e:e+""}function c9(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class h9{constructor(e){VT(this,"settings",{}),VT(this,"defaults",Object.freeze(this.getDefaults())),Lt(this.defaults,(t,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(t===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,n)=>{const s=this.getSetting("data",e,t);$h(n,s??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return t===void 0?Lt(e,(n,s)=>{this.settings[s]=n}):this.settings[e]=t,this}getSetting(e,t,n,s,i){return typeof this.settings[e]=="function"?this.settings[e](t,n,s,i):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Qw extends Vu{constructor(e,t,n,s){super(e,t,n,s,"master")}alignOverlaysWithTrimmingContainer(){const e=Nm(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,s=bE(e,"height",t),i=bE(e,"overflow",t),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(i)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?n.insertBefore(d,e.nextElementSibling):n.appendChild(d);const m=parseInt(ia(d,t).height,10);n.removeChild(d),m===0&&(c=0)}c=Math.min(c,l),o.height=s==="auto"?"auto":`${c}px`,u=Math.min(u,a),o.width=`${u}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=gh(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,n="master",i=e.getSetting("columnHeaders").length;if(i&&!t.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<i;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);t.hasOversizedColumnHeadersMarked[n]=!0}}}ur(Qw,Ww);ur(Qw,Bp);class d9{constructor(e,t,n,s,i){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new Z6:new eK],["fullyVisible",()=>new W6],["partiallyVisible",()=>new mM]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new X6:new J6],["fullyVisible",()=>new U6],["partiallyVisible",()=>new fM]]),this.eventManager=s,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return t===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=Ss(t)>0&&t.clientHeight>0?t.clientHeight:1/0,n}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:t,rootWindow:n}=this.domBindings,s=this.dataAccessObject.inlineStartOverlayTrimmingContainer,i=t.documentElement.offsetWidth,o=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-i:u.left,h=i-c;let d,m;if(a)return Fr(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?d=Math.min(h,i):d=Math.min(this.getContainerFillWidth(),h,i),s===n&&o>0&&this.sumColumnWidths(0,o-1)>d)return t.documentElement.clientWidth;if(s!==n&&(m=bE(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",n),m==="scroll"||m==="hidden"||m==="auto"))return Math.max(d,s.clientWidth);const E=e.getSetting("stretchH");return E==="none"||!E?Math.max(d,Fr(this.wtTable.TABLE)):d}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let n=0,s=e;for(;s<t;)n+=this.wtTable.getColumnWidth(s),s+=1;return n}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);const n=t.offsetWidth;return this.containerWidth=n,e.removeChild(t),n}getWorkspaceOffset(){return Es(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Ss(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,s=t.length;n<s;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let s=0,i=t.length;s<i;s++)n?(this.rowHeaderWidth+=Fr(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:n}=this;let s=this.getViewportHeight(),i,o;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=t.getSetting("fixedRowsTop"),u=t.getSetting("fixedRowsBottom"),c=t.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,s-=o),u&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),s-=o),n.holder.clientHeight===n.holder.offsetHeight?i=0:i=vn(this.domBindings.rootDocument),new uK({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:s,scrollOffset:a,totalRows:t.getSetting("totalRows"),rowHeightFn:h=>n.getRowHeight(h),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:i})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:n}=this;let s=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=t.getSetting("fixedColumnsStart");if(o&&i>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);i+=a,s-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(s-=vn(this.domBindings.rootDocument)),new iK({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:s,scrollOffset:i,totalColumns:t.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,n=this.createRowsCalculator(),s=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){const i=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(i)}if(e&&!t.getSetting("renderAllColumns")){const i=s.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(i)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=s.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=s.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=s.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:n}=e;if(t===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:s,endRow:i}=this.rowsRenderCalculator;return t<s||t===s&&t>0?!1:!(n>i||n===i&&n<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:n}=e;if(t===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:s,endColumn:i}=this.columnsRenderCalculator;return t<s||t===s&&t>0?!1:!(n>i||n===i&&n<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Lt(this.hasOversizedColumnHeadersMarked,(e,t,n)=>{n[t]=void 0})}}class f9 extends kw{constructor(e,t){super(e,new h9(t));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new Qw(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new d9(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new K5(this.wtSettings.getSetting("selections")),this.wtEvent=new vM(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new l9(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],n=[];Lt(e,(s,i)=>{this.wtSettings.getSetting(i).length&&n.push(s),t.push(s)}),Nr(this.wtTable.wtRootElement.parentNode,t),dt(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var t;if(!CM.includes(e))return null;const n=e.replace(/_([a-z])/g,s=>s[1].toUpperCase());return(t=this.wtOverlays[`${n}Overlay`])!==null&&t!==void 0?t:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class Zw{constructor(e){e instanceof kw?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=t=>{const n=new Zw(t);return()=>n},this._wot=new f9(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,n){return this._wot.createCellRange(e,t,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,t)}scrollViewport(e,t,n,s,i){return this._wot.scrollViewport(e,t,n,s,i)}scrollViewportHorizontally(e,t,n){return this._wot.scrollViewportHorizontally(e,t,n)}scrollViewportVertically(e,t,n){return this._wot.scrollViewportVertically(e,t,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,n,s,i){return this._wot.wtSettings.getSetting(e,t,n,s,i)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function UT(r){let{isShiftKey:e,isLeftClick:t,isRightClick:n,coords:s,selection:i,controller:o,cellCoordsFactory:a}=r;const l=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),c=i.isSelectedByRowHeader();if(i.markSource("mouse"),e&&l)s.row>=0&&s.col>=0&&!o.cell?i.setRangeEnd(s):(u||c)&&s.row>=0&&s.col>=0&&!o.cell?i.setRangeEnd(a(s.row,s.col)):u&&s.row<0&&!o.column?i.setRangeEnd(a(l.to.row,s.col)):c&&s.col<0&&!o.row?i.setRangeEnd(a(s.row,l.to.col)):(!u&&!c&&s.col<0||u&&s.col<0)&&!o.row?i.selectRows(Math.max(l.from.row,0),s.row,s.col):(!u&&!c&&s.row<0||c&&s.row<0)&&!o.column&&i.selectColumns(Math.max(l.from.col,0),s.col,s.row);else{const h=!i.inInSelection(s),d=t||n&&h;s.row<0&&s.col>=0&&!o.column?d&&i.selectColumns(s.col,s.col,s.row):s.col<0&&s.row>=0&&!o.row?d&&i.selectRows(s.row,s.row,s.col):s.col>=0&&s.row>=0&&!o.cell?d&&i.setRangeStart(s):s.col<0&&s.row<0&&i.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}i.markEndSource()}function m9(r){let{isLeftClick:e,coords:t,selection:n,controller:s,cellCoordsFactory:i}=r;if(!e)return;const o=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),a&&!s.column?n.setRangeEnd(i(u-1,t.col)):o&&!s.row?n.setRangeEnd(i(t.row,l-1)):s.cell||n.setRangeEnd(t),n.markEndSource()}const p9=new Map([["mousedown",UT],["mouseover",m9],["touchstart",UT]]);function kT(r,e){let{coords:t,selection:n,controller:s,cellCoordsFactory:i}=e;p9.get(r.type)({coords:t,selection:n,controller:s,cellCoordsFactory:i,isShiftKey:r.shiftKey,isLeftClick:sM(r)||r.type==="touchstart",isRightClick:AE(r)})}const IM=new WeakMap,Jw=Symbol("rootInstance");function g9(r){IM.set(r,!0)}function y9(r){return r===Jw}function Hf(r){return IM.has(r)}function E9(r,e){MM(r,e),e.add(r)}function xa(r,e,t){MM(r,e),e.set(r,t)}function MM(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ho(r,e,t){return(e=v9(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function v9(r){var e=w9(r,"string");return typeof e=="symbol"?e:e+""}function w9(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Mr(r,e){return r.get(Eh(r,e))}function hs(r,e,t){return r.set(Eh(r,e),t),t}function Eh(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var my=new WeakMap,Gd=new WeakMap,zd=new WeakMap,Ji=new WeakMap,Us=new WeakMap,py=new WeakMap,gy=new WeakMap,Vf=new WeakSet;class R9{constructor(e){E9(this,Vf),Ho(this,"hot",void 0),Ho(this,"eventManager",void 0),Ho(this,"settings",void 0),Ho(this,"THEAD",void 0),Ho(this,"TBODY",void 0),Ho(this,"_wt",void 0),Ho(this,"activeWt",void 0),xa(this,my,0),xa(this,Gd,0),Ho(this,"postponedAdjustElementsSize",!1),xa(this,zd,!1),xa(this,Ji,void 0),xa(this,Us,void 0),xa(this,py,0),xa(this,gy,0),this.hot=e,this.eventManager=new Ou(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){const n=this._wt.getCell(e,t);return n<0?null:n}scrollViewport(e,t,n,s,i){return this._wt.scrollViewport(e,t,n,s,i)}scrollViewportHorizontally(e,t,n){return this._wt.scrollViewportHorizontally(e,t,n)}scrollViewportVertically(e,t,n){return this._wt.scrollViewportVertically(e,t,n)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),dt(e,"handsontable"),hs(Us,this,t.createElement("TABLE")),dt(Mr(Us,this),"htCore"),this.hot.getSettings().tableClassName&&dt(Mr(Us,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Yt(Mr(Us,this),[mo()]),Yt(e,[Nj(),UI(-1),Fp(this.hot.countCols()),Lj()])),this.THEAD=t.createElement("THEAD"),Mr(Us,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),Mr(Us,this).appendChild(this.TBODY),this.hot.table=Mr(Us,this),this.hot.container.insertBefore(Mr(Us,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:t,selection:n,rootWindow:s}=this.hot,i=t.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{hs(zd,this,!0),this.isTextSelectionAllowed(a.target)||(YC(s),a.preventDefault(),s.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{hs(zd,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{Mr(zd,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&YC(s),a.preventDefault())}),this.eventManager.addEventListener(i,"keyup",a=>{n.isInProgress()&&!a.shiftKey&&n.finish()}),this.eventManager.addEventListener(i,"mouseup",a=>{n.isInProgress()&&sM(a)&&n.finish(),hs(Ji,this,!1);const l=qI(t.activeElement);Ff(t.activeElement)&&!l||(l||!n.isSelected()&&!n.isSelectedByAnyHeader()&&!e.contains(a.target)&&!AE(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",a=>{n.isInProgress()&&AE(a)&&(n.finish(),hs(Ji,this,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{n.isInProgress()&&n.finish(),hs(Ji,this,!1)}),this.eventManager.addEventListener(i,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(Mr(Ji,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const E=vn(t);if(t.elementFromPoint(u+E,c)!==d||t.elementFromPoint(u,c+E)!==d)return}else for(;h!==i;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let o=Tm(s);for(;o!==null;)this.eventManager.addEventListener(o.document.documentElement,"click",()=>{this.hot.unlisten()}),o=Tm(o);this.eventManager.addEventListener(Mr(Us,this),"selectstart",a=>{this.settings.fragmentSelection||Ff(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,n))}translateFromRenderableToVisualIndex(e,t){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,s=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return n===null&&(n=e),s===null&&(s=t),[n,s]}countRenderableIndexes(e,t){const n=Math.min(e.getNotTrimmedIndexesLength(),t),s=e.getNearestNotHiddenIndex(n-1,-1);return s===null?0:e.getRenderableFromVisualIndex(s)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,n,s){if(isNaN(e)||e<0)return 0;const i=n.getNearestNotHiddenIndex(e,t),o=n.getRenderableFromVisualIndex(i);if(!Number.isInteger(o))return 0;let a=0;return t<0?a=o+1:t>0&&(a=s-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let n=0;for(let s=e;s<=t;s++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(s)!==null&&(n+=1);return n}countRenderableRowsInRange(e,t){let n=0;for(let s=e;s<=t;s++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(s)!==null&&(n+=1);return n}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Mr(Us,this),isDataViewInstance:()=>Hf(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(i,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(i,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const i=[];return this.hot.hasRowHeaders()&&i.push((o,a)=>{const l=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",i),hs(Gd,this,i.length),this.hot.getSettings().ariaTags&&Eh(Vf,this,_M).call(this)===this.hot.countCols()&&Eh(Vf,this,S9).call(this,Mr(Gd,this)),i},columnHeaders:()=>{const i=[];return this.hot.hasColHeaders()&&i.push((o,a)=>{const l=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",i),hs(my,this,i.length),i},columnWidth:i=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i);return this.hot.getColWidth(o===null?i:o)},rowHeight:i=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(i);return this.hot.getRowHeight(o===null?i:o)},rowHeightByOverlayName:(i,o)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),l=a===null?i:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,o)},cellRenderer:(i,o,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(i,o),c=this.hot.runHooks("modifyGetCellCoords",l,u);let h=l,d=u;Array.isArray(c)&&([h,d]=c);const m=this.hot.getCellMeta(h,d),E=this.hot.colToProp(d);let g=this.hot.getDataAtRowProp(h,E);this.hot.hasHook("beforeValueRender")&&(g=this.hot.runHooks("beforeValueRender",g,m)),this.hot.runHooks("beforeRenderer",a,l,u,E,g,m),this.hot.getCellRenderer(m)(this.hot,a,l,u,E,g,m),this.hot.runHooks("afterRenderer",a,l,u,E,g,m)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&gh(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(i,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,hs(Ji,this,!0),this.hot.runHooks("beforeOnCellMouseDown",i,u,a,c),!Ga(i)&&(kT(i,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",i,u,a),this.activeWt=this._wt)},onCellContextMenu:(i,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,hs(Ji,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",i,u,a),!Ga(i)&&(this.hot.runHooks("afterOnCellContextMenu",i,u,a),this.activeWt=this._wt)},onCellMouseOut:(i,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",i,u,a),!Ga(i)&&(this.hot.runHooks("afterOnCellMouseOut",i,u,a),this.activeWt=this._wt)},onCellMouseOver:(i,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",i,u,a,c),!Ga(i)&&(Mr(Ji,this)&&kT(i,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",i,u,a),this.activeWt=this._wt)},onCellMouseUp:(i,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",i,u,a),!(Ga(i)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",i,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:i=>{i.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",i)},onCellCornerDblClick:i=>{i.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",i)},beforeDraw:(i,o)=>this.beforeRender(i,o),onDraw:i=>this.afterRender(i),onBeforeViewportScrollVertically:i=>{const o=this.hot.rowIndexMapper,a=i<0;let l=i;return!a&&(l=o.getVisualFromRenderableIndex(i),l===null)?i:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:o.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:i=>{const o=this.hot.columnIndexMapper,a=i<0;let l=i;return!a&&(l=o.getVisualFromRenderableIndex(i),l===null)?i:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:o.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(i,o,a)=>{const l=this.hot.rowIndexMapper,u=i<0;let c=i;u||(c=l.getVisualFromRenderableIndex(i));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,o,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(i,o,a)=>{const l=this.hot.columnIndexMapper,u=i<0;let c=i;u||(c=l.getVisualFromRenderableIndex(i));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,o,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(i,o,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(i,o),h=this.hot.selection.getSelectedRange();if(h.size()>0){const m=h.peekByIndex(a??0);l=[m.from.row,m.from.col,m.to.row,m.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(i,o)=>{const[a,l,u,c]=i,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(i,o)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.runHooks("beforeStretchingColumnWidth",i,a)},onModifyRowHeaderWidth:i=>this.hot.runHooks("modifyRowHeaderWidth",i),onModifyGetCellCoords:(i,o,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=o>=0?u.getVisualFromRenderableIndex(o):o,h=i>=0?l.getVisualFromRenderableIndex(i):i,d=this.hot.runHooks("modifyGetCellCoords",h,c,a);if(Array.isArray(d)){const[m,E,g,O]=d;return[m>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(m,1)):m,E>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(E,1)):E,g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,-1)):g,O>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(O,-1)):O]}},viewportRowCalculatorOverride:i=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const a=this.countRenderableRows(),l=i.startRow,u=i.endRow;if(typeof o=="number")i.startRow=Math.max(l-o,0),i.endRow=Math.min(u+o,a-1);else if(o==="auto"){const c=Math.ceil(u/a*12);i.startRow=Math.max(l-c,0),i.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",i)},viewportColumnCalculatorOverride:i=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const a=this.countRenderableColumns(),l=i.startColumn,u=i.endColumn;if(typeof o=="number"&&(i.startColumn=Math.max(l-o,0),i.endColumn=Math.min(u+o,a-1)),o==="auto"){const c=Math.ceil(u/a*6);i.startColumn=Math.max(l-c,0),i.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",i)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const i=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||i}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new Zw(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:n,height:s}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,s),this.eventManager.addEventListener(t,"mousedown",i=>{i.target===t&&i.which===3&&i.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",i=>{i.target===t&&i.which===3&&i.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(Ff(e))return!0;const t=TE(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&t||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Mr(Ji,this)}isSelectedOnlyCell(){var e,t;return(e=(t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const n=t.firstChild;if(!zt(n,"relative")){bu(t),this.appendRowHeader(e,t);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:s}=this.hot,i=n.createElement("div"),o=n.createElement("span");i.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,s),i.appendChild(o),t.appendChild(i)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const i=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(t.firstChild){const o=t.firstChild;zt(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,n,s),o.className="",dt(o,["relative",...i()])):(bu(t),this.appendColHeader(e,t,n,s))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),l=o.createElement("span"),u=i();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Yt(a,...mo()),Yt(l,...mo())),this.updateCellHeader(l,e,n,s),a.appendChild(l),t.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,t,s)}updateCellHeader(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=t;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(zt(e,"colHeader")?i=o.wtTable.columnFilter.sourceToRendered(t):zt(e,"rowHeader")&&(i=o.wtTable.rowFilter.sourceToRendered(t))),i>-1?Uj(e,n(t,s)):($h(e,""),dt(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,t){hs(py,this,e),hs(gy,this,t)}getLastSize(){return{width:Mr(py,this),height:Mr(gy,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Mr(my,this)}getRowHeadersCount(){return Mr(Gd,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return((t=this._wt.wtOverlays.getParentOverlay(e))!==null&&t!==void 0?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function _M(){return parseInt(this.hot.rootElement.getAttribute(Fp()[0]),10)}function S9(r){const e=Eh(Vf,this,_M).call(this)+r;Yt(this.hot.rootElement,...Fp(e))}const C9="ABCDEFGHIJKLMNOPQRSTUVWXYZ",BT=C9.length;function T9(r){let e=r+1,t="",n;for(;e>0;)n=(e-1)%BT,t=String.fromCharCode(65+n)+t,e=parseInt((e-n)/BT,10);return t}function xM(r){let e=0;return Array.isArray(r)&&(r[0]&&Array.isArray(r[0])?e=r[0].length:r[0]&&Fi(r[0])&&(e=xw(r[0]))),e}function Ec(r,e,t){return(e=b9(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function b9(r){var e=N9(r,"string");return typeof e=="symbol"?e:e+""}function N9(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class A9{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Ec(this,"hot",void 0),Ec(this,"data",void 0),Ec(this,"dataType","array"),Ec(this,"colToProp",()=>{}),Ec(this,"propToCol",()=>{}),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const t=[];return Je(this.data,(n,s)=>{const i=this.getAtCell(s,e);t.push(i)}),t}getAtRow(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=t===void 0&&n===void 0,{dataDotNotation:o}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],i?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):vs(t,n,u=>{l[u-t]=this.getAtPhysicalCell(e,u,a)});else if(Fi(a)||Bt(a))if(s?l=[]:l={},!i||s){const c=this.countFirstRowKeys()-1;vs(0,c,h=>{const d=this.colToProp(h);if(h>=(t||0)&&h<=(n||c)&&!Number.isInteger(d)){const m=this.getAtPhysicalCell(e,d,a);s?l.push(m):o?Xg(l,d,m):l[d]=m}})}else Lt(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);o?Xg(l,c,h):l[c]=h});return l}setAtCell(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const s=qs(n);this.hot.runHooks("modifySourceData",e,t,s,"set"),s.isTouched()&&(n=s.value)}Number.isInteger(t)?this.data[e][t]=n:Xg(this.data[e],t,n)}}getAtPhysicalCell(e,t,n){let s=null;if(n)if(typeof t=="string"){const{dataDotNotation:i}=this.hot.getSettings();s=i?h3(n,t):n[t]}else typeof t=="function"?s=t(n):s=n[t];if(this.hot.hasHook("modifySourceData")){const i=qs(s);this.hot.runHooks("modifySourceData",e,t,i,"get"),i.isTouched()&&(s=i.value)}return s}getAtCell(e,t){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=!1,i=null,o=null,a=null,l=null;e===null||t===null?(s=!0,i=0,a=this.countRows()-1):(i=Math.min(e.row,t.row),o=Math.min(e.col,t.col),a=Math.max(e.row,t.row),l=Math.max(e.col,t.col));const u=[];return vs(i,a,c=>{u.push(s?this.getAtRow(c,void 0,void 0,n):this.getAtRow(c,o,l,n))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return xM(this.data)}destroy(){this.data=null,this.hot=null}}function WT(r,e,t){return(e=O9(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function O9(r){var e=I9(r,"string");return typeof e=="symbol"?e:e+""}function I9(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Kh{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;WT(this,"indexedValues",[]),WT(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length?(this.indexedValues[e]=t,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Bt(this.initValueOrFn)?vs(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):vs(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}ur(Kh,Io);function LM(r,e,t,n){const s=t.length?t[0]:void 0;return[...r.slice(0,s),...t.map((i,o)=>Bt(n)?n(i,o):n),...s===void 0?[]:r.slice(s)]}function PM(r,e){return Nw(r,(t,n)=>e.includes(n)===!1)}class eR extends Kh{insert(e,t){this.indexedValues=LM(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=PM(this.indexedValues,e),super.remove(e)}}class FM extends eR{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Lp(this.getValues(),(e,t,n)=>(t&&e.push(n),e),[])}}function DM(r,e,t){return[...r.slice(0,e),...t,...r.slice(e)]}function Im(r,e){return Nw(r,t=>e.includes(t)===!1)}function HM(r,e){return Ja(r,t=>t-e.filter(n=>n<t).length)}function VM(r,e){const t=e[0],n=e.length;return Ja(r,s=>s>=t?s+n:s)}function M9(r,e,t){return(e=_9(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function _9(r){var e=x9(r,"string");return typeof e=="symbol"?e:e+""}function x9(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class L9 extends Kh{constructor(){super(...arguments),M9(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=t,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Im(this.orderOfIndexes,[e]),Bt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=LM(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=VM(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=PM(this.indexedValues,e),this.orderOfIndexes=Im(this.orderOfIndexes,e),this.orderOfIndexes=HM(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class UM extends eR{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Lp(this.getValues(),(e,t,n)=>(t&&e.push(n),e),[])}}class P9 extends Kh{constructor(){super(e=>e)}insert(e,t){const n=VM(this.indexedValues,t);this.indexedValues=DM(n,e,t),super.insert(e,t)}remove(e){const t=Im(this.indexedValues,e);this.indexedValues=HM(t,e),super.remove(e)}}const $T=new Map([["hiding",FM],["index",Kh],["linkedPhysicalIndexToValue",L9],["physicalIndexToValue",eR],["trimming",UM]]);function F9(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!$T.has(r))throw new Error(`The provided map type ("${r}") does not exist.`);return new($T.get(r))(e)}function D9(r,e,t){return(e=H9(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function H9(r){var e=V9(r,"string");return typeof e=="symbol"?e:e+""}function V9(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class tR{constructor(){D9(this,"collection",new Map)}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)))}unregister(e){const t=this.collection.get(e);at(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t))}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return Ln(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(n=>{n.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}ur(tR,Io);function yy(r,e,t){return(e=U9(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function U9(r){var e=k9(r,"string");return typeof e=="symbol"?e:e+""}function k9(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class GT extends tR{constructor(e,t){super(),yy(this,"mergedValuesCache",[]),yy(this,"aggregationFunction",void 0),yy(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const t=Ja(this.get(),i=>i.getValues()),n=[],s=at(t[0])&&t[0].length||0;for(let i=0;i<s;i+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(t[a][i]);n.push(o)}return Ja(n,this.aggregationFunction)}getMergedValueAtIndex(e,t){const n=this.getMergedValues(t)[e];return at(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function B9(r,e,t){W9(r,e),e.set(r,t)}function W9(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $9(r,e,t){return r.set(kM(r,e),t),t}function G9(r,e){return r.get(kM(r,e))}function kM(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ey=new WeakMap;class BM{constructor(){B9(this,Ey,[])}subscribe(e){return this.addLocalHook("change",e),this._write(G9(Ey,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){$9(Ey,this,e)}}ur(BM,Io);function zT(r,e){const t=[];let n=0,s=0;for(;n<r.length&&s<e.length;n++,s++)r[n]!==e[s]&&t.push({op:"replace",index:s,oldValue:r[n],newValue:e[s]});for(;n<e.length;n++)t.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;s<r.length;s++)t.push({op:"remove",index:s,oldValue:r[s],newValue:void 0});return t}function vc(r,e,t){z9(r,e),e.set(r,t)}function z9(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ds(r,e){return r.get(WM(r,e))}function Yd(r,e,t){return r.set(WM(r,e),t),t}function WM(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var jd=new WeakMap,wc=new WeakMap,Kd=new WeakMap,Xd=new WeakMap,qd=new WeakMap;class Y9{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};vc(this,jd,new Set),vc(this,wc,[]),vc(this,Kd,[]),vc(this,Xd,!1),vc(this,qd,!1),Yd(qd,this,e??!1)}createObserver(){const e=new BM;return ds(jd,this).add(e),e.addLocalHook("unsubscribe",()=>{ds(jd,this).delete(e)}),e._writeInitialChanges(zT(ds(wc,this),ds(Kd,this))),e}emit(e){let t=ds(Kd,this);(!ds(Xd,this)||ds(wc,this).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(ds(qd,this)):Yd(wc,this,new Array(e.length).fill(ds(qd,this))),ds(Xd,this)||(Yd(Xd,this,!0),t=ds(wc,this)));const n=zT(t,e);ds(jd,this).forEach(s=>s._write(n)),Yd(Kd,this,e)}}function dn(r,e,t){return(e=j9(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function j9(r){var e=K9(r,"string");return typeof e=="symbol"?e:e+""}function K9(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class FE{constructor(){dn(this,"indexesSequence",new P9),dn(this,"trimmingMapsCollection",new GT(e=>e.some(t=>t===!0),!1)),dn(this,"hidingMapsCollection",new GT(e=>e.some(t=>t===!0),!1)),dn(this,"variousMapsCollection",new tR),dn(this,"hidingChangesObservable",new Y9({initialIndexValue:!1})),dn(this,"notTrimmedIndexesCache",[]),dn(this,"notHiddenIndexesCache",[]),dn(this,"isBatched",!1),dn(this,"indexesSequenceChanged",!1),dn(this,"indexesChangeSource",void 0),dn(this,"trimmedIndexesChanged",!1),dn(this,"hiddenIndexesChanged",!1),dn(this,"renderablePhysicalIndexesCache",[]),dn(this,"fromPhysicalToVisualIndexesCache",new Map),dn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,n){return this.registerMap(e,F9(t,n))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof UM?this.trimmingMapsCollection.register(e,t):t instanceof FM?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const n=this.getNumberOfIndexes();return n>0&&t.init(n),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return at(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return at(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return at(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return at(t)?t:null}getNearestNotHiddenIndex(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const i=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return t>0?o=i.findIndex(a=>a>e):o=i.reverse().findIndex(a=>a<e),o===-1?n?this.getNearestNotHiddenIndex(e,-t,!1):null:i[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(s=>s+e);this.removeIndexes(n)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);const n=Ja(e,u=>this.getPhysicalFromVisualIndex(u)),s=this.getNotTrimmedIndexesLength(),i=e.length,o=Im(this.getIndexesSequence(),n),a=o.filter(u=>this.isTrimmed(u)===!1);let l=o.indexOf(a[a.length-1])+1;if(t+i<s){const u=a[t];l=o.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(DM(o,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const n=this.getNotTrimmedIndexes()[e],s=at(n)?n:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),o=Ja(new Array(t).fill(s),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,o),this.hidingMapsCollection.insertToEvery(i,o),this.variousMapsCollection.insertToEvery(i,o),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const n=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(n,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const n=this.getPhysicalFromRenderableIndex(t),s=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(s,t)}}}ur(FE,Io);function X9(r,e){return Lt(e,(t,n)=>{Ln(r[n])&&(r[n]=t)}),r}function $M(r){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(r);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:r}function GM(r){at(r)&&j3(Qn`Language with code "${r}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function q9(r,e){return Array.isArray(r)&&Number.isInteger(e)?r[e]:r}const{register:Q9,getValues:Z9}=Hu("phraseFormatters");function J9(r,e){Q9(r,e)}function eX(){return Z9()}J9("pluralize",q9);const zM="ContextMenu:items",We=zM,YM=`${We}.noItems`,jM=`${We}.insertRowAbove`,KM=`${We}.insertRowBelow`,XM=`${We}.insertColumnOnTheLeft`,qM=`${We}.insertColumnOnTheRight`,QM=`${We}.removeRow`,ZM=`${We}.removeColumn`,JM=`${We}.undo`,e0=`${We}.redo`,t0=`${We}.readOnly`,r0=`${We}.clearColumn`,n0=`${We}.copy`,s0=`${We}.copyWithHeaders`,i0=`${We}.copyWithGroupHeaders`,o0=`${We}.copyHeadersOnly`,a0=`${We}.cut`,l0=`${We}.freezeColumn`,u0=`${We}.unfreezeColumn`,c0=`${We}.mergeCells`,h0=`${We}.unmergeCells`,d0=`${We}.addComment`,f0=`${We}.editComment`,m0=`${We}.removeComment`,p0=`${We}.readOnlyComment`,g0=`${We}.align`,y0=`${We}.align.left`,E0=`${We}.align.center`,v0=`${We}.align.right`,w0=`${We}.align.justify`,R0=`${We}.align.top`,S0=`${We}.align.middle`,C0=`${We}.align.bottom`,T0=`${We}.borders`,b0=`${We}.borders.top`,N0=`${We}.borders.right`,A0=`${We}.borders.bottom`,O0=`${We}.borders.left`,I0=`${We}.borders.remove`,M0=`${We}.nestedHeaders.insertChildRow`,_0=`${We}.nestedHeaders.detachFromParent`,x0=`${We}.hideColumn`,L0=`${We}.showColumn`,P0=`${We}.hideRow`,F0=`${We}.showRow`,Bn="Filters:",tr=`${Bn}conditions`,D0=`${tr}.none`,H0=`${tr}.isEmpty`,V0=`${tr}.isNotEmpty`,U0=`${tr}.isEqualTo`,k0=`${tr}.isNotEqualTo`,B0=`${tr}.beginsWith`,W0=`${tr}.endsWith`,$0=`${tr}.contains`,G0=`${tr}.doesNotContain`,tX=`${tr}.byValue`,z0=`${tr}.greaterThan`,Y0=`${tr}.greaterThanOrEqualTo`,j0=`${tr}.lessThan`,K0=`${tr}.lessThanOrEqualTo`,X0=`${tr}.isBetween`,q0=`${tr}.isNotBetween`,Q0=`${tr}.after`,Z0=`${tr}.before`,J0=`${tr}.today`,e_=`${tr}.tomorrow`,t_=`${tr}.yesterday`,r_=`${Bn}labels.filterByCondition`,n_=`${Bn}labels.filterByValue`,s_=`${Bn}labels.conjunction`,i_=`${Bn}labels.disjunction`,o_=`${Bn}values.blankCells`,a_=`${Bn}buttons.selectAll`,l_=`${Bn}buttons.clear`,u_=`${Bn}buttons.ok`,c_=`${Bn}buttons.cancel`,h_=`${Bn}buttons.placeholder.search`,d_=`${Bn}buttons.placeholder.value`,f_=`${Bn}buttons.placeholder.secondValue`,rR="CheckboxRenderer:",m_=`${rR}checked`,p_=`${rR}unchecked`,rX=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:m_,CHECKBOX_RENDERER_NAMESPACE:rR,CHECKBOX_UNCHECKED:p_,CONTEXTMENU_ITEMS_ADD_COMMENT:d0,CONTEXTMENU_ITEMS_ALIGNMENT:g0,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:C0,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:E0,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:w0,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:y0,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:S0,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:v0,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:R0,CONTEXTMENU_ITEMS_BORDERS:T0,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:A0,CONTEXTMENU_ITEMS_BORDERS_LEFT:O0,CONTEXTMENU_ITEMS_BORDERS_RIGHT:N0,CONTEXTMENU_ITEMS_BORDERS_TOP:b0,CONTEXTMENU_ITEMS_CLEAR_COLUMN:r0,CONTEXTMENU_ITEMS_COPY:n0,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:o0,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:i0,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:s0,CONTEXTMENU_ITEMS_CUT:a0,CONTEXTMENU_ITEMS_EDIT_COMMENT:f0,CONTEXTMENU_ITEMS_FREEZE_COLUMN:l0,CONTEXTMENU_ITEMS_HIDE_COLUMN:x0,CONTEXTMENU_ITEMS_HIDE_ROW:P0,CONTEXTMENU_ITEMS_INSERT_LEFT:XM,CONTEXTMENU_ITEMS_INSERT_RIGHT:qM,CONTEXTMENU_ITEMS_MERGE_CELLS:c0,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:_0,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:M0,CONTEXTMENU_ITEMS_NO_ITEMS:YM,CONTEXTMENU_ITEMS_READ_ONLY:t0,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:p0,CONTEXTMENU_ITEMS_REDO:e0,CONTEXTMENU_ITEMS_REMOVE_BORDERS:I0,CONTEXTMENU_ITEMS_REMOVE_COLUMN:ZM,CONTEXTMENU_ITEMS_REMOVE_COMMENT:m0,CONTEXTMENU_ITEMS_REMOVE_ROW:QM,CONTEXTMENU_ITEMS_ROW_ABOVE:jM,CONTEXTMENU_ITEMS_ROW_BELOW:KM,CONTEXTMENU_ITEMS_SHOW_COLUMN:L0,CONTEXTMENU_ITEMS_SHOW_ROW:F0,CONTEXTMENU_ITEMS_UNDO:JM,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:u0,CONTEXTMENU_ITEMS_UNMERGE_CELLS:h0,CONTEXT_MENU_ITEMS_NAMESPACE:zM,FILTERS_BUTTONS_CANCEL:c_,FILTERS_BUTTONS_CLEAR:l_,FILTERS_BUTTONS_OK:u_,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:h_,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:f_,FILTERS_BUTTONS_PLACEHOLDER_VALUE:d_,FILTERS_BUTTONS_SELECT_ALL:a_,FILTERS_CONDITIONS_AFTER:Q0,FILTERS_CONDITIONS_BEFORE:Z0,FILTERS_CONDITIONS_BEGINS_WITH:B0,FILTERS_CONDITIONS_BETWEEN:X0,FILTERS_CONDITIONS_BY_VALUE:tX,FILTERS_CONDITIONS_CONTAINS:$0,FILTERS_CONDITIONS_EMPTY:H0,FILTERS_CONDITIONS_ENDS_WITH:W0,FILTERS_CONDITIONS_EQUAL:U0,FILTERS_CONDITIONS_GREATER_THAN:z0,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:Y0,FILTERS_CONDITIONS_LESS_THAN:j0,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:K0,FILTERS_CONDITIONS_NAMESPACE:tr,FILTERS_CONDITIONS_NONE:D0,FILTERS_CONDITIONS_NOT_BETWEEN:q0,FILTERS_CONDITIONS_NOT_CONTAIN:G0,FILTERS_CONDITIONS_NOT_EMPTY:V0,FILTERS_CONDITIONS_NOT_EQUAL:k0,FILTERS_CONDITIONS_TODAY:J0,FILTERS_CONDITIONS_TOMORROW:e_,FILTERS_CONDITIONS_YESTERDAY:t_,FILTERS_DIVS_FILTER_BY_CONDITION:r_,FILTERS_DIVS_FILTER_BY_VALUE:n_,FILTERS_LABELS_CONJUNCTION:s_,FILTERS_LABELS_DISJUNCTION:i_,FILTERS_NAMESPACE:Bn,FILTERS_VALUES_BLANK_CELLS:o_},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const g_={languageCode:"en-US",[YM]:"No available options",[jM]:"Insert row above",[KM]:"Insert row below",[XM]:"Insert column left",[qM]:"Insert column right",[QM]:["Remove row","Remove rows"],[ZM]:["Remove column","Remove columns"],[JM]:"Undo",[e0]:"Redo",[t0]:"Read only",[r0]:"Clear column",[g0]:"Alignment",[y0]:"Left",[E0]:"Center",[v0]:"Right",[w0]:"Justify",[R0]:"Top",[S0]:"Middle",[C0]:"Bottom",[l0]:"Freeze column",[u0]:"Unfreeze column",[T0]:"Borders",[b0]:"Top",[N0]:"Right",[A0]:"Bottom",[O0]:"Left",[I0]:"Remove border(s)",[d0]:"Add comment",[f0]:"Edit comment",[m0]:"Delete comment",[p0]:"Read-only comment",[c0]:"Merge cells",[h0]:"Unmerge cells",[n0]:"Copy",[s0]:["Copy with header","Copy with headers"],[i0]:["Copy with group header","Copy with group headers"],[o0]:["Copy header only","Copy headers only"],[a0]:"Cut",[M0]:"Insert child row",[_0]:"Detach from parent",[x0]:["Hide column","Hide columns"],[L0]:["Show column","Show columns"],[P0]:["Hide row","Hide rows"],[F0]:["Show row","Show rows"],[D0]:"None",[H0]:"Is empty",[V0]:"Is not empty",[U0]:"Is equal to",[k0]:"Is not equal to",[B0]:"Begins with",[W0]:"Ends with",[$0]:"Contains",[G0]:"Does not contain",[z0]:"Greater than",[Y0]:"Greater than or equal to",[j0]:"Less than",[K0]:"Less than or equal to",[X0]:"Is between",[q0]:"Is not between",[Q0]:"After",[Z0]:"Before",[J0]:"Today",[e_]:"Tomorrow",[t_]:"Yesterday",[o_]:"Blank cells",[r_]:"Filter by condition",[n_]:"Filter by value",[s_]:"And",[i_]:"Or",[a_]:"Select all",[l_]:"Clear",[u_]:"OK",[c_]:"Cancel",[h_]:"Search",[d_]:"Value",[f_]:"Second value",[m_]:"Checked",[p_]:"Unchecked"},nX=rX,DE=g_.languageCode,{register:sX,getItem:y_,hasItem:iX,getValues:oX}=Hu("languagesDictionaries");E_(g_);function E_(r,e){let t=r,n=e;return Fi(r)&&(n=r,t=n.languageCode),aX(t,n),sX(t,oa(n)),oa(n)}function aX(r,e){r!==DE&&X9(e,y_(DE))}function v_(r){return nR(r)?oa(y_(r)):null}function nR(r){return iX(r)}function lX(){return oX()}function w_(r,e,t){const n=v_(r);if(n===null)return null;const s=n[e];if(Ln(s))return null;const i=uX(s,t);return Array.isArray(i)?i[0]:i}function uX(r,e){let t=r;return Je(eX(),n=>{t=n(r,e)}),t}function cX(r){let e=$M(r);return nR(e)||(e=DE,GM(r)),e}function hX(r,e,t){return(e=dX(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function dX(r){var e=fX(r,"string");return typeof e=="symbol"?e:e+""}function fX(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Mo extends TM{constructor(e,t){super(e,null),hX(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:n}=e,s=this.getNearestNotHiddenCoords(t,1),i=this.getNearestNotHiddenCoords(n,-1);return s===null||i===null?null:((s.row>i.row||s.col>i.col)&&(s=t,i=n),this.settings.createCellRange(s,s,i))}getNearestNotHiddenCoords(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const s=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(s===null)return null;const i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return i===null?null:this.settings.createCellCoords(s,i)}getNearestNotHiddenIndex(e,t,n){return t<0?t:e.getNearestNotHiddenIndex(t,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,s=e.getHorizontalDirection()==="W-E"?1:-1,i=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((i===null||i.col===null||i.row===null)&&(o=this.getNearestNotHiddenCoords(t,n,s)),o!==null&&e.overlaps(o)){const a=e.highlight.clone();if(a.row>=0&&(a.row=o.row),a.col>=0&&(a.col=o.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&i!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const n=this.settings.visualToRenderableCoords(e),s=this.settings.visualToRenderableCoords(t);return n.row===null||n.col===null||s.row===null||s.col===null?null:this.settings.createCellRange(n,n,s)}}function vy(r){let{activeHeaderClassName:e,...t}=r;return new Mo({className:e,...t,selectionType:U5})}function mX(r){let{areaCornerVisible:e,...t}=r;return new Mo({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...t,selectionType:Gw})}function pX(r){let{...e}=r;return new Mo({className:"highlight",...e,selectionType:Gw})}function gX(r){let{columnClassName:e,...t}=r;return new Mo({className:e,...t,selectionType:W5})}function yX(r){let{cellCornerVisible:e,...t}=r;return new Mo({className:"current",headerAttributes:[BI()],border:{width:2,color:"#4b89ff",cornerVisible:e},...t,selectionType:zw})}function EX(r){let{border:e,visualCellRange:t,...n}=r;return new Mo({...e,...n,selectionType:$5},t)}function vX(r){let{...e}=r;return new Mo({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:k5})}function YT(r){let{headerClassName:e,...t}=r;return new Mo({className:e,...t,selectionType:bM})}function wX(r){let{rowClassName:e,...t}=r;return new Mo({className:e,...t,selectionType:B5})}function RX(r,e){SX(r,e),e.add(r)}function SX(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bn(r,e,t){return(e=CX(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function CX(r){var e=TX(r,"string");return typeof e=="symbol"?e:e+""}function TX(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function eo(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var yi=new WeakSet;class bX{constructor(e){RX(this,yi),bn(this,"options",void 0),bn(this,"layerLevel",0),bn(this,"focus",void 0),bn(this,"fill",void 0),bn(this,"layeredAreas",new Map),bn(this,"areas",new Map),bn(this,"rowHeaders",new Map),bn(this,"columnHeaders",new Map),bn(this,"activeRowHeaders",new Map),bn(this,"activeColumnHeaders",new Map),bn(this,"activeCornerHeaders",new Map),bn(this,"rowHighlights",new Map),bn(this,"columnHighlights",new Map),bn(this,"customSelections",[]),this.options=e,this.focus=yX(e),this.fill=vX(e)}isEnabledFor(e,t){let n=e;e===zw&&(n="current");let s=this.options.disabledCellSelection(t.row,t.col);return typeof s=="string"&&(s=[s]),s===!1||Array.isArray(s)&&!s.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return eo(yi,this,to).call(this,this.layeredAreas,mX)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return eo(yi,this,to).call(this,this.areas,pX)}getAreas(){return[...this.areas.values()]}createRowHeader(){return eo(yi,this,to).call(this,this.rowHeaders,YT)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return eo(yi,this,to).call(this,this.columnHeaders,YT)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return eo(yi,this,to).call(this,this.activeRowHeaders,vy)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return eo(yi,this,to).call(this,this.activeColumnHeaders,vy)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return eo(yi,this,to).call(this,this.activeCornerHeaders,vy)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return eo(yi,this,to).call(this,this.rowHighlights,wX)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return eo(yi,this,to).call(this,this.columnHighlights,gX)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(EX({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),Je(this.areas.values(),e=>void e.clear()),Je(this.layeredAreas.values(),e=>void e.clear()),Je(this.rowHeaders.values(),e=>void e.clear()),Je(this.columnHeaders.values(),e=>void e.clear()),Je(this.activeRowHeaders.values(),e=>void e.clear()),Je(this.activeColumnHeaders.values(),e=>void e.clear()),Je(this.activeCornerHeaders.values(),e=>void e.clear()),Je(this.rowHighlights.values(),e=>void e.clear()),Je(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function to(r,e){const t=this.layerLevel;if(r.has(t))return r.get(t);const n=e({layerLevel:t,...this.options});return r.set(t,n),n}function jT(r,e,t){return(e=NX(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function NX(r){var e=AX(r,"string");return typeof e=="symbol"?e:e+""}function AX(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class OX{constructor(e){jT(this,"ranges",[]),jT(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function IX(r,e){R_(r,e),e.add(r)}function wy(r,e,t){R_(r,e),e.set(r,t)}function R_(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ut(r,e){return r.get(mr(r,e))}function Qd(r,e,t){return r.set(mr(r,e),t),t}function mr(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Zd=new WeakMap,Mt=new WeakMap,ei=new WeakMap,Tr=new WeakSet;class HE{constructor(e,t){IX(this,Tr),wy(this,Zd,void 0),wy(this,Mt,void 0),wy(this,ei,{x:0,y:0}),Qd(Zd,this,e),Qd(Mt,this,t)}transformStart(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=ut(Mt,this).createCellCoords(e,t);let i=ut(Zd,this).current().highlight;const o=ut(Mt,this).visualToRenderableCoords(i);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",s),o.row!==null&&o.col!==null){const{width:u,height:c}=mr(Tr,this,S_).call(this),{row:h,col:d}=mr(Tr,this,XT).call(this,i),m=ut(Mt,this).fixedRowsBottom(),E=ut(Mt,this).minSpareRows(),g=ut(Mt,this).minSpareCols(),O=ut(Mt,this).autoWrapRow(),T=ut(Mt,this).autoWrapCol(),_=ut(Mt,this).createCellCoords(h+s.row,d+s.col);if(_.row>=c){const Q=qs(n&&E>0&&m===0),oe=_.col+1,re=ut(Mt,this).createCellCoords(_.row-c,oe>=u?oe-u:oe);this.runLocalHooks("beforeColumnWrap",Q,mr(Tr,this,Dl).call(this,re),oe>=u),Q.value?this.runLocalHooks("insertRowRequire",ut(Mt,this).countRenderableRows()):T&&_.assign(re)}else if(_.row<0){const Q=qs(T),oe=_.col-1,re=ut(Mt,this).createCellCoords(c+_.row,oe<0?u+oe:oe);this.runLocalHooks("beforeColumnWrap",Q,mr(Tr,this,Dl).call(this,re),oe<0),T&&_.assign(re)}if(_.col>=u){const Q=qs(n&&g>0),oe=_.row+1,re=ut(Mt,this).createCellCoords(oe>=c?oe-c:oe,_.col-u);this.runLocalHooks("beforeRowWrap",Q,mr(Tr,this,Dl).call(this,re),oe>=c),Q.value?this.runLocalHooks("insertColRequire",ut(Mt,this).countRenderableColumns()):O&&_.assign(re)}else if(_.col<0){const Q=qs(O),oe=_.row-1,re=ut(Mt,this).createCellCoords(oe<0?c+oe:oe,u+_.col);this.runLocalHooks("beforeRowWrap",Q,mr(Tr,this,Dl).call(this,re),oe<0),O&&_.assign(re)}const{rowDir:V,colDir:H}=mr(Tr,this,KT).call(this,_);a=V,l=H,i=mr(Tr,this,Dl).call(this,_)}return this.runLocalHooks("afterTransformStart",i,a,l),i}transformEnd(e,t){const n=ut(Mt,this).createCellCoords(e,t),s=ut(Zd,this).current(),i=ut(Mt,this).visualToRenderableCoords(s.highlight),o=mr(Tr,this,Ry).call(this,s.to.row,s.from.row),a=mr(Tr,this,Sy).call(this,s.to.col,s.from.col),l=s.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",n),i.row!==null&&i.col!==null&&o!==null&&a!==null){const{row:h,col:d}=mr(Tr,this,XT).call(this,s.highlight),m=ut(Mt,this).createCellCoords(o+n.row,a+n.col),E=s.getTopStartCorner(),g=s.getTopEndCorner(),O=s.getBottomEndCorner();if(n.col<0&&a>=d&&m.col<d){const H=m.col-d;m.col=mr(Tr,this,Sy).call(this,E.col,g.col)+H}else if(n.col>0&&a<=d&&m.col>d){const H=mr(Tr,this,Sy).call(this,g.col,E.col),Q=Math.max(m.col-H,1);m.col=H+Q}if(n.row<0&&o>=h&&m.row<h){const H=m.row-h;m.row=mr(Tr,this,Ry).call(this,E.row,O.row)+H}else if(n.row>0&&o<=h&&m.row>h){const H=mr(Tr,this,Ry).call(this,O.row,E.row),Q=Math.max(m.row-H,1);m.row=H+Q}const{rowDir:T,colDir:_}=mr(Tr,this,KT).call(this,m);u=T,c=_;const V=mr(Tr,this,Dl).call(this,m);n.row===0&&n.col!==0?l.col=V.col:n.row!==0&&n.col===0?l.row=V.row:(l.row=V.row,l.col=V.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:t,y:n}=e;Qd(ei,this,{x:t,y:n})}resetOffsetSize(){Qd(ei,this,{x:0,y:0})}}function KT(r){const{width:e,height:t}=mr(Tr,this,S_).call(this);let n=0,s=0;return r.row<0?(n=-1,r.row=0):r.row>0&&r.row>=t&&(n=1,r.row=t-1),r.col<0?(s=-1,r.col=0):r.col>0&&r.col>=e&&(s=1,r.col=e-1),{rowDir:n,colDir:s}}function S_(){return{width:ut(ei,this).x+ut(Mt,this).countRenderableColumns(),height:ut(ei,this).y+ut(Mt,this).countRenderableRows()}}function Ry(r,e){const t=ut(Mt,this).findFirstNonHiddenRenderableRow(r,e);return t===null?null:ut(ei,this).y+t}function Sy(r,e){const t=ut(Mt,this).findFirstNonHiddenRenderableColumn(r,e);return t===null?null:ut(ei,this).x+t}function XT(r){const{row:e,col:t}=ut(Mt,this).visualToRenderableCoords(r);if(e===null||t===null)throw new Error("Renderable coords are not visible.");return ut(Mt,this).createCellCoords(ut(ei,this).y+e,ut(ei,this).x+t)}function Dl(r){const e=r.clone();return e.col=r.col-ut(ei,this).x,e.row=r.row-ut(ei,this).y,ut(Mt,this).renderableToVisualCoords(e)}ur(HE,Io);const C_=0,T_=1,b_=2,sR=3,MX=[sR,b_],_X=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Cy=Symbol("root"),qT=Symbol("child");function N_(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cy;if(e!==Cy&&e!==qT)throw new Error("The second argument is used internally only and cannot be overwritten.");const t=Array.isArray(r),n=e===Cy;let s=C_;if(t){const i=r[0];r.length===0?s=T_:n&&i instanceof zh?s=sR:n&&Array.isArray(i)?s=N_(i,qT):r.length>=2&&r.length<=4&&!r.some((a,l)=>!_X[l].includes(typeof a))&&(s=b_)}return s}function xX(r){let{createCellCoords:e,createCellRange:t,keepDirection:n=!1,propToCol:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!MX.includes(r))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){const o=r===sR;let a=o?i.from.row:i[0],l=o?i.from.col:i[1],u=o?i.to.row:i[2],c=o?i.to.col:i[3];if(typeof s=="function"&&(typeof l=="string"&&(l=s(l)),typeof c=="string"&&(c=s(c))),Ln(u)&&(u=a),Ln(c)&&(c=l),!n){const m=a,E=l,g=u,O=c;a=Math.min(m,g),l=Math.min(E,O),u=Math.max(m,g),c=Math.max(E,O)}const h=e(a,l),d=e(u,c);return t(h,h,d)}}function Hl(r,e,t){LX(r,e),e.set(r,t)}function LX(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function La(r,e,t){return(e=PX(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function PX(r){var e=FX(r,"string");return typeof e=="symbol"?e:e+""}function FX(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function xt(r,e){return r.get(A_(r,e))}function Ei(r,e,t){return r.set(A_(r,e),t),t}function A_(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Qr=new WeakMap,Pa=new WeakMap,Jd=new WeakMap,Rc=new WeakMap,ef=new WeakMap,Sc=new WeakMap;class O_{constructor(e,t){var n=this;La(this,"settings",void 0),La(this,"tableProps",void 0),La(this,"inProgress",!1),La(this,"selectedRange",new OX((s,i,o)=>this.tableProps.createCellRange(s,i,o))),La(this,"highlight",void 0),Hl(this,Qr,void 0),Hl(this,Pa,void 0),La(this,"selectedByRowHeader",new Set),La(this,"selectedByColumnHeader",new Set),Hl(this,Jd,!1),Hl(this,Rc,!1),Hl(this,ef,"unknown"),Hl(this,Sc,-1),this.settings=e,this.tableProps=t,this.highlight=new bX({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[BI()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(s,i)=>this.tableProps.isDisabledCellSelection(s,i),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),createCellCoords:(s,i)=>this.tableProps.createCellCoords(s,i),createCellRange:(s,i,o)=>this.tableProps.createCellRange(s,i,o)}),Ei(Qr,this,new HE(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(s,i)=>this.tableProps.createCellCoords(s,i),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Ei(Pa,this,new HE(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const s=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,s.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const s=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,s.getOuterBottomEndCorner().col)},visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(s,i)=>this.tableProps.createCellCoords(s,i),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),xt(Qr,this).addLocalHook("beforeTransformStart",function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformStart",...i)}),xt(Qr,this).addLocalHook("afterTransformStart",function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return n.runLocalHooks("afterModifyTransformStart",...i)}),xt(Qr,this).addLocalHook("beforeTransformEnd",function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformEnd",...i)}),xt(Qr,this).addLocalHook("afterTransformEnd",function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return n.runLocalHooks("afterModifyTransformEnd",...i)}),xt(Qr,this).addLocalHook("insertRowRequire",function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return n.runLocalHooks("insertRowRequire",...i)}),xt(Qr,this).addLocalHook("insertColRequire",function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return n.runLocalHooks("insertColRequire",...i)}),xt(Qr,this).addLocalHook("beforeRowWrap",function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return n.runLocalHooks("beforeRowWrap",...i)}),xt(Qr,this).addLocalHook("beforeColumnWrap",function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return n.runLocalHooks("beforeColumnWrap",...i)}),xt(Pa,this).addLocalHook("beforeTransformStart",function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformFocus",...i)}),xt(Pa,this).addLocalHook("afterTransformStart",function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return n.runLocalHooks("afterModifyTransformFocus",...i)})}getSelectedRange(){return this.selectedRange}markSource(e){Ei(ef,this,e)}markEndSource(){Ei(ef,this,"unknown")}getSelectionSource(){return xt(ef,this)}setExpectedLayers(e){Ei(Sc,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Ei(Sc,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const i=this.settings.selectionMode==="multiple",o=Ln(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,a=e.clone();Ei(Jd,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!i||i&&!o&&Ln(t))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(s.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,t,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),n=this.tableProps.countRows(),s=this.tableProps.countCols(),i=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||s>0)&&(n===0&&t.col<0&&!i||s===0&&t.row<0&&!i))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),this.settings.selectionMode==="single")o.setFrom(o.highlight),o.setTo(o.highlight);else{const l=o.getHorizontalDirection(),u=o.getVerticalDirection(),c=this.isMultiple();o.setTo(t),c&&(l!==o.getHorizontalDirection()||o.getWidth()===1&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),c&&(u!==o.getVerticalDirection()||o.getHeight()===1&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}n>0&&s>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=xt(Sc,this)===-1||this.selectedRange.size()===xt(Sc,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),s=this.tableProps.countCols();t<this.highlight.layerLevel&&(Je(this.highlight.getAreas(),E=>void E.clear()),Je(this.highlight.getLayeredAreas(),E=>void E.clear()),Je(this.highlight.getRowHeaders(),E=>void E.clear()),Je(this.highlight.getColumnHeaders(),E=>void E.clear()),Je(this.highlight.getActiveRowHeaders(),E=>void E.clear()),Je(this.highlight.getActiveColumnHeaders(),E=>void E.clear()),Je(this.highlight.getActiveCornerHeaders(),E=>void E.clear()),Je(this.highlight.getRowHighlights(),E=>void E.clear()),Je(this.highlight.getColumnHighlights(),E=>void E.clear())),this.highlight.useLayerLevel(t);const i=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),m=this.highlight.createColumnHighlight();if(i.clear(),o.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),m.clear(),this.highlight.isEnabledFor(Gw,e.highlight)&&(this.isMultiple()||t>=1)&&(i.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),t===1)){const E=this.selectedRange.previous();this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(E.from).commit().syncWith(E),this.highlight.createLayeredArea().add(E.from).commit().syncWith(E),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(bM,e.highlight)){if(!e.isSingleHeader()){const O=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),T=this.tableProps.createCellCoords(e.to.row,-1),_=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),V=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(O).commit(),l.add(_).commit(),d.add(O).commit(),m.add(_).commit()):(a.add(O).add(T).commit(),l.add(_).add(V).commit(),d.add(O).add(T).commit(),m.add(_).add(V).commit())}const E=!xt(Rc,this)&&this.isEntireRowSelected()&&(s>0&&s===e.getWidth()||s===0&&this.isSelectedByRowHeader()),g=!xt(Rc,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());E&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),g&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),E&&g&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const t=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(zw,t.highlight)&&n.add(t.highlight).commit().syncWith(t),this.inProgress||(Ei(Jd,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?xt(Qr,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):xt(Qr,this).resetOffsetSize(),this.setRangeStart(xt(Qr,this).transformStart(e,t,n))}transformEnd(e,t){this.settings.navigableHeaders?xt(Qr,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):xt(Qr,this).resetOffsetSize(),this.setRangeEnd(xt(Qr,this).transformEnd(e,t))}transformFocus(e,t){const n=this.selectedRange.current(),{row:s,col:i}=n.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,i-1),a=this.tableProps.countRenderableRowsInRange(0,s-1);n.highlight.isHeader()?xt(Pa,this).setOffsetSize({x:i<0?Math.abs(i):-o,y:s<0?Math.abs(s):-a}):xt(Pa,this).setOffsetSize({x:i<0?0:-o,y:s<0?0:-a});const l=xt(Pa,this).transformStart(e,t);this.setRangeFocus(l.normalize())}shiftRows(e,t){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:s,to:i,highlight:o}=n,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:t;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(qt(s.row+h,c,a-1),s.col),m=this.tableProps.createCellCoords(qt(i.row+t,c,a-1),i.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(qt(o.row+t,0,a-1),o.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(m),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:s,to:i,highlight:o}=n,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:t;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(s.row,qt(s.col+h,c,a-1)),m=this.tableProps.createCellCoords(i.row,qt(i.col+t,c,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(o.row,qt(o.col+t,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(m),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=qs(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&xt(Jd,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=s=>{const{col:i}=s.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(o>0&&i<0||o===0)&&s.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(s=>t(s));const n=this.selectedRange.peekByIndex(e);return n?t(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=s=>{const{row:i}=s.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(o>0&&i<0||o===0)&&s.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(s=>t(s));const n=this.selectedRange.peekByIndex(e);return n?t(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return t.row!==null&&t.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const i=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=n?-l:0,c=t?-a:0;if(u===0&&c===0&&(i===0||o===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:m}=s;Ei(Rc,this,m),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(qt(d.row,u,i-1),qt(d.col,c,o-1)));const E=this.tableProps.createCellCoords(u,c),g=this.tableProps.createCellCoords(i-1,o-1);this.clear(),this.setRangeStartOnly(E,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.finish(),Ei(Rc,this,!1)}selectCells(e){var t=this;const n=N_(e);if(n===T_)return!1;if(n===C_)throw new Error(Qn`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const s=xX(n,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),i=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:i?this.tableProps.countRowHeaders():0,countColHeaders:i?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=s(l),c=u.isValid(o);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),Je(e,l=>{const{from:u,to:c}=s(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const s=typeof e=="string"?this.tableProps.propToCol(e):e,i=typeof t=="string"?this.tableProps.propToCol(t):t,o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,s),h=this.tableProps.createCellCoords(o-1,i),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let m=0,E=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(m=qt(n.row,u,o-1),E=qt(n.col,Math.min(s,i),Math.max(s,i))):(m=qt(n,u,o-1),E=s);const g=this.tableProps.createCellCoords(m,E),O=l===0?0:qt(g.row,u,-1),T=o-1,_=this.tableProps.createCellCoords(O,s),V=this.tableProps.createCellCoords(T,i);this.runLocalHooks("beforeSelectColumns",_,V,g),_.row=O,V.row=T,this.setRangeStartOnly(_,void 0,g),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(V),this.runLocalHooks("afterSelectColumns",_,V,g),this.finish()}return d}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const s=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=o===0?0:-o,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(t,i-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:s,countCols:i,countRowHeaders:o,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(h=qt(n.row,Math.min(e,t),Math.max(e,t)),d=qt(n.col,a,i-1)):(h=e,d=qt(n,a,i-1));const m=this.tableProps.createCellCoords(h,d),E=o===0?0:qt(m.col,a,-1),g=i-1,O=this.tableProps.createCellCoords(e,E),T=this.tableProps.createCellCoords(t,g);this.runLocalHooks("beforeSelectRows",O,T,m),O.col=E,T.col=g,this.setRangeStartOnly(O,void 0,m),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectRows",O,T,m),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),t=this.tableProps.countCols();if(e===0||t===0){this.deselect();return}const n=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:s,to:i,highlight:o}=n;this.clear(),o.assign({row:qt(o.row,-1/0,e-1),col:qt(o.col,-1/0,t-1)}),s.assign({row:qt(s.row,-1/0,e-1),col:qt(s.col,-1/0,t-1)}),i.assign({row:qt(i.row,0,e-1),col:qt(i.col,0,t-1)}),this.selectedRange.ranges.push(n),this.highlight.getFocus().add(o).commit().syncWith(n),this.applyAndCommit(n)}commit(){if(this.highlight.getCustomSelections().forEach(s=>{s.commit()}),!this.isSelected())return;const t=this.highlight.getFocus(),n=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let s=0;s<this.selectedRange.size();s+=1){this.highlight.useLayerLevel(s);const i=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),m=this.highlight.createColumnHighlight();i.commit(),o.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),m.commit()}this.highlight.useLayerLevel(n)}}ur(O_,Io);function QT(r){let e,t,n,s,i="",o;for(e=0,t=r.length;e<t;e+=1){for(s=r[e].length,n=0;n<s;n+=1)n>0&&(i+="	"),o=r[e][n],typeof o=="string"?o.indexOf(`
`)>-1?i+=`"${o.replace(/"/g,'""')}"`:i+=o:o==null?i+="":i+=o;e!==t-1&&(i+=`
`)}return i}function Fa(r,e,t){return(e=DX(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function DX(r){var e=HX(r,"string");return typeof e=="symbol"?e:e+""}function HX(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class eu{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,n){Fa(this,"hot",void 0),Fa(this,"metaManager",void 0),Fa(this,"tableMeta",void 0),Fa(this,"dataSource",void 0),Fa(this,"duckSchema",void 0),Fa(this,"colToPropCache",void 0),Fa(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,t){let s=0,i=0,o=!1;if(typeof t=="function"){const a=xw(e);s=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;s=Math.min(a,t.length)}for(n=0;n<s;n++){const a=o?t(n):t[n];if(Fi(a)){if(typeof a.data<"u"){const l=o?i:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}i+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return xM(this.dataSource)}recursiveDuckColumns(e,t,n){let s=t,i=n,o;return typeof s>"u"&&(s=0,i=""),typeof e=="object"&&!Array.isArray(e)&&Lt(e,(a,l)=>{a===null?(o=i+l,this.colToPropCache.push(o),this.propToColCache.set(o,s),s+=1):s=this.recursiveDuckColumns(a,s,`${l}.`)}),s}colToProp(e){if(Number.isInteger(e)===!1)return e;const t=this.hot.toPhysicalColumn(e);return t===null?e:this.colToPropCache&&at(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(at(t))return this.hot.toVisualColumn(t);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?yh(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:s="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=this.hot.countSourceRows();let o=i,a=0,l=e;if((typeof l!="number"||l>=i)&&(l=i),l<this.hot.countRows()&&(o=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,t,n)===!1||o===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<t&&i+a<c;){let E=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?E=oa(this.getSchema()):(E=[],vs(h-1,()=>E.push(null))):this.hot.dataType==="function"?E=this.tableMeta.dataSchema(l+a):(E={},tM(E,this.getSchema())),d.push(E),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),s==="below"&&(o=Math.min(o+1,i)),this.spliceData(o,0,d);const m=this.hot.toVisualRow(o);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(o,t)),this.hot.runHooks("afterCreateRow",m,a,n),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:o}}createCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:s="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const i=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,t,n)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),m=0,E=c;s==="end"&&(E=Math.min(E+1,a));const g=E;for(;m<t&&d<o;){if(typeof l!="number"||l>=d)if(h>0)for(let T=0;T<h;T+=1)typeof i[T]>"u"&&(i[T]=[]),i[T].push(null);else i.push([null]);else for(let T=0;T<h;T++)i[T].splice(E,0,null);m+=1,E+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,m),m>0&&(e==null?this.metaManager.createColumn(null,m):n!=="auto"&&this.metaManager.createColumn(g,t));const O=this.hot.toVisualColumn(g);return this.hot.runHooks("afterCreateCol",O,m,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:m,startPhysicalIndex:g}}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,s=Number.isInteger(e)?e:-t;const i=this.visualRowsToPhysical(s,t),o=this.hot.countSourceRows();if(s=(o+s)%o,this.hot.runHooks("beforeRemoveRow",s,i.length,i,n)===!1)return!1;const l=i.length;if(this.filterData(s,l,i),s<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(i);const c=at(this.tableMeta.columns)||at(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return i.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",s,l,i,n),this.hot.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let s=typeof e!="number"?-t:e;s=(this.hot.countCols()+s)%this.hot.countCols();const i=this.visualColumnsToPhysical(s,t),o=i.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",s,t,i,n)===!1)return!1;let l=!0;const u=o.length,c=this.dataSource;for(let h=0;h<u;h++)l&&i[0]!==i[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(i[0],t),h===0&&this.metaManager.removeColumn(i[0],t);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let m=0;m<u;m++)c[h].splice(o[m],1),h===0&&this.metaManager.removeColumn(o[m],1);return s<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(i),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",s,t,i,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,n){const s=this.hot.getDataAtCol(e),i=s.slice(t,t+n),o=s.slice(t+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];HC(l,o);let c=0;for(;c<n;)l.push(null),c+=1;return Ej(l),this.hot.populateFromArray(t,e,l,null,null,"spliceCol"),i}spliceRow(e,t,n){const s=this.hot.getSourceDataAtRow(e),i=s.slice(t,t+n),o=s.slice(t+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];HC(l,o);let c=0;for(;c<n;)l.push(null),c+=1;return this.hot.populateFromArray(e,t,[l],null,null,"spliceRow"),i}spliceData(e,t,n){if(this.hot.runHooks("beforeDataSplice",e,t,n)!==!1){const i=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,i.forEach(o=>this.dataSource.push(o))}}filterData(e,t,n){let s=this.hot.runHooks("filterData",e,t,n);Array.isArray(s)===!1&&(s=this.dataSource.filter((i,o)=>n.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,s)}get(e,t){const n=this.hot.toPhysicalRow(e);let s=this.dataSource[n];const i=this.hot.runHooks("modifyRowData",n);s=isNaN(i)?i:s;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(s&&s.hasOwnProperty&&Au(s,t))a=s[t];else if(o&&typeof t=="string"&&t.indexOf(".")>-1){let l=s;if(!l)return null;const u=t.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof t=="function"&&(a=t(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const l=qs(a);this.hot.runHooks("modifyData",n,this.propToCol(t),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,n){const s=this.hot.toPhysicalRow(e);let i=n,o=this.dataSource[s];const a=this.hot.runHooks("modifyRowData",s);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const u=qs(i);this.hot.runHooks("modifyData",s,this.propToCol(t),u,"set"),u.isTouched()&&(i=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(o&&o.hasOwnProperty&&Au(o,t))o[t]=i;else if(l&&typeof t=="string"&&t.indexOf(".")>-1){let u=o,c=0,h;const d=t.split(".");for(c=0,h=d.length-1;c<h;c++)typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]];u[d[c]]=i}else typeof t=="function"?t(this.dataSource.slice(s,s+1)[0],i):o[t]=i}visualRowsToPhysical(e,t){const n=this.hot.countSourceRows(),s=[];let i=(n+e)%n,o=t,a;for(;i<n&&o;)a=this.hot.toPhysicalRow(i),s.push(a),o-=1,i+=1;return s}visualColumnsToPhysical(e,t){const n=this.hot.countCols(),s=[];let i=(n+e)%n,o=t;for(;i<n&&o;){const a=this.hot.toPhysicalColumn(i);s.push(a),o-=1,i+=1}return s}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;e<0||e===0?t=0:t=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,t,eu.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,n){const s=[];let i,o,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=n===eu.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,t.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,t.col));for(i=Math.min(e.row,t.row);i<=h;i++){a=[];const m=i>=0?this.hot.toPhysicalRow(i):i;for(o=Math.min(e.col,t.col);o<=d&&m!==null;o++)a.push(c.call(this,i,this.colToProp(o)));m!==null&&s.push(a)}return s}getText(e,t){return QT(this.getRange(e,t,eu.DESTINATION_RENDERER))}getCopyableText(e,t){return QT(this.getRange(e,t,eu.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:VX,getItem:UX,hasItem:kX}=Hu("cellTypes");function BX(r){if(!kX(r))throw Error(`You declared cell type "${r}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return UX(r)}function WX(r,e){typeof r!="string"&&(e=r,r=e.CELL_TYPE);const{editor:t,renderer:n,validator:s}=e;t&&uM(r,t),n&&E6(r,n),s&&C6(r,s),VX(r,e)}function $X(r,e){var t;return r==="CELL_TYPE"?!1:((t=e._automaticallyAssignedMetaProps)===null||t===void 0?void 0:t.has(r))||!Au(e,r)}function Wp(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const n=typeof e.type=="string"?BX(e.type):e.type;if(r._automaticallyAssignedMetaProps&&Lt(e,(i,o)=>void r._automaticallyAssignedMetaProps.delete(o)),!Fi(n))return;t===r&&!r._automaticallyAssignedMetaProps&&(r._automaticallyAssignedMetaProps=new Set);const s={};Lt(n,(i,o)=>{if($X(o,t)){var a;s[o]=i,(a=r._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),Nu(r,s)}function GX(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function t(){}c3(t,r);for(let n=0;n<e.length;n++)t.prototype[e[n]]=void 0;return t}function Uf(r){return Number.isInteger(r)&&r>=0}function kf(r,e){if(!r())throw new Error(`Assertion failed: ${e}`)}function tf(r){return r==null}const I_=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(r){let e,t,n;for(e=0,t=this.countRows();e<t;e++)if(n=this.getDataAtCell(e,r),Tu(n)===!1)return!1;return!0},isEmptyRow(r){let e,t,n,s;for(e=0,t=this.countCols();e<t;e++)if(n=this.getDataAtCell(r,e),Tu(n)===!1)return typeof n=="object"?(s=this.getCellMeta(r,e),rM(this.getSchema()[s.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function ZT(r,e,t){return(e=zX(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function zX(r){var e=YX(r,"string");return typeof e=="symbol"?e:e+""}function YX(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function jX(){return class{}}class KX{constructor(e){ZT(this,"metaCtor",jX()),ZT(this,"meta",void 0),this.meta=this.metaCtor.prototype,Nu(this.meta,I_()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;Nu(this.meta,e),Wp(this.meta,{...e,type:(t=e.type)!==null&&t!==void 0?t:this.meta.type},e)}}function XX(r,e,t){return(e=qX(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function qX(r){var e=QX(r,"string");return typeof e=="symbol"?e:e+""}function QX(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class ZX{constructor(e){XX(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){Nu(this.meta,e),Wp(this.meta,e,e)}}function rf(r,e,t){return(e=JX(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function JX(r){var e=e8(r,"string");return typeof e=="symbol"?e:e+""}function e8(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class Mm{constructor(e){rf(this,"valueFactory",void 0),rf(this,"data",[]),rf(this,"index",[]),rf(this,"holes",new Set),this.valueFactory=e}obtain(e){kf(()=>Uf(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let n;if(t>=0)n=this.data[t],n===void 0&&(n=this.valueFactory(e),this.data[t]=n);else if(n=this.valueFactory(e),this.holes.size>0){const s=this.holes.values().next().value;this.holes.delete(s),this.data[s]=n,this.index[e]=s}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;kf(()=>Uf(e)||tf(e),"Expecting an unsigned number or null/undefined argument.");const n=[],s=this.data.length;for(let o=0;o<t;o++)n.push(s+o),this.data.push(void 0);const i=tf(e)?this.index.length:e;this.index=[...this.index.slice(0,i),...n,...this.index.slice(i)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;kf(()=>Uf(e)||tf(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(tf(e)?this.index.length-t:e,t);for(let s=0;s<n.length;s++){const i=n[s];typeof i=="number"&&this.holes.add(i)}}size(){return this.data.length-this.holes.size}values(){return Nw(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const s=this._getKeyByStorageIndex(n);s!==-1&&e.push([s,this.data[n]])}let t=0;return{next:()=>{if(t<e.length){const n=e[t];return t+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function JT(r,e,t){return(e=t8(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function t8(r){var e=r8(r,"string");return typeof e=="symbol"?e:e+""}function r8(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const n8=["data","width"];class s8{constructor(e){JT(this,"globalMeta",void 0),JT(this,"metas",new Mm(()=>this._createMeta())),this.globalMeta=e,this.metas=new Mm(()=>this._createMeta())}updateMeta(e,t){const n=this.getMeta(e);Nu(n,t),Wp(n,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return GX(this.globalMeta.getMetaConstructor(),n8).prototype}}function eb(r,e,t){return(e=i8(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function i8(r){var e=o8(r,"string");return typeof e=="symbol"?e:e+""}function o8(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class a8{constructor(e){eb(this,"columnMeta",void 0),eb(this,"metas",new Mm(()=>this._createRow())),this.columnMeta=e}updateMeta(e,t,n){const s=this.getMeta(e,t);Nu(s,n),Wp(s,n)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,t)}getMeta(e,t,n){const s=this.metas.obtain(e).obtain(t);return n===void 0?s:s[n]}setMeta(e,t,n,s){var i;const o=this.metas.obtain(e).obtain(t);(i=o._automaticallyAssignedMetaProps)===null||i===void 0||i.delete(n),o[n]=s}removeMeta(e,t,n){const s=this.metas.obtain(e).obtain(t);delete s[n]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let n=0;n<t.length;n++)at(t[n])&&e.push(...t[n].values());return e}getMetasAtRow(e){kf(()=>Uf(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Mm(e=>this._createMeta(e))}_createMeta(e){const t=this.columnMeta.getMetaConstructor(e);return new t}}class M_{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new KX(e),this.tableMeta=new ZX(this.globalMeta),this.columnMeta=new s8(this.globalMeta),this.cellMeta=new a8(this.columnMeta),n.forEach(s=>new s(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,n){let{visualRow:s,visualColumn:i}=n;const o=this.cellMeta.getMeta(e,t);return o.visualRow=s,o.visualCol=i,o.row=e,o.col=t,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(e,t,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,n)}setCellMeta(e,t,n,s){this.cellMeta.setMeta(e,t,n,s)}updateCellMeta(e,t,n){this.cellMeta.updateMeta(e,t,n)}removeCellMeta(e,t,n){this.cellMeta.removeMeta(e,t,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}ur(M_,Io);function tb(r,e,t,n){const{hotInstance:s,dataMap:i,dataSource:o,internalSource:a,source:l,metaManager:u,firstRun:c}=n,h=Aw(a),d=s.getSettings();Array.isArray(d.dataSchema)?s.dataType="array":Bt(d.dataSchema)?s.dataType="function":s.dataType="object",i&&i.destroy(),r=s.runHooks(`before${h}`,r,c,l);const m=new eu(s,r,u);if(e(m),typeof r=="object"&&r!==null)r.push&&r.splice||(r=[r]);else if(r===null){const E=m.getSchema();r=[];let g,O=0,T=0;for(O=0,T=d.startRows;O<T;O++)if((s.dataType==="object"||s.dataType==="function")&&d.dataSchema)g=oa(E),r.push(g);else if(s.dataType==="array")g=oa(E[0]),r.push(g);else{g=[];for(let _=0,V=d.startCols;_<V;_++)g.push(null);r.push(g)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof r} given)`);Array.isArray(r[0])&&(s.dataType="array"),d.data=r,m.dataSource=r,o.data=r,o.dataType=s.dataType,o.colToProp=m.colToProp.bind(m),o.propToCol=m.propToCol.bind(m),o.countCachedColumns=m.countCachedColumns.bind(m),t(m),s.runHooks(`after${h}`,r,c,l),c||(s.runHooks("afterChange",null,a),s.render()),s.getSettings().ariaTags&&Yt(s.rootElement,[UI(-1),Fp(s.countCols()+(s.view?s.countRowHeaders():0))])}function rb(r,e,t){return(e=l8(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function l8(r){var e=u8(r,"string");return typeof e=="symbol"?e:e+""}function u8(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}class c8{constructor(e){rb(this,"metaManager",void 0),rb(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),In.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:n,col:s}=e;if((t=this.metaSyncMemo.get(n))!==null&&t!==void 0&&t.has(s))return;const{visualRow:i,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",i,o,e);const u=Au(e,"type")?e.type:null;let c=Bt(e.cells)?e.cells(n,s,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(n,s,c),a.runHooks("afterGetCellMeta",i,o,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(s)}}function h8(r,e,t){d8(r,e),e.set(r,t)}function d8(r,e){if(e.has(r))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ty(r,e,t){return(e=f8(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function f8(r){var e=m8(r,"string");return typeof e=="symbol"?e:e+""}function m8(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function p8(r,e){return r.get(g8(r,e))}function g8(r,e,t){if(typeof r=="function"?r===e:r.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var nb=new WeakMap;class y8{constructor(e){Ty(this,"metaManager",void 0),Ty(this,"usageTracker",new Set),Ty(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),h8(this,nb,(t,n,s)=>{if(!s)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{initOnly:n,target:s,onChange:i}=e,o=typeof s=="string",a=o?s:t,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],i?(this.installPropWatcher(t,l,i),o&&this.installPropWatcher(s,l,i)):n&&(this.installPropWatcher(t,l,p8(nb,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))})}installPropWatcher(e,t,n){const s=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(i){const o=!s.usageTracker.has(e);s.usageTracker.add(e),n.call(s,e,i,o),this[t]=i},enumerable:!0,configurable:!0})}}const __="gridDefault",x_="editorManager.handlingEditor",E8={name:"editorCloseAndSave",callback(r){r._getEditorManager().closeEditorAndSaveChanges()}},v8="hooksRefRegisterer",L_={_hooksStorage:Object.create(null),addHook(r,e){return this._hooksStorage[r]||(this._hooksStorage[r]=[]),this.hot.addHook(r,e),this._hooksStorage[r].push(e),this},removeHooksByKey(r){Je(this._hooksStorage[r]||[],e=>{this.hot.removeHook(r,e)})},clearHooks(){Lt(this._hooksStorage,(r,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};ua(L_,"MIXIN_NAME",v8,{writable:!1,enumerable:!1});function ks(r,e,t){return(e=w8(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function w8(r){var e=R8(r,"string");return typeof e=="symbol"?e:e+""}function R8(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const S8="base",yr=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class iR{static get EDITOR_TYPE(){return S8}constructor(e){ks(this,"hot",void 0),ks(this,"state",yr.VIRGIN),ks(this,"_opened",!1),ks(this,"_fullEditMode",!1),ks(this,"_closeCallback",null),ks(this,"TD",null),ks(this,"row",null),ks(this,"col",null),ks(this,"prop",null),ks(this,"originalValue",null),ks(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,n,s,i,o){this.TD=s,this.row=e,this.col=t,this.prop=n,this.originalValue=i,this.cellProperties=o,this.state=this.isOpened()?this.state:yr.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let n,s,i,o;if(t){const l=this.hot.getSelectedLast();n=Math.max(Math.min(l[0],l[2]),0),s=Math.max(Math.min(l[1],l[3]),0),i=Math.max(l[0],l[2]),o=Math.max(l[1],l[3])}else[n,s,i,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,s);Array.isArray(a)&&([n,s]=a),this.hot.populateFromArray(n,s,e,i,o,"edit")}beginEditing(e,t){if(this.state!==yr.VIRGIN)return;const n=this.hot,s=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(s,i)),this.state=yr.EDITING,this.isInFullEditMode()){const o=typeof e=="string"?e:DI(this.originalValue);this.setValue(o)}this.open(t),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,t,n){let s;if(n){const i=this._closeCallback;this._closeCallback=o=>{i&&i(o),n(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===yr.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===yr.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const i=this.getValue();this.cellProperties.trimWhitespace?s=[[typeof i=="string"?String.prototype.trim.call(i||""):i]]:s=[[i]],this.state=yr.WAITING,this.saveValue(s,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=yr.FINISHED,this.discardEditor(o)}):(this.state=yr.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=yr.FINISHED,this.discardEditor()}discardEditor(e){this.state===yr.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=yr.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=yr.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===yr.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:n,wtViewport:s}=this.hot.view._wt,i=this.hot.rootWindow,o=Es(t),a=Fr(t),l=Es(this.hot.rootElement),u=Fr(this.hot.rootElement),c=n.topOverlay.holder,h=n.inlineStartOverlay.holder,d=c!==i?c.scrollTop:0,m=h!==i?h.scrollLeft:0,E=i.innerWidth-l.left-u,{wtTable:g}=(e=n.getParentOverlay(t))!==null&&e!==void 0?e:this.hot.view._wt,O=g.name,T=["master","inline_start"].includes(O)?d:0,_=["master","top","bottom"].includes(O)?m:0,V=o.top===l.top?0:1;let H=o.top-l.top-V-T,Q=0;this.hot.isRtl()?Q=i.innerWidth-o.left-a-E-1+_:Q=o.left-l.left-1-_,["top","top_inline_start_corner"].includes(O)&&(H+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(O)&&(Q+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const oe=this.hot.hasColHeaders(),re=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),ie=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),Ie=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(oe&&re<=0||re===Ie)&&(H+=1),ie<=0&&(Q+=1);const _e=s.rowsRenderCalculator.startPosition,tt=s.columnsRenderCalculator.startPosition,Ge=Math.abs(n.inlineStartOverlay.getScrollPosition()),ke=n.topOverlay.getScrollPosition(),nt=vn(this.hot.rootDocument);let je=t.offsetTop;if(["inline_start","master"].includes(O)&&(je+=_e-ke),["bottom","bottom_inline_start_corner"].includes(O)){const{wtViewport:j,wtTable:fe}=n.bottomOverlay.clone;je+=j.getWorkspaceHeight()-fe.getHeight()-nt}let Ne=t.offsetLeft;this.hot.isRtl()?(Ne>=0?Ne=g.getWidth()-t.offsetLeft:Ne=Math.abs(Ne),Ne+=tt-Ge-a):["top","master","bottom"].includes(O)&&(Ne+=tt-Ge);const ue=ia(this.TD,this.hot.rootWindow),Ae=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",bt=parseInt(ue[Ae],10)>0?0:1,p=parseInt(ue.borderTopWidth,10)>0?0:1,y=Fr(t)+bt,R=Ss(t)+p,x=Gj(c)?nt:0,P=zj(h)?nt:0,U=this.hot.view.maximumVisibleElementWidth(Ne)-x+bt,G=Math.max(this.hot.view.maximumVisibleElementHeight(je)-P+p,23);return{top:H,start:Q,height:R,maxHeight:G,width:y,maxWidth:U}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?t="top-inline-start-corner":t="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?t="bottom-inline-start-corner":t="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}ur(iR,L_);const C8={name:"editorCloseAndSaveByArrowKeys",callback(r,e,t){const n=r._getEditorManager(),s=n.getActiveEditor();s.isInFullEditMode()&&s.state===yr.EDITING||(n.closeEditorAndSaveChanges(),r.getSelected()&&(t.includes("arrowdown")?r.selection.transformStart(1,0):t.includes("arrowup")?r.selection.transformStart(-1,0):t.includes("arrowleft")?r.selection.transformStart(0,-1*r.getDirectionFactor()):t.includes("arrowright")&&r.selection.transformStart(0,r.getDirectionFactor())),e.preventDefault())}},T8={name:"editorCloseAndSaveByEnter",callback(r,e){const t=r._getEditorManager();t.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),t.moveSelectionAfterEnter(e)}},b8={name:"editorCloseWithoutSaving",callback(r){const e=r._getEditorManager();e.closeEditorAndRestoreOriginalValue(r.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},N8={name:"editorFastOpen",callback(r,e){const{highlight:t}=r.getSelectedRangeLast();t.isHeader()||r._getEditorManager().openEditor(null,e,!0)}},A8={name:"editorOpen",callback(r,e,t){const n=r._getEditorManager(),s=r.getSelectedRangeLast(),{highlight:i}=s;if(r.selection.isMultiple()&&!s.isHeader()&&r.countRenderedCols()>0&&r.countRenderedRows()>0){const o=r.getSettings(),a=typeof o.enterMoves=="function"?o.enterMoves(e):o.enterMoves;t.includes("shift")?r.selection.transformFocus(-a.row,-a.col):r.selection.transformFocus(a.row,a.col);return}i.isHeader()||(r.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(e):n.openEditor(null,e,!0):n.moveSelectionAfterEnter(e),Vp(e))}};function O8(){return[E8,C8,T8,b8,N8,A8]}const I8={name:"extendCellsSelectionDown",callback(r){const{highlight:e}=r.getSelectedRangeLast();!r.selection.isSelectedByColumnHeader()&&!r.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&r.selection.isSelectedByRowHeader())&&r.selection.transformEnd(1,0)}},M8={name:"extendCellsSelectionDownByViewportHeight",callback(r){const{to:e}=r.getSelectedRangeLast(),t=Math.min(e.row+r.countVisibleRows(),r.countRows()-1),n=r.rowIndexMapper.getNearestNotHiddenIndex(t,-1);if(n!==null){const s=r._createCellCoords(n,e.col),i=e.row-r.view.getFirstFullyVisibleRow(),o=Math.min(s.row-i,r.countRows()-1);r.selection.setRangeEnd(s),r.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},_8={name:"extendCellsSelectionLeft",callback(r){const{highlight:e}=r.getSelectedRangeLast();!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&r.selection.isSelectedByColumnHeader())&&r.selection.transformEnd(0,-1*r.getDirectionFactor())}},x8={name:"extendCellsSelectionRight",callback(r){const{highlight:e}=r.getSelectedRangeLast();!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&r.selection.isSelectedByColumnHeader())&&r.selection.transformEnd(0,r.getDirectionFactor())}},L8={name:"extendCellsSelectionToColumns",callback(r){const{highlight:e,from:t,to:n}=r.getSelectedRangeLast();r.selection.isSelectedByRowHeader()?r.selection.selectAll(!0,!0):r.selectColumns(t.col,n.col,e)}},P8={name:"extendCellsSelectionToMostBottom",callback(r){const{selection:e,rowIndexMapper:t}=r,{highlight:n,from:s,to:i}=r.getSelectedRangeLast(),o=n.isHeader()&&r.selection.isSelectedByRowHeader();if(n.isCell()||o){const a=t.getNearestNotHiddenIndex(r.countRows()-1,-1),l=s.clone();l.row=n.row,e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(r._createCellCoords(a,i.col))}}},F8={name:"extendCellsSelectionToMostInlineEnd",callback(r){const{selection:e,columnIndexMapper:t}=r,{highlight:n,from:s,to:i}=r.getSelectedRangeLast();if(!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&n.isCell()){const o=t.getNearestNotHiddenIndex(r.countCols()-1,-1),a=s.clone();a.col=n.col,e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(r._createCellCoords(i.row,o))}}},D8={name:"extendCellsSelectionToMostInlineStart",callback(r){const{selection:e,columnIndexMapper:t}=r,{highlight:n,from:s,to:i}=r.getSelectedRangeLast();if(!r.selection.isSelectedByRowHeader()&&!r.selection.isSelectedByCorner()&&n.isCell()){const o=parseInt(r.getSettings().fixedColumnsStart,10),a=t.getNearestNotHiddenIndex(o,1),l=s.clone();l.col=n.col,e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(r._createCellCoords(i.row,a))}}},H8={name:"extendCellsSelectionToMostLeft",callback(r){const{selection:e,columnIndexMapper:t}=r,{highlight:n,from:s,to:i}=r.getSelectedRangeLast(),o=n.isHeader()&&r.selection.isSelectedByColumnHeader();if(n.isCell()||o){const a=t.getNearestNotHiddenIndex(...r.isRtl()?[r.countCols()-1,-1]:[0,1]),l=s.clone();l.col=n.col,e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(r._createCellCoords(i.row,a))}}},V8={name:"extendCellsSelectionToMostRight",callback(r){const{selection:e,columnIndexMapper:t}=r,{highlight:n,from:s,to:i}=r.getSelectedRangeLast(),o=n.isHeader()&&r.selection.isSelectedByColumnHeader();if(n.isCell()||o){const a=t.getNearestNotHiddenIndex(...r.isRtl()?[0,1]:[r.countCols()-1,-1]),l=s.clone();l.col=n.col,e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(r._createCellCoords(i.row,a))}}},U8={name:"extendCellsSelectionToMostTop",callback(r){const{selection:e,rowIndexMapper:t}=r,{highlight:n,from:s,to:i}=r.getSelectedRangeLast(),o=n.isHeader()&&r.selection.isSelectedByRowHeader();if(n.isCell()||o){const a=t.getNearestNotHiddenIndex(0,1),l=s.clone();l.row=n.row,e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(r._createCellCoords(a,i.col))}}},k8={name:"extendCellsSelectionToRows",callback(r){const{highlight:e,from:t,to:n}=r.getSelectedRangeLast();r.selection.isSelectedByColumnHeader()?r.selection.selectAll(!0,!0):r.selectRows(t.row,n.row,e)}},B8={name:"extendCellsSelectionUp",callback(r){const{highlight:e}=r.getSelectedRangeLast();!r.selection.isSelectedByColumnHeader()&&!r.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&r.selection.isSelectedByRowHeader())&&r.selection.transformEnd(-1,0)}},W8={name:"extendCellsSelectionUpByViewportHeight",callback(r){const{to:e}=r.getSelectedRangeLast(),t=Math.max(e.row-r.countVisibleRows(),0),n=r.rowIndexMapper.getNearestNotHiddenIndex(t,1);if(n!==null){const s=r._createCellCoords(n,e.col),i=e.row-r.view.getFirstFullyVisibleRow(),o=Math.max(s.row-i,0);r.selection.setRangeEnd(s),r.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}};function $8(){return[I8,M8,_8,x8,L8,P8,F8,D8,H8,V8,U8,k8,B8,W8]}const G8={name:"moveCellSelectionDown",callback(r){let{selection:e}=r;e.transformStart(1,0)}},z8={name:"moveCellSelectionDownByViewportHeight",callback(r){const{navigableHeaders:e}=r.getSettings(),t=e?r.countColHeaders():0,{row:n}=r.getSelectedRangeLast().highlight;let s=r.countVisibleRows()+t;n===r.countRows()-1?s=1:n+s>r.countRows()&&(s=r.countRows()-n-1),r.selection.transformStart(s,0),r.getSelectedRangeLast().highlight.row<0&&r.scrollViewportTo({row:0})}},Y8={name:"moveCellSelectionInlineEnd",callback(r,e){const t=r.getSettings(),n=r.getSelectedRangeLast(),s=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;r.selection.isMultiple()&&!n.isHeader()&&r.countRenderedCols()>0&&r.countRenderedRows()>0?r.selection.transformFocus(-s.row,-s.col):r.selection.transformStart(-s.row,-s.col)}},j8={name:"moveCellSelectionInlineStart",callback(r,e){const t=r.getSettings(),n=r.getSelectedRangeLast(),s=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;r.selection.isMultiple()&&!n.isHeader()&&r.countRenderedCols()>0&&r.countRenderedRows()>0?r.selection.transformFocus(s.row,s.col):r.selection.transformStart(s.row,s.col)}},K8={name:"moveCellSelectionLeft",callback(r){r.selection.transformStart(0,-1*r.getDirectionFactor())}},X8={name:"moveCellSelectionRight",callback(r){r.selection.transformStart(0,r.getDirectionFactor())}},q8={name:"moveCellSelectionToMostBottom",callback(r){const{col:e}=r.getSelectedRangeLast().highlight;let t=r.rowIndexMapper.getNearestNotHiddenIndex(r.countRows()-1,-1);t===null&&(t=-1),r.selection.setRangeStart(r._createCellCoords(t,e))}},Q8={name:"moveCellSelectionToMostBottomInlineEnd",callback(r){const{selection:e,rowIndexMapper:t,columnIndexMapper:n}=r,s=parseInt(r.getSettings().fixedRowsBottom,10),i=t.getNearestNotHiddenIndex(r.countRows()-s-1,-1),o=n.getNearestNotHiddenIndex(r.countCols()-1,-1);e.setRangeStart(r._createCellCoords(i,o))}},Z8={name:"moveCellSelectionToMostInlineEnd",callback(r){const{selection:e,columnIndexMapper:t}=r;e.setRangeStart(r._createCellCoords(r.getSelectedRangeLast().highlight.row,t.getNearestNotHiddenIndex(r.countCols()-1,-1)))}},J8={name:"moveCellSelectionToMostInlineStart",callback(r){const{selection:e,columnIndexMapper:t}=r,n=parseInt(r.getSettings().fixedColumnsStart,10),s=r.getSelectedRangeLast().highlight.row,i=t.getNearestNotHiddenIndex(n,1);e.setRangeStart(r._createCellCoords(s,i))}},e7={name:"moveCellSelectionToMostLeft",callback(r){const{selection:e,columnIndexMapper:t}=r,n=r.getSelectedRangeLast().highlight.row;let s=t.getNearestNotHiddenIndex(...r.isRtl()?[r.countCols()-1,-1]:[0,1]);s===null&&(s=r.isRtl()?-1:-r.countRowHeaders()),e.setRangeStart(r._createCellCoords(n,s))}},t7={name:"moveCellSelectionToMostRight",callback(r){const{selection:e,columnIndexMapper:t}=r,{row:n}=r.getSelectedRangeLast().highlight;let s=t.getNearestNotHiddenIndex(...r.isRtl()?[0,1]:[r.countCols()-1,-1]);s===null&&(s=r.isRtl()?-r.countRowHeaders():-1),e.setRangeStart(r._createCellCoords(n,s))}},r7={name:"moveCellSelectionToMostTop",callback(r){const{col:e}=r.getSelectedRangeLast().highlight;let t=r.rowIndexMapper.getNearestNotHiddenIndex(0,1);t===null&&(t=-r.countColHeaders()),r.selection.setRangeStart(r._createCellCoords(t,e))}},n7={name:"moveCellSelectionToMostTopInlineStart",callback(r){const{selection:e,rowIndexMapper:t,columnIndexMapper:n}=r,s=parseInt(r.getSettings().fixedRowsTop,10),i=parseInt(r.getSettings().fixedColumnsStart,10),o=t.getNearestNotHiddenIndex(s,1),a=n.getNearestNotHiddenIndex(i,1);e.setRangeStart(r._createCellCoords(o,a))}},s7={name:"moveCellSelectionUp",callback(r){let{selection:e}=r;e.transformStart(-1,0)}},i7={name:"moveCellSelectionUpByViewportHight",callback(r){const{navigableHeaders:e}=r.getSettings(),t=e?r.countColHeaders():0,{row:n}=r.getSelectedRangeLast().highlight;let s=-(r.countVisibleRows()+t);n===-t?s=-1:n+s<t&&(s=-(n+t)),r.selection.transformStart(s,0),r.getSelectedRangeLast().highlight.row<0&&r.scrollViewportTo({row:0})}};function o7(){return[G8,z8,Y8,j8,K8,X8,q8,Q8,Z8,J8,e7,t7,r7,n7,s7,i7]}const a7={name:"emptySelectedCells",callback(r){r.emptySelectedCells(),r._getEditorManager().prepareEditor()}},l7={name:"scrollToFocusedCell",callback(r){const{highlight:e}=r.getSelectedRangeLast(),t=r.view.getFirstFullyVisibleRow()-1,n=r.view.getFirstFullyVisibleColumn()-1,s=r.view.getLastFullyVisibleRow()+1,i=r.view.getLastFullyVisibleColumn()+1,o=r._createCellCoords(t,n),a=r._createCellCoords(s,i);if(!r._createCellRange(o,o,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(r.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(r.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}r.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},u7={name:"selectAllCells",callback(r){r.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},c7={name:"selectAllCellsAndHeaders",callback(r){r.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},h7={name:"populateSelectedCellsData",callback(r){const e=r.getSelectedRange(),{row:t,col:n}=e[e.length-1].highlight.normalize(),s=r.getDataAtCell(t,n),i=new Map;for(let o=0;o<e.length;o++)e[o].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==t||l!==n)){const{readOnly:u}=r.getCellMeta(a,l);u||i.set(`${a}x${l}`,[a,l,s])}});r.setDataAtCell(Array.from(i.values()))}},d7=[...O8(),...$8(),...o7(),a7,l7,u7,c7,h7];function P_(r){const e={};return d7.forEach(t=>{let{name:n,callback:s}=t;e[n]=function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return s(r,...o)}}),e}function f7(r){const e=r.getShortcutManager().addContext("editor"),t=P_(r),n={group:x_};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(s,i)=>t.editorCloseAndSaveByEnter(s,i)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(s,i)=>t.editorCloseAndSaveByEnter(s,i)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:r.getShortcutManager().getContext("grid"),callback:(s,i)=>t.editorCloseAndSave(s,i)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(s,i)=>t.editorCloseAndSaveByArrowKeys(s,i)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>t.editorCloseWithoutSaving()}],n)}function m7(r){const e=r.getShortcutManager().addContext("grid"),t=P_(r),n={runOnlyIf:()=>{const{navigableHeaders:s}=r.getSettings();return at(r.getSelected())&&(s||!s&&r.countRenderedRows()>0&&r.countRenderedCols()>0)},group:__};e.addShortcuts([{keys:[["F2"]],callback:s=>t.editorFastOpen(s)},{keys:[["Enter"],["Enter","Shift"]],callback:(s,i)=>t.editorOpen(s,i)},{keys:[["Backspace"],["Delete"]],callback:()=>t.emptySelectedCells()}],{group:x_,runOnlyIf:()=>at(r.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>t.selectAllCells(),runOnlyIf:()=>{var s;return!((s=r.getSelectedRangeLast())!==null&&s!==void 0&&s.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var s;return(s=r.getSelectedRangeLast())===null||s===void 0?void 0:s.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>t.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>t.populateSelectedCellsData(),runOnlyIf:()=>{var s,i;return!((s=r.getSelectedRangeLast())!==null&&s!==void 0&&s.highlight.isHeader())&&((i=r.getSelectedRangeLast())===null||i===void 0?void 0:i.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>t.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>t.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>t.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>t.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>t.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>t.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>t.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>t.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>t.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>t.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>t.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>t.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>t.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:s=>t.moveCellSelectionInlineStart(s)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:s=>t.moveCellSelectionInlineEnd(s)},{keys:[["Control/Meta","Backspace"]],callback:()=>t.scrollToFocusedCell()}],n)}function p7(r){[m7,f7].forEach(e=>e(r))}function g7(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=r.rootElement,n=sb(r),s=sb(r);return n.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),s.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),t.firstChild.before(n),t.lastChild.after(s),{activate(){r._registerTimeout(()=>{n.tabIndex=0,s.tabIndex=0},10)},deactivate(){r._registerTimeout(()=>{n.tabIndex=-1,s.tabIndex=-1},10)}}}function sb(r){const t=r.rootDocument.createElement("input");return t.type="text",t.classList.add("htFocusCatcher"),r.getSettings().ariaTags&&Yt(t,[mo(),xj()]),t}function y7(r){const e=E7(r);let t;const{activate:n,deactivate:s}=g7(r,{onFocusFromTop(){var h;const d=(h=e(t))!==null&&h!==void 0?h:VE(r);d&&(r.runHooks("modifyFocusOnTabNavigation","from_above",d),r.selectCell(d.row,d.col)),r.listen()},onFocusFromBottom(){var h;const d=(h=e(t))!==null&&h!==void 0?h:UE(r);d&&(r.runHooks("modifyFocusOnTabNavigation","from_below",d),r.selectCell(d.row,d.col)),r.listen()}}),i={wrapped:!1,flipped:!1};let o=!0,a=!1,l=!1;r.addHook("afterListen",()=>s()),r.addHook("afterUnlisten",()=>n()),r.addHook("afterSelection",(h,d,m,E,g)=>{if(a&&(i.wrapped&&i.flipped||l)&&(l=!1,g.value=!0),o){var O;t=(O=r.getSelectedRangeLast())===null||O===void 0?void 0:O.highlight}}),r.addHook("beforeRowWrap",(h,d,m)=>{i.wrapped=!0,i.flipped=m});function u(){i.wrapped=!1,i.flipped=!1,r.deselectCell(),r.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:__,group:"focusCatcher"};r.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=r.getSettings();a=!0,r.getSelectedRangeLast()&&!h&&(o=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:m}=r.getSettings();if(a=!1,o=!0,!d||!r.selection.isSelected()||m&&i.wrapped&&i.flipped||!m&&i.wrapped)return m&&i.wrapped&&i.flipped&&(t=h.shiftKey?VE(r):UE(r)),u(),!1;h.preventDefault()},position:"after"}])}function VE(r){const{rowIndexMapper:e,columnIndexMapper:t}=r,{navigableHeaders:n}=r.getSettings();let s=n&&r.countColHeaders()>0?-r.countColHeaders():0,i=n&&r.countRowHeaders()>0?-r.countRowHeaders():0;return s===0&&(s=e.getVisualFromRenderableIndex(s)),i===0&&(i=t.getVisualFromRenderableIndex(i)),s===null||i===null?null:r._createCellCoords(s,i)}function UE(r){var e,t;const{rowIndexMapper:n,columnIndexMapper:s}=r,{navigableHeaders:i}=r.getSettings();let o=n.getRenderableIndexesLength()-1,a=s.getRenderableIndexesLength()-1;if(o<0){if(!i||r.countColHeaders()===0)return null;o=-1}if(a<0){if(!i||r.countColHeaders()===0)return null;a=-1}return r._createCellCoords((e=n.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(t=s.getVisualFromRenderableIndex(a))!==null&&t!==void 0?t:a)}function E7(r){return e=>{if(!e)return null;const t=VE(r),n=UE(r);return e.col<t.col&&(e.col=t.col),e.col>n.col&&(e.col=n.col),e.row<t.row&&(e.row=t.row),e.row>n.row&&(e.row=n.row),e}}function v7(r){return e=>{let{col:t}=e;r.scrollViewportTo({col:t})}}function w7(){return()=>{}}function R7(r){return e=>{r.scrollViewportTo(e.toObject())}}function S7(r){return e=>{r.scrollViewportTo(e.toObject())}}function C7(r){return e=>{r.scrollViewportTo(e.toObject())}}function T7(r){return e=>{let{row:t}=e;r.scrollViewportTo({row:t})}}function b7(r){return e=>{const t=r.selection.getSelectionSource(),{row:n,col:s}=e;if(n<0&&s>=0)r.scrollViewportTo({col:s});else if(s<0&&n>=0)r.scrollViewportTo({row:n});else{if(t==="mouse"&&(s===r.view.getLastPartiallyVisibleColumn()||n===r.view.getLastPartiallyVisibleRow()))return;r.scrollViewportTo({row:n,col:s})}}}function N7(r){const{selection:e}=r;let t=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){t=!0},scrollTo(s){var i;if(t||n){t=!1;return}let o;e.isFocusSelectionChanged()?o=R7(r):e.isSelectedByCorner()?o=w7():e.isSelectedByRowHeader()?o=T7(r):e.isSelectedByColumnHeader()?o=v7(r):e.getSelectedRange().size()===1&&e.isMultiple()?o=S7(r):e.getSelectedRange().size()===1&&!e.isMultiple()?o=b7(r):e.getSelectedRange().size()>1&&(o=C7(r)),(i=o)===null||i===void 0||i(s)}}}const ib=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),nf=r=>r.map(e=>{const t=e.toLowerCase();return ib.has(t)?ib.get(t):t}).sort().join("+"),A7=r=>r.split("+"),ob=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),by=r=>{let{which:e,key:t}=r;if(ob.has(e))return ob.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:t.toLowerCase()},F_=Symbol("shortcut-context");function D_(r){return Fi(r)&&r.__kindOf===F_}const O7=r=>{const e=Up({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${r}" context.`}),t=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:m=!0,stopPropagation:E=!1,relativeToGroup:g,position:O,forwardToContext:T}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Ln(c))throw new Error("You need to define the shortcut's group.");if(Bt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(Qn`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const _={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:m,stopPropagation:E};at(g)&&(_.relativeToGroup=g,_.position=O),D_(T)&&(_.forwardToContext=T),l.forEach(V=>{const H=nf(V);if(e.hasItem(H)){const oe=e.getItem(H);let re=oe.findIndex(ie=>ie.group===g);re!==-1?O==="before"?re-=1:re+=1:re=oe.length,oe.splice(re,0,_)}else e.addItem(H,[_])})},n=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Lt(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),t(c)})},s=l=>{const u=nf(l);e.removeItem(u)};return{__kindOf:F_,addShortcut:t,addShortcuts:n,getShortcuts:l=>{const u=nf(l),c=e.getItem(u);return at(c)?c.slice():[]},hasShortcut:l=>{const u=nf(l);return e.hasItem(u)},removeShortcutsByKeys:s,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const m=d.filter(E=>E.group!==l);m.length===0?s(A7(h)):(d.length=0,d.push(...m))})}}};function I7(){const r=new Set;return{press(e){r.add(e)},release(e){r.delete(e)},releaseAll(){r.clear()},isPressed(e){return r.has(e)}}}const M7=["meta","alt","shift","control"],Cc=I7(),Tc=[];let sf=0;function _7(r,e,t,n,s){const i=m=>M7.includes(m),o=function(m){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const g=[];return m.altKey&&g.push("alt"),E&&(m.ctrlKey||m.metaKey)?g.push("control/meta"):(m.ctrlKey&&g.push("control"),m.metaKey&&g.push("meta")),m.shiftKey&&g.push("shift"),g},a=m=>{if(e(m)===!1)return;const E=t(m);if(m.keyCode===229||E===!1||Ga(m))return;const g=by(m);let O=[];i(g)||(O=o(m));const T=[g].concat(O);!s(m,T)&&(nT()&&O.includes("meta")||!nT()&&O.includes("control"))&&s(m,[g].concat(o(m,!0))),n(m)},l=m=>{if(m.key){const E=by(m);i(E)&&Cc.press(E)}},u=m=>{if(m.key){const E=by(m);i(E)&&Cc.release(E)}},c=()=>{Cc.releaseAll()};return{mount:()=>{let m=r;for(sf+=1;m;)sf===1&&(m.document.documentElement.addEventListener("keydown",l),Tc.push({event:"keydown",listener:l}),m.document.documentElement.addEventListener("keyup",u),Tc.push({event:"keyup",listener:u})),m.document.documentElement.addEventListener("keydown",a),m.document.documentElement.addEventListener("blur",c),m=Tm(m)},unmount:()=>{let m=r;for(sf-=1;m;){if(sf===0){for(let E=0;E<Tc.length;E++){const{event:g,listener:O}=Tc[E];m.document.documentElement.removeEventListener(g,O)}Tc.length=0}m.document.documentElement.removeEventListener("keydown",a),m.document.documentElement.removeEventListener("blur",c),m=Tm(m)}},isPressed:m=>Cc.isPressed(m),releasePressedKeys:()=>Cc.releaseAll()}}const x7=r=>{let{ownerWindow:e,handleEvent:t,beforeKeyDown:n,afterKeyDown:s}=r;const i=Up({errorIdExists:E=>`The "${E}" context name is already registered.`});let o="grid";const a=E=>{const g=O7(E);return i.addItem(E,g),g},l=()=>o,u=E=>i.getItem(E),c=E=>{if(!i.hasItem(E))throw new Error(Qn`You've tried to activate the "${E}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=E};let h=!1;const d=function(E,g){let O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const T=D_(O)?O:u(O);let _=!1;if(!T.hasShortcut(g))return _;const V=T.getShortcuts(g);for(let H=0;H<V.length;H++){const{callback:Q,runOnlyIf:oe,preventDefault:re,stopPropagation:ie,captureCtrl:Fe,forwardToContext:Ie}=V[H];if(oe(E)===!0){if(h=Fe,_=Q(E,g)===!1,h=!1,re&&E.preventDefault(),ie&&(Vp(E),E.stopPropagation()),_)break;Ie&&d(E,g,Ie)}}return _},m=_7(e,t,n,s,d);return m.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(m.isPressed("control")||m.isPressed("meta")),releasePressedKeys:()=>m.releasePressedKeys(),destroy:()=>m.unmount()}};let Ny=null;const Ay=new Map;function H_(r,e){var t,n=this;let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this;const o=new Ou(i);let a,l,u,c,h,d,m=!0;y9(s)&&g9(this),this.rootElement=r,this.rootDocument=r.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const E=(t=e==null?void 0:e.layoutDirection)!==null&&t!==void 0?t:"inherit",g=["rtl","ltr"].includes(E)?E:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",g),this.isRtl=function(){return g==="rtl"},this.isLtr=function(){return!i.isRtl()},this.getDirectionFactor=function(){return i.isLtr()?1:-1},e.language=cX(e.language);const O=new M_(i,e,[c8,y8]),T=O.getTableMeta(),_=O.getGlobalMeta(),V=Up();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,r.insertBefore(this.container,r.firstChild),Hf(this)&&Sj(e.licenseKey,r),this.guid=`ht_${HI()}`,Ay.set(this.guid,this),this.columnIndexMapper=new FE,this.rowIndexMapper=new FE,this.columnIndexMapper.addLocalHook("indexesSequenceChange",p=>{i.runHooks("afterColumnSequenceChange",p)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",p=>{i.runHooks("afterRowSequenceChange",p)}),l=new A9(i),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const H=p=>{const{row:y,col:R}=p;return i._createCellCoords(y>=0?i.rowIndexMapper.getRenderableFromVisualIndex(y):y,R>=0?i.columnIndexMapper.getRenderableFromVisualIndex(R):R)},Q=p=>{const{row:y,col:R}=p;return i._createCellCoords(y>=0?i.rowIndexMapper.getVisualFromRenderableIndex(y):y,R>=0?i.columnIndexMapper.getVisualFromRenderableIndex(R):R)},oe=(p,y)=>{const R=y>p?1:-1,x=Math.min(p,y),P=Math.max(p,y),U=i.rowIndexMapper.getNearestNotHiddenIndex(p,R);return U===null||R===1&&U>P||R===-1&&U<x?null:U>=0?i.rowIndexMapper.getRenderableFromVisualIndex(U):U},re=(p,y)=>{const R=y>p?1:-1,x=Math.min(p,y),P=Math.max(p,y),U=i.columnIndexMapper.getNearestNotHiddenIndex(p,R);return U===null||R===1&&U>P||R===-1&&U<x?null:U>=0?i.columnIndexMapper.getRenderableFromVisualIndex(U):U};let ie=new O_(T,{rowIndexMapper:i.rowIndexMapper,columnIndexMapper:i.columnIndexMapper,countCols:()=>i.countCols(),countRows:()=>i.countRows(),propToCol:p=>a.propToCol(p),isEditorOpened:()=>i.getActiveEditor()?i.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>i.getShortcutManager(),createCellCoords:(p,y)=>i._createCellCoords(p,y),createCellRange:(p,y,R)=>i._createCellRange(p,y,R),visualToRenderableCoords:H,renderableToVisualCoords:Q,findFirstNonHiddenRenderableRow:oe,findFirstNonHiddenRenderableColumn:re,isDisabledCellSelection:(p,y)=>p<0||y<0?i.getSettings().disableVisualSelection:i.getCellMeta(p,y).disableVisualSelection});this.selection=ie;const Fe=p=>{let{hiddenIndexesChanged:y}=p;y&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",Fe),this.rowIndexMapper.addLocalHook("cacheUpdated",Fe),this.selection.addLocalHook("afterSetRangeEnd",(p,y)=>{const R=qs(!1),x=this.selection.getSelectedRange(),{from:P,to:U}=x.current(),G=x.size()-1;this.runHooks("afterSelection",P.row,P.col,U.row,U.col,R,G),this.runHooks("afterSelectionByProp",P.row,i.colToProp(P.col),U.row,i.colToProp(U.col),R,G),y&&(!R.isTouched()||R.isTouched()&&!R.value)&&d.scrollTo(p);const j=ie.isSelectedByRowHeader(),fe=ie.isSelectedByColumnHeader();j&&fe?dt(this.rootElement,["ht__selection--rows","ht__selection--columns"]):j?(Nr(this.rootElement,"ht__selection--columns"),dt(this.rootElement,"ht__selection--rows")):fe?(Nr(this.rootElement,"ht__selection--rows"),dt(this.rootElement,"ht__selection--columns")):Nr(this.rootElement,["ht__selection--rows","ht__selection--columns"]),ie.getSelectionSource()!=="shift"&&c.closeEditor(null),i.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",p=>{this.runHooks("beforeSelectionFocusSet",p.row,p.col)}),this.selection.addLocalHook("afterSetFocus",p=>{const y=qs(!1);this.runHooks("afterSelectionFocusSet",p.row,p.col,y),(!y.isTouched()||y.isTouched()&&!y.value)&&d.scrollTo(p),c.closeEditor(),i.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",p=>{const y=p.length-1,{from:R,to:x}=p[y];this.runHooks("afterSelectionEnd",R.row,R.col,x.row,x.col,y),this.runHooks("afterSelectionEndByProp",R.row,i.colToProp(R.col),x.row,i.colToProp(x.col),y)}),this.selection.addLocalHook("afterIsMultipleSelection",p=>{const y=this.runHooks("afterIsMultipleSelection",p.value);p.value&&(p.value=y)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),i.view.render(),Nr(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var p=arguments.length,y=new Array(p),R=0;R<p;R++)y[R]=arguments[R];return n.runHooks("beforeSetRangeStart",...y)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var p=arguments.length,y=new Array(p),R=0;R<p;R++)y[R]=arguments[R];return n.runHooks("beforeSetRangeStartOnly",...y)}).addLocalHook("beforeSetRangeEnd",function(){for(var p=arguments.length,y=new Array(p),R=0;R<p;R++)y[R]=arguments[R];return n.runHooks("beforeSetRangeEnd",...y)}).addLocalHook("beforeSelectColumns",function(){for(var p=arguments.length,y=new Array(p),R=0;R<p;R++)y[R]=arguments[R];return n.runHooks("beforeSelectColumns",...y)}).addLocalHook("afterSelectColumns",function(){for(var p=arguments.length,y=new Array(p),R=0;R<p;R++)y[R]=arguments[R];return n.runHooks("afterSelectColumns",...y)}).addLocalHook("beforeSelectRows",function(){for(var p=arguments.length,y=new Array(p),R=0;R<p;R++)y[R]=arguments[R];return n.runHooks("beforeSelectRows",...y)}).addLocalHook("afterSelectRows",function(){for(var p=arguments.length,y=new Array(p),R=0;R<p;R++)y[R]=arguments[R];return n.runHooks("afterSelectRows",...y)}).addLocalHook("beforeModifyTransformStart",function(){for(var p=arguments.length,y=new Array(p),R=0;R<p;R++)y[R]=arguments[R];return n.runHooks("modifyTransformStart",...y)}).addLocalHook("afterModifyTransformStart",function(){for(var p=arguments.length,y=new Array(p),R=0;R<p;R++)y[R]=arguments[R];return n.runHooks("afterModifyTransformStart",...y)}).addLocalHook("beforeModifyTransformFocus",function(){for(var p=arguments.length,y=new Array(p),R=0;R<p;R++)y[R]=arguments[R];return n.runHooks("modifyTransformFocus",...y)}).addLocalHook("afterModifyTransformFocus",function(){for(var p=arguments.length,y=new Array(p),R=0;R<p;R++)y[R]=arguments[R];return n.runHooks("afterModifyTransformFocus",...y)}).addLocalHook("beforeModifyTransformEnd",function(){for(var p=arguments.length,y=new Array(p),R=0;R<p;R++)y[R]=arguments[R];return n.runHooks("modifyTransformEnd",...y)}).addLocalHook("afterModifyTransformEnd",function(){for(var p=arguments.length,y=new Array(p),R=0;R<p;R++)y[R]=arguments[R];return n.runHooks("afterModifyTransformEnd",...y)}).addLocalHook("beforeRowWrap",function(){for(var p=arguments.length,y=new Array(p),R=0;R<p;R++)y[R]=arguments[R];return n.runHooks("beforeRowWrap",...y)}).addLocalHook("beforeColumnWrap",function(){for(var p=arguments.length,y=new Array(p),R=0;R<p;R++)y[R]=arguments[R];return n.runHooks("beforeColumnWrap",...y)}).addLocalHook("insertRowRequire",p=>this.alter("insert_row_above",p,1,"auto")).addLocalHook("insertColRequire",p=>this.alter("insert_col_start",p,1,"auto")),u={alter(p,y){var R,x;let P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,U=arguments.length>3?arguments[3]:void 0,G=arguments.length>4?arguments[4]:void 0;const j=fe=>{if(fe.length===0)return[];const me=[...fe];return me.sort((b,M)=>{let[D]=b,[W]=M;return D===W?0:D>W?1:-1}),Lp(me,(b,M)=>{let[D,W]=M;const k=b[b.length-1],[$,K]=k,Y=$+K;if(D<=Y){const z=Math.max(W-(Y-D),0);k[1]+=z}else b.push([D,W]);return b},[me[0]])};switch(p){case"insert_row_below":case"insert_row_above":const fe=i.countSourceRows();if(T.maxRows===fe)return;const me=p==="insert_row_below"?"below":"above";y=(R=y)!==null&&R!==void 0?R:me==="below"?fe:0;const{delta:ne,startPhysicalIndex:b}=a.createRow(y,P,{source:U,mode:me});ie.shiftRows(i.toVisualRow(b),ne);break;case"insert_col_start":case"insert_col_end":const M=p==="insert_col_end"?"end":"start";y=(x=y)!==null&&x!==void 0?x:M==="end"?i.countSourceCols():0;const{delta:D,startPhysicalIndex:W}=a.createCol(y,P,{source:U,mode:M});if(D){if(Array.isArray(T.colHeaders)){const K=[i.toVisualColumn(W),0];K.length+=D,Array.prototype.splice.apply(T.colHeaders,K)}ie.shiftColumns(i.toVisualColumn(W),D)}break;case"remove_row":const k=K=>{let Y=0;Je(K,z=>{let[B,ae]=z;const se=Tu(B)?i.countRows()-1:Math.max(B-Y,0);if(Number.isInteger(B)&&(B=Math.max(B-Y,0)),!a.removeRow(B,ae,U))return;if(ie.isSelected()){const{row:Le}=i.getSelectedRangeLast().highlight;Le>=B&&Le<=B+ae-1&&c.closeEditor(!0)}const Se=i.countRows();Se===0?ie.deselect():U==="ContextMenu.removeRow"?ie.refresh():ie.shiftRows(B,-ae);const xe=T.fixedRowsTop;xe>=se+1&&(T.fixedRowsTop-=Math.min(ae,xe-se));const De=T.fixedRowsBottom;De&&se>=Se-De&&(T.fixedRowsBottom-=Math.min(ae,De)),Y+=ae})};Array.isArray(y)?k(j(y)):k([[y,P]]);break;case"remove_col":const $=K=>{let Y=0;Je(K,z=>{let[B,ae]=z;const se=Tu(B)?i.countCols()-1:Math.max(B-Y,0);let ye=i.toPhysicalColumn(se);if(Number.isInteger(B)&&(B=Math.max(B-Y,0)),!a.removeCol(B,ae,U))return;if(ie.isSelected()){const{col:Le}=i.getSelectedRangeLast().highlight;Le>=B&&Le<=B+ae-1&&c.closeEditor(!0)}i.countCols()===0?ie.deselect():U==="ContextMenu.removeColumn"?ie.refresh():ie.shiftColumns(B,-ae);const De=T.fixedColumnsStart;De>=se+1&&(T.fixedColumnsStart-=Math.min(ae,De-se)),Array.isArray(T.colHeaders)&&(typeof ye>"u"&&(ye=-1),T.colHeaders.splice(ye,ae)),Y+=ae})};Array.isArray(y)?$(j(y)):$([[y,P]]);break;default:throw new Error(`There is no such action "${p}"`)}i.view.render(),G||u.adjustRowsAndCols()},adjustRowsAndCols(){const p=T.minRows,y=T.minSpareRows,R=T.minCols,x=T.minSpareCols;if(p){const P=i.countRows();P<p&&a.createRow(P,p-P,{source:"auto"})}if(y){const P=i.countEmptyRows(!0);if(P<y){const U=y-P,G=Math.min(U,T.maxRows-i.countSourceRows());a.createRow(i.countRows(),G,{source:"auto"})}}{let P;(R||x)&&(P=i.countEmptyCols(!0));let U=i.countCols();if(R&&!T.columns&&U<R){const G=R-U;P+=G,a.createCol(U,G,{source:"auto"})}if(x&&!T.columns&&i.dataType==="array"&&P<x){U=i.countCols();const G=x-P,j=Math.min(G,T.maxCols-U);a.createCol(U,j,{source:"auto"})}}i.view&&i.view.adjustElementsSize()},populateFromArray(p,y,R,x,P){let U,G,j,fe;const me=[],ne={},b=[],M=p.row,D=p.col;if(G=y.length,G===0)return!1;let W=0,k=0;switch(Fi(R)&&(W=R.col-D+1,k=R.row-M+1),P){case"shift_down":const $=jg(y),K=$.length,Y=Math.max(K,W),z=i.getData().slice(M),B=jg(z).slice(D,D+Y);for(j=0;j<Y;j+=1)if(j<K){for(U=0,G=$[j].length;U<k-G;U+=1)$[j].push($[j][U%G]);j<B.length?b.push($[j].concat(B[j])):b.push($[j].concat(new Array(z.length).fill(null)))}else b.push($[j%K].concat(B[j]));i.populateFromArray(M,D,jg(b));break;case"shift_right":const ae=y.length,se=Math.max(ae,k),ye=i.getData().slice(M).map(It=>It.slice(D));for(U=0;U<se;U+=1)if(U<ae){for(j=0,fe=y[U].length;j<W-fe;j+=1)y[U].push(y[U][j%fe]);if(U<ye.length)for(let It=0;It<ye[U].length;It+=1)y[U].push(ye[U][It]);else y[U].push(...new Array(ye[0].length).fill(null))}else y.push(y[U%G].slice(0,se).concat(ye[U]));i.populateFromArray(M,D,y);break;case"overwrite":default:ne.row=p.row,ne.col=p.col;let Se=0,xe=0,De=!0,Le;const Kt=function(Sr){let cr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const gt=y[Sr%y.length];return cr!==null?gt[cr%gt.length]:gt},Ht=y.length,Rr=R?R.row-p.row+1:0;for(R?G=Rr:G=Math.max(Ht,Rr),U=0;U<G&&!(R&&ne.row>R.row&&Rr>Ht||!T.allowInsertRow&&ne.row>i.countRows()-1||ne.row>=T.maxRows);U++){const It=U-Se,Sr=Kt(It).length,cr=R?R.col-p.col+1:0;if(R?fe=cr:fe=Math.max(Sr,cr),ne.col=p.col,Le=i.getCellMeta(ne.row,ne.col),(x==="CopyPaste.paste"||x==="Autofill.fill")&&Le.skipRowOnPaste){Se+=1,ne.row+=1,G+=1;continue}for(xe=0,j=0;j<fe&&!(R&&ne.col>R.col&&cr>Sr||!T.allowInsertColumn&&ne.col>i.countCols()-1||ne.col>=T.maxCols);j++){if(Le=i.getCellMeta(ne.row,ne.col),(x==="CopyPaste.paste"||x==="Autofill.fill")&&Le.skipColumnOnPaste){xe+=1,ne.col+=1,fe+=1;continue}if(Le.readOnly&&x!=="UndoRedo.undo"){ne.col+=1;continue}const gt=j-xe;let rt=Kt(It,gt),Nt=i.getDataAtCell(ne.row,ne.col);if(rt!==null&&typeof rt=="object")if(Array.isArray(rt)&&Nt===null&&(Nt=[]),Nt===null||typeof Nt!="object")De=!1;else{const Sn=yh(Array.isArray(Nt)?Nt:Nt[0]||Nt),Lo=yh(Array.isArray(rt)?rt:rt[0]||rt);rM(Sn,Lo)||Array.isArray(Sn)&&Array.isArray(Lo)?rt=oa(rt):De=!1}else Nt!==null&&typeof Nt=="object"&&(De=!1);De&&me.push([ne.row,ne.col,rt]),De=!0,ne.col+=1}ne.row+=1}i.setDataAtCell(me,null,null,x||"populateFromArray");break}}};function Ie(p){const y=$M(p);nR(y)?(i.runHooks("beforeLanguageChange",y),_.language=y,i.runHooks("afterLanguageChange",y)):GM(p)}function _e(p,y){const R=p==="className"?i.rootElement:i.table;if(m)dt(R,y);else{let x=[],P=[];_[p]&&(x=Array.isArray(_[p])?_[p]:UC(_[p])),y&&(P=Array.isArray(y)?y:UC(y));const U=VC(x,P),G=VC(P,x);U.length&&Nr(R,U),G.length&&dt(R,G)}_[p]=y}this.init=function(){l.setData(T.data),i.runHooks("beforeInit"),(Jl()||R3())&&dt(i.rootElement,"mobile"),this.updateSettings(T,!0),this.view=new R9(this),c=LE.getInstance(i,T,ie),d=N7(i),h=new p4(i),Hf(this)&&y7(i),i.runHooks("init"),this.forceFullRender=!0,this.view.render(),m&&i.rootElement.offsetParent===null&&Yj(i.rootElement,()=>{i.view._wt.wtOverlays.updateLastSpreaderSize(),i.render(),i.view.adjustElementsSize()}),typeof m=="object"&&(i.runHooks("afterChange",m[0],m[1]),m=!1),i.runHooks("afterInit")};function tt(){let p=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,p=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&p===!1&&(p=!0,this.onQueueEmpty(this.valid))}}}function Ge(p){const y=p.replace(",",".");return isNaN(parseFloat(y))===!1?parseFloat(y):p}function ke(p,y,R){if(!p.length){R();return}const x=i.getActiveEditor(),P=new tt;let U=!0;P.onQueueEmpty=()=>{x&&U&&x.cancelChanges(),R()};for(let G=p.length-1;G>=0;G--){const[j,fe,,me]=p[G],ne=a.propToCol(fe);let b;Number.isInteger(ne)?b=i.getCellMeta(j,ne):b={...Object.getPrototypeOf(T),...T},b.type==="numeric"&&typeof me=="string"&&e6(me)&&(p[G][3]=Ge(me)),i.getCellValidator(b)&&(P.addValidatorToQueue(),i.validateCell(p[G][3],b,function(M,D){return function(W){if(typeof W!="boolean")throw new Error("Validation error: result is not boolean");W===!1&&D.allowInvalid===!1&&(U=!1,p.splice(M,1),D.valid=!0),P.removeValidatorFormQueue()}}(G,b),y))}P.checkIfQueueIsEmpty()}function nt(p,y){for(let x=p.length-1;x>=0;x--){let P=!1;if(p[x]===null){p.splice(x,1);continue}if(!((p[x][2]===null||p[x][2]===void 0)&&(p[x][3]===null||p[x][3]===void 0))){if(T.allowInsertRow)for(;p[x][0]>i.countRows()-1;){const{delta:U}=a.createRow(void 0,void 0,{source:y});if(U===0){P=!0;break}}if(i.dataType==="array"&&(!T.columns||T.columns.length===0)&&T.allowInsertColumn)for(;a.propToCol(p[x][1])>i.countCols()-1;){const{delta:U}=a.createCol(void 0,void 0,{source:y});if(U===0){P=!0;break}}P||a.set(p[x][0],p[x][1],p[x][3])}}const R=p.length>0;if(i.forceFullRender=!0,R){u.adjustRowsAndCols(),i.runHooks("beforeChangeRender",p,y),c.closeEditor(),i.view.render(),c.prepareEditor(),i.view.adjustElementsSize(),i.runHooks("afterChange",p,y||"edit");const x=i.getActiveEditor();x&&at(x.refreshValue)&&x.refreshValue()}else i.view.render()}this._createCellCoords=function(p,y){return i.view._wt.createCellCoords(p,y)},this._createCellRange=function(p,y,R){return i.view._wt.createCellRange(p,y,R)},this.validateCell=function(p,y,R,x){let P=i.getCellValidator(y);function U(G){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||y.hidden===!0){R(G);return}const fe=y.visualCol,me=y.visualRow,ne=i.getCell(me,fe,!0);if(ne&&ne.nodeName!=="TH"){const b=i.rowIndexMapper.getRenderableFromVisualIndex(me),M=i.columnIndexMapper.getRenderableFromVisualIndex(fe);i.view._wt.getSetting("cellRenderer",b,M,ne)}R(G)}vj(P)&&(P=function(G){return function(j,fe){fe(G.test(j))}}(P)),Bt(P)?(p=i.runHooks("beforeValidate",p,y.visualRow,y.prop,x),i._registerImmediate(()=>{P.call(y,p,G=>{i&&(G=i.runHooks("afterValidate",G,p,y.visualRow,y.prop,x),y.valid=G,U(G),i.runHooks("postAfterValidate",G,p,y.visualRow,y.prop,x))})})):i._registerImmediate(()=>{y.valid=!0,U(y.valid,!1)})};function je(p,y,R){return Array.isArray(p)?p:[[p,y,R]]}function Ne(p,y){const R=i.getActiveEditor(),x=i.runHooks("beforeChange",p,y||"edit"),P=p.filter(U=>U!==null);return x===!1||P.length===0?(R&&R.cancelChanges(),[]):P}this.setDataAtCell=function(p,y,R,x){const P=je(p,y,R),U=[];let G=x,j,fe,me;for(j=0,fe=P.length;j<fe;j++){if(typeof P[j]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof P[j][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");P[j][1]>=this.countCols()?me=P[j][1]:me=a.colToProp(P[j][1]),U.push([P[j][0],me,l.getAtCell(this.toPhysicalRow(P[j][0]),P[j][1]),P[j][2]])}!G&&typeof p=="object"&&(G=y);const ne=Ne(U,x);i.runHooks("afterSetDataAtCell",ne,G),ke(ne,G,()=>{nt(ne,G)})},this.setDataAtRowProp=function(p,y,R,x){const P=je(p,y,R),U=[];let G=x,j,fe;for(j=0,fe=P.length;j<fe;j++)U.push([P[j][0],P[j][1],l.getAtCell(this.toPhysicalRow(P[j][0]),P[j][1]),P[j][2]]);!G&&typeof p=="object"&&(G=y);const me=Ne(U,x);i.runHooks("afterSetDataAtRowProp",me,G),ke(me,G,()=>{nt(me,G)})},this.listen=function(){i&&!i.isListening()&&(Ay.forEach(p=>{i!==p&&p.unlisten()}),Ny=i.guid,i.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Ny=null,i.runHooks("afterUnlisten"))},this.isListening=function(){return Ny===i.guid},this.destroyEditor=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(p),i.view.render(),y&&ie.isSelected()&&c.prepareEditor()},this.populateFromArray=function(p,y,R,x,P,U,G){if(!(typeof R=="object"&&typeof R[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const j=typeof x=="number"?i._createCellCoords(x,P):null;return u.populateFromArray(i._createCellCoords(p,y),R,j,U,G)},this.spliceCol=function(p,y,R){for(var x=arguments.length,P=new Array(x>3?x-3:0),U=3;U<x;U++)P[U-3]=arguments[U];return a.spliceCol(p,y,R,...P)},this.spliceRow=function(p,y,R){for(var x=arguments.length,P=new Array(x>3?x-3:0),U=3;U<x;U++)P[U-3]=arguments[U];return a.spliceRow(p,y,R,...P)},this.getSelected=function(){if(ie.isSelected())return Ja(ie.getSelectedRange(),p=>{let{from:y,to:R}=p;return[y.row,y.col,R.row,R.col]})},this.getSelectedLast=function(){const p=this.getSelected();let y;return p&&p.length>0&&(y=p[p.length-1]),y},this.getSelectedRange=function(){if(ie.isSelected())return Array.from(ie.getSelectedRange())},this.getSelectedRangeLast=function(){const p=this.getSelectedRange();let y;return p&&p.length>0&&(y=p[p.length-1]),y},this.emptySelectedCells=function(p){if(!ie.isSelected()||this.countRows()===0||this.countCols()===0)return;const y=[];Je(ie.getSelectedRange(),R=>{if(R.isSingleHeader())return;const x=R.getTopStartCorner(),P=R.getBottomEndCorner();vs(x.row,P.row,U=>{vs(x.col,P.col,G=>{this.getCellMeta(U,G).readOnly||y.push([U,G,null])})})}),y.length>0&&this.setDataAtCell(y,p)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const p=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(p,0),!this.isRenderSuspended()&&p===this.renderSuspendedCounter&&(this.renderCall?this.render():i.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||i.view.render())},this.batchRender=function(p){this.suspendRender();const y=p();return this.resumeRender(),y},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const y=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(y,0),(!this.isExecutionSuspended()&&y===this.executionSuspendedCounter||p)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(p){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const R=p();return this.resumeExecution(y),R},this.batch=function(p){this.suspendRender(),this.suspendExecution();const y=p();return this.resumeExecution(),this.resumeRender(),y},this.refreshDimensions=function(){if(!i.view)return;const{width:p,height:y}=i.view.getLastSize(),{width:R,height:x}=i.rootElement.getBoundingClientRect(),P=R!==p||x!==y;i.runHooks("beforeRefreshDimensions",{width:p,height:y},{width:R,height:x},P)!==!1&&((P||i.view._wt.wtOverlays.scrollableElement===i.rootWindow)&&(i.view.setLastSize(R,x),i.render()),i.runHooks("afterRefreshDimensions",{width:p,height:y},{width:R,height:x},P))},this.updateData=function(p,y){tb(p,R=>{a=R},R=>{a=R,i.columnIndexMapper.fitToLength(this.getInitialColumnCount()),i.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),ie.refresh()},{hotInstance:i,dataMap:a,dataSource:l,internalSource:"updateData",source:y,metaManager:O,firstRun:m})},this.loadData=function(p,y){tb(p,R=>{a=R},()=>{O.clearCellsCache(),i.initIndexMappers(),u.adjustRowsAndCols(),ie.refresh(),m&&(m=[null,"loadData"])},{hotInstance:i,dataMap:a,dataSource:l,internalSource:"loadData",source:y,metaManager:O,firstRun:m})},this.getInitialColumnCount=function(){const p=T.columns;let y=0;if(Array.isArray(p))y=p.length;else if(Bt(p))if(i.dataType==="array"){const R=this.countSourceCols();for(let x=0;x<R;x+=1)p(x)&&(y+=1)}else(i.dataType==="object"||i.dataType==="function")&&(y=a.colToPropCache.length);else if(at(T.dataSchema)){const R=a.getSchema();y=Array.isArray(R)?R.length:xw(R)}else y=this.countSourceCols();return y},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(p,y,R,x){return Ln(p)?a.getAll():a.getRange(i._createCellCoords(p,y),i._createCellCoords(R,x),a.DESTINATION_RENDERER)},this.getCopyableText=function(p,y,R,x){return a.getCopyableText(i._createCellCoords(p,y),i._createCellCoords(R,x))},this.getCopyableData=function(p,y){return a.getCopyable(p,a.colToProp(y))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(p){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const R=(m?i.loadData:i.updateData).bind(this);let x=!1,P,U;if(at(p.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(at(p.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(at(p.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(P in p)P==="data"||(P==="language"?Ie(p.language):P==="className"?_e("className",p.className):P==="tableClassName"&&i.table?(_e("tableClassName",p.tableClassName),i.view._wt.wtOverlays.syncOverlayTableClassNames()):In.getSingleton().isRegistered(P)||In.getSingleton().isDeprecated(P)?(Bt(p[P])||Array.isArray(p[P]))&&(p[P].initialHook=!0,i.addHook(P,p[P])):!y&&Au(p,P)&&(_[P]=p[P]));p.data===void 0&&T.data===void 0?R(null,"updateSettings"):p.data!==void 0?R(p.data,"updateSettings"):p.columns!==void 0&&(a.createMap(),i.initIndexMappers());const G=i.countCols(),j=T.columns;if(j&&Bt(j)&&(x=!0),(p.cell!==void 0||p.cells!==void 0||p.columns!==void 0)&&O.clearCache(),G>0)for(P=0,U=0;P<G;P++){if(j){const ne=x?j(P):j[U];ne&&O.updateColumnMeta(U,ne)}U+=1}at(p.cell)&&Lt(p.cell,ne=>{i.setCellMetaObject(ne.row,ne.col,ne)}),i.runHooks("afterCellMetaReset");let fe=i.rootElement.style.height;fe!==""&&(fe=parseInt(i.rootElement.style.height,10));let me=p.height;if(Bt(me)&&(me=me()),y&&i.rootElement.getAttribute("style")&&i.rootElement.setAttribute("data-initialstyle",i.rootElement.getAttribute("style")),me===null){const ne=i.rootElement.getAttribute("data-initialstyle");ne&&(ne.indexOf("height")>-1||ne.indexOf("overflow")>-1)?i.rootElement.setAttribute("style",ne):(i.rootElement.style.height="",i.rootElement.style.overflow="")}else me!==void 0&&(i.rootElement.style.height=isNaN(me)?`${me}`:`${me}px`,i.rootElement.style.overflow="hidden");if(typeof p.width<"u"){let ne=p.width;Bt(ne)&&(ne=ne()),i.rootElement.style.width=isNaN(ne)?`${ne}`:`${ne}px`}y||(i.view&&(i.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),i.view._wt.exportSettingsAsClassNames()),i.runHooks("afterUpdateSettings",p)),u.adjustRowsAndCols(),i.view&&!m&&(i.forceFullRender=!0,i.view.render(),i.view._wt.wtOverlays.adjustElementsSize()),!y&&i.view&&(fe===""||me===""||me===void 0)&&fe!==me&&i.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const p=i.getSelectedLast();if(T.getValue){if(Bt(T.getValue))return T.getValue.call(i);if(p)return i.getData()[p[0][0]][T.getValue]}else if(p)return i.getDataAtCell(p[0],p[1])},this.getSettings=function(){return T},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(p,y,R,x,P){u.alter(p,y,R,x,P)},this.getCell=function(p,y){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,x=y,P=p;if(y>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(y)))return null;x=this.columnIndexMapper.getRenderableFromVisualIndex(y)}if(p>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(p)))return null;P=this.rowIndexMapper.getRenderableFromVisualIndex(p)}return P===null||x===null||P===void 0||x===void 0?null:i.view.getCellAtCoords(i._createCellCoords(P,x),R)},this.getCoords=function(p){const y=this.view._wt.wtTable.getCoords(p);if(y===null)return null;const{row:R,col:x}=y;let P=R,U=x;return R>=0&&(P=this.rowIndexMapper.getVisualFromRenderableIndex(R)),x>=0&&(U=this.columnIndexMapper.getVisualFromRenderableIndex(x)),i._createCellCoords(P,U)},this.colToProp=function(p){return a.colToProp(p)},this.propToCol=function(p){return a.propToCol(p)},this.toVisualRow=p=>this.rowIndexMapper.getVisualFromPhysicalIndex(p),this.toVisualColumn=p=>this.columnIndexMapper.getVisualFromPhysicalIndex(p),this.toPhysicalRow=p=>this.rowIndexMapper.getPhysicalFromVisualIndex(p),this.toPhysicalColumn=p=>this.columnIndexMapper.getPhysicalFromVisualIndex(p),this.getDataAtCell=function(p,y){return a.get(p,a.colToProp(y))},this.getDataAtRowProp=function(p,y){return a.get(p,y)},this.getDataAtCol=function(p){const y=[],R=a.getRange(i._createCellCoords(0,p),i._createCellCoords(T.data.length-1,p),a.DESTINATION_RENDERER);for(let x=0;x<R.length;x+=1)for(let P=0;P<R[x].length;P+=1)y.push(R[x][P]);return y},this.getDataAtProp=function(p){const y=[],R=a.getRange(i._createCellCoords(0,a.propToCol(p)),i._createCellCoords(T.data.length-1,a.propToCol(p)),a.DESTINATION_RENDERER);for(let x=0;x<R.length;x+=1)for(let P=0;P<R[x].length;P+=1)y.push(R[x][P]);return y},this.getSourceData=function(p,y,R,x){let P;return p===void 0?P=l.getData():P=l.getByRange(i._createCellCoords(p,y),i._createCellCoords(R,x)),P},this.getSourceDataArray=function(p,y,R,x){let P;return p===void 0?P=l.getData(!0):P=l.getByRange(i._createCellCoords(p,y),i._createCellCoords(R,x),!0),P},this.getSourceDataAtCol=function(p){return l.getAtColumn(p)},this.setSourceDataAtCell=function(p,y,R,x){const P=je(p,y,R),U=this.hasHook("afterSetSourceDataAtCell"),G=[];U&&Je(P,fe=>{let[me,ne,b]=fe;G.push([me,ne,l.getAtCell(me,ne),b])}),Je(P,fe=>{let[me,ne,b]=fe;l.setAtCell(me,ne,b)}),U&&this.runHooks("afterSetSourceDataAtCell",G,x),this.render();const j=i.getActiveEditor();j&&at(j.refreshValue)&&j.refreshValue()},this.getSourceDataAtRow=function(p){return l.getAtRow(p)},this.getSourceDataAtCell=function(p,y){return l.getAtCell(p,y)},this.getDataAtRow=function(p){return a.getRange(i._createCellCoords(p,0),i._createCellCoords(p,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(p,y,R,x){const P=p===void 0?[0,0,this.countRows(),this.countCols()]:[p,y,R,x],[U,G]=P;let[,,j,fe]=P,me=null,ne=null;j===void 0&&(j=U),fe===void 0&&(fe=G);let b="mixed";return vs(Math.max(Math.min(U,j),0),Math.max(U,j),M=>{let D=!0;return vs(Math.max(Math.min(G,fe),0),Math.max(G,fe),W=>(ne=this.getCellMeta(M,W).type,me?D=me===ne:me=ne,D)),b=D?ne:"mixed",D}),b},this.removeCellMeta=function(p,y,R){const[x,P]=[this.toPhysicalRow(p),this.toPhysicalColumn(y)];let U=O.getCellMetaKeyValue(x,P,R);i.runHooks("beforeRemoveCellMeta",p,y,R,U)!==!1&&(O.removeCellMeta(x,P,R),i.runHooks("afterRemoveCellMeta",p,y,R,U)),U=null},this.spliceCellsMeta=function(p){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var R=arguments.length,x=new Array(R>2?R-2:0),P=2;P<R;P++)x[P-2]=arguments[P];if(x.length>0&&!Array.isArray(x[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");y>0&&O.removeRow(this.toPhysicalRow(p),y),x.length>0&&Je(x.reverse(),U=>{O.createRow(this.toPhysicalRow(p)),Je(U,(G,j)=>this.setCellMetaObject(p,j,G))}),i.render()},this.setCellMetaObject=function(p,y,R){typeof R=="object"&&Lt(R,(x,P)=>{this.setCellMeta(p,y,P,x)})},this.setCellMeta=function(p,y,R,x){if(i.runHooks("beforeSetCellMeta",p,y,R,x)===!1)return;let U=p,G=y;p<this.countRows()&&(U=this.toPhysicalRow(p)),y<this.countCols()&&(G=this.toPhysicalColumn(y)),O.setCellMeta(U,G,R,x),i.runHooks("afterSetCellMeta",p,y,R,x)},this.getCellsMeta=function(){return O.getCellsMeta()},this.getCellMeta=function(p,y){let R=this.toPhysicalRow(p),x=this.toPhysicalColumn(y);return R===null&&(R=p),x===null&&(x=y),O.getCellMeta(R,x,{visualRow:p,visualColumn:y})},this.getColumnMeta=function(p){return O.getColumnMeta(this.toPhysicalColumn(p))},this.getCellMetaAtRow=function(p){return O.getCellsMetaAtRow(p)},this.isColumnModificationAllowed=function(){return!(i.dataType==="object"||T.columns)},this.getCellRenderer=function(p,y){const R=typeof p=="number"?i.getCellMeta(p,y).renderer:p.renderer;return typeof R=="string"?vT(R):Ln(R)?vT("text"):R},this.getCellEditor=function(p,y){const R=typeof p=="number"?i.getCellMeta(p,y).editor:p.editor;return typeof R=="string"?lT(R):Ln(R)?lT("text"):R},this.getCellValidator=function(p,y){const R=typeof p=="number"?i.getCellMeta(p,y).validator:p.validator;return typeof R=="string"?S6(R):R},this.validateCells=function(p){this._validateCells(p)},this.validateRows=function(p,y){if(!Array.isArray(p))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(y,p)},this.validateColumns=function(p,y){if(!Array.isArray(p))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(y,void 0,p)},this._validateCells=function(p,y,R){const x=new tt;p&&(x.onQueueEmpty=p);let P=i.countRows()-1;for(;P>=0;){if(y!==void 0&&y.indexOf(P)===-1){P-=1;continue}let U=i.countCols()-1;for(;U>=0;){if(R!==void 0&&R.indexOf(U)===-1){U-=1;continue}x.addValidatorToQueue(),i.validateCell(i.getDataAtCell(P,U),i.getCellMeta(P,U),G=>{if(typeof G!="boolean")throw new Error("Validation error: result is not boolean");G===!1&&(x.valid=!1),x.removeValidatorFormQueue()},"validateCells"),U-=1}P-=1}x.checkIfQueueIsEmpty()},this.getRowHeader=function(p){let y=T.rowHeaders,R=p;return R!==void 0&&(R=i.runHooks("modifyRowHeader",R)),R===void 0?(y=[],vs(i.countRows()-1,x=>{y.push(i.getRowHeader(x))})):Array.isArray(y)&&y[R]!==void 0?y=y[R]:Bt(y)?y=y(R):y&&typeof y!="string"&&typeof y!="number"&&(y=R+1),y},this.hasRowHeaders=function(){return!!T.rowHeaders},this.hasColHeaders=function(){if(T.colHeaders!==void 0&&T.colHeaders!==null)return!!T.colHeaders;for(let p=0,y=i.countCols();p<y;p++)if(i.getColHeader(p))return!0;return!1},this.getColHeader=function(p){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const R=i.runHooks("modifyColHeader",p);if(R===void 0){const j=[],fe=i.countCols();for(let me=0;me<fe;me++)j.push(i.getColHeader(me));return j}let x=T.colHeaders;const P=function(j){const fe=[],me=i.countCols();let ne=0;for(;ne<me;ne++)Bt(T.columns)&&T.columns(ne)&&fe.push(ne);return fe[j]},U=i.toPhysicalColumn(R),G=P(U);return T.colHeaders===!1?x=null:T.columns&&Bt(T.columns)&&T.columns(G)&&T.columns(G).title?x=T.columns(G).title:T.columns&&T.columns[U]&&T.columns[U].title?x=T.columns[U].title:Array.isArray(T.colHeaders)&&T.colHeaders[U]!==void 0?x=T.colHeaders[U]:Bt(T.colHeaders)?x=T.colHeaders(U):T.colHeaders&&typeof T.colHeaders!="string"&&typeof T.colHeaders!="number"&&(x=T9(R)),x=i.runHooks("modifyColumnHeaderValue",x,p,y),x},this._getColWidthFromSettings=function(p){let y;if(p>=0&&(y=i.getCellMeta(0,p).width),(y===void 0||y===T.width)&&(y=T.colWidths),y!=null){switch(typeof y){case"object":y=y[p];break;case"function":y=y(p);break}typeof y=="string"&&(y=parseInt(y,10))}return y},this.getColWidth=function(p){let y=i._getColWidthFromSettings(p);return y=i.runHooks("modifyColWidth",y,p),y===void 0&&(y=Hw),y},this._getRowHeightFromSettings=function(p){let y=T.rowHeights;if(y!=null){switch(typeof y){case"object":y=y[p];break;case"function":y=y(p);break}typeof y=="string"&&(y=parseInt(y,10))}return y},this.getRowHeight=function(p){let y=i._getRowHeightFromSettings(p);return y=i.runHooks("modifyRowHeight",y,p),y},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const p=T.maxCols,y=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(p,y)},this.countRenderedRows=function(){return i.view._wt.drawn?i.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return i.view._wt.drawn?i.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return i.view._wt.drawn?i.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return i.view._wt.drawn?i.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,y=0;return yT(i.countRows()-1,R=>{if(i.isEmptyRow(R))y+=1;else if(p===!0)return!1}),y},this.countEmptyCols=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,y=0;return yT(i.countCols()-1,R=>{if(i.isEmptyCol(R))y+=1;else if(p===!0)return!1}),y},this.isEmptyRow=function(p){return T.isEmptyRow.call(i,p)},this.isEmptyCol=function(p){return T.isEmptyCol.call(i,p)},this.selectCell=function(p,y,R,x){let P=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,U=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Ln(p)||Ln(y)?!1:this.selectCells([[p,y,R,x]],P,U)},this.selectCells=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;y===!1&&d.suspend();const x=ie.selectCells(p);return x&&R&&i.listen(),d.resume(),x},this.selectColumns=function(p){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p,R=arguments.length>2?arguments[2]:void 0;return ie.selectColumns(p,y,R)},this.selectRows=function(p){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p,R=arguments.length>2?arguments[2]:void 0;return ie.selectRows(p,y,R)},this.deselectCell=function(){ie.deselect()},this.selectAll=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p,R=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),ie.selectAll(p,y,R)};const ue=(p,y)=>p.getNearestNotHiddenIndex(y,1,!0);this.scrollViewportTo=function(p){var y;if(typeof p=="number"){var R;p={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(R=arguments[4])!==null&&R!==void 0?R:!0}}const{row:x,col:P,verticalSnap:U,horizontalSnap:G,considerHiddenIndexes:j}=(y=p)!==null&&y!==void 0?y:{};let fe,me,ne,b;U!==void 0&&(fe=U==="top",me=!fe),G!==void 0&&(ne=G==="start",b=!ne);let M=x,D=P;if(j===void 0||j){const $=Number.isInteger(x)&&x>=0,K=Number.isInteger(P)&&P>=0,Y=$?ue(this.rowIndexMapper,x):void 0,z=K?ue(this.columnIndexMapper,P):void 0;if(Y===null||z===null)return!1;M=$?i.rowIndexMapper.getRenderableFromVisualIndex(Y):x,D=K?i.columnIndexMapper.getRenderableFromVisualIndex(z):P}const W=Number.isInteger(M),k=Number.isInteger(D);return W&&M>=0&&k&&D>=0?i.view.scrollViewport(i._createCellCoords(M,D),fe,b,me,ne):W&&M>=0&&(k&&D<0||!k)?i.view.scrollViewportVertically(M,fe,me):k&&D>=0&&(W&&M<0||!W)?i.view.scrollViewportHorizontally(D,b,ne):!1},this.scrollToFocusedCell=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",p);const{highlight:y}=this.getSelectedRangeLast();this.scrollViewportTo(y.toObject())?this.view.render():(this.removeHook("afterScroll",p),this._registerImmediate(()=>p()))},this.destroy=function(){if(i._clearTimeouts(),i._clearImmediates(),i.view&&i.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),O.clearCache(),Ay.delete(this.guid),Hf(i)){const p=this.rootDocument.querySelector(".hot-display-license-info");p&&p.parentNode.removeChild(p)}bu(i.rootElement),o.destroy(),c&&c.destroy(),i.batchExecution(()=>{i.rowIndexMapper.unregisterAll(),i.columnIndexMapper.unregisterAll(),V.getItems().forEach(p=>{let[,y]=p;y.destroy()}),V.clear(),i.runHooks("afterDestroy")},!0),In.getSingleton().destroy(i),Lt(i,(p,y,R)=>{Bt(p)?R[y]=Ae(y):y!=="guid"&&(R[y]=null)}),i.isDestroyed=!0,a&&a.destroy(),a=null,u=null,ie=null,c=null,i=null};function Ae(p){return()=>{throw new Error(`The "${p}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return i.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return i.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return i.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return i.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return i.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return i.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return i.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return i.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return i.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return i.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return i.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return i.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(p){const y=Aw(p);return y==="UndoRedo"?this.undoRedo:V.getItem(y)},this.getPluginName=function(p){return p===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:V.getId(p)},this.getInstance=function(){return i},this.addHook=function(p,y,R){In.getSingleton().add(p,y,i,R)},this.hasHook=function(p){return In.getSingleton().has(p,i)||In.getSingleton().has(p)},this.addHookOnce=function(p,y,R){In.getSingleton().once(p,y,i,R)},this.removeHook=function(p,y){In.getSingleton().remove(p,y,i)},this.runHooks=function(p,y,R,x,P,U,G){return In.getSingleton().run(i,p,y,R,x,P,U,G)},this.getTranslatedPhrase=function(p,y){return w_(T.language,p,y)},this.toHTML=()=>gT(this),this.toTableElement=()=>{const p=this.rootDocument.createElement("div");return p.insertAdjacentHTML("afterbegin",gT(this)),p.firstElementChild},this.timeouts=[],this._registerTimeout=function(p){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,R=p;typeof R=="function"&&(R=setTimeout(R,y)),this.timeouts.push(R)},this._clearTimeouts=function(){Je(this.timeouts,p=>{clearTimeout(p)})},this.immediates=[],this._registerImmediate=function(p){this.immediates.push(setImmediate(p))},this._clearImmediates=function(){Je(this.immediates,p=>{clearImmediate(p)})},this._getEditorManager=function(){return c},this.isRtl=function(){return i.rootWindow.getComputedStyle(i.rootElement).direction==="rtl"},this.isLtr=function(){return!i.isRtl()},this.getDirectionFactor=function(){return i.isLtr()?1:-1};const bt=x7({handleEvent(){return i.isListening()},beforeKeyDown:p=>this.runHooks("beforeKeyDown",p),afterKeyDown:p=>{this.isDestroyed||i.runHooks("afterDocumentKeyDown",p)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",p=>{p.ctrlKey===!1&&p.metaKey===!1&&bt.releasePressedKeys()}),this.getShortcutManager=function(){return bt},this.getFocusManager=function(){return h},f6().forEach(p=>{const y=m6(p);V.addItem(p,new y(this))}),p7(i),bt.setActiveContextName("grid"),In.getSingleton().run(i,"construct")}function ab(r,e,t){r.addEventListener(e,t,!1)}function lb(r,e,t){r.removeEventListener(e,t,!1)}function ub(r){return r.ownerDocument.defaultView.getComputedStyle(r)}function L7(r){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t=r.body,n=r.createTextNode(""),s=r.createElement("span");let i;function o(){n.textContent=i.value,s.style.position="absolute",s.style.fontSize=ub(i).fontSize,s.style.fontFamily=ub(i).fontFamily,s.style.whiteSpace="pre",t.appendChild(s);const c=s.clientWidth+2;t.removeChild(s);const h=i.style;h.height=`${e.minHeight}px`,e.minWidth>c?h.width=`${e.minWidth}px`:c>e.maxWidth?h.width=`${e.maxWidth}px`:h.width=`${c}px`;const d=i.scrollHeight?i.scrollHeight-1:0;e.minHeight>d?h.height=`${e.minHeight}px`:e.maxHeight<d?(h.height=`${e.maxHeight}px`,h.overflowY="visible"):h.height=`${d}px`}function a(){r.defaultView.setTimeout(o,0)}function l(c){if(c&&c.minHeight)if(c.minHeight==="inherit")e.minHeight=i.clientHeight;else{const h=parseInt(c.minHeight,10);isNaN(h)||(e.minHeight=h)}if(c&&c.maxHeight)if(c.maxHeight==="inherit")e.maxHeight=i.clientHeight;else{const h=parseInt(c.maxHeight,10);isNaN(h)||(e.maxHeight=h)}if(c&&c.minWidth)if(c.minWidth==="inherit")e.minWidth=i.clientWidth;else{const h=parseInt(c.minWidth,10);isNaN(h)||(e.minWidth=h)}if(c&&c.maxWidth)if(c.maxWidth==="inherit")e.maxWidth=i.clientWidth;else{const h=parseInt(c.maxWidth,10);isNaN(h)||(e.maxWidth=h)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(n))}function u(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;i=c,l(h),i.nodeName==="TEXTAREA"&&(i.style.resize="none",i.style.height=`${e.minHeight}px`,i.style.minWidth=`${e.minWidth}px`,i.style.maxWidth=`${e.maxWidth}px`,i.style.overflowY="hidden"),d&&(ab(i,"input",o),ab(i,"keydown",a)),o()}return{init:u,resize:o,unObserve(){lb(i,"input",o),lb(i,"keydown",a)}}}function cb(r,e){const t=Wj(e),n=e.value.split(`
`);let s=t,i=0;for(let o=0;o<n.length;o++){const a=n[o];o!==0&&(i+=n[o-1].length+1);const l=i+a.length;if(r==="home"?s=i:r==="end"&&(s=l),t<=l)break}XI(e,s)}function Da(r,e,t){return(e=P7(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function P7(r){var e=F7(r,"string");return typeof e=="symbol"?e:e+""}function F7(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}const D7="ht_editor_visible",of="ht_editor_hidden",hb="textEditor",H7="text";class V7 extends iR{static get EDITOR_TYPE(){return H7}constructor(e){super(e),Da(this,"eventManager",new Ou(this)),Da(this,"autoResize",L7(this.hot.rootDocument)),Da(this,"TEXTAREA",void 0),Da(this,"textareaStyle",void 0),Da(this,"TEXTAREA_PARENT",void 0),Da(this,"textareaParentStyle",void 0),Da(this,"layerClass",void 0),this.eventManager=new Ou(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),Fj(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,n,s,i,o){const a=this.state;if(super.prepare(e,t,n,s,i,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=o;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==yr.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,t){this.state===yr.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),XI(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Yt(this.TEXTAREA,[["data-hot-input",""],Pp(-1)]),dt(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),dt(this.TEXTAREA_PARENT,"handsontableInputHolder"),zt(this.TEXTAREA_PARENT,this.layerClass)&&Nr(this.TEXTAREA_PARENT,this.layerClass),dt(this.TEXTAREA_PARENT,of),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){w3()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Nr(this.TEXTAREA_PARENT,this.layerClass),dt(this.TEXTAREA_PARENT,of)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;vs(e.length-1,n=>{const s=e[n];if(zt(s,"handsontableEditor"))return t=!0,!1}),zt(this.TEXTAREA_PARENT,of)&&Nr(this.TEXTAREA_PARENT,of),t?(this.layerClass=D7,dt(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),dt(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==yr.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:t,start:n,width:s,maxWidth:i,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=ia(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=ia(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),h=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),d=s-c,m=o-h,E=i-c,g=a-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(d,E),minHeight:Math.min(m,g),maxWidth:E,maxHeight:g},!0)}bindEvents(){nM()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===yr.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===yr.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>at(this.hot.getSelected()),group:hb},s=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};t.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(s(),!1),runOnlyIf:i=>!this.hot.selection.isMultiple()&&!i.altKey},{keys:[["Meta","Enter"]],callback:()=>(s(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(s(),!1)},{keys:[["Home"]],callback:(i,o)=>{let[a]=o;cb(a,this.TEXTAREA)}},{keys:[["End"]],callback:(i,o)=>{let[a]=o;cb(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(hb)}}const U7="base";function V_(r,e,t,n,s,i,o){const a=o.ariaTags,l=[],u=[],c=[],h=[];o.className&&dt(e,o.className),o.readOnly?(l.push(o.readOnlyCellClassName),a&&h.push(GC())):a&&c.push(GC()[0]),o.valid===!1&&o.invalidCellClassName?(l.push(o.invalidCellClassName),a&&h.push(zC())):(u.push(o.invalidCellClassName),a&&c.push(zC()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&l.push(o.noWordWrapClassName),!i&&o.placeholder&&l.push(o.placeholderCellClassName),Nr(e,u),dt(e,l),Wh(e,c),Yt(e,h)}V_.RENDERER_TYPE=U7;const k7="text";function U_(r,e,t,n,s,i,o){V_.apply(this,[r,e,t,n,s,i,o]);let a=i;if(!a&&o.placeholder&&(a=o.placeholder),a=DI(a),o.trimWhitespace&&(a=a.trim()),o.rendererTemplate){bu(e);const l=r.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=r.getSourceDataAtRow(t),e.appendChild(l)}else $h(e,a)}U_.RENDERER_TYPE=k7;const B7="text",W7={CELL_TYPE:B7,editor:V7,renderer:U_};WX(W7);Zn.editors={BaseEditor:iR};function Zn(r,e){const t=new H_(r,e||{},Jw);return t.init(),t}Zn.Core=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new H_(r,e,Jw)};Zn.DefaultSettings=I_();Zn.hooks=In.getSingleton();Zn.CellCoords=tl;Zn.CellRange=zh;Zn.packageName="handsontable";Zn.buildDate="07/02/2025 16:13:23";Zn.version="14.6.2";Zn.languages={dictionaryKeys:nX,getLanguageDictionary:v_,getLanguagesDictionaries:lX,registerLanguageDictionary:E_,getTranslatedPhrase:w_};function $7(r,e,t){return(e=Y7(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function db(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,n)}return t}function G7(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?db(Object(t),!0).forEach(function(n){$7(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):db(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function z7(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Y7(r){var e=z7(r,"string");return typeof e=="symbol"?e:e+""}function Xc(r){"@babel/helpers - typeof";return Xc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xc(r)}var gu=Symbol("unassigned"),j7="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function _m(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function k_(r){var e=Zn.hooks.getRegistered(),t={};Object.assign(t,Zn.DefaultSettings);for(var n in t)t[n]={default:gu};for(var s=0;s<e.length;s++)t[e[s]]={default:gu};return t.settings={default:gu},r==="HotTable"&&(t.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),t}function B_(r){var e={},t=r.settings;if(t!==gu)for(var n in t)_m(t,n)&&t[n]!==gu&&(e[n]=t[n]);for(var s in r)_m(r,s)&&s!=="settings"&&r[s]!==gu&&(e[s]=r[s]);return e}function fb(r,e){var t=B_(r),n=r.settings?r.settings:t,s=r.settings?t:null,i={};for(var o in n)_m(n,o)&&n[o]!==void 0&&(!(e&&o!=="data")||!mb(e[o],n[o]))&&(i[o]=n[o]);for(var a in s)_m(s,a)&&a!=="id"&&a!=="settings"&&s[a]!==void 0&&(!(e&&a!=="data")||!mb(e[a],s[a]))&&(i[a]=s[a]);return i}function mb(r,e){var t=function(s){var i=function(){var o=new WeakSet;return function(a,l){if(Xc(l)==="object"&&l!==null){if(o.has(l))return;o.add(l)}return l}}();return JSON.stringify(s,i)};return typeof r=="function"&&typeof e=="function"?r.toString()===e.toString():Xc(r)!==Xc(e)?!1:t(r)===t(e)}var K7="14.6.2",oR=Lv({name:"HotTable",props:k_("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(e){var t=fb(e,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||t===void 0||(t.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete t.data),Object.keys(t).length?this.hotInstance.updateSettings(t):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(j7),null)},set hotInstance(e){this.__hotInstance=e}}},methods:{hotInit:function(){var e=fb(this.$props);e.columns=this.columnSettings?this.columnSettings:e.columns,this.hotInstance=uA(new Zn.Core(this.$el,e)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var t=this.hotInstance.getSourceData(),n=[],s=[],i=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),o=this.hotInstance.isColumnModificationAllowed(),a=0;if(t&&t.length!==i&&t.length<i)for(var l=t.length;l<i;l++)n.push(l);if(o){var u;if(a=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),t&&t[0]&&((u=t[0])===null||u===void 0?void 0:u.length)!==a&&t[0].length<a)for(var c=t[0].length;c<a;c++)s.push(c)}this.hotInstance.batch(function(){n.length>0?e.hotInstance.rowIndexMapper.removeIndexes(n):e.hotInstance.rowIndexMapper.insertIndexes(i-1,t.length-i),o&&t.length!==0&&(s.length>0?e.hotInstance.columnIndexMapper.removeIndexes(s):e.hotInstance.columnIndexMapper.insertIndexes(a-1,t[0].length-a))})}},getColumnSettings:function(){var e=Array.from(this.columnsCache.values());return e.length?e:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:K7}),X7=["id"];function q7(r,e,t,n,s,i){return pr(),Zr("div",{id:r.id},[iF(r.$slots,"default")],8,X7)}oR.render=q7;oR.__file="src/HotTable.vue";var Q7=Lv({name:"HotColumn",props:k_("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var e=B_(this.$props),t=G7({},e);e.renderer&&(t.renderer=e.renderer),e.editor&&(t.editor=e.editor),this.columnsCache.set(this,t)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});Q7.__file="src/HotColumn.vue";const W_="pv-sheets:v1";function Z7(){var r;try{const e=localStorage.getItem(W_);if(!e)return{sheets:[Bf("Planilha 1")],activeId:null};const t=JSON.parse(e);return(r=t.sheets)!=null&&r.length||(t.sheets=[Bf("Planilha 1")]),t.activeId||(t.activeId=t.sheets[0].id),t}catch{return{sheets:[Bf("Planilha 1")],activeId:null}}}function J7(r){try{localStorage.setItem(W_,JSON.stringify(r))}catch{}}function Bf(r){const n=Array.from({length:100},()=>Array.from({length:26},()=>""));return{id:crypto.randomUUID?crypto.randomUUID():String(Date.now()),name:r,data:n}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var er;(function(r){r.RELATIVE="RELATIVE",r.ABSOLUTE="ABSOLUTE"})(er||(er={}));class mn{constructor(e,t,n){this.type=e,this.col=t,this.sheet=n}static absolute(e,t){return new mn(er.ABSOLUTE,e,t)}static relative(e,t){return new mn(er.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,n)=>t.toSimpleColumnAddress(e).col-n.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===er.ABSOLUTE}isColumnRelative(){return this.type===er.RELATIVE}isAbsolute(){return this.type===er.ABSOLUTE&&this.sheet!==void 0}moved(e,t,n){const s=this.sheet===void 0?void 0:e;return new mn(this.type,this.col+t,s)}shiftedByColumns(e){return new mn(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){const t=ti(this,e);let n=this.col;return this.isColumnRelative()&&(n=e.col+this.col),y1(t,n)}shiftRelativeDimensions(e,t){const n=this.isColumnRelative()?this.col+e:this.col;return new mn(this.type,n,this.sheet)}shiftAbsoluteDimensions(e,t){const n=this.isColumnAbsolute()?this.col+e:this.col;return new mn(this.type,n,this.sheet)}withSheet(e){return new mn(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case er.RELATIVE:return`${t}#COLR${this.col}`;case er.ABSOLUTE:return`${t}#COLA${this.col}`}}unparse(e){const t=this.toSimpleColumnAddress(e);if(xJ(t))return;const n=Gp(t.col);return`${this.type===er.ABSOLUTE?"$":""}${n}`}exceedsSheetSizeLimits(e){return this.col>=e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class tn{constructor(e,t,n){this.type=e,this.row=t,this.sheet=n}static absolute(e,t){return new tn(er.ABSOLUTE,e,t)}static relative(e,t){return new tn(er.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,n)=>t.toSimpleRowAddress(e).row-n.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===er.ABSOLUTE}isRowRelative(){return this.type===er.RELATIVE}isAbsolute(){return this.type===er.ABSOLUTE&&this.sheet!==void 0}moved(e,t,n){const s=this.sheet===void 0?void 0:e;return new tn(this.type,this.row+n,s)}shiftedByRows(e){return new tn(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){const t=ti(this,e);let n=this.row;return this.isRowRelative()&&(n=e.row+this.row),g1(t,n)}shiftRelativeDimensions(e,t){const n=this.isRowRelative()?this.row+t:this.row;return new tn(this.type,n,this.sheet)}shiftAbsoluteDimensions(e,t){const n=this.isRowAbsolute()?this.row+t:this.row;return new tn(this.type,n,this.sheet)}withSheet(e){return new tn(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case er.RELATIVE:return`${t}#ROWR${this.row}`;case er.ABSOLUTE:return`${t}#ROWA${this.row}`}}unparse(e){const t=this.toSimpleRowAddress(e);return _J(t)?void 0:`${this.type===er.ABSOLUTE?"$":""}${t.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var Et;(function(r){r.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",r.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",r.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",r.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"})(Et||(Et={}));class St{constructor(e,t,n,s){this.col=e,this.row=t,this.type=n,this.sheet=s}static fromColAndRow(e,t,n){return(e.isColumnAbsolute()&&t.isRowAbsolute()?St.absolute.bind(this):e.isColumnAbsolute()?St.absoluteCol.bind(this):t.isRowAbsolute()?St.absoluteRow.bind(this):St.relative.bind(this))(e.col,t.row,n)}static relative(e,t,n){return new St(e,t,Et.CELL_REFERENCE_RELATIVE,n)}static absolute(e,t,n){return new St(e,t,Et.CELL_REFERENCE_ABSOLUTE,n)}static absoluteCol(e,t,n){return new St(e,t,Et.CELL_REFERENCE_ABSOLUTE_COL,n)}static absoluteRow(e,t,n){return new St(e,t,Et.CELL_REFERENCE_ABSOLUTE_ROW,n)}toSimpleCellAddress(e){const t=ti(this,e);return this.type===Et.CELL_REFERENCE_ABSOLUTE?he(t,this.col,this.row):this.type===Et.CELL_REFERENCE_ABSOLUTE_ROW?he(t,e.col+this.col,this.row):this.type===Et.CELL_REFERENCE_ABSOLUTE_COL?he(t,this.col,e.row+this.row):he(t,e.col+this.col,e.row+this.row)}toColumnAddress(){const e=this.isColumnRelative()?er.RELATIVE:er.ABSOLUTE;return new mn(e,this.col,this.sheet)}toRowAddress(){const e=this.isRowRelative()?er.RELATIVE:er.ABSOLUTE;return new tn(e,this.row,this.sheet)}toSimpleColumnAddress(e){const t=ti(this,e);let n=this.col;return this.isColumnRelative()&&(n+=e.col),y1(t,n)}toSimpleRowAddress(e){const t=ti(this,e);let n=this.row;return this.isRowRelative()&&(n+=e.row),g1(t,n)}isRowAbsolute(){return this.type===Et.CELL_REFERENCE_ABSOLUTE||this.type===Et.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===Et.CELL_REFERENCE_ABSOLUTE||this.type===Et.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===Et.CELL_REFERENCE_RELATIVE||this.type===Et.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===Et.CELL_REFERENCE_RELATIVE||this.type===Et.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===Et.CELL_REFERENCE_ABSOLUTE&&this.sheet!==void 0}shiftedByRows(e){return new St(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new St(this.col+e,this.row,this.type,this.sheet)}moved(e,t,n){const s=this.sheet===void 0?void 0:e;return new St(this.col+t,this.row+n,this.type,s)}withSheet(e){return new St(this.col,this.row,this.type,e)}isInvalid(e){return Fn(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,t){const n=this.isColumnAbsolute()?this.col:this.col+e,s=this.isRowAbsolute()?this.row:this.row+t;return new St(n,s,this.type,this.sheet)}shiftAbsoluteDimensions(e,t){const n=this.isColumnRelative()?this.col:this.col+e,s=this.isRowRelative()?this.row:this.row+t;return new St(n,s,this.type,this.sheet)}hash(e){const t=e&&this.sheet!==void 0?`#${this.sheet}`:"";switch(this.type){case Et.CELL_REFERENCE_RELATIVE:return`${t}#${this.row}R${this.col}`;case Et.CELL_REFERENCE_ABSOLUTE:return`${t}#${this.row}A${this.col}`;case Et.CELL_REFERENCE_ABSOLUTE_COL:return`${t}#${this.row}AC${this.col}`;case Et.CELL_REFERENCE_ABSOLUTE_ROW:return`${t}#${this.row}AR${this.col}`}}unparse(e){const t=this.toSimpleCellAddress(e);if(Fn(t))return;const n=Gp(t.col),s=this.type===Et.CELL_REFERENCE_ABSOLUTE||this.type===Et.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";return`${this.type===Et.CELL_REFERENCE_ABSOLUTE||this.type===Et.CELL_REFERENCE_ABSOLUTE_COL?"$":""}${n}${s}${t.row+1}`}exceedsSheetSizeLimits(e,t){return this.row>=t||this.col>=e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Xh=":",En="$",eq="\\s+",tq="[ \\t\\n\\r]+",$p="A-Za-z-",aR=`${$p}0-9_.`,$_=`[${$p}0-9_]+`,rq="'(((?!').|'')*)'",Uu=`(${$_}|${rq})!`,G_=`(${Uu})?\\${En}?[A-Za-z]+\\${En}?[0-9]+`,pb=`(${Uu})?\\${En}?[A-Za-z]+`,gb=`(${Uu})?\\${En}?[0-9]+`,z_="[rR][0-9]*[cC][0-9]*",nq=`(${G_})[^${aR}]`,Y_=`[${$p}_][${aR}]*`,sq=["0","1","2","3","4","5","6","7","8","9"],j_=[...Array.from(Array(26)).map((r,e)=>e+65),...Array.from(Array(26)).map((r,e)=>e+97),...Array.from(Array(496)).map((r,e)=>e+192)].map(r=>String.fromCharCode(r));/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const K_=new RegExp(`^(${Uu})?(\\${En}?)([A-Za-z]+)(\\${En}?)([0-9]+)$`),iq=new RegExp(`^(${Uu})?(\\${En}?)([A-Za-z]+)$`),oq=new RegExp(`^(${Uu})?(\\${En}?)([0-9]+)$`),aq=new RegExp(`^${$_}$`),Gl=(r,e,t)=>{const n=K_.exec(e),s=lR(n[6]);let i=zp(n,r);if(i===void 0)return;i===null&&(i=void 0);const o=Number(n[8])-1;return n[5]===En&&n[7]===En?St.absolute(s,o,i):n[5]===En?St.absoluteCol(s,o-t.row,i):n[7]===En?St.absoluteRow(s-t.col,o,i):St.relative(s-t.col,o-t.row,i)},xm=(r,e,t)=>{const n=iq.exec(e);let s=zp(n,r);if(s===void 0)return;s===null&&(s=void 0);const i=lR(n[6]);return n[5]===En?mn.absolute(i,s):mn.relative(i-t.col,s)},Lm=(r,e,t)=>{const n=oq.exec(e);let s=zp(n,r);if(s===void 0)return;s===null&&(s=void 0);const i=Number(n[6])-1;return n[5]===En?tn.absolute(i,s):tn.relative(i-t.row,s)},kE=(r,e,t)=>{const n=K_.exec(e);if(!n)return;const s=lR(n[6]);let i=zp(n,r);if(i===void 0)return;i===null&&(i=t);const o=Number(n[8])-1;return he(i,s,o)},lq=(r,e,t)=>{const n=e.split(Xh);if(n.length!==2)return;const[s,i]=n,o=kE(r,s,t);if(o===void 0)return;const a=kE(r,i,o.sheet);if(a!==void 0&&o.sheet===a.sheet)return tv(o,a)},Pm=(r,e,t)=>{const n=Gp(e.col),s=X_(e.sheet,r);if(s!==void 0)return t!==e.sheet?`${s}!${n}${e.row+1}`:`${n}${e.row+1}`},uq=(r,e,t)=>{const n=Pm(r,e.start,t),s=Pm(r,e.end,e.start.sheet);if(!(n===void 0||s===void 0))return`${n}${Xh}${s}`};function lR(r){return r.length===1?r.toUpperCase().charCodeAt(0)-65:r.split("").reduce((e,t)=>e*26+(t.toUpperCase().charCodeAt(0)-64),0)-1}function Gp(r){let e="";for(;r>=0;)e=String.fromCharCode(r%26+97)+e,r=Math.floor(r/26)-1;return e.toUpperCase()}function X_(r,e){let t=e(r);if(t!==void 0)return aq.test(t)?t:(t=t.replace(/'/g,"''"),`'${t}'`)}function zp(r,e){var t;let n=(t=r[3])!==null&&t!==void 0?t:r[2];return n?(n=n.replace(/''/g,"'"),e(n)):null}function Ct(r){return r&&r.length===0}function _o(r){return r==null?[]:Object.keys(r)}function nn(r){for(var e=[],t=Object.keys(r),n=0;n<t.length;n++)e.push(r[t[n]]);return e}function cq(r,e){for(var t=[],n=_o(r),s=0;s<n.length;s++){var i=n[s];t.push(e.call(null,r[i],i))}return t}function pe(r,e){for(var t=[],n=0;n<r.length;n++)t.push(e.call(null,r[n],n));return t}function Vn(r){for(var e=[],t=0;t<r.length;t++){var n=r[t];Array.isArray(n)?e=e.concat(Vn(n)):e.push(n)}return e}function Ns(r){return Ct(r)?void 0:r[0]}function q_(r){var e=r&&r.length;return e?r[e-1]:void 0}function be(r,e){if(Array.isArray(r))for(var t=0;t<r.length;t++)e.call(null,r[t],t);else if(cR(r))for(var n=_o(r),t=0;t<n.length;t++){var s=n[t],i=r[s];e.call(null,i,s)}else throw Error("non exhaustive match")}function Di(r){return typeof r=="string"}function As(r){return r===void 0}function ca(r){return r instanceof Function}function Br(r,e){return e===void 0&&(e=1),r.slice(e,r.length)}function vh(r,e){return e===void 0&&(e=1),r.slice(0,r.length-e)}function oi(r,e){var t=[];if(Array.isArray(r))for(var n=0;n<r.length;n++){var s=r[n];e.call(null,s)&&t.push(s)}return t}function il(r,e){return oi(r,function(t){return!e(t)})}function xs(r,e){for(var t=Object.keys(r),n={},s=0;s<t.length;s++){var i=t[s],o=r[i];e(o)&&(n[i]=o)}return n}function Te(r,e){return cR(r)?r.hasOwnProperty(e):!1}function Or(r,e){return Iu(r,function(t){return t===e})!==void 0}function Un(r){for(var e=[],t=0;t<r.length;t++)e.push(r[t]);return e}function qh(r){var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e}function Iu(r,e){for(var t=0;t<r.length;t++){var n=r[t];if(e.call(null,n))return n}}function hq(r,e){for(var t=[],n=0;n<r.length;n++){var s=r[n];e.call(null,s)&&t.push(s)}return t}function zr(r,e,t){for(var n=Array.isArray(r),s=n?r:nn(r),i=n?[]:_o(r),o=t,a=0;a<s.length;a++)o=e.call(null,o,s[a],n?a:i[a]);return o}function Qh(r){return il(r,function(e){return e==null})}function uR(r,e){e===void 0&&(e=function(n){return n});var t=[];return zr(r,function(n,s){var i=e(s);return Or(t,i)?n:(t.push(i),n.concat(s))},[])}function Qs(r){return Array.isArray(r)}function To(r){return r instanceof RegExp}function cR(r){return r instanceof Object}function Cs(r,e){for(var t=0;t<r.length;t++)if(!e(r[t],t))return!1;return!0}function Yp(r,e){return il(r,function(t){return Or(e,t)})}function Q_(r,e){for(var t=0;t<r.length;t++)if(e(r[t]))return!0;return!1}function dq(r,e){for(var t=0;t<r.length;t++)if(r[t]===e)return t;return-1}function ai(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var n=0;n<e.length;n++)for(var s=e[n],i=_o(s),o=0;o<i.length;o++){var a=i[o];r[a]=s[a]}return r}function fq(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var n=0;n<e.length;n++){var s=e[n];if(!As(s))for(var i=_o(s),o=0;o<i.length;o++){var a=i[o];Te(r,a)||(r[a]=s[a])}}return r}function jp(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return fq.apply(null,[{}].concat(r))}function Z_(r,e){var t={};return be(r,function(n){var s=e(n),i=t[s];i?i.push(n):t[s]=[n]}),t}function yb(r,e){for(var t=qh(r),n=_o(e),s=0;s<n.length;s++){var i=n[s],o=e[i];t[i]=o}return t}function _r(){}function Eb(r){return r}function mq(r){for(var e=[],t=0;t<r.length;t++){var n=r[t];e.push(n!==void 0?n:void 0)}return e}function BE(r){console&&console.error&&console.error("Error: "+r)}function hR(r){console&&console.warn&&console.warn("Warning: "+r)}function vb(){return typeof Map=="function"}function pq(r,e){e.forEach(function(t){var n=t.prototype;Object.getOwnPropertyNames(n).forEach(function(s){if(s!=="constructor"){var i=Object.getOwnPropertyDescriptor(n,s);i&&(i.get||i.set)?Object.defineProperty(r.prototype,s,i):r.prototype[s]=t.prototype[s]}})})}function J_(r){function e(){}e.prototype=r;var t=new e;function n(){return typeof t.bar}return n(),n(),r}function Fm(r){return r[r.length-1]}function ex(r){var e=new Date().getTime(),t=r(),n=new Date().getTime(),s=n-e;return{time:s,value:t}}var tx={exports:{}};(function(r){(function(e,t){r.exports?r.exports=t():e.regexpToAst=t()})(typeof self<"u"?self:Oc,function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(g){this.idx=g.idx,this.input=g.input,this.groupIdx=g.groupIdx},e.prototype.pattern=function(g){this.idx=0,this.input=g,this.groupIdx=0,this.consumeChar("/");var O=this.disjunction();this.consumeChar("/");for(var T={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":a(T,"global");break;case"i":a(T,"ignoreCase");break;case"m":a(T,"multiLine");break;case"u":a(T,"unicode");break;case"y":a(T,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:T,value:O}},e.prototype.disjunction=function(){var g=[];for(g.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),g.push(this.alternative());return{type:"Disjunction",value:g}},e.prototype.alternative=function(){for(var g=[];this.isTerm();)g.push(this.term());return{type:"Alternative",value:g}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var g;switch(this.popChar()){case"=":g="Lookahead";break;case"!":g="NegativeLookahead";break}l(g);var O=this.disjunction();return this.consumeChar(")"),{type:g,value:O}}u()},e.prototype.quantifier=function(g){var O;switch(this.popChar()){case"*":O={atLeast:0,atMost:1/0};break;case"+":O={atLeast:1,atMost:1/0};break;case"?":O={atLeast:0,atMost:1};break;case"{":var T=this.integerIncludingZero();switch(this.popChar()){case"}":O={atLeast:T,atMost:T};break;case",":var _;this.isDigit()?(_=this.integerIncludingZero(),O={atLeast:T,atMost:_}):O={atLeast:T,atMost:1/0},this.consumeChar("}");break}if(g===!0&&O===void 0)return;l(O);break}if(!(g===!0&&O===void 0))return l(O),this.peekChar(0)==="?"?(this.consumeChar("?"),O.greedy=!1):O.greedy=!0,O.type="Quantifier",O},e.prototype.atom=function(){var g;switch(this.peekChar()){case".":g=this.dotAll();break;case"\\":g=this.atomEscape();break;case"[":g=this.characterClass();break;case"(":g=this.group();break}return g===void 0&&this.isPatternCharacter()&&(g=this.patternCharacter()),l(g),this.isQuantifier()&&(g.quantifier=this.quantifier()),g},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[i(`
`),i("\r"),i("\u2028"),i("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){var g=this.positiveInteger();return{type:"GroupBackReference",value:g}},e.prototype.characterClassEscape=function(){var g,O=!1;switch(this.popChar()){case"d":g=h;break;case"D":g=h,O=!0;break;case"s":g=m;break;case"S":g=m,O=!0;break;case"w":g=d;break;case"W":g=d,O=!0;break}return l(g),{type:"Set",value:g,complement:O}},e.prototype.controlEscapeAtom=function(){var g;switch(this.popChar()){case"f":g=i("\f");break;case"n":g=i(`
`);break;case"r":g=i("\r");break;case"t":g=i("	");break;case"v":g=i("\v");break}return l(g),{type:"Character",value:g}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var g=this.popChar();if(/[a-zA-Z]/.test(g)===!1)throw Error("Invalid ");var O=g.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:O}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:i("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){var g=this.popChar();return{type:"Character",value:i(g)}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var g=this.popChar();return{type:"Character",value:i(g)}}},e.prototype.characterClass=function(){var g=[],O=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),O=!0);this.isClassAtom();){var T=this.classAtom(),_=T.type==="Character";if(_&&this.isRangeDash()){this.consumeChar("-");var V=this.classAtom(),H=V.type==="Character";if(H){if(V.value<T.value)throw Error("Range out of order in character class");g.push({from:T.value,to:V.value})}else o(T.value,g),g.push(i("-")),o(V.value,g)}else o(T.value,g)}return this.consumeChar("]"),{type:"Set",complement:O,value:g}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:i("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var g=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),g=!1;break;default:this.groupIdx++;break}var O=this.disjunction();this.consumeChar(")");var T={type:"Group",capturing:g,value:O};return g&&(T.idx=this.groupIdx),T},e.prototype.positiveInteger=function(){var g=this.popChar();if(s.test(g)===!1)throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)g+=this.popChar();return parseInt(g,10)},e.prototype.integerIncludingZero=function(){var g=this.popChar();if(n.test(g)===!1)throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)g+=this.popChar();return parseInt(g,10)},e.prototype.patternCharacter=function(){var g=this.popChar();switch(g){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:i(g)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},e.prototype.isDigit=function(){return n.test(this.peekChar(0))},e.prototype.isClassAtom=function(g){switch(g===void 0&&(g=0),this.peekChar(g)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},e.prototype.isQuantifier=function(){var g=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(g)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(g){for(var O="",T=0;T<g;T++){var _=this.popChar();if(t.test(_)===!1)throw Error("Expecting a HexDecimal digits");O+=_}var V=parseInt(O,16);return{type:"Character",value:V}},e.prototype.peekChar=function(g){return g===void 0&&(g=0),this.input[this.idx+g]},e.prototype.popChar=function(){var g=this.peekChar(0);return this.consumeChar(),g},e.prototype.consumeChar=function(g){if(g!==void 0&&this.input[this.idx]!==g)throw Error("Expected: '"+g+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t=/[0-9a-fA-F]/,n=/[0-9]/,s=/[1-9]/;function i(g){return g.charCodeAt(0)}function o(g,O){g.length!==void 0?g.forEach(function(T){O.push(T)}):O.push(g)}function a(g,O){if(g[O]===!0)throw"duplicate flag "+O;g[O]=!0}function l(g){if(g===void 0)throw Error("Internal Error - Should never get here!")}function u(){throw Error("Internal Error - Should never get here!")}var c,h=[];for(c=i("0");c<=i("9");c++)h.push(c);var d=[i("_")].concat(h);for(c=i("a");c<=i("z");c++)d.push(c);for(c=i("A");c<=i("Z");c++)d.push(c);var m=[i(" "),i("\f"),i(`
`),i("\r"),i("	"),i("\v"),i("	"),i(""),i(""),i(""),i(""),i(""),i(""),i(""),i(""),i(""),i(""),i(""),i(""),i(""),i("\u2028"),i("\u2029"),i(""),i(""),i(""),i("\uFEFF")];function E(){}return E.prototype.visitChildren=function(g){for(var O in g){var T=g[O];g.hasOwnProperty(O)&&(T.type!==void 0?this.visit(T):Array.isArray(T)&&T.forEach(function(_){this.visit(_)},this))}},E.prototype.visit=function(g){switch(g.type){case"Pattern":this.visitPattern(g);break;case"Flags":this.visitFlags(g);break;case"Disjunction":this.visitDisjunction(g);break;case"Alternative":this.visitAlternative(g);break;case"StartAnchor":this.visitStartAnchor(g);break;case"EndAnchor":this.visitEndAnchor(g);break;case"WordBoundary":this.visitWordBoundary(g);break;case"NonWordBoundary":this.visitNonWordBoundary(g);break;case"Lookahead":this.visitLookahead(g);break;case"NegativeLookahead":this.visitNegativeLookahead(g);break;case"Character":this.visitCharacter(g);break;case"Set":this.visitSet(g);break;case"Group":this.visitGroup(g);break;case"GroupBackReference":this.visitGroupBackReference(g);break;case"Quantifier":this.visitQuantifier(g);break}this.visitChildren(g)},E.prototype.visitPattern=function(g){},E.prototype.visitFlags=function(g){},E.prototype.visitDisjunction=function(g){},E.prototype.visitAlternative=function(g){},E.prototype.visitStartAnchor=function(g){},E.prototype.visitEndAnchor=function(g){},E.prototype.visitWordBoundary=function(g){},E.prototype.visitNonWordBoundary=function(g){},E.prototype.visitLookahead=function(g){},E.prototype.visitNegativeLookahead=function(g){},E.prototype.visitCharacter=function(g){},E.prototype.visitSet=function(g){},E.prototype.visitGroup=function(g){},E.prototype.visitGroupBackReference=function(g){},E.prototype.visitQuantifier=function(g){},{RegExpParser:e,BaseRegExpVisitor:E,VERSION:"0.4.0"}})})(tx);var Zh=tx.exports,Wf={},gq=new Zh.RegExpParser;function Kp(r){var e=r.toString();if(Wf.hasOwnProperty(e))return Wf[e];var t=gq.pattern(e);return Wf[e]=t,t}function yq(){Wf={}}var Eq=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),rx="Complement Sets are not supported for first char optimization",Dm=`Unable to use "first char" lexer optimizations:
`;function vq(r,e){e===void 0&&(e=!1);try{var t=Kp(r),n=WE(t.value,{},t.flags.ignoreCase);return n}catch(i){if(i.message===rx)e&&hR(""+Dm+("	Unable to optimize: < "+r.toString()+` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var s="";e&&(s=`
	This will disable the lexer's first char optimizations.
	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),BE(Dm+`
`+("	Failed parsing: < "+r.toString()+` >
`)+("	Using the regexp-to-ast library version: "+Zh.VERSION+`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+s)}}return[]}function WE(r,e,t){switch(r.type){case"Disjunction":for(var n=0;n<r.value.length;n++)WE(r.value[n],e,t);break;case"Alternative":for(var s=r.value,n=0;n<s.length;n++){var i=s[n];switch(i.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var o=i;switch(o.type){case"Character":af(o.value,e,t);break;case"Set":if(o.complement===!0)throw Error(rx);be(o.value,function(u){if(typeof u=="number")af(u,e,t);else{var c=u;if(t===!0)for(var h=c.from;h<=c.to;h++)af(h,e,t);else{for(var h=c.from;h<=c.to&&h<_c;h++)af(h,e,t);if(c.to>=_c)for(var d=c.from>=_c?c.from:_c,m=c.to,E=aa(d),g=aa(m),O=E;O<=g;O++)e[O]=O}}});break;case"Group":WE(o.value,e,t);break;default:throw Error("Non Exhaustive Match")}var a=o.quantifier!==void 0&&o.quantifier.atLeast===0;if(o.type==="Group"&&$E(o)===!1||o.type!=="Group"&&a===!1)break}break;default:throw Error("non exhaustive match!")}return nn(e)}function af(r,e,t){var n=aa(r);e[n]=n,t===!0&&wq(r,e)}function wq(r,e){var t=String.fromCharCode(r),n=t.toUpperCase();if(n!==t){var s=aa(n.charCodeAt(0));e[s]=s}else{var i=t.toLowerCase();if(i!==t){var s=aa(i.charCodeAt(0));e[s]=s}}}function wb(r,e){return Iu(r.value,function(t){if(typeof t=="number")return Or(e,t);var n=t;return Iu(e,function(s){return n.from<=s&&s<=n.to})!==void 0})}function $E(r){return r.quantifier&&r.quantifier.atLeast===0?!0:r.value?Qs(r.value)?Cs(r.value,$E):$E(r.value):!1}var Rq=function(r){Eq(e,r);function e(t){var n=r.call(this)||this;return n.targetCharCodes=t,n.found=!1,n}return e.prototype.visitChildren=function(t){if(this.found!==!0){switch(t.type){case"Lookahead":this.visitLookahead(t);return;case"NegativeLookahead":this.visitNegativeLookahead(t);return}r.prototype.visitChildren.call(this,t)}},e.prototype.visitCharacter=function(t){Or(this.targetCharCodes,t.value)&&(this.found=!0)},e.prototype.visitSet=function(t){t.complement?wb(t,this.targetCharCodes)===void 0&&(this.found=!0):wb(t,this.targetCharCodes)!==void 0&&(this.found=!0)},e}(Zh.BaseRegExpVisitor);function dR(r,e){if(e instanceof RegExp){var t=Kp(e),n=new Rq(r);return n.visit(t),n.found}else return Iu(e,function(s){return Or(r,s.charCodeAt(0))})!==void 0}var nx=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Hi="PATTERN",Ka="defaultMode",lf="modes",sx=typeof new RegExp("(?:)").sticky=="boolean";function Sq(r,e){e=jp(e,{useSticky:sx,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(_,V){return V()}});var t=e.tracer;t("initCharCodeToOptimizedIndexMap",function(){zq()});var n;t("Reject Lexer.NA",function(){n=il(r,function(_){return _[Hi]===Hn.NA})});var s=!1,i;t("Transform Patterns",function(){s=!1,i=pe(n,function(_){var V=_[Hi];if(To(V)){var H=V.source;return H.length===1&&H!=="^"&&H!=="$"&&H!=="."?H:H.length===2&&H[0]==="\\"&&!Or(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],H[1])?H[1]:e.useSticky?Sb(V):Rb(V)}else{if(ca(V))return s=!0,{exec:V};if(Te(V,"exec"))return s=!0,V;if(typeof V=="string"){if(V.length===1)return V;var Q=V.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),oe=new RegExp(Q);return e.useSticky?Sb(oe):Rb(oe)}else throw Error("non exhaustive match")}})});var o,a,l,u,c;t("misc mapping",function(){o=pe(n,function(_){return _.tokenTypeIdx}),a=pe(n,function(_){var V=_.GROUP;if(V!==Hn.SKIPPED){if(Di(V))return V;if(As(V))return!1;throw Error("non exhaustive match")}}),l=pe(n,function(_){var V=_.LONGER_ALT;if(V){var H=dq(n,V);return H}}),u=pe(n,function(_){return _.PUSH_MODE}),c=pe(n,function(_){return Te(_,"POP_MODE")})});var h;t("Line Terminator Handling",function(){var _=ax(e.lineTerminatorCharacters);h=pe(n,function(V){return!1}),e.positionTracking!=="onlyOffset"&&(h=pe(n,function(V){if(Te(V,"LINE_BREAKS"))return V.LINE_BREAKS;if(ox(V,_)===!1)return dR(_,V.PATTERN)}))});var d,m,E,g;t("Misc Mapping #2",function(){d=pe(n,ix),m=pe(i,Wq),E=zr(n,function(_,V){var H=V.GROUP;return Di(H)&&H!==Hn.SKIPPED&&(_[H]=[]),_},{}),g=pe(i,function(_,V){return{pattern:i[V],longerAlt:l[V],canLineTerminator:h[V],isCustom:d[V],short:m[V],group:a[V],push:u[V],pop:c[V],tokenTypeIdx:o[V],tokenType:n[V]}})});var O=!0,T=[];return e.safeMode||t("First Char Optimization",function(){T=zr(n,function(_,V,H){if(typeof V.PATTERN=="string"){var Q=V.PATTERN.charCodeAt(0),oe=aa(Q);Oy(_,oe,g[H])}else if(Qs(V.START_CHARS_HINT)){var re;be(V.START_CHARS_HINT,function(Fe){var Ie=typeof Fe=="string"?Fe.charCodeAt(0):Fe,_e=aa(Ie);re!==_e&&(re=_e,Oy(_,_e,g[H]))})}else if(To(V.PATTERN))if(V.PATTERN.unicode)O=!1,e.ensureOptimizations&&BE(""+Dm+("	Unable to analyze < "+V.PATTERN.toString()+` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var ie=vq(V.PATTERN,e.ensureOptimizations);Ct(ie)&&(O=!1),be(ie,function(Fe){Oy(_,Fe,g[H])})}else e.ensureOptimizations&&BE(""+Dm+("	TokenType: <"+V.name+`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),O=!1;return _},[])}),t("ArrayPacking",function(){T=mq(T)}),{emptyGroups:E,patternIdxToConfig:g,charCodeToPatternIdxToConfig:T,hasCustom:s,canBeOptimized:O}}function Cq(r,e){var t=[],n=bq(r);t=t.concat(n.errors);var s=Nq(n.valid),i=s.valid;return t=t.concat(s.errors),t=t.concat(Tq(i)),t=t.concat(Pq(i)),t=t.concat(Fq(i,e)),t=t.concat(Dq(i)),t}function Tq(r){var e=[],t=oi(r,function(n){return To(n[Hi])});return e=e.concat(Oq(t)),e=e.concat(_q(t)),e=e.concat(xq(t)),e=e.concat(Lq(t)),e=e.concat(Iq(t)),e}function bq(r){var e=oi(r,function(s){return!Te(s,Hi)}),t=pe(e,function(s){return{message:"Token Type: ->"+s.name+"<- missing static 'PATTERN' property",type:lr.MISSING_PATTERN,tokenTypes:[s]}}),n=Yp(r,e);return{errors:t,valid:n}}function Nq(r){var e=oi(r,function(s){var i=s[Hi];return!To(i)&&!ca(i)&&!Te(i,"exec")&&!Di(i)}),t=pe(e,function(s){return{message:"Token Type: ->"+s.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:lr.INVALID_PATTERN,tokenTypes:[s]}}),n=Yp(r,e);return{errors:t,valid:n}}var Aq=/[^\\][\$]/;function Oq(r){var e=function(s){nx(i,s);function i(){var o=s!==null&&s.apply(this,arguments)||this;return o.found=!1,o}return i.prototype.visitEndAnchor=function(o){this.found=!0},i}(Zh.BaseRegExpVisitor),t=oi(r,function(s){var i=s[Hi];try{var o=Kp(i),a=new e;return a.visit(o),a.found}catch{return Aq.test(i.source)}}),n=pe(t,function(s){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+s.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:lr.EOI_ANCHOR_FOUND,tokenTypes:[s]}});return n}function Iq(r){var e=oi(r,function(n){var s=n[Hi];return s.test("")}),t=pe(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' must not match an empty string",type:lr.EMPTY_MATCH_PATTERN,tokenTypes:[n]}});return t}var Mq=/[^\\[][\^]|^\^/;function _q(r){var e=function(s){nx(i,s);function i(){var o=s!==null&&s.apply(this,arguments)||this;return o.found=!1,o}return i.prototype.visitStartAnchor=function(o){this.found=!0},i}(Zh.BaseRegExpVisitor),t=oi(r,function(s){var i=s[Hi];try{var o=Kp(i),a=new e;return a.visit(o),a.found}catch{return Mq.test(i.source)}}),n=pe(t,function(s){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+s.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:lr.SOI_ANCHOR_FOUND,tokenTypes:[s]}});return n}function xq(r){var e=oi(r,function(n){var s=n[Hi];return s instanceof RegExp&&(s.multiline||s.global)}),t=pe(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:lr.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[n]}});return t}function Lq(r){var e=[],t=pe(r,function(i){return zr(r,function(o,a){return i.PATTERN.source===a.PATTERN.source&&!Or(e,a)&&a.PATTERN!==Hn.NA&&(e.push(a),o.push(a)),o},[])});t=Qh(t);var n=oi(t,function(i){return i.length>1}),s=pe(n,function(i){var o=pe(i,function(l){return l.name}),a=Ns(i).PATTERN;return{message:"The same RegExp pattern ->"+a+"<-"+("has been used in all of the following Token Types: "+o.join(", ")+" <-"),type:lr.DUPLICATE_PATTERNS_FOUND,tokenTypes:i}});return s}function Pq(r){var e=oi(r,function(n){if(!Te(n,"GROUP"))return!1;var s=n.GROUP;return s!==Hn.SKIPPED&&s!==Hn.NA&&!Di(s)}),t=pe(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:lr.INVALID_GROUP_TYPE_FOUND,tokenTypes:[n]}});return t}function Fq(r,e){var t=oi(r,function(s){return s.PUSH_MODE!==void 0&&!Or(e,s.PUSH_MODE)}),n=pe(t,function(s){var i="Token Type: ->"+s.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+s.PUSH_MODE+"<-which does not exist";return{message:i,type:lr.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[s]}});return n}function Dq(r){var e=[],t=zr(r,function(n,s,i){var o=s.PATTERN;return o===Hn.NA||(Di(o)?n.push({str:o,idx:i,tokenType:s}):To(o)&&Vq(o)&&n.push({str:o.source,idx:i,tokenType:s})),n},[]);return be(r,function(n,s){be(t,function(i){var o=i.str,a=i.idx,l=i.tokenType;if(s<a&&Hq(o,n.PATTERN)){var u="Token: ->"+l.name+`<- can never be matched.
`+("Because it appears AFTER the Token Type ->"+n.name+"<-")+`in the lexer's definition.
See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:u,type:lr.UNREACHABLE_PATTERN,tokenTypes:[n,l]})}})}),e}function Hq(r,e){if(To(e)){var t=e.exec(r);return t!==null&&t.index===0}else{if(ca(e))return e(r,0,[],{});if(Te(e,"exec"))return e.exec(r,0,[],{});if(typeof e=="string")return e===r;throw Error("non exhaustive match")}}function Vq(r){var e=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return Iu(e,function(t){return r.source.indexOf(t)!==-1})===void 0}function Rb(r){var e=r.ignoreCase?"i":"";return new RegExp("^(?:"+r.source+")",e)}function Sb(r){var e=r.ignoreCase?"iy":"y";return new RegExp(""+r.source,e)}function Uq(r,e,t){var n=[];return Te(r,Ka)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+Ka+`> property in its definition
`,type:lr.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Te(r,lf)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+lf+`> property in its definition
`,type:lr.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Te(r,lf)&&Te(r,Ka)&&!Te(r.modes,r.defaultMode)&&n.push({message:"A MultiMode Lexer cannot be initialized with a "+Ka+": <"+r.defaultMode+`>which does not exist
`,type:lr.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Te(r,lf)&&be(r.modes,function(s,i){be(s,function(o,a){As(o)&&n.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+("<"+i+"> at index: <"+a+`>
`),type:lr.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),n}function kq(r,e,t){var n=[],s=!1,i=Qh(Vn(cq(r.modes,function(l){return l}))),o=il(i,function(l){return l[Hi]===Hn.NA}),a=ax(t);return e&&be(o,function(l){var u=ox(l,a);if(u!==!1){var c=Gq(l,u),h={message:c,type:u.issue,tokenType:l};n.push(h)}else Te(l,"LINE_BREAKS")?l.LINE_BREAKS===!0&&(s=!0):dR(a,l.PATTERN)&&(s=!0)}),e&&!s&&n.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:lr.NO_LINE_BREAKS_FLAGS}),n}function Bq(r){var e={},t=_o(r);return be(t,function(n){var s=r[n];if(Qs(s))e[n]=[];else throw Error("non exhaustive match")}),e}function ix(r){var e=r.PATTERN;if(To(e))return!1;if(ca(e))return!0;if(Te(e,"exec"))return!0;if(Di(e))return!1;throw Error("non exhaustive match")}function Wq(r){return Di(r)&&r.length===1?r.charCodeAt(0):!1}var $q={test:function(r){for(var e=r.length,t=this.lastIndex;t<e;t++){var n=r.charCodeAt(t);if(n===10)return this.lastIndex=t+1,!0;if(n===13)return r.charCodeAt(t+1)===10?this.lastIndex=t+2:this.lastIndex=t+1,!0}return!1},lastIndex:0};function ox(r,e){if(Te(r,"LINE_BREAKS"))return!1;if(To(r.PATTERN)){try{dR(e,r.PATTERN)}catch(t){return{issue:lr.IDENTIFY_TERMINATOR,errMsg:t.message}}return!1}else{if(Di(r.PATTERN))return!1;if(ix(r))return{issue:lr.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function Gq(r,e){if(e.issue===lr.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+("	The problem is in the <"+r.name+`> Token Type
`)+("	 Root cause: "+e.errMsg+`.
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===lr.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+("	The problem is in the <"+r.name+`> Token Type
`)+"	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function ax(r){var e=pe(r,function(t){return Di(t)&&t.length>0?t.charCodeAt(0):t});return e}function Oy(r,e,t){r[e]===void 0?r[e]=[t]:r[e].push(t)}var _c=256;function aa(r){return r<_c?r:$f[r]}var $f=[];function zq(){if(Ct($f)){$f=new Array(65536);for(var r=0;r<65536;r++)$f[r]=r>255?255+~~(r/255):r}}function Xp(r,e){var t=r.tokenTypeIdx;return t===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[t]===!0}function Hm(r,e){return r.tokenTypeIdx===e.tokenTypeIdx}var Cb=1,lx={};function Jh(r){var e=Yq(r);jq(e),Xq(e),Kq(e),be(e,function(t){t.isParent=t.categoryMatches.length>0})}function Yq(r){for(var e=Un(r),t=r,n=!0;n;){t=Qh(Vn(pe(t,function(i){return i.CATEGORIES})));var s=Yp(t,e);e=e.concat(s),Ct(s)?n=!1:t=s}return e}function jq(r){be(r,function(e){cx(e)||(lx[Cb]=e,e.tokenTypeIdx=Cb++),Tb(e)&&!Qs(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),Tb(e)||(e.CATEGORIES=[]),qq(e)||(e.categoryMatches=[]),Qq(e)||(e.categoryMatchesMap={})})}function Kq(r){be(r,function(e){e.categoryMatches=[],be(e.categoryMatchesMap,function(t,n){e.categoryMatches.push(lx[n].tokenTypeIdx)})})}function Xq(r){be(r,function(e){ux([],e)})}function ux(r,e){be(r,function(t){e.categoryMatchesMap[t.tokenTypeIdx]=!0}),be(e.CATEGORIES,function(t){var n=r.concat(e);Or(n,t)||ux(n,t)})}function cx(r){return Te(r,"tokenTypeIdx")}function Tb(r){return Te(r,"CATEGORIES")}function qq(r){return Te(r,"categoryMatches")}function Qq(r){return Te(r,"categoryMatchesMap")}function Zq(r){return Te(r,"tokenTypeIdx")}var Jq={buildUnableToPopLexerModeMessage:function(r){return"Unable to pop Lexer Mode after encountering Token ->"+r.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(r,e,t,n,s){return"unexpected character: ->"+r.charAt(e)+"<- at offset: "+e+","+(" skipped "+t+" characters.")}},lr;(function(r){r[r.MISSING_PATTERN=0]="MISSING_PATTERN",r[r.INVALID_PATTERN=1]="INVALID_PATTERN",r[r.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",r[r.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",r[r.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",r[r.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",r[r.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",r[r.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",r[r.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",r[r.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",r[r.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",r[r.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",r[r.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",r[r.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",r[r.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",r[r.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",r[r.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(lr||(lr={}));var xc={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:Jq,traceInitPerf:!1,skipValidations:!1};Object.freeze(xc);var Hn=function(){function r(e,t){var n=this;if(t===void 0&&(t=xc),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},typeof t=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=yb(xc,t);var s=this.config.traceInitPerf;s===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof s=="number"&&(this.traceInitMaxIdent=s,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var i,o=!0;n.TRACE_INIT("Lexer Config handling",function(){if(n.config.lineTerminatorsPattern===xc.lineTerminatorsPattern)n.config.lineTerminatorsPattern=$q;else if(n.config.lineTerminatorCharacters===xc.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');n.trackStartLines=/full|onlyStart/i.test(n.config.positionTracking),n.trackEndLines=/full/i.test(n.config.positionTracking),Qs(e)?(i={modes:{}},i.modes[Ka]=Un(e),i[Ka]=Ka):(o=!1,i=qh(e))}),n.config.skipValidations===!1&&(n.TRACE_INIT("performRuntimeChecks",function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(Uq(i,n.trackStartLines,n.config.lineTerminatorCharacters))}),n.TRACE_INIT("performWarningRuntimeChecks",function(){n.lexerDefinitionWarning=n.lexerDefinitionWarning.concat(kq(i,n.trackStartLines,n.config.lineTerminatorCharacters))})),i.modes=i.modes?i.modes:{},be(i.modes,function(c,h){i.modes[h]=il(c,function(d){return As(d)})});var a=_o(i.modes);if(be(i.modes,function(c,h){n.TRACE_INIT("Mode: <"+h+"> processing",function(){if(n.modes.push(h),n.config.skipValidations===!1&&n.TRACE_INIT("validatePatterns",function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(Cq(c,a))}),Ct(n.lexerDefinitionErrors)){Jh(c);var d;n.TRACE_INIT("analyzeTokenTypes",function(){d=Sq(c,{lineTerminatorCharacters:n.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:n.TRACE_INIT.bind(n)})}),n.patternIdxToConfig[h]=d.patternIdxToConfig,n.charCodeToPatternIdxToConfig[h]=d.charCodeToPatternIdxToConfig,n.emptyGroups=yb(n.emptyGroups,d.emptyGroups),n.hasCustom=d.hasCustom||n.hasCustom,n.canModeBeOptimized[h]=d.canBeOptimized}})}),n.defaultMode=i.defaultMode,!Ct(n.lexerDefinitionErrors)&&!n.config.deferDefinitionErrorsHandling){var l=pe(n.lexerDefinitionErrors,function(c){return c.message}),u=l.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+u)}be(n.lexerDefinitionWarning,function(c){hR(c.message)}),n.TRACE_INIT("Choosing sub-methods implementations",function(){if(sx?(n.chopInput=Eb,n.match=n.matchWithTest):(n.updateLastIndex=_r,n.match=n.matchWithExec),o&&(n.handleModes=_r),n.trackStartLines===!1&&(n.computeNewColumn=Eb),n.trackEndLines===!1&&(n.updateTokenEndLineColumnLocation=_r),/full/i.test(n.config.positionTracking))n.createTokenInstance=n.createFullToken;else if(/onlyStart/i.test(n.config.positionTracking))n.createTokenInstance=n.createStartOnlyToken;else if(/onlyOffset/i.test(n.config.positionTracking))n.createTokenInstance=n.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+n.config.positionTracking+'"');n.hasCustom?(n.addToken=n.addTokenUsingPush,n.handlePayload=n.handlePayloadWithCustom):(n.addToken=n.addTokenUsingMemberAccess,n.handlePayload=n.handlePayloadNoCustom)}),n.TRACE_INIT("Failed Optimization Warnings",function(){var c=zr(n.canModeBeOptimized,function(h,d,m){return d===!1&&h.push(m),h},[]);if(t.ensureOptimizations&&!Ct(c))throw Error("Lexer Modes: < "+c.join(", ")+` > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),n.TRACE_INIT("clearRegExpParserCache",function(){yq()}),n.TRACE_INIT("toFastProperties",function(){J_(n)})})}return r.prototype.tokenize=function(e,t){if(t===void 0&&(t=this.defaultMode),!Ct(this.lexerDefinitionErrors)){var n=pe(this.lexerDefinitionErrors,function(o){return o.message}),s=n.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+s)}var i=this.tokenizeInternal(e,t);return i},r.prototype.tokenizeInternal=function(e,t){var n=this,s,i,o,a,l,u,c,h,d,m,E,g,O,T,_=e,V=_.length,H=0,Q=0,oe=this.hasCustom?0:Math.floor(e.length/10),re=new Array(oe),ie=[],Fe=this.trackStartLines?1:void 0,Ie=this.trackStartLines?1:void 0,_e=Bq(this.emptyGroups),tt=this.trackStartLines,Ge=this.config.lineTerminatorsPattern,ke=0,nt=[],je=[],Ne=[],ue=[];Object.freeze(ue);var Ae=void 0;function bt(){return nt}function p(z){var B=aa(z),ae=je[B];return ae===void 0?ue:ae}var y=function(z){if(Ne.length===1&&z.tokenType.PUSH_MODE===void 0){var B=n.config.errorMessageProvider.buildUnableToPopLexerModeMessage(z);ie.push({offset:z.startOffset,line:z.startLine!==void 0?z.startLine:void 0,column:z.startColumn!==void 0?z.startColumn:void 0,length:z.image.length,message:B})}else{Ne.pop();var ae=q_(Ne);nt=n.patternIdxToConfig[ae],je=n.charCodeToPatternIdxToConfig[ae],ke=nt.length;var se=n.canModeBeOptimized[ae]&&n.config.safeMode===!1;je&&se?Ae=p:Ae=bt}};function R(z){Ne.push(z),je=this.charCodeToPatternIdxToConfig[z],nt=this.patternIdxToConfig[z],ke=nt.length,ke=nt.length;var B=this.canModeBeOptimized[z]&&this.config.safeMode===!1;je&&B?Ae=p:Ae=bt}R.call(this,t);for(var x;H<V;){l=null;var P=_.charCodeAt(H),U=Ae(P),G=U.length;for(s=0;s<G;s++){x=U[s];var j=x.pattern;u=null;var fe=x.short;if(fe!==!1?P===fe&&(l=j):x.isCustom===!0?(T=j.exec(_,H,re,_e),T!==null?(l=T[0],T.payload!==void 0&&(u=T.payload)):l=null):(this.updateLastIndex(j,H),l=this.match(j,e,H)),l!==null){if(a=x.longerAlt,a!==void 0){var me=nt[a],ne=me.pattern;c=null,me.isCustom===!0?(T=ne.exec(_,H,re,_e),T!==null?(o=T[0],T.payload!==void 0&&(c=T.payload)):o=null):(this.updateLastIndex(ne,H),o=this.match(ne,e,H)),o&&o.length>l.length&&(l=o,u=c,x=me)}break}}if(l!==null){if(h=l.length,d=x.group,d!==void 0&&(m=x.tokenTypeIdx,E=this.createTokenInstance(l,H,m,x.tokenType,Fe,Ie,h),this.handlePayload(E,u),d===!1?Q=this.addToken(re,Q,E):_e[d].push(E)),e=this.chopInput(e,h),H=H+h,Ie=this.computeNewColumn(Ie,h),tt===!0&&x.canLineTerminator===!0){var b=0,M=void 0,D=void 0;Ge.lastIndex=0;do M=Ge.test(l),M===!0&&(D=Ge.lastIndex-1,b++);while(M===!0);b!==0&&(Fe=Fe+b,Ie=h-D,this.updateTokenEndLineColumnLocation(E,d,D,b,Fe,Ie,h))}this.handleModes(x,y,R,E)}else{for(var W=H,k=Fe,$=Ie,K=!1;!K&&H<V;)for(_.charCodeAt(H),e=this.chopInput(e,1),H++,i=0;i<ke;i++){var Y=nt[i],j=Y.pattern,fe=Y.short;if(fe!==!1?_.charCodeAt(H)===fe&&(K=!0):Y.isCustom===!0?K=j.exec(_,H,re,_e)!==null:(this.updateLastIndex(j,H),K=j.exec(e)!==null),K===!0)break}g=H-W,O=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(_,W,g,k,$),ie.push({offset:W,line:k,column:$,length:g,message:O})}}return this.hasCustom||(re.length=Q),{tokens:re,groups:_e,errors:ie}},r.prototype.handleModes=function(e,t,n,s){if(e.pop===!0){var i=e.push;t(s),i!==void 0&&n.call(this,i)}else e.push!==void 0&&n.call(this,e.push)},r.prototype.chopInput=function(e,t){return e.substring(t)},r.prototype.updateLastIndex=function(e,t){e.lastIndex=t},r.prototype.updateTokenEndLineColumnLocation=function(e,t,n,s,i,o,a){var l,u;t!==void 0&&(l=n===a-1,u=l?-1:0,s===1&&l===!0||(e.endLine=i+u,e.endColumn=o-1+-u))},r.prototype.computeNewColumn=function(e,t){return e+t},r.prototype.createTokenInstance=function(){return null},r.prototype.createOffsetOnlyToken=function(e,t,n,s){return{image:e,startOffset:t,tokenTypeIdx:n,tokenType:s}},r.prototype.createStartOnlyToken=function(e,t,n,s,i,o){return{image:e,startOffset:t,startLine:i,startColumn:o,tokenTypeIdx:n,tokenType:s}},r.prototype.createFullToken=function(e,t,n,s,i,o,a){return{image:e,startOffset:t,endOffset:t+a-1,startLine:i,endLine:i,startColumn:o,endColumn:o+a-1,tokenTypeIdx:n,tokenType:s}},r.prototype.addToken=function(e,t,n){return 666},r.prototype.addTokenUsingPush=function(e,t,n){return e.push(n),t},r.prototype.addTokenUsingMemberAccess=function(e,t,n){return e[t]=n,t++,t},r.prototype.handlePayload=function(e,t){},r.prototype.handlePayloadNoCustom=function(e,t){},r.prototype.handlePayloadWithCustom=function(e,t){t!==null&&(e.payload=t)},r.prototype.match=function(e,t,n){return null},r.prototype.matchWithTest=function(e,t,n){var s=e.test(t);return s===!0?t.substring(n,e.lastIndex):null},r.prototype.matchWithExec=function(e,t){var n=e.exec(t);return n!==null?n[0]:n},r.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--> <"+e+">");var s=ex(t),i=s.time,o=s.value,a=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(n+"<-- <"+e+"> time: "+i+"ms"),this.traceInitIndent--,o}else return t()},r.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",r.NA=/NOT_APPLICABLE/,r}();function yu(r){return hx(r)?r.LABEL:r.name}function hx(r){return Di(r.LABEL)&&r.LABEL!==""}var eQ="parent",bb="categories",Nb="label",Ab="group",Ob="push_mode",Ib="pop_mode",Mb="longer_alt",_b="line_breaks",xb="start_chars_hint";function st(r){return tQ(r)}function tQ(r){var e=r.pattern,t={};if(t.name=r.name,As(e)||(t.PATTERN=e),Te(r,eQ))throw`The parent property is no longer supported.
See: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.`;return Te(r,bb)&&(t.CATEGORIES=r[bb]),Jh([t]),Te(r,Nb)&&(t.LABEL=r[Nb]),Te(r,Ab)&&(t.GROUP=r[Ab]),Te(r,Ib)&&(t.POP_MODE=r[Ib]),Te(r,Ob)&&(t.PUSH_MODE=r[Ob]),Te(r,Mb)&&(t.LONGER_ALT=r[Mb]),Te(r,_b)&&(t.LINE_BREAKS=r[_b]),Te(r,xb)&&(t.START_CHARS_HINT=r[xb]),t}var ol=st({name:"EOF",pattern:Hn.NA});Jh([ol]);function fR(r,e,t,n,s,i,o,a){return{image:e,startOffset:t,endOffset:n,startLine:s,endLine:i,startColumn:o,endColumn:a,tokenTypeIdx:r.tokenTypeIdx,tokenType:r}}function Rt(r,e){return Xp(r,e)}var xo=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),zi=function(){function r(e){this.definition=e}return r.prototype.accept=function(e){e.visit(this),be(this.definition,function(t){t.accept(e)})},r}(),Jn=function(r){xo(e,r);function e(t){var n=r.call(this,[])||this;return n.idx=1,ai(n,xs(t,function(s){return s!==void 0})),n}return Object.defineProperty(e.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.accept=function(t){t.visit(this)},e}(zi),ku=function(r){xo(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.orgText="",ai(n,xs(t,function(s){return s!==void 0})),n}return e}(zi),kn=function(r){xo(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.ignoreAmbiguities=!1,ai(n,xs(t,function(s){return s!==void 0})),n}return e}(zi),Gr=function(r){xo(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,ai(n,xs(t,function(s){return s!==void 0})),n}return e}(zi),Os=function(r){xo(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,ai(n,xs(t,function(s){return s!==void 0})),n}return e}(zi),Is=function(r){xo(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,ai(n,xs(t,function(s){return s!==void 0})),n}return e}(zi),ar=function(r){xo(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,ai(n,xs(t,function(s){return s!==void 0})),n}return e}(zi),es=function(r){xo(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,ai(n,xs(t,function(s){return s!==void 0})),n}return e}(zi),ts=function(r){xo(e,r);function e(t){var n=r.call(this,t.definition)||this;return n.idx=1,n.ignoreAmbiguities=!1,n.hasPredicates=!1,ai(n,xs(t,function(s){return s!==void 0})),n}return e}(zi),jt=function(){function r(e){this.idx=1,ai(this,xs(e,function(t){return t!==void 0}))}return r.prototype.accept=function(e){e.visit(this)},r}();function rQ(r){return pe(r,Gf)}function Gf(r){function e(s){return pe(s,Gf)}if(r instanceof Jn)return{type:"NonTerminal",name:r.nonTerminalName,idx:r.idx};if(r instanceof kn)return{type:"Flat",definition:e(r.definition)};if(r instanceof Gr)return{type:"Option",idx:r.idx,definition:e(r.definition)};if(r instanceof Os)return{type:"RepetitionMandatory",name:r.name,idx:r.idx,definition:e(r.definition)};if(r instanceof Is)return{type:"RepetitionMandatoryWithSeparator",name:r.name,idx:r.idx,separator:Gf(new jt({terminalType:r.separator})),definition:e(r.definition)};if(r instanceof es)return{type:"RepetitionWithSeparator",name:r.name,idx:r.idx,separator:Gf(new jt({terminalType:r.separator})),definition:e(r.definition)};if(r instanceof ar)return{type:"Repetition",name:r.name,idx:r.idx,definition:e(r.definition)};if(r instanceof ts)return{type:"Alternation",name:r.name,idx:r.idx,definition:e(r.definition)};if(r instanceof jt){var t={type:"Terminal",name:r.terminalType.name,label:yu(r.terminalType),idx:r.idx},n=r.terminalType.PATTERN;return r.terminalType.PATTERN&&(t.pattern=To(n)?n.source:n),t}else{if(r instanceof ku)return{type:"Rule",name:r.name,orgText:r.orgText,definition:e(r.definition)};throw Error("non exhaustive match")}}var qp=function(){function r(){}return r.prototype.walk=function(e,t){var n=this;t===void 0&&(t=[]),be(e.definition,function(s,i){var o=Br(e.definition,i+1);if(s instanceof Jn)n.walkProdRef(s,o,t);else if(s instanceof jt)n.walkTerminal(s,o,t);else if(s instanceof kn)n.walkFlat(s,o,t);else if(s instanceof Gr)n.walkOption(s,o,t);else if(s instanceof Os)n.walkAtLeastOne(s,o,t);else if(s instanceof Is)n.walkAtLeastOneSep(s,o,t);else if(s instanceof es)n.walkManySep(s,o,t);else if(s instanceof ar)n.walkMany(s,o,t);else if(s instanceof ts)n.walkOr(s,o,t);else throw Error("non exhaustive match")})},r.prototype.walkTerminal=function(e,t,n){},r.prototype.walkProdRef=function(e,t,n){},r.prototype.walkFlat=function(e,t,n){var s=t.concat(n);this.walk(e,s)},r.prototype.walkOption=function(e,t,n){var s=t.concat(n);this.walk(e,s)},r.prototype.walkAtLeastOne=function(e,t,n){var s=[new Gr({definition:e.definition})].concat(t,n);this.walk(e,s)},r.prototype.walkAtLeastOneSep=function(e,t,n){var s=Lb(e,t,n);this.walk(e,s)},r.prototype.walkMany=function(e,t,n){var s=[new Gr({definition:e.definition})].concat(t,n);this.walk(e,s)},r.prototype.walkManySep=function(e,t,n){var s=Lb(e,t,n);this.walk(e,s)},r.prototype.walkOr=function(e,t,n){var s=this,i=t.concat(n);be(e.definition,function(o){var a=new kn({definition:[o]});s.walk(a,i)})},r}();function Lb(r,e,t){var n=[new Gr({definition:[new jt({terminalType:r.separator})].concat(r.definition)})],s=n.concat(e,t);return s}var vl=function(){function r(){}return r.prototype.visit=function(e){var t=e;switch(t.constructor){case Jn:return this.visitNonTerminal(t);case kn:return this.visitFlat(t);case Gr:return this.visitOption(t);case Os:return this.visitRepetitionMandatory(t);case Is:return this.visitRepetitionMandatoryWithSeparator(t);case es:return this.visitRepetitionWithSeparator(t);case ar:return this.visitRepetition(t);case ts:return this.visitAlternation(t);case jt:return this.visitTerminal(t);case ku:return this.visitRule(t);default:throw Error("non exhaustive match")}},r.prototype.visitNonTerminal=function(e){},r.prototype.visitFlat=function(e){},r.prototype.visitOption=function(e){},r.prototype.visitRepetition=function(e){},r.prototype.visitRepetitionMandatory=function(e){},r.prototype.visitRepetitionMandatoryWithSeparator=function(e){},r.prototype.visitRepetitionWithSeparator=function(e){},r.prototype.visitAlternation=function(e){},r.prototype.visitTerminal=function(e){},r.prototype.visitRule=function(e){},r}(),nQ=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function sQ(r){return r instanceof kn||r instanceof Gr||r instanceof ar||r instanceof Os||r instanceof Is||r instanceof es||r instanceof jt||r instanceof ku}function Vm(r,e){e===void 0&&(e=[]);var t=r instanceof Gr||r instanceof ar||r instanceof es;return t?!0:r instanceof ts?Q_(r.definition,function(n){return Vm(n,e)}):r instanceof Jn&&Or(e,r)?!1:r instanceof zi?(r instanceof Jn&&e.push(r),Cs(r.definition,function(n){return Vm(n,e)})):!1}function iQ(r){return r instanceof ts}function Ys(r){if(r instanceof Jn)return"SUBRULE";if(r instanceof Gr)return"OPTION";if(r instanceof ts)return"OR";if(r instanceof Os)return"AT_LEAST_ONE";if(r instanceof Is)return"AT_LEAST_ONE_SEP";if(r instanceof es)return"MANY_SEP";if(r instanceof ar)return"MANY";if(r instanceof jt)return"CONSUME";throw Error("non exhaustive match")}var oQ=function(r){nQ(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(t){var n=t.terminalType.name+this.separator+"Terminal";Te(this.dslMethods,n)||(this.dslMethods[n]=[]),this.dslMethods[n].push(t)},e.prototype.visitNonTerminal=function(t){var n=t.nonTerminalName+this.separator+"Terminal";Te(this.dslMethods,n)||(this.dslMethods[n]=[]),this.dslMethods[n].push(t)},e.prototype.visitOption=function(t){this.dslMethods.option.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.dslMethods.repetitionWithSeparator.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.dslMethods.repetitionMandatory.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)},e.prototype.visitRepetition=function(t){this.dslMethods.repetition.push(t)},e.prototype.visitAlternation=function(t){this.dslMethods.alternation.push(t)},e}(vl),uf=new oQ;function aQ(r){uf.reset(),r.accept(uf);var e=uf.dslMethods;return uf.reset(),e}function ed(r){if(r instanceof Jn)return ed(r.referencedRule);if(r instanceof jt)return cQ(r);if(sQ(r))return lQ(r);if(iQ(r))return uQ(r);throw Error("non exhaustive match")}function lQ(r){for(var e=[],t=r.definition,n=0,s=t.length>n,i,o=!0;s&&o;)i=t[n],o=Vm(i),e=e.concat(ed(i)),n=n+1,s=t.length>n;return uR(e)}function uQ(r){var e=pe(r.definition,function(t){return ed(t)});return uR(Vn(e))}function cQ(r){return[r.terminalType]}var dx="_~IN~_",hQ=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),dQ=function(r){hQ(e,r);function e(t){var n=r.call(this)||this;return n.topProd=t,n.follows={},n}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(t,n,s){},e.prototype.walkProdRef=function(t,n,s){var i=mQ(t.referencedRule,t.idx)+this.topProd.name,o=n.concat(s),a=new kn({definition:o}),l=ed(a);this.follows[i]=l},e}(qp);function fQ(r){var e={};return be(r,function(t){var n=new dQ(t).startWalking();ai(e,n)}),e}function mQ(r,e){return r.name+e+dx}var pQ=4,ha=8,gQ=8,Eu=1<<ha,Um=2<<ha,qc=3<<ha,Qc=4<<ha,Zc=5<<ha,tu=6<<ha;function Jc(r,e,t){return t|e|r}var yQ=32-gQ;function fx(r,e,t,n){var s=n+1<<yQ;return Jc(r,e,t)|s}var EQ=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function Pb(r,e){isNaN(r.startOffset)===!0?(r.startOffset=e.startOffset,r.endOffset=e.endOffset):r.endOffset<e.endOffset&&(r.endOffset=e.endOffset)}function Fb(r,e){isNaN(r.startOffset)===!0?(r.startOffset=e.startOffset,r.startColumn=e.startColumn,r.startLine=e.startLine,r.endOffset=e.endOffset,r.endColumn=e.endColumn,r.endLine=e.endLine):r.endOffset<e.endOffset&&(r.endOffset=e.endOffset,r.endColumn=e.endColumn,r.endLine=e.endLine)}function vQ(r,e,t){r.children[t]===void 0?r.children[t]=[e]:r.children[t].push(e)}function Db(r,e,t){r.children[e]===void 0?r.children[e]=[t]:r.children[e].push(t)}var mR=function(r){EQ(e,r);function e(t){var n=r.call(this)||this;return n.result=[],n.ruleIdx=t,n}return e.prototype.collectNamedDSLMethod=function(t,n,s){if(!As(t.name)){var i=void 0;if(t instanceof Gr||t instanceof ar||t instanceof Os||t instanceof ts)i=new n({definition:t.definition,idx:t.idx});else if(t instanceof Is||t instanceof es)i=new n({definition:t.definition,idx:t.idx,separator:t.separator});else throw Error("non exhaustive match");var o=[i],a=Jc(this.ruleIdx,s,t.idx);this.result.push({def:o,key:a,name:t.name,orgProd:t})}},e.prototype.visitOption=function(t){this.collectNamedDSLMethod(t,Gr,Um)},e.prototype.visitRepetition=function(t){this.collectNamedDSLMethod(t,ar,qc)},e.prototype.visitRepetitionMandatory=function(t){this.collectNamedDSLMethod(t,Os,Qc)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.collectNamedDSLMethod(t,Is,tu)},e.prototype.visitRepetitionWithSeparator=function(t){this.collectNamedDSLMethod(t,es,Zc)},e.prototype.visitAlternation=function(t){var n=this;this.collectNamedDSLMethod(t,ts,Eu);var s=t.definition.length>1;be(t.definition,function(i,o){if(!As(i.name)){var a=i.definition;s?a=[new Gr({definition:i.definition})]:a=i.definition;var l=fx(n.ruleIdx,Eu,t.idx,o);n.result.push({def:a,key:l,name:i.name,orgProd:i})}})},e}(vl);function wQ(r,e){var t={allRuleNames:[]};return be(r,function(n){var s=e[n.name];t.allRuleNames.push(n.name);var i=new mR(s);n.accept(i),be(i.result,function(o){o.def,o.key;var a=o.name;t.allRuleNames.push(n.name+a)})}),t}var wl=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),RQ=function(r){wl(e,r);function e(t,n){var s=r.call(this)||this;return s.topProd=t,s.path=n,s.possibleTokTypes=[],s.nextProductionName="",s.nextProductionOccurrence=0,s.found=!1,s.isAtEndOfPath=!1,s}return e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Un(this.path.ruleStack).reverse(),this.occurrenceStack=Un(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(t,n){n===void 0&&(n=[]),this.found||r.prototype.walk.call(this,t,n)},e.prototype.walkProdRef=function(t,n,s){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){var i=n.concat(s);this.updateExpectedNext(),this.walk(t.referencedRule,i)}},e.prototype.updateExpectedNext=function(){Ct(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e}(qp),SQ=function(r){wl(e,r);function e(t,n){var s=r.call(this,t,n)||this;return s.path=n,s.nextTerminalName="",s.nextTerminalOccurrence=0,s.nextTerminalName=s.path.lastTok.name,s.nextTerminalOccurrence=s.path.lastTokOccurrence,s}return e.prototype.walkTerminal=function(t,n,s){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){var i=n.concat(s),o=new kn({definition:i});this.possibleTokTypes=ed(o),this.found=!0}},e}(RQ),Qp=function(r){wl(e,r);function e(t,n){var s=r.call(this)||this;return s.topRule=t,s.occurrence=n,s.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},s}return e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e}(qp),CQ=function(r){wl(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkMany=function(t,n,s){if(t.idx===this.occurrence){var i=Ns(n.concat(s));this.result.isEndOfRule=i===void 0,i instanceof jt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else r.prototype.walkMany.call(this,t,n,s)},e}(Qp),Hb=function(r){wl(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkManySep=function(t,n,s){if(t.idx===this.occurrence){var i=Ns(n.concat(s));this.result.isEndOfRule=i===void 0,i instanceof jt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else r.prototype.walkManySep.call(this,t,n,s)},e}(Qp),TQ=function(r){wl(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkAtLeastOne=function(t,n,s){if(t.idx===this.occurrence){var i=Ns(n.concat(s));this.result.isEndOfRule=i===void 0,i instanceof jt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else r.prototype.walkAtLeastOne.call(this,t,n,s)},e}(Qp),Vb=function(r){wl(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.walkAtLeastOneSep=function(t,n,s){if(t.idx===this.occurrence){var i=Ns(n.concat(s));this.result.isEndOfRule=i===void 0,i instanceof jt&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else r.prototype.walkAtLeastOneSep.call(this,t,n,s)},e}(Qp);function GE(r,e,t){t===void 0&&(t=[]),t=Un(t);var n=[],s=0;function i(u){return u.concat(Br(r,s+1))}function o(u){var c=GE(i(u),e,t);return n.concat(c)}for(;t.length<e&&s<r.length;){var a=r[s];if(a instanceof kn)return o(a.definition);if(a instanceof Jn)return o(a.definition);if(a instanceof Gr)n=o(a.definition);else if(a instanceof Os){var l=a.definition.concat([new ar({definition:a.definition})]);return o(l)}else if(a instanceof Is){var l=[new kn({definition:a.definition}),new ar({definition:[new jt({terminalType:a.separator})].concat(a.definition)})];return o(l)}else if(a instanceof es){var l=a.definition.concat([new ar({definition:[new jt({terminalType:a.separator})].concat(a.definition)})]);n=o(l)}else if(a instanceof ar){var l=a.definition.concat([new ar({definition:a.definition})]);n=o(l)}else{if(a instanceof ts)return be(a.definition,function(u){n=o(u.definition)}),n;if(a instanceof jt)t.push(a.terminalType);else throw Error("non exhaustive match")}s++}return n.push({partialPath:t,suffixDef:Br(r,s)}),n}function mx(r,e,t,n){var s="EXIT_NONE_TERMINAL",i=[s],o="EXIT_ALTERNATIVE",a=!1,l=e.length,u=l-n-1,c=[],h=[];for(h.push({idx:-1,def:r,ruleStack:[],occurrenceStack:[]});!Ct(h);){var d=h.pop();if(d===o){a&&q_(h).idx<=u&&h.pop();continue}var m=d.def,E=d.idx,g=d.ruleStack,O=d.occurrenceStack;if(!Ct(m)){var T=m[0];if(T===s){var _={idx:E,def:Br(m),ruleStack:vh(g),occurrenceStack:vh(O)};h.push(_)}else if(T instanceof jt)if(E<l-1){var V=E+1,H=e[V];if(t(H,T.terminalType)){var _={idx:V,def:Br(m),ruleStack:g,occurrenceStack:O};h.push(_)}}else if(E===l-1)c.push({nextTokenType:T.terminalType,nextTokenOccurrence:T.idx,ruleStack:g,occurrenceStack:O}),a=!0;else throw Error("non exhaustive match");else if(T instanceof Jn){var Q=Un(g);Q.push(T.nonTerminalName);var oe=Un(O);oe.push(T.idx);var _={idx:E,def:T.definition.concat(i,Br(m)),ruleStack:Q,occurrenceStack:oe};h.push(_)}else if(T instanceof Gr){var re={idx:E,def:Br(m),ruleStack:g,occurrenceStack:O};h.push(re),h.push(o);var ie={idx:E,def:T.definition.concat(Br(m)),ruleStack:g,occurrenceStack:O};h.push(ie)}else if(T instanceof Os){var Fe=new ar({definition:T.definition,idx:T.idx}),Ie=T.definition.concat([Fe],Br(m)),_={idx:E,def:Ie,ruleStack:g,occurrenceStack:O};h.push(_)}else if(T instanceof Is){var _e=new jt({terminalType:T.separator}),Fe=new ar({definition:[_e].concat(T.definition),idx:T.idx}),Ie=T.definition.concat([Fe],Br(m)),_={idx:E,def:Ie,ruleStack:g,occurrenceStack:O};h.push(_)}else if(T instanceof es){var re={idx:E,def:Br(m),ruleStack:g,occurrenceStack:O};h.push(re),h.push(o);var _e=new jt({terminalType:T.separator}),tt=new ar({definition:[_e].concat(T.definition),idx:T.idx}),Ie=T.definition.concat([tt],Br(m)),ie={idx:E,def:Ie,ruleStack:g,occurrenceStack:O};h.push(ie)}else if(T instanceof ar){var re={idx:E,def:Br(m),ruleStack:g,occurrenceStack:O};h.push(re),h.push(o);var tt=new ar({definition:T.definition,idx:T.idx}),Ie=T.definition.concat([tt],Br(m)),ie={idx:E,def:Ie,ruleStack:g,occurrenceStack:O};h.push(ie)}else if(T instanceof ts)for(var Ge=T.definition.length-1;Ge>=0;Ge--){var ke=T.definition[Ge],nt={idx:E,def:ke.definition.concat(Br(m)),ruleStack:g,occurrenceStack:O};h.push(nt),h.push(o)}else if(T instanceof kn)h.push({idx:E,def:T.definition.concat(Br(m)),ruleStack:g,occurrenceStack:O});else if(T instanceof ku)h.push(bQ(T,E,g,O));else throw Error("non exhaustive match")}}return c}function bQ(r,e,t,n){var s=Un(t);s.push(r.name);var i=Un(n);return i.push(1),{idx:e,def:r.definition,ruleStack:s,occurrenceStack:i}}var px=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ot;(function(r){r[r.OPTION=0]="OPTION",r[r.REPETITION=1]="REPETITION",r[r.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",r[r.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",r[r.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",r[r.ALTERNATION=5]="ALTERNATION"})(Ot||(Ot={}));function NQ(r){if(r instanceof Gr)return Ot.OPTION;if(r instanceof ar)return Ot.REPETITION;if(r instanceof Os)return Ot.REPETITION_MANDATORY;if(r instanceof Is)return Ot.REPETITION_MANDATORY_WITH_SEPARATOR;if(r instanceof es)return Ot.REPETITION_WITH_SEPARATOR;if(r instanceof ts)return Ot.ALTERNATION;throw Error("non exhaustive match")}function AQ(r,e,t,n,s,i){var o=pR(r,e,t),a=Ex(o)?Hm:Xp;return i(o,n,a,s)}function OQ(r,e,t,n,s,i){var o=gR(r,e,s,t),a=Ex(o)?Hm:Xp;return i(o[0],a,n)}function IQ(r,e,t,n){var s=r.length,i=Cs(r,function(l){return Cs(l,function(u){return u.length===1})});if(e)return function(l){for(var u=pe(l,function(V){return V.GATE}),c=0;c<s;c++){var h=r[c],d=h.length,m=u[c];if(!(m!==void 0&&m.call(this)===!1))e:for(var E=0;E<d;E++){for(var g=h[E],O=g.length,T=0;T<O;T++){var _=this.LA(T+1);if(t(_,g[T])===!1)continue e}return c}}};if(i&&!n){var o=pe(r,function(l){return Vn(l)}),a=zr(o,function(l,u,c){return be(u,function(h){Te(l,h.tokenTypeIdx)||(l[h.tokenTypeIdx]=c),be(h.categoryMatches,function(d){Te(l,d)||(l[d]=c)})}),l},[]);return function(){var l=this.LA(1);return a[l.tokenTypeIdx]}}else return function(){for(var l=0;l<s;l++){var u=r[l],c=u.length;e:for(var h=0;h<c;h++){for(var d=u[h],m=d.length,E=0;E<m;E++){var g=this.LA(E+1);if(t(g,d[E])===!1)continue e}return l}}}}function MQ(r,e,t){var n=Cs(r,function(u){return u.length===1}),s=r.length;if(n&&!t){var i=Vn(r);if(i.length===1&&Ct(i[0].categoryMatches)){var o=i[0],a=o.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===a}}else{var l=zr(i,function(u,c,h){return u[c.tokenTypeIdx]=!0,be(c.categoryMatches,function(d){u[d]=!0}),u},[]);return function(){var u=this.LA(1);return l[u.tokenTypeIdx]===!0}}}else return function(){e:for(var u=0;u<s;u++){for(var c=r[u],h=c.length,d=0;d<h;d++){var m=this.LA(d+1);if(e(m,c[d])===!1)continue e}return!0}return!1}}var _Q=function(r){px(e,r);function e(t,n,s){var i=r.call(this)||this;return i.topProd=t,i.targetOccurrence=n,i.targetProdType=s,i}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(t,n,s,i){return t.idx===this.targetOccurrence&&this.targetProdType===n?(this.restDef=s.concat(i),!0):!1},e.prototype.walkOption=function(t,n,s){this.checkIsTarget(t,Ot.OPTION,n,s)||r.prototype.walkOption.call(this,t,n,s)},e.prototype.walkAtLeastOne=function(t,n,s){this.checkIsTarget(t,Ot.REPETITION_MANDATORY,n,s)||r.prototype.walkOption.call(this,t,n,s)},e.prototype.walkAtLeastOneSep=function(t,n,s){this.checkIsTarget(t,Ot.REPETITION_MANDATORY_WITH_SEPARATOR,n,s)||r.prototype.walkOption.call(this,t,n,s)},e.prototype.walkMany=function(t,n,s){this.checkIsTarget(t,Ot.REPETITION,n,s)||r.prototype.walkOption.call(this,t,n,s)},e.prototype.walkManySep=function(t,n,s){this.checkIsTarget(t,Ot.REPETITION_WITH_SEPARATOR,n,s)||r.prototype.walkOption.call(this,t,n,s)},e}(qp),gx=function(r){px(e,r);function e(t,n,s){var i=r.call(this)||this;return i.targetOccurrence=t,i.targetProdType=n,i.targetRef=s,i.result=[],i}return e.prototype.checkIsTarget=function(t,n){t.idx===this.targetOccurrence&&this.targetProdType===n&&(this.targetRef===void 0||t===this.targetRef)&&(this.result=t.definition)},e.prototype.visitOption=function(t){this.checkIsTarget(t,Ot.OPTION)},e.prototype.visitRepetition=function(t){this.checkIsTarget(t,Ot.REPETITION)},e.prototype.visitRepetitionMandatory=function(t){this.checkIsTarget(t,Ot.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.checkIsTarget(t,Ot.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(t){this.checkIsTarget(t,Ot.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(t){this.checkIsTarget(t,Ot.ALTERNATION)},e}(vl);function Ub(r){for(var e=new Array(r),t=0;t<r;t++)e[t]=[];return e}function Iy(r){for(var e=[""],t=0;t<r.length;t++){for(var n=r[t],s=[],i=0;i<e.length;i++){var o=e[i];s.push(o+"_"+n.tokenTypeIdx);for(var a=0;a<n.categoryMatches.length;a++){var l="_"+n.categoryMatches[a];s.push(o+l)}}e=s}return e}function xQ(r,e,t){for(var n=0;n<r.length;n++)if(n!==t)for(var s=r[n],i=0;i<e.length;i++){var o=e[i];if(s[o]===!0)return!1}return!0}function yx(r,e){for(var t=pe(r,function(c){return GE([c],1)}),n=Ub(t.length),s=pe(t,function(c){var h={};return be(c,function(d){var m=Iy(d.partialPath);be(m,function(E){h[E]=!0})}),h}),i=t,o=1;o<=e;o++){var a=i;i=Ub(a.length);for(var l=function(c){for(var h=a[c],d=0;d<h.length;d++){var m=h[d].partialPath,E=h[d].suffixDef,g=Iy(m),O=xQ(s,g,c);if(O||Ct(E)||m.length===e){var T=n[c];if(zE(T,m)===!1){T.push(m);for(var _=0;_<g.length;_++){var V=g[_];s[c][V]=!0}}}else{var H=GE(E,o+1,m);i[c]=i[c].concat(H),be(H,function(Q){var oe=Iy(Q.partialPath);be(oe,function(re){s[c][re]=!0})})}}},u=0;u<a.length;u++)l(u)}return n}function pR(r,e,t,n){var s=new gx(r,Ot.ALTERNATION,n);return e.accept(s),yx(s.result,t)}function gR(r,e,t,n){var s=new gx(r,t);e.accept(s);var i=s.result,o=new _Q(e,r,t),a=o.startWalking(),l=new kn({definition:i}),u=new kn({definition:a});return yx([l,u],n)}function zE(r,e){e:for(var t=0;t<r.length;t++){var n=r[t];if(n.length===e.length){for(var s=0;s<n.length;s++){var i=e[s],o=n[s],a=i===o||o.categoryMatchesMap[i.tokenTypeIdx]!==void 0;if(a===!1)continue e}return!0}}return!1}function LQ(r,e){return r.length<e.length&&Cs(r,function(t,n){var s=e[n];return t===s||s.categoryMatchesMap[t.tokenTypeIdx]})}function Ex(r){return Cs(r,function(e){return Cs(e,function(t){return Cs(t,function(n){return Ct(n.categoryMatches)})})})}var yR=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function PQ(r,e,t,n,s,i){var o=pe(r,function(_){return DQ(_,s)}),a=pe(r,function(_){return Rx(_,_,s)}),l=[],u=[],c=[];Cs(a,Ct)&&(l=pe(r,function(_){return GQ(_,s)}),u=pe(r,function(_){return zQ(_,e,n,s)}),c=KQ(r,e,s));var h=QQ(r,t,s),d=pe(t,function(_){return BQ(_,s)}),m=FQ(r,s),E=ZQ(r,s),g=pe(r,function(_){return jQ(_,s)}),O=pe(r,function(_){return UQ(_,s)}),T=pe(r,function(_){return WQ(_,r,i,s)});return Vn(o.concat(d,m,E,c,a,l,u,h,g,O,T))}function FQ(r,e){var t=[];return be(r,function(n){var s=new mR("");n.accept(s);var i=pe(s.result,function(o){return o.orgProd});t.push(pe(i,function(o){return kQ(n,o,e)}))}),Vn(t)}function DQ(r,e){var t=new VQ;r.accept(t);var n=t.allProductions,s=Z_(n,HQ),i=xs(s,function(a){return a.length>1}),o=pe(nn(i),function(a){var l=Ns(a),u=e.buildDuplicateFoundError(r,a),c=Ys(l),h={message:u,type:Hr.DUPLICATE_PRODUCTIONS,ruleName:r.name,dslName:c,occurrence:l.idx},d=vx(l);return d&&(h.parameter=d),h});return o}function HQ(r){return Ys(r)+"_#_"+r.idx+"_#_"+vx(r)}function vx(r){return r instanceof jt?r.terminalType.name:r instanceof Jn?r.nonTerminalName:""}var VQ=function(r){yR(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitNonTerminal=function(t){this.allProductions.push(t)},e.prototype.visitOption=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e.prototype.visitAlternation=function(t){this.allProductions.push(t)},e.prototype.visitTerminal=function(t){this.allProductions.push(t)},e}(vl),al=/^[a-zA-Z_]\w*$/,wx=new RegExp(al.source.replace("^","^\\$"));function UQ(r,e){var t=[],n=r.name;return n.match(al)||t.push({message:e.buildInvalidRuleNameError({topLevelRule:r,expectedPattern:al}),type:Hr.INVALID_RULE_NAME,ruleName:n}),t}function kQ(r,e,t){var n=[],s;return e.name.match(wx)||(s=t.buildInvalidNestedRuleNameError(r,e),n.push({message:s,type:Hr.INVALID_NESTED_RULE_NAME,ruleName:r.name})),n}function BQ(r,e){var t=[],n=r.name;return n.match(al)||t.push({message:e.buildTokenNameError({tokenType:r,expectedPattern:al}),type:Hr.INVALID_TOKEN_NAME}),t}function WQ(r,e,t,n){var s=[],i=zr(e,function(a,l){return l.name===r.name?a+1:a},0);if(i>1){var o=n.buildDuplicateRuleNameError({topLevelRule:r,grammarName:t});s.push({message:o,type:Hr.DUPLICATE_RULE_NAME,ruleName:r.name})}return s}function $Q(r,e,t){var n=[],s;return Or(e,r)||(s="Invalid rule override, rule: ->"+r+"<- cannot be overridden in the grammar: ->"+t+"<-as it is not defined in any of the super grammars ",n.push({message:s,type:Hr.INVALID_RULE_OVERRIDE,ruleName:r})),n}function Rx(r,e,t,n){n===void 0&&(n=[]);var s=[],i=zf(e.definition);if(Ct(i))return[];var o=r.name,a=Or(i,r);a&&s.push({message:t.buildLeftRecursionError({topLevelRule:r,leftRecursionPath:n}),type:Hr.LEFT_RECURSION,ruleName:o});var l=Yp(i,n.concat([r])),u=pe(l,function(c){var h=Un(n);return h.push(c),Rx(r,c,t,h)});return s.concat(Vn(u))}function zf(r){var e=[];if(Ct(r))return e;var t=Ns(r);if(t instanceof Jn)e.push(t.referencedRule);else if(t instanceof kn||t instanceof Gr||t instanceof Os||t instanceof Is||t instanceof es||t instanceof ar)e=e.concat(zf(t.definition));else if(t instanceof ts)e=Vn(pe(t.definition,function(o){return zf(o.definition)}));else if(!(t instanceof jt))throw Error("non exhaustive match");var n=Vm(t),s=r.length>1;if(n&&s){var i=Br(r);return e.concat(zf(i))}else return e}var ER=function(r){yR(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.alternations=[],t}return e.prototype.visitAlternation=function(t){this.alternations.push(t)},e}(vl);function GQ(r,e){var t=new ER;r.accept(t);var n=t.alternations,s=zr(n,function(i,o){var a=vh(o.definition),l=pe(a,function(u,c){var h=mx([u],[],null,1);return Ct(h)?{message:e.buildEmptyAlternationError({topLevelRule:r,alternation:o,emptyChoiceIdx:c}),type:Hr.NONE_LAST_EMPTY_ALT,ruleName:r.name,occurrence:o.idx,alternative:c+1}:null});return i.concat(Qh(l))},[]);return s}function zQ(r,e,t,n){var s=new ER;r.accept(s);var i=s.alternations,o=t[r.name];o&&(i=il(i,function(l){return o[Ys(l)+(l.idx===0?"":l.idx)]})),i=il(i,function(l){return l.ignoreAmbiguities===!0});var a=zr(i,function(l,u){var c=u.idx,h=u.maxLookahead||e,d=pR(c,r,h,u),m=XQ(d,u,r,n),E=qQ(d,u,r,n);return l.concat(m,E)},[]);return a}var YQ=function(r){yR(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.allProductions=[],t}return e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e}(vl);function jQ(r,e){var t=new ER;r.accept(t);var n=t.alternations,s=zr(n,function(i,o){return o.definition.length>255&&i.push({message:e.buildTooManyAlternativesError({topLevelRule:r,alternation:o}),type:Hr.TOO_MANY_ALTS,ruleName:r.name,occurrence:o.idx}),i},[]);return s}function KQ(r,e,t){var n=[];return be(r,function(s){var i=new YQ;s.accept(i);var o=i.allProductions;be(o,function(a){var l=NQ(a),u=a.maxLookahead||e,c=a.idx,h=gR(c,s,l,u),d=h[0];if(Ct(Vn(d))){var m=t.buildEmptyRepetitionError({topLevelRule:s,repetition:a});n.push({message:m,type:Hr.NO_NON_EMPTY_LOOKAHEAD,ruleName:s.name})}})}),n}function XQ(r,e,t,n){var s=[],i=zr(r,function(a,l,u){return e.definition[u].ignoreAmbiguities===!0||be(l,function(c){var h=[u];be(r,function(d,m){u!==m&&zE(d,c)&&e.definition[m].ignoreAmbiguities!==!0&&h.push(m)}),h.length>1&&!zE(s,c)&&(s.push(c),a.push({alts:h,path:c}))}),a},[]),o=pe(i,function(a){var l=pe(a.alts,function(c){return c+1}),u=n.buildAlternationAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:l,prefixPath:a.path});return{message:u,type:Hr.AMBIGUOUS_ALTS,ruleName:t.name,occurrence:e.idx,alternatives:[a.alts]}});return o}function qQ(r,e,t,n){var s=[],i=zr(r,function(o,a,l){var u=pe(a,function(c){return{idx:l,path:c}});return o.concat(u)},[]);return be(i,function(o){var a=e.definition[o.idx];if(a.ignoreAmbiguities!==!0){var l=o.idx,u=o.path,c=hq(i,function(d){return e.definition[d.idx].ignoreAmbiguities!==!0&&d.idx<l&&LQ(d.path,u)}),h=pe(c,function(d){var m=[d.idx+1,l+1],E=e.idx===0?"":e.idx,g=n.buildAlternationPrefixAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:m,prefixPath:d.path});return{message:g,type:Hr.AMBIGUOUS_PREFIX_ALTS,ruleName:t.name,occurrence:E,alternatives:m}});s=s.concat(h)}}),s}function QQ(r,e,t){var n=[],s=pe(e,function(i){return i.name});return be(r,function(i){var o=i.name;if(Or(s,o)){var a=t.buildNamespaceConflictError(i);n.push({message:a,type:Hr.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:o})}}),n}function ZQ(r,e){var t=[];return be(r,function(n){var s=new mR("");n.accept(s);var i=Z_(s.result,function(a){return a.name}),o=xs(i,function(a){return a.length>1});be(nn(o),function(a){var l=pe(a,function(c){return c.orgProd}),u=e.buildDuplicateNestedRuleNameError(n,l);t.push({message:u,type:Hr.DUPLICATE_NESTED_NAME,ruleName:n.name})})}),t}var Sx={buildMismatchTokenMessage:function(r){var e=r.expected,t=r.actual;r.previous,r.ruleName;var n=hx(e),s=n?"--> "+yu(e)+" <--":"token of type --> "+e.name+" <--",i="Expecting "+s+" but found --> '"+t.image+"' <--";return i},buildNotAllInputParsedMessage:function(r){var e=r.firstRedundant;return r.ruleName,"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(r){var e=r.expectedPathsPerAlt,t=r.actual;r.previous;var n=r.customUserDescription;r.ruleName;var s="Expecting: ",i=Ns(t).image,o=`
but found: '`+i+"'";if(n)return s+n+o;var a=zr(e,function(h,d){return h.concat(d)},[]),l=pe(a,function(h){return"["+pe(h,function(d){return yu(d)}).join(", ")+"]"}),u=pe(l,function(h,d){return"  "+(d+1)+". "+h}),c=`one of these possible Token sequences:
`+u.join(`
`);return s+c+o},buildEarlyExitMessage:function(r){var e=r.expectedIterationPaths,t=r.actual,n=r.customUserDescription;r.ruleName;var s="Expecting: ",i=Ns(t).image,o=`
but found: '`+i+"'";if(n)return s+n+o;var a=pe(e,function(u){return"["+pe(u,function(c){return yu(c)}).join(",")+"]"}),l=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+("<"+a.join(" ,")+">");return s+l+o}};Object.freeze(Sx);var JQ={buildRuleNotFoundError:function(r,e){var t="Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+r.name+"<-";return t}},vR={buildDuplicateFoundError:function(r,e){function t(c){return c instanceof jt?c.terminalType.name:c instanceof Jn?c.nonTerminalName:""}var n=r.name,s=Ns(e),i=s.idx,o=Ys(s),a=t(s),l=i>0,u="->"+o+(l?i:"")+"<- "+(a?"with argument: ->"+a+"<-":"")+`
                  appears more than once (`+e.length+" times) in the top level rule: ->"+n+`<-.                  
                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return u=u.replace(/[ \t]+/g," "),u=u.replace(/\s\s+/g,`
`),u},buildInvalidNestedRuleNameError:function(r,e){var t="Invalid nested rule name: ->"+e.name+"<- inside rule: ->"+r.name+`<-
`+("it must match the pattern: ->"+wx.toString()+`<-.
`)+"Note that this means a nested rule name must start with the '$'(dollar) sign.";return t},buildDuplicateNestedRuleNameError:function(r,e){var t=Ns(e).name,n="Duplicate nested rule name: ->"+t+"<- inside rule: ->"+r.name+`<-
A nested name must be unique in the scope of a top level grammar rule.`;return n},buildNamespaceConflictError:function(r){var e=`Namespace conflict found in grammar.
`+("The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+r.name+`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return e},buildAlternationPrefixAmbiguityError:function(r){var e=pe(r.prefixPath,function(s){return yu(s)}).join(", "),t=r.alternation.idx===0?"":r.alternation.idx,n="Ambiguous alternatives: <"+r.ambiguityIndices.join(" ,")+`> due to common lookahead prefix
`+("in <OR"+t+"> inside <"+r.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`)+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return n},buildAlternationAmbiguityError:function(r){var e=pe(r.prefixPath,function(s){return yu(s)}).join(", "),t=r.alternation.idx===0?"":r.alternation.idx,n="Ambiguous Alternatives Detected: <"+r.ambiguityIndices.join(" ,")+"> in <OR"+t+">"+(" inside <"+r.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`);return n=n+`See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,n},buildEmptyRepetitionError:function(r){var e=Ys(r.repetition);r.repetition.idx!==0&&(e+=r.repetition.idx);var t="The repetition <"+e+"> within Rule <"+r.topLevelRule.name+`> can never consume any tokens.
This could lead to an infinite loop.`;return t},buildTokenNameError:function(r){var e=r.tokenType.name,t="Invalid Grammar Token name: ->"+e+"<- it must match the pattern: ->"+r.expectedPattern.toString()+"<-";return t},buildEmptyAlternationError:function(r){var e="Ambiguous empty alternative: <"+(r.emptyChoiceIdx+1)+">"+(" in <OR"+r.alternation.idx+"> inside <"+r.topLevelRule.name+`> Rule.
`)+"Only the last alternative may be an empty alternative.";return e},buildTooManyAlternativesError:function(r){var e=`An Alternation cannot have more than 256 alternatives:
`+("<OR"+r.alternation.idx+"> inside <"+r.topLevelRule.name+`> Rule.
 has `+(r.alternation.definition.length+1)+" alternatives.");return e},buildLeftRecursionError:function(r){var e=r.topLevelRule.name,t=pe(r.leftRecursionPath,function(i){return i.name}),n=e+" --> "+t.concat([e]).join(" --> "),s=`Left Recursion found in grammar.
`+("rule: <"+e+`> can be invoked from itself (directly or indirectly)
`)+(`without consuming any Tokens. The grammar path that causes this is: 
 `+n+`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.`;return s},buildInvalidRuleNameError:function(r){var e=r.topLevelRule.name,t=r.expectedPattern.toString(),n="Invalid grammar rule name: ->"+e+"<- it must match the pattern: ->"+t+"<-";return n},buildDuplicateRuleNameError:function(r){var e;r.topLevelRule instanceof ku?e=r.topLevelRule.name:e=r.topLevelRule;var t="Duplicate definition, rule: ->"+e+"<- is already defined in the grammar: ->"+r.grammarName+"<-";return t}},eZ=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();function tZ(r,e){var t=new rZ(r,e);return t.resolveRefs(),t.errors}var rZ=function(r){eZ(e,r);function e(t,n){var s=r.call(this)||this;return s.nameToTopRule=t,s.errMsgProvider=n,s.errors=[],s}return e.prototype.resolveRefs=function(){var t=this;be(nn(this.nameToTopRule),function(n){t.currTopLevel=n,n.accept(t)})},e.prototype.visitNonTerminal=function(t){var n=this.nameToTopRule[t.nonTerminalName];if(n)t.referencedRule=n;else{var s=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:s,type:Hr.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}},e}(vl);function nZ(r){r=jp(r,{errMsgProvider:JQ});var e={};return be(r.rules,function(t){e[t.name]=t}),tZ(e,r.errMsgProvider)}function sZ(r){return r=jp(r,{errMsgProvider:vR,ignoredIssues:{}}),PQ(r.rules,r.maxLookahead,r.tokenTypes,r.ignoredIssues,r.errMsgProvider,r.grammarName)}var Cx="MismatchedTokenException",Tx="NoViableAltException",bx="EarlyExitException",Nx="NotAllInputParsedException",Ax=[Cx,Tx,bx,Nx];Object.freeze(Ax);function km(r){return Or(Ax,r.name)}function wR(r,e,t){this.name=Cx,this.message=r,this.token=e,this.previousToken=t,this.resyncedTokens=[]}wR.prototype=Error.prototype;function Ox(r,e,t){this.name=Tx,this.message=r,this.token=e,this.previousToken=t,this.resyncedTokens=[]}Ox.prototype=Error.prototype;function Ix(r,e){this.name=Nx,this.message=r,this.token=e,this.resyncedTokens=[]}Ix.prototype=Error.prototype;function Mx(r,e,t){this.name=bx,this.message=r,this.token=e,this.previousToken=t,this.resyncedTokens=[]}Mx.prototype=Error.prototype;var My={},_x="InRuleRecoveryException";function xx(r){this.name=_x,this.message=r}xx.prototype=Error.prototype;var iZ=function(){function r(){}return r.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Te(e,"recoveryEnabled")?e.recoveryEnabled:Pn.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=oZ)},r.prototype.getTokenToInsert=function(e){var t=fR(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},r.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},r.prototype.tryInRepetitionRecovery=function(e,t,n,s){for(var i=this,o=this.findReSyncTokenType(),a=this.exportLexerState(),l=[],u=!1,c=this.LA(1),h=this.LA(1),d=function(){var m=i.LA(0),E=i.errorMessageProvider.buildMismatchTokenMessage({expected:s,actual:c,previous:m,ruleName:i.getCurrRuleFullName()}),g=new wR(E,c,i.LA(0));g.resyncedTokens=vh(l),i.SAVE_ERROR(g)};!u;)if(this.tokenMatcher(h,s)){d();return}else if(n.call(this)){d(),e.apply(this,t);return}else this.tokenMatcher(h,o)?u=!0:(h=this.SKIP_TOKEN(),this.addToResyncTokens(h,l));this.importLexerState(a)},r.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,n){return!(n===!1||e===void 0||t===void 0||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))},r.prototype.getFollowsForInRuleRecovery=function(e,t){var n=this.getCurrentGrammarPath(e,t),s=this.getNextPossibleTokenTypes(n);return s},r.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t)){var n=this.getTokenToInsert(e);return n}if(this.canRecoverWithSingleTokenDeletion(e)){var s=this.SKIP_TOKEN();return this.consumeToken(),s}throw new xx("sad sad panda")},r.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},r.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var n=this;if(!this.canTokenTypeBeInsertedInRecovery(e)||Ct(t))return!1;var s=this.LA(1),i=Iu(t,function(o){return n.tokenMatcher(s,o)})!==void 0;return i},r.prototype.canRecoverWithSingleTokenDeletion=function(e){var t=this.tokenMatcher(this.LA(2),e);return t},r.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(t);return Or(n,e)},r.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),n=2;;){var s=t.tokenType;if(Or(e,s))return s;t=this.LA(n),n++}},r.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return My;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(n)}},r.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return Ct(this.LAST_EXPLICIT_RULE_STACK)||(t=pe(this.LAST_EXPLICIT_RULE_STACK,function(s){return e.RULE_STACK[s]}),n=pe(this.LAST_EXPLICIT_RULE_STACK,function(s){return e.RULE_OCCURRENCE_STACK[s]})),pe(t,function(s,i){return i===0?My:{ruleName:e.shortRuleNameToFullName(s),idxInCallingRule:n[i],inRule:e.shortRuleNameToFullName(t[i-1])}})},r.prototype.flattenFollowSet=function(){var e=this,t=pe(this.buildFullFollowKeyStack(),function(n){return e.getFollowSetFromFollowKey(n)});return Vn(t)},r.prototype.getFollowSetFromFollowKey=function(e){if(e===My)return[ol];var t=e.ruleName+e.idxInCallingRule+dx+e.inRule;return this.resyncFollows[t]},r.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,ol)||t.push(e),t},r.prototype.reSyncTo=function(e){for(var t=[],n=this.LA(1);this.tokenMatcher(n,e)===!1;)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,t);return vh(t)},r.prototype.attemptInRepetitionRecovery=function(e,t,n,s,i,o,a){},r.prototype.getCurrentGrammarPath=function(e,t){var n=this.getHumanReadableRuleStack(),s=Un(this.RULE_OCCURRENCE_STACK),i={ruleStack:n,occurrenceStack:s,lastTok:e,lastTokOccurrence:t};return i},r.prototype.getHumanReadableRuleStack=function(){var e=this;return Ct(this.LAST_EXPLICIT_RULE_STACK)?pe(this.RULE_STACK,function(t){return e.shortRuleNameToFullName(t)}):pe(this.LAST_EXPLICIT_RULE_STACK,function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])})},r}();function oZ(r,e,t,n,s,i,o){var a=this.getKeyForAutomaticLookahead(n,s),l=this.firstAfterRepMap[a];if(l===void 0){var u=this.getCurrRuleFullName(),c=this.getGAstProductions()[u],h=new i(c,s);l=h.startWalking(),this.firstAfterRepMap[a]=l}var d=l.token,m=l.occurrence,E=l.isEndOfRule;this.RULE_STACK.length===1&&E&&d===void 0&&(d=ol,m=1),this.shouldInRepetitionRecoveryBeTried(d,m,o)&&this.tryInRepetitionRecovery(r,e,t,d)}var aZ=function(){function r(){}return r.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=Te(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:Pn.dynamicTokensEnabled,this.maxLookahead=Te(e,"maxLookahead")?e.maxLookahead:Pn.maxLookahead,this.lookAheadFuncsCache=vb()?new Map:[],vb()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},r.prototype.preComputeLookaheadFunctions=function(e){var t=this;be(e,function(n){t.TRACE_INIT(n.name+" Rule Lookahead",function(){var s=aQ(n),i=s.alternation,o=s.repetition,a=s.option,l=s.repetitionMandatory,u=s.repetitionMandatoryWithSeparator,c=s.repetitionWithSeparator;be(i,function(h){var d=h.idx===0?"":h.idx;t.TRACE_INIT(""+Ys(h)+d,function(){var m=AQ(h.idx,n,h.maxLookahead||t.maxLookahead,h.hasPredicates,t.dynamicTokensEnabled,t.lookAheadBuilderForAlternatives),E=Jc(t.fullRuleNameToShort[n.name],Eu,h.idx);t.setLaFuncCache(E,m)})}),be(o,function(h){t.computeLookaheadFunc(n,h.idx,qc,Ot.REPETITION,h.maxLookahead,Ys(h))}),be(a,function(h){t.computeLookaheadFunc(n,h.idx,Um,Ot.OPTION,h.maxLookahead,Ys(h))}),be(l,function(h){t.computeLookaheadFunc(n,h.idx,Qc,Ot.REPETITION_MANDATORY,h.maxLookahead,Ys(h))}),be(u,function(h){t.computeLookaheadFunc(n,h.idx,tu,Ot.REPETITION_MANDATORY_WITH_SEPARATOR,h.maxLookahead,Ys(h))}),be(c,function(h){t.computeLookaheadFunc(n,h.idx,Zc,Ot.REPETITION_WITH_SEPARATOR,h.maxLookahead,Ys(h))})})})},r.prototype.computeLookaheadFunc=function(e,t,n,s,i,o){var a=this;this.TRACE_INIT(""+o+(t===0?"":t),function(){var l=OQ(t,e,i||a.maxLookahead,a.dynamicTokensEnabled,s,a.lookAheadBuilderForOptional),u=Jc(a.fullRuleNameToShort[e.name],n,t);a.setLaFuncCache(u,l)})},r.prototype.lookAheadBuilderForOptional=function(e,t,n){return MQ(e,t,n)},r.prototype.lookAheadBuilderForAlternatives=function(e,t,n,s){return IQ(e,t,n,s)},r.prototype.getKeyForAutomaticLookahead=function(e,t){var n=this.getLastExplicitRuleShortName();return Jc(n,e,t)},r.prototype.getLaFuncFromCache=function(e){},r.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},r.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},r.prototype.setLaFuncCache=function(e,t){},r.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},r.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},r}();function lZ(r){return Zp(r.constructor)}var uZ=/^\s*function\s*(\S*)\s*\(/,kb="name";function Zp(r){var e=r.name;if(e)return e;var t=r.toString().match(uZ)[1];return t}function Lx(r,e){var t=Object.getOwnPropertyDescriptor(r,kb);return As(t)||t.configurable?(Object.defineProperty(r,kb,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0):!1}function cZ(r,e){for(var t=_o(r),n=t.length,s=0;s<n;s++)for(var i=t[s],o=r[i],a=o.length,l=0;l<a;l++){var u=o[l];u.tokenTypeIdx===void 0&&(u.fullName!==void 0?this[u.fullName](u.children,e):this[u.name](u.children,e))}}function hZ(r,e){var t=function(){};Lx(t,r+"BaseSemantics");var n={visit:function(s,i){if(Qs(s)&&(s=s[0]),!As(s))return s.fullName!==void 0?this[s.fullName](s.children,i):this[s.name](s.children,i)},validateVisitor:function(){var s=fZ(this,e);if(!Ct(s)){var i=pe(s,function(o){return o.msg});throw Error("Errors Detected in CST Visitor <"+Zp(this.constructor)+`>:
	`+(""+i.join(`

`).replace(/\n/g,`
	`)))}}};return t.prototype=n,t.prototype.constructor=t,t._RULE_NAMES=e,t}function dZ(r,e,t){var n=function(){};Lx(n,r+"BaseSemanticsWithDefaults");var s=Object.create(t.prototype);return be(e,function(i){s[i]=cZ}),n.prototype=s,n.prototype.constructor=n,n}var Bm;(function(r){r[r.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",r[r.MISSING_METHOD=1]="MISSING_METHOD"})(Bm||(Bm={}));function fZ(r,e){var t=mZ(r,e),n=gZ(r,e);return t.concat(n)}function mZ(r,e){var t=pe(e,function(n){if(!ca(r[n]))return{msg:"Missing visitor method: <"+n+"> on "+Zp(r.constructor)+" CST Visitor.",type:Bm.MISSING_METHOD,methodName:n}});return Qh(t)}var pZ=["constructor","visit","validateVisitor"];function gZ(r,e){var t=[];for(var n in r)al.test(n)&&ca(r[n])&&!Or(pZ,n)&&!Or(e,n)&&t.push({msg:"Redundant visitor method: <"+n+"> on "+Zp(r.constructor)+` CST Visitor
There is no Grammar Rule corresponding to this method's name.
`+("For utility methods on visitor classes use methods names that do not match /"+al.source+"/."),type:Bm.REDUNDANT_METHOD,methodName:n});return t}var yZ=function(){function r(){}return r.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=Te(e,"outputCst")?e.outputCst:Pn.outputCst,this.nodeLocationTracking=Te(e,"nodeLocationTracking")?e.nodeLocationTracking:Pn.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=_r,this.cstFinallyStateUpdate=_r,this.cstPostTerminal=_r,this.cstPostNonTerminal=_r,this.cstPostRule=_r,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Fb,this.setNodeLocationFromNode=Fb,this.cstPostRule=_r,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=_r,this.setNodeLocationFromNode=_r,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Pb,this.setNodeLocationFromNode=Pb,this.cstPostRule=_r,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=_r,this.setNodeLocationFromNode=_r,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=_r,this.setNodeLocationFromNode=_r,this.cstPostRule=_r,this.setInitialNodeLocation=_r;else throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"')},r.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},r.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},r.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},r.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},r.prototype.cstNestedInvocationStateUpdate=function(e,t){var n={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},r.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var n={name:e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},r.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},r.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},r.prototype.cstPostRuleFull=function(e){var t=this.LA(0),n=e.location;n.startOffset<=t.startOffset?(n.endOffset=t.endOffset,n.endLine=t.endLine,n.endColumn=t.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)},r.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),n=e.location;n.startOffset<=t.startOffset?n.endOffset=t.endOffset:n.startOffset=NaN},r.prototype.cstPostTerminal=function(e,t){var n=this.CST_STACK[this.CST_STACK.length-1];vQ(n,t,e),this.setNodeLocationFromToken(n.location,t)},r.prototype.cstPostNonTerminal=function(e,t){if(this.isBackTracking()!==!0){var n=this.CST_STACK[this.CST_STACK.length-1];Db(n,t,e),this.setNodeLocationFromNode(n.location,e.location)}},r.prototype.getBaseCstVisitorConstructor=function(){if(As(this.baseCstVisitorConstructor)){var e=hZ(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},r.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(As(this.baseCstVisitorWithDefaultsConstructor)){var e=dZ(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},r.prototype.nestedRuleBeforeClause=function(e,t){var n;if(e.NAME!==void 0)return n=e.NAME,this.nestedRuleInvocationStateUpdate(n,t),n},r.prototype.nestedAltBeforeClause=function(e,t,n,s){var i=this.getLastExplicitRuleShortName(),o=fx(i,n,t,s),a;if(e.NAME!==void 0)return a=e.NAME,this.nestedRuleInvocationStateUpdate(a,o),{shortName:o,nestedName:a}},r.prototype.nestedRuleFinallyClause=function(e,t){var n=this.CST_STACK,s=n[n.length-1];this.nestedRuleFinallyStateUpdate();var i=n[n.length-1];Db(i,t,s),this.setNodeLocationFromNode(i.location,s.location)},r.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},r.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},r.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},r.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},r.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},r.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},r.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},r.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},r}(),EZ=function(){function r(){}return r.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(r.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),r.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):$m},r.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?$m:this.tokVector[t]},r.prototype.consumeToken=function(){this.currIdx++},r.prototype.exportLexerState=function(){return this.currIdx},r.prototype.importLexerState=function(e){this.currIdx=e},r.prototype.resetLexerState=function(){this.currIdx=-1},r.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},r.prototype.getLexerPosition=function(){return this.exportLexerState()},r}(),vZ=function(){function r(){}return r.prototype.ACTION=function(e){return e.call(this)},r.prototype.consume=function(e,t,n){return this.consumeInternal(t,e,n)},r.prototype.subrule=function(e,t,n){return this.subruleInternal(t,e,n)},r.prototype.option=function(e,t){return this.optionInternal(t,e)},r.prototype.or=function(e,t){return this.orInternal(t,e)},r.prototype.many=function(e,t){return this.manyInternal(e,t)},r.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},r.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},r.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},r.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},r.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},r.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},r.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},r.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},r.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},r.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},r.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},r.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},r.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},r.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},r.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},r.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},r.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},r.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},r.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},r.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},r.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},r.prototype.OPTION=function(e){return this.optionInternal(e,0)},r.prototype.OPTION1=function(e){return this.optionInternal(e,1)},r.prototype.OPTION2=function(e){return this.optionInternal(e,2)},r.prototype.OPTION3=function(e){return this.optionInternal(e,3)},r.prototype.OPTION4=function(e){return this.optionInternal(e,4)},r.prototype.OPTION5=function(e){return this.optionInternal(e,5)},r.prototype.OPTION6=function(e){return this.optionInternal(e,6)},r.prototype.OPTION7=function(e){return this.optionInternal(e,7)},r.prototype.OPTION8=function(e){return this.optionInternal(e,8)},r.prototype.OPTION9=function(e){return this.optionInternal(e,9)},r.prototype.OR=function(e){return this.orInternal(e,0)},r.prototype.OR1=function(e){return this.orInternal(e,1)},r.prototype.OR2=function(e){return this.orInternal(e,2)},r.prototype.OR3=function(e){return this.orInternal(e,3)},r.prototype.OR4=function(e){return this.orInternal(e,4)},r.prototype.OR5=function(e){return this.orInternal(e,5)},r.prototype.OR6=function(e){return this.orInternal(e,6)},r.prototype.OR7=function(e){return this.orInternal(e,7)},r.prototype.OR8=function(e){return this.orInternal(e,8)},r.prototype.OR9=function(e){return this.orInternal(e,9)},r.prototype.MANY=function(e){this.manyInternal(0,e)},r.prototype.MANY1=function(e){this.manyInternal(1,e)},r.prototype.MANY2=function(e){this.manyInternal(2,e)},r.prototype.MANY3=function(e){this.manyInternal(3,e)},r.prototype.MANY4=function(e){this.manyInternal(4,e)},r.prototype.MANY5=function(e){this.manyInternal(5,e)},r.prototype.MANY6=function(e){this.manyInternal(6,e)},r.prototype.MANY7=function(e){this.manyInternal(7,e)},r.prototype.MANY8=function(e){this.manyInternal(8,e)},r.prototype.MANY9=function(e){this.manyInternal(9,e)},r.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},r.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},r.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},r.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},r.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},r.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},r.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},r.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},r.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},r.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},r.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},r.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},r.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},r.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},r.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},r.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},r.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},r.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},r.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},r.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},r.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},r.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},r.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},r.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},r.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},r.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},r.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},r.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},r.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},r.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},r.prototype.RULE=function(e,t,n){if(n===void 0&&(n=Gm),Or(this.definedRulesNames,e)){var s=vR.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),i={message:s,type:Hr.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(i)}this.definedRulesNames.push(e);var o=this.defineRule(e,t,n);return this[e]=o,o},r.prototype.OVERRIDE_RULE=function(e,t,n){n===void 0&&(n=Gm);var s=[];s=s.concat($Q(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,s);var i=this.defineRule(e,t,n);return this[e]=i,i},r.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{return e.apply(this,t),!0}catch(s){if(km(s))return!1;throw s}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},r.prototype.getGAstProductions=function(){return this.gastProductionsCache},r.prototype.getSerializedGastProductions=function(){return rQ(nn(this.gastProductionsCache))},r}(),wZ=function(){function r(){}return r.prototype.initRecognizerEngine=function(e,t){if(this.className=lZ(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=Hm,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Te(t,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(Qs(e)){if(Ct(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(Qs(e))this.tokensMap=zr(e,function(o,a){return o[a.name]=a,o},{});else if(Te(e,"modes")&&Cs(Vn(nn(e.modes)),Zq)){var n=Vn(nn(e.modes)),s=uR(n);this.tokensMap=zr(s,function(o,a){return o[a.name]=a,o},{})}else if(cR(e))this.tokensMap=qh(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=ol;var i=Cs(nn(e),function(o){return Ct(o.categoryMatches)});this.tokenMatcher=i?Hm:Xp,Jh(nn(this.tokensMap))},r.prototype.defineRule=function(e,t,n){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+`> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);var s=Te(n,"resyncEnabled")?n.resyncEnabled:Gm.resyncEnabled,i=Te(n,"recoveryValueFunc")?n.recoveryValueFunc:Gm.recoveryValueFunc,o=this.ruleShortNameIdx<<pQ+ha;this.ruleShortNameIdx++,this.shortRuleNameToFull[o]=e,this.fullRuleNameToShort[e]=o;function a(c){try{if(this.outputCst===!0){t.apply(this,c);var h=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(h),h}else return t.apply(this,c)}catch(d){return this.invokeRuleCatch(d,s,i)}finally{this.ruleFinallyStateUpdate()}}var l;l=function(c,h){return c===void 0&&(c=0),this.ruleInvocationStateUpdate(o,e,c),a.call(this,h)};var u="ruleName";return l[u]=e,l.originalGrammarAction=t,l},r.prototype.invokeRuleCatch=function(e,t,n){var s=this.RULE_STACK.length===1,i=t&&!this.isBackTracking()&&this.recoveryEnabled;if(km(e)){var o=e;if(i){var a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a))if(o.resyncedTokens=this.reSyncTo(a),this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];return l.recoveredNode=!0,l}else return n();else{if(this.outputCst){var l=this.CST_STACK[this.CST_STACK.length-1];l.recoveredNode=!0,o.partialCstResult=l}throw o}}else{if(s)return this.moveToTerminatedState(),n();throw o}}else throw e},r.prototype.optionInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(Um,t),s=this.nestedRuleBeforeClause(e,n);try{return this.optionInternalLogic(e,t,n)}finally{s!==void 0&&this.nestedRuleFinallyClause(n,s)}},r.prototype.optionInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(Um,t);return this.optionInternalLogic(e,t,n)},r.prototype.optionInternalLogic=function(e,t,n){var s=this,i=this.getLaFuncFromCache(n),o,a;if(e.DEF!==void 0){if(o=e.DEF,a=e.GATE,a!==void 0){var l=i;i=function(){return a.call(s)&&l.call(s)}}}else o=e;if(i.call(this)===!0)return o.call(this)},r.prototype.atLeastOneInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(Qc,e),s=this.nestedRuleBeforeClause(t,n);try{return this.atLeastOneInternalLogic(e,t,n)}finally{s!==void 0&&this.nestedRuleFinallyClause(n,s)}},r.prototype.atLeastOneInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(Qc,e);this.atLeastOneInternalLogic(e,t,n)},r.prototype.atLeastOneInternalLogic=function(e,t,n){var s=this,i=this.getLaFuncFromCache(n),o,a;if(t.DEF!==void 0){if(o=t.DEF,a=t.GATE,a!==void 0){var l=i;i=function(){return a.call(s)&&l.call(s)}}}else o=t;if(i.call(this)===!0)for(var u=this.doSingleRepetition(o);i.call(this)===!0&&u===!0;)u=this.doSingleRepetition(o);else throw this.raiseEarlyExitException(e,Ot.REPETITION_MANDATORY,t.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],i,Qc,e,TQ)},r.prototype.atLeastOneSepFirstInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(tu,e),s=this.nestedRuleBeforeClause(t,n);try{this.atLeastOneSepFirstInternalLogic(e,t,n)}finally{s!==void 0&&this.nestedRuleFinallyClause(n,s)}},r.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(tu,e);this.atLeastOneSepFirstInternalLogic(e,t,n)},r.prototype.atLeastOneSepFirstInternalLogic=function(e,t,n){var s=this,i=t.DEF,o=t.SEP,a=this.getLaFuncFromCache(n);if(a.call(this)===!0){i.call(this);for(var l=function(){return s.tokenMatcher(s.LA(1),o)};this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,l,i,Vb],l,tu,e,Vb)}else throw this.raiseEarlyExitException(e,Ot.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG)},r.prototype.manyInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(qc,e),s=this.nestedRuleBeforeClause(t,n);try{return this.manyInternalLogic(e,t,n)}finally{s!==void 0&&this.nestedRuleFinallyClause(n,s)}},r.prototype.manyInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(qc,e);return this.manyInternalLogic(e,t,n)},r.prototype.manyInternalLogic=function(e,t,n){var s=this,i=this.getLaFuncFromCache(n),o,a;if(t.DEF!==void 0){if(o=t.DEF,a=t.GATE,a!==void 0){var l=i;i=function(){return a.call(s)&&l.call(s)}}}else o=t;for(var u=!0;i.call(this)===!0&&u===!0;)u=this.doSingleRepetition(o);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],i,qc,e,CQ,u)},r.prototype.manySepFirstInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(Zc,e),s=this.nestedRuleBeforeClause(t,n);try{this.manySepFirstInternalLogic(e,t,n)}finally{s!==void 0&&this.nestedRuleFinallyClause(n,s)}},r.prototype.manySepFirstInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(Zc,e);this.manySepFirstInternalLogic(e,t,n)},r.prototype.manySepFirstInternalLogic=function(e,t,n){var s=this,i=t.DEF,o=t.SEP,a=this.getLaFuncFromCache(n);if(a.call(this)===!0){i.call(this);for(var l=function(){return s.tokenMatcher(s.LA(1),o)};this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,l,i,Hb],l,Zc,e,Hb)}},r.prototype.repetitionSepSecondInternal=function(e,t,n,s,i){for(;n();)this.CONSUME(t),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,n,s,i],n,tu,e,i)},r.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();e.call(this);var n=this.getLexerPosition();return n>t},r.prototype.orInternalNoCst=function(e,t){var n=Qs(e)?e:e.DEF,s=this.getKeyForAutomaticLookahead(Eu,t),i=this.getLaFuncFromCache(s),o=i.call(this,n);if(o!==void 0){var a=n[o];return a.ALT.call(this)}this.raiseNoAltException(t,e.ERR_MSG)},r.prototype.orInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(Eu,t),s=this.nestedRuleBeforeClause(e,n);try{var i=Qs(e)?e:e.DEF,o=this.getLaFuncFromCache(n),a=o.call(this,i);if(a!==void 0){var l=i[a],u=this.nestedAltBeforeClause(l,t,Eu,a);try{return l.ALT.call(this)}finally{u!==void 0&&this.nestedRuleFinallyClause(u.shortName,u.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{s!==void 0&&this.nestedRuleFinallyClause(n,s)}},r.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new Ix(t,e))}},r.prototype.subruleInternal=function(e,t,n){var s;try{var i=n!==void 0?n.ARGS:void 0;return s=e.call(this,t,i),this.cstPostNonTerminal(s,n!==void 0&&n.LABEL!==void 0?n.LABEL:e.ruleName),s}catch(o){this.subruleInternalError(o,n,e.ruleName)}},r.prototype.subruleInternalError=function(e,t,n){throw km(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,t!==void 0&&t.LABEL!==void 0?t.LABEL:n),delete e.partialCstResult),e},r.prototype.consumeInternal=function(e,t,n){var s;try{var i=this.LA(1);this.tokenMatcher(i,e)===!0?(this.consumeToken(),s=i):this.consumeInternalError(e,i,n)}catch(o){s=this.consumeInternalRecovery(e,t,o)}return this.cstPostTerminal(n!==void 0&&n.LABEL!==void 0?n.LABEL:e.name,s),s},r.prototype.consumeInternalError=function(e,t,n){var s,i=this.LA(0);throw n!==void 0&&n.ERR_MSG?s=n.ERR_MSG:s=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:i,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new wR(s,t,i))},r.prototype.consumeInternalRecovery=function(e,t,n){if(this.recoveryEnabled&&n.name==="MismatchedTokenException"&&!this.isBackTracking()){var s=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,s)}catch(i){throw i.name===_x?n:i}}else throw n},r.prototype.saveRecogState=function(){var e=this.errors,t=Un(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},r.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},r.prototype.ruleInvocationStateUpdate=function(e,t,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},r.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},r.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},r.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},r.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),ol)},r.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},r}(),RZ=function(){function r(){}return r.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=jp(e.errorMessageProvider,Pn.errorMessageProvider)},r.prototype.SAVE_ERROR=function(e){if(km(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Un(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(r.prototype,"errors",{get:function(){return Un(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),r.prototype.raiseEarlyExitException=function(e,t,n){for(var s=this.getCurrRuleFullName(),i=this.getGAstProductions()[s],o=gR(e,i,t,this.maxLookahead),a=o[0],l=[],u=1;u<=this.maxLookahead;u++)l.push(this.LA(u));var c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:a,actual:l,previous:this.LA(0),customUserDescription:n,ruleName:s});throw this.SAVE_ERROR(new Mx(c,this.LA(1),this.LA(0)))},r.prototype.raiseNoAltException=function(e,t){for(var n=this.getCurrRuleFullName(),s=this.getGAstProductions()[n],i=pR(e,s,this.maxLookahead),o=[],a=1;a<=this.maxLookahead;a++)o.push(this.LA(a));var l=this.LA(0),u=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:i,actual:o,previous:l,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new Ox(u,this.LA(1),l))},r}(),SZ=function(){function r(){}return r.prototype.initContentAssist=function(){},r.prototype.computeContentAssist=function(e,t){var n=this.gastProductionsCache[e];if(As(n))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return mx([n],t,this.tokenMatcher,this.maxLookahead)},r.prototype.getNextPossibleTokenTypes=function(e){var t=Ns(e.ruleStack),n=this.getGAstProductions(),s=n[t],i=new SQ(s,e).startWalking();return i},r}(),Jp={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Jp);var Bb=!0,Wb=Math.pow(2,ha)-1,Px=st({name:"RECORDING_PHASE_TOKEN",pattern:Hn.NA});Jh([Px]);var Fx=fR(Px,`This IToken indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(Fx);var CZ={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details`,children:{}},TZ=function(){function r(){}return r.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},r.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var t=function(s){var i=s>0?s:"";e["CONSUME"+i]=function(o,a){return this.consumeInternalRecord(o,s,a)},e["SUBRULE"+i]=function(o,a){return this.subruleInternalRecord(o,s,a)},e["OPTION"+i]=function(o){return this.optionInternalRecord(o,s)},e["OR"+i]=function(o){return this.orInternalRecord(o,s)},e["MANY"+i]=function(o){this.manyInternalRecord(s,o)},e["MANY_SEP"+i]=function(o){this.manySepFirstInternalRecord(s,o)},e["AT_LEAST_ONE"+i]=function(o){this.atLeastOneInternalRecord(s,o)},e["AT_LEAST_ONE_SEP"+i]=function(o){this.atLeastOneSepFirstInternalRecord(s,o)}},n=0;n<10;n++)t(n);e.consume=function(s,i,o){return this.consumeInternalRecord(i,s,o)},e.subrule=function(s,i,o){return this.subruleInternalRecord(i,s,o)},e.option=function(s,i){return this.optionInternalRecord(i,s)},e.or=function(s,i){return this.orInternalRecord(i,s)},e.many=function(s,i){this.manyInternalRecord(s,i)},e.atLeastOne=function(s,i){this.atLeastOneInternalRecord(s,i)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD})},r.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var t=0;t<10;t++){var n=t>0?t:"";delete e["CONSUME"+n],delete e["SUBRULE"+n],delete e["OPTION"+n],delete e["OR"+n],delete e["MANY"+n],delete e["MANY_SEP"+n],delete e["AT_LEAST_ONE"+n],delete e["AT_LEAST_ONE_SEP"+n]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})},r.prototype.ACTION_RECORD=function(e){},r.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},r.prototype.LA_RECORD=function(e){return $m},r.prototype.topLevelRuleRecord=function(e,t){try{var n=new ku({definition:[],name:e});return n.name=e,this.recordingProdStack.push(n),t.call(this),this.recordingProdStack.pop(),n}catch(s){if(s.KNOWN_RECORDER_ERROR!==!0)try{s.message=s.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording`}catch{throw s}throw s}},r.prototype.optionInternalRecord=function(e,t){return bc.call(this,Gr,e,t)},r.prototype.atLeastOneInternalRecord=function(e,t){bc.call(this,Os,t,e)},r.prototype.atLeastOneSepFirstInternalRecord=function(e,t){bc.call(this,Is,t,e,Bb)},r.prototype.manyInternalRecord=function(e,t){bc.call(this,ar,t,e)},r.prototype.manySepFirstInternalRecord=function(e,t){bc.call(this,es,t,e,Bb)},r.prototype.orInternalRecord=function(e,t){return bZ.call(this,e,t)},r.prototype.subruleInternalRecord=function(e,t,n){if(Wm(t),!e||Te(e,"ruleName")===!1){var s=new Error("<SUBRULE"+$b(t)+"> argument is invalid"+(" expecting a Parser method reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw s.KNOWN_RECORDER_ERROR=!0,s}var i=Fm(this.recordingProdStack),o=e.ruleName,a=new Jn({idx:t,nonTerminalName:o,referencedRule:void 0});return i.definition.push(a),this.outputCst?CZ:Jp},r.prototype.consumeInternalRecord=function(e,t,n){if(Wm(t),!cx(e)){var s=new Error("<CONSUME"+$b(t)+"> argument is invalid"+(" expecting a TokenType reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw s.KNOWN_RECORDER_ERROR=!0,s}var i=Fm(this.recordingProdStack),o=new jt({idx:t,terminalType:e});return i.definition.push(o),Fx},r}();function bc(r,e,t,n){n===void 0&&(n=!1),Wm(t);var s=Fm(this.recordingProdStack),i=ca(e)?e:e.DEF,o=new r({definition:[],idx:t});return Te(e,"NAME")&&(o.name=e.NAME),n&&(o.separator=e.SEP),Te(e,"MAX_LOOKAHEAD")&&(o.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(o),i.call(this),s.definition.push(o),this.recordingProdStack.pop(),Jp}function bZ(r,e){var t=this;Wm(e);var n=Fm(this.recordingProdStack),s=Qs(r)===!1,i=s===!1?r:r.DEF,o=new ts({definition:[],idx:e,ignoreAmbiguities:s&&r.IGNORE_AMBIGUITIES===!0});Te(r,"NAME")&&(o.name=r.NAME),Te(r,"MAX_LOOKAHEAD")&&(o.maxLookahead=r.MAX_LOOKAHEAD);var a=Q_(i,function(l){return ca(l.GATE)});return o.hasPredicates=a,n.definition.push(o),be(i,function(l){var u=new kn({definition:[]});o.definition.push(u),Te(l,"NAME")&&(u.name=l.NAME),Te(l,"IGNORE_AMBIGUITIES")?u.ignoreAmbiguities=l.IGNORE_AMBIGUITIES:Te(l,"GATE")&&(u.ignoreAmbiguities=!0),t.recordingProdStack.push(u),l.ALT.call(t),t.recordingProdStack.pop()}),Jp}function $b(r){return r===0?"":""+r}function Wm(r){if(r<0||r>Wb){var e=new Error("Invalid DSL Method idx value: <"+r+`>
	`+("Idx value must be a none negative value smaller than "+(Wb+1)));throw e.KNOWN_RECORDER_ERROR=!0,e}}var NZ=function(){function r(){}return r.prototype.initPerformanceTracer=function(e){if(Te(e,"traceInitPerf")){var t=e.traceInitPerf,n=typeof t=="number";this.traceInitMaxIdent=n?t:1/0,this.traceInitPerf=n?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=Pn.traceInitPerf;this.traceInitIndent=-1},r.prototype.TRACE_INIT=function(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--> <"+e+">");var s=ex(t),i=s.time,o=s.value,a=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(n+"<-- <"+e+"> time: "+i+"ms"),this.traceInitIndent--,o}else return t()},r}(),Dx=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)s.hasOwnProperty(i)&&(n[i]=s[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),$m=fR(ol,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze($m);var Pn=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:Sx,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),Gm=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0}),Hr;(function(r){r[r.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",r[r.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",r[r.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",r[r.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",r[r.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",r[r.LEFT_RECURSION=5]="LEFT_RECURSION",r[r.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",r[r.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",r[r.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",r[r.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",r[r.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",r[r.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",r[r.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",r[r.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",r[r.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"})(Hr||(Hr={}));function AZ(r){return r===void 0&&(r=void 0),function(){return r}}var RR=function(){function r(e,t){t===void 0&&(t=Pn),this.ignoredIssues=Pn.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;var n=this;n.initErrorHandler(t),n.initLexerAdapter(),n.initLooksAhead(t),n.initRecognizerEngine(e,t),n.initRecoverable(t),n.initTreeBuilder(t),n.initContentAssist(),n.initGastRecorder(t),n.initPerformanceTracer(t),Te(t,"ignoredIssues")&&t.ignoredIssues!==Pn.ignoredIssues&&hR(`The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.`),this.ignoredIssues=Te(t,"ignoredIssues")?t.ignoredIssues:Pn.ignoredIssues,this.skipValidations=Te(t,"skipValidations")?t.skipValidations:Pn.skipValidations}return r.performSelfAnalysis=function(e){e.performSelfAnalysis()},r.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",function(){var t;e.selfAnalysisDone=!0;var n=e.className;e.TRACE_INIT("toFastProps",function(){J_(e)}),e.TRACE_INIT("Grammar Recording",function(){try{e.enableRecording(),be(e.definedRulesNames,function(i){var o=e[i],a=o.originalGrammarAction,l=void 0;e.TRACE_INIT(i+" Rule",function(){l=e.topLevelRuleRecord(i,a)}),e.gastProductionsCache[i]=l})}finally{e.disableRecording()}});var s=[];if(e.TRACE_INIT("Grammar Resolving",function(){s=nZ({rules:nn(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,s)}),e.TRACE_INIT("Grammar Validations",function(){if(Ct(s)&&e.skipValidations===!1){var i=sZ({rules:nn(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:nn(e.tokensMap),ignoredIssues:e.ignoredIssues,errMsgProvider:vR,grammarName:n});e.definitionErrors.push.apply(e.definitionErrors,i)}}),Ct(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",function(){var i=fQ(nn(e.gastProductionsCache));e.resyncFollows=i}),e.TRACE_INIT("ComputeLookaheadFunctions",function(){e.preComputeLookaheadFunctions(nn(e.gastProductionsCache))})),e.TRACE_INIT("expandAllNestedRuleNames",function(){var i=wQ(nn(e.gastProductionsCache),e.fullRuleNameToShort);e.allRuleNames=i.allRuleNames}),!r.DEFER_DEFINITION_ERRORS_HANDLING&&!Ct(e.definitionErrors))throw t=pe(e.definitionErrors,function(i){return i.message}),new Error(`Parser Definition Errors detected:
 `+t.join(`
-------------------------------
`))})},r.DEFER_DEFINITION_ERRORS_HANDLING=!1,r}();pq(RR,[iZ,aZ,yZ,EZ,wZ,vZ,RZ,SZ,TZ,NZ]);(function(r){Dx(e,r);function e(t,n){n===void 0&&(n=Pn);var s=this,i=qh(n);return i.outputCst=!0,s=r.call(this,t,i)||this,s}return e})(RR);var OZ=function(r){Dx(e,r);function e(t,n){n===void 0&&(n=Pn);var s=this,i=qh(n);return i.outputCst=!1,s=r.call(this,t,i)||this,s}return e}(RR);/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Gb=(r,e)=>({type:r,message:e});var Jt;(function(r){r.LexingError="LexingError",r.ParserError="ParsingError",r.StaticOffsetError="StaticOffsetError",r.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",r.RangeOffsetNotAllowed="RangeOffsetNotAllowed",r.InvalidRangeSize="InvalidRangeSize"})(Jt||(Jt={}));var C;(function(r){r.EMPTY="EMPTY",r.NUMBER="NUMBER",r.STRING="STRING",r.MINUS_UNARY_OP="MINUS_UNARY_OP",r.PLUS_UNARY_OP="PLUS_UNARY_OP",r.PERCENT_OP="PERCENT_OP",r.CONCATENATE_OP="CONCATENATE_OP",r.EQUALS_OP="EQUALS_OP",r.NOT_EQUAL_OP="NOT_EQUAL_OP",r.GREATER_THAN_OP="GREATER_THAN_OP",r.LESS_THAN_OP="LESS_THAN_OP",r.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",r.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",r.PLUS_OP="PLUS_OP",r.MINUS_OP="MINUS_OP",r.TIMES_OP="TIMES_OP",r.DIV_OP="DIV_OP",r.POWER_OP="POWER_OP",r.FUNCTION_CALL="FUNCTION_CALL",r.NAMED_EXPRESSION="NAMED_EXPRESSION",r.PARENTHESIS="PARENTHESES",r.CELL_REFERENCE="CELL_REFERENCE",r.CELL_RANGE="CELL_RANGE",r.COLUMN_RANGE="COLUMN_RANGE",r.ROW_RANGE="ROW_RANGE",r.ERROR="ERROR",r.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",r.ARRAY="ARRAY"})(C||(C={}));var ws;(function(r){r[r.RELATIVE=0]="RELATIVE",r[r.START_ABSOLUTE=1]="START_ABSOLUTE",r[r.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"})(ws||(ws={}));const IZ=r=>({type:C.EMPTY,leadingWhitespace:r==null?void 0:r.image}),MZ=(r,e)=>({type:C.NUMBER,value:r,leadingWhitespace:e==null?void 0:e.image}),_Z=r=>{var e;return{type:C.STRING,value:r.image.slice(1,-1),leadingWhitespace:(e=r.leadingWhitespace)===null||e===void 0?void 0:e.image}},zb=(r,e)=>({type:C.CELL_REFERENCE,reference:r,leadingWhitespace:e==null?void 0:e.image}),Yb=(r,e,t,n)=>(SR(r,e,t),{type:C.CELL_RANGE,start:r,end:e,sheetReferenceType:t,leadingWhitespace:n}),xZ=(r,e,t,n)=>(SR(r,e,t),{type:C.COLUMN_RANGE,start:r,end:e,sheetReferenceType:t,leadingWhitespace:n==null?void 0:n.image}),LZ=(r,e,t,n)=>(SR(r,e,t),{type:C.ROW_RANGE,start:r,end:e,sheetReferenceType:t,leadingWhitespace:n==null?void 0:n.image}),PZ=(r,e,t)=>({type:C.CONCATENATE_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),FZ=(r,e,t)=>({type:C.EQUALS_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),DZ=(r,e,t)=>({type:C.NOT_EQUAL_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),HZ=(r,e,t)=>({type:C.GREATER_THAN_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),VZ=(r,e,t)=>({type:C.LESS_THAN_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),UZ=(r,e,t)=>({type:C.GREATER_THAN_OR_EQUAL_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),kZ=(r,e,t)=>({type:C.LESS_THAN_OR_EQUAL_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),BZ=(r,e,t)=>({type:C.PLUS_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),WZ=(r,e,t)=>({type:C.MINUS_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),$Z=(r,e,t)=>({type:C.TIMES_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),GZ=(r,e,t)=>({type:C.DIV_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),zZ=(r,e,t)=>({type:C.POWER_OP,left:r,right:e,leadingWhitespace:t==null?void 0:t.image}),YZ=(r,e)=>({type:C.MINUS_UNARY_OP,value:r,leadingWhitespace:e==null?void 0:e.image}),jZ=(r,e)=>({type:C.PLUS_UNARY_OP,value:r,leadingWhitespace:e==null?void 0:e.image}),KZ=(r,e)=>({type:C.PERCENT_OP,value:r,leadingWhitespace:e==null?void 0:e.image}),XZ=(r,e,t,n,s)=>({type:C.FUNCTION_CALL,procedureName:r,args:e,leadingWhitespace:t==null?void 0:t.image,internalWhitespace:n==null?void 0:n.image,hyperlink:s}),jb=(r,e,t)=>({type:C.ARRAY,args:r,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:t==null?void 0:t.image}),qZ=(r,e)=>({type:C.NAMED_EXPRESSION,expressionName:r,leadingWhitespace:e==null?void 0:e.image}),QZ=(r,e,t)=>({type:C.PARENTHESIS,expression:r,leadingWhitespace:e==null?void 0:e.image,internalWhitespace:t==null?void 0:t.image}),bi=(r,e)=>({type:C.ERROR,error:r,leadingWhitespace:e==null?void 0:e.image}),Vl=(r,e,t)=>({type:C.ERROR_WITH_RAW_INPUT,error:e,rawInput:r,leadingWhitespace:t==null?void 0:t.image}),YE=()=>({type:C.ERROR,error:v.parsingError()});function SR(r,e,t){if(r.sheet!==void 0&&e.sheet===void 0||r.sheet===void 0&&e.sheet!==void 0)throw new Error("Start address inconsistent with end address");if(r.sheet===void 0&&t!==ws.RELATIVE||r.sheet!==void 0&&t===ws.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function ot(r,e){return(e??"")+r}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Hx={[C.PLUS_OP]:"+",[C.MINUS_OP]:"-",[C.TIMES_OP]:"*",[C.DIV_OP]:"/",[C.CONCATENATE_OP]:"&",[C.POWER_OP]:"^",[C.EQUALS_OP]:"=",[C.NOT_EQUAL_OP]:"<>",[C.GREATER_THAN_OP]:">",[C.GREATER_THAN_OR_EQUAL_OP]:">=",[C.LESS_THAN_OP]:"<",[C.LESS_THAN_OR_EQUAL_OP]:"<="};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const ZZ=(r,e,t,n)=>({ast:r,relativeDependencies:e,hasVolatileFunction:t,hasStructuralChangeFunction:n});class JZ{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,t){const n=tg(t,this.functionRegistry),s=ZZ(t,n,Bo(t,this.functionRegistry.isFunctionVolatile),Bo(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,s),s}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,t){const n=this.cache.get(e);return n!==void 0?n.ast:(this.set(e,t),t)}}const Bo=(r,e)=>{switch(r.type){case C.EMPTY:case C.NUMBER:case C.STRING:case C.ERROR:case C.ERROR_WITH_RAW_INPUT:case C.CELL_REFERENCE:case C.CELL_RANGE:case C.COLUMN_RANGE:case C.ROW_RANGE:case C.NAMED_EXPRESSION:return!1;case C.PERCENT_OP:case C.PLUS_UNARY_OP:case C.MINUS_UNARY_OP:return Bo(r.value,e);case C.CONCATENATE_OP:case C.EQUALS_OP:case C.NOT_EQUAL_OP:case C.LESS_THAN_OP:case C.GREATER_THAN_OP:case C.LESS_THAN_OR_EQUAL_OP:case C.GREATER_THAN_OR_EQUAL_OP:case C.MINUS_OP:case C.PLUS_OP:case C.TIMES_OP:case C.DIV_OP:case C.POWER_OP:return Bo(r.left,e)||Bo(r.right,e);case C.PARENTHESIS:return Bo(r.expression,e);case C.FUNCTION_CALL:return e(r.procedureName)?!0:r.args.some(t=>Bo(t,e));case C.ARRAY:return r.args.some(t=>t.some(n=>Bo(n,e)))}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class N{}N.DistinctSigns="Distinct signs.";N.WrongArgNumber="Wrong number of arguments.";N.EmptyArg="Empty function argument.";N.EmptyArray="Empty array not allowed.";N.ArrayDimensions="Array dimensions are not compatible.";N.NoSpaceForArrayResult="No space for array result.";N.ValueSmall="Value too small.";N.ValueLarge="Value too large.";N.BadCriterion="Incorrect criterion.";N.RangeManySheets="Range spans more than one sheet.";N.CellRangeExpected="Cell range expected.";N.WrongDimension="Wrong range dimension.";N.ScalarExpected="Cell range not allowed.";N.NumberCoercion="Value cannot be coerced to number.";N.NumberExpected="Number argument expected.";N.IntegerExpected="Value needs to be an integer.";N.BadMode="Mode not recognized.";N.DateBounds="Date outside of bounds.";N.OutOfSheet="Resulting reference is out of the sheet.";N.WrongType="Wrong type of argument.";N.NaN="NaN or infinite value encountered.";N.EqualLength="Ranges need to be of equal length.";N.Negative="Value cannot be negative.";N.NotBinary="String does not represent a binary number.";N.NotOctal="String does not represent an octal number.";N.NotHex="String does not represent a hexadecimal number.";N.EndStartPeriod="End period needs to be at least start period.";N.CellRefExpected="Cell reference expected.";N.EmptyRange="Empty range not allowed.";N.BadRef="Address is not correct.";N.NumberRange="Number-only range expected.";N.ValueNotFound="Value not found.";N.ValueBaseLarge="Value in base too large.";N.ValueBaseSmall="Value in base too small.";N.ValueBaseLong="Value in base too long.";N.NegativeLength="Length cannot be negative.";N.PatternNotFound="Pattern not found.";N.OneValue="Needs at least one value.";N.TwoValues="Range needs to contain at least two elements.";N.ThreeValues="Range needs to contain at least three elements.";N.IndexBounds="Index out of bounds.";N.IndexLarge="Index too large.";N.Formula="Expected formula.";N.NegativeCount="Count cannot be negative.";N.ParseError="Parsing error.";N.SheetRef="Sheet does not exist.";N.PeriodLong="Period number cannot exceed life length.";N.InvalidDate="Invalid date.";N.BitshiftLong="Result of bitshift is too long.";N.EmptyString="Empty-string argument not allowed.";N.LengthBounds="Length out of bounds.";N.NegativeTime="Time cannot be negative.";N.NoDefault="No default option.";N.NoConditionMet="None of the conditions were met.";N.Selector="Selector cannot exceed the number of arguments.";N.StartEndDate="Start date needs to be earlier than end date.";N.IncorrectDateTime="String does not represent correct DateTime.";N.CharacterCodeBounds="Character code out of bounds.";N.NonZero="Argument cannot be 0.";N.LessThanOne="Argument cannot be less than 1.";N.WeekendString="Incorrect weekend bitmask string.";N.InvalidRoman="Invalid roman numeral.";N.WrongOrder="Wrong order of values.";N.ComplexNumberExpected="Complex number expected.";N.ShouldBeIorJ="Should be 'i' or 'j'.";N.SizeMismatch="Array dimensions mismatched.";N.FunctionName=r=>`Function name ${r} not recognized.`;N.NamedExpressionName=r=>`Named expression ${r} not recognized.`;N.LicenseKey=r=>`License key is ${r}.`;/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class eJ{constructor(){this.POSSIBLE_START_CHARACTERS=[...j_,...sq,En,"'","_"],this.cellReferenceRegexp=new RegExp(nq,"y")}match(e,t){this.cellReferenceRegexp.lastIndex=t;const n=this.cellReferenceRegexp.exec(e+"@");return n==null||n[1]==null?null:(n[0]=n[1],n)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class tJ{constructor(){this.POSSIBLE_START_CHARACTERS=[...j_,"_"],this.namedExpressionRegexp=new RegExp(Y_,"y"),this.r1c1CellRefRegexp=new RegExp(`^${z_}$`)}match(e,t){this.namedExpressionRegexp.lastIndex=t;const n=this.namedExpressionRegexp.exec(e);return n==null||n[0]==null||this.r1c1CellRefRegexp.test(n[0])?null:n}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const wh=st({name:"AdditionOp",pattern:Hn.NA}),jE=st({name:"PlusOp",pattern:/\+/,categories:wh}),KE=st({name:"MinusOp",pattern:/-/,categories:wh}),eg=st({name:"MultiplicationOp",pattern:Hn.NA}),Vx=st({name:"TimesOp",pattern:/\*/,categories:eg}),Ux=st({name:"DivOp",pattern:/\//,categories:eg}),XE=st({name:"PowerOp",pattern:/\^/}),kx=st({name:"PercentOp",pattern:/%/}),da=st({name:"BooleanOp",pattern:Hn.NA}),qE=st({name:"EqualsOp",pattern:/=/,categories:da}),Bx=st({name:"NotEqualOp",pattern:/<>/,categories:da}),Wx=st({name:"GreaterThanOp",pattern:/>/,categories:da}),$x=st({name:"LessThanOp",pattern:/</,categories:da}),Gx=st({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:da}),zx=st({name:"LessThanOrEqualOp",pattern:/<=/,categories:da}),Yx=st({name:"ConcatenateOp",pattern:/&/}),QE=st({name:"LParen",pattern:/\(/}),Yf=st({name:"RParen",pattern:/\)/}),jx=st({name:"ArrayLParen",pattern:/{/}),Kx=st({name:"ArrayRParen",pattern:/}/}),Xx=st({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),qx=st({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),Rh=st({name:"RangeSeparator",pattern:new RegExp(Xh)}),CR=st({name:"ColumnRange",pattern:new RegExp(`${pb}${Xh}${pb}`)}),TR=st({name:"RowRange",pattern:new RegExp(`${gb}${Xh}${gb}`)}),bR=st({name:"ProcedureName",pattern:new RegExp(`([${$p}][${aR}]*)\\(`)}),_y=new eJ,Ko=st({name:"CellReference",pattern:_y.match.bind(_y),start_chars_hint:_y.POSSIBLE_START_CHARACTERS,line_breaks:!1}),xy=new tJ,Qx=st({name:"NamedExpression",pattern:xy.match.bind(xy),start_chars_hint:xy.POSSIBLE_START_CHARACTERS,line_breaks:!1}),NR=r=>{const e=r.translationPackage.getFunctionTranslation("OFFSET"),t=r.errorMapping,n=r.translationPackage.buildFunctionMapping(),s=new RegExp(r.ignoreWhiteSpace==="standard"?tq:eq),i=st({name:"WhiteSpace",pattern:s}),o=st({name:"ArrayRowSep",pattern:r.arrayRowSeparator}),a=st({name:"ArrayColSep",pattern:r.arrayColumnSeparator}),l=st({name:"NumberLiteral",pattern:new RegExp(`(([${r.decimalSeparator}]\\d+)|(\\d+([${r.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),u=st({name:"OffsetProcedureName",pattern:new RegExp(e,"i")});let c,h;r.functionArgSeparator===r.arrayColumnSeparator?(c=a,h=[]):r.functionArgSeparator===r.arrayRowSeparator?(c=o,h=[]):(c=st({name:"ArgSeparator",pattern:r.functionArgSeparator}),h=[c]);const d=[i,jE,KE,Vx,Ux,XE,qE,Bx,kx,Gx,zx,Wx,$x,QE,Yf,jx,Kx,u,bR,Rh,...h,CR,TR,l,Xx,qx,Yx,da,wh,eg,Ko,Qx,o,a];return{ArgSeparator:c,NumberLiteral:l,OffsetProcedureName:u,ArrayRowSeparator:o,ArrayColSeparator:a,WhiteSpace:i,allTokens:d,errorMapping:t,functionMapping:n,decimalSeparator:r.decimalSeparator,maxColumns:r.maxColumns,maxRows:r.maxRows}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class ru extends OZ{constructor(e,t){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",()=>this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:AZ(IZ())}])),this.procedureExpression=this.RULE("procedureExpression",()=>{var n;const s=this.CONSUME(bR),i=s.image.toUpperCase().slice(0,-1),o=(n=this.lexerConfig.functionMapping[i])!==null&&n!==void 0?n:i,a=[];let l=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY(()=>{var c;const h=this.CONSUME(this.lexerConfig.ArgSeparator);l.type===C.EMPTY&&(l.leadingWhitespace=(c=h.leadingWhitespace)===null||c===void 0?void 0:c.image),a.push(l),l=this.SUBRULE2(this.booleanExpressionOrEmpty)}),a.push(l),a.length===1&&a[0].type===C.EMPTY&&(a.length=0);const u=this.CONSUME(Yf);return XZ(o,a,s.leadingWhitespace,u.leadingWhitespace)}),this.namedExpressionExpression=this.RULE("namedExpressionExpression",()=>{const n=this.CONSUME(Qx);return qZ(n.image,n.leadingWhitespace)}),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",()=>{const n=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(QE),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{n.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(Yf),this.handleOffsetHeuristic(n)}),this.columnRangeExpression=this.RULE("columnRangeExpression",()=>{const n=this.CONSUME(CR),[s,i]=n.image.split(":"),o=this.ACTION(()=>xm(this.sheetMapping,s,this.formulaAddress)),a=this.ACTION(()=>xm(this.sheetMapping,i,this.formulaAddress));if(o===void 0||a===void 0)return bi(new v(S.REF));if(o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return Vl(n.image,new v(S.NAME),n.leadingWhitespace);if(o.sheet===void 0&&a.sheet!==void 0)return this.parsingError(Jt.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:c}=ru.fixSheetIdsForRangeEnds(o,a);return xZ(l,u,c,n.leadingWhitespace)}),this.rowRangeExpression=this.RULE("rowRangeExpression",()=>{const n=this.CONSUME(TR),[s,i]=n.image.split(":"),o=this.ACTION(()=>Lm(this.sheetMapping,s,this.formulaAddress)),a=this.ACTION(()=>Lm(this.sheetMapping,i,this.formulaAddress));if(o===void 0||a===void 0)return bi(new v(S.REF));if(o.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return Vl(n.image,new v(S.NAME),n.leadingWhitespace);if(o.sheet===void 0&&a.sheet!==void 0)return this.parsingError(Jt.ParserError,"Malformed range expression");const{firstEnd:l,secondEnd:u,sheetRefType:c}=ru.fixSheetIdsForRangeEnds(o,a);return LZ(l,u,c,n.leadingWhitespace)}),this.cellReference=this.RULE("cellReference",()=>{const n=this.CONSUME(Ko),s=this.ACTION(()=>Gl(this.sheetMapping,n.image,this.formulaAddress));return s===void 0?Vl(n.image,new v(S.REF),n.leadingWhitespace):s.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?Vl(n.image,new v(S.NAME),n.leadingWhitespace):zb(s,n.leadingWhitespace)}),this.endRangeReference=this.RULE("endRangeReference",n=>{var s;const i=this.CONSUME(Ko),o=this.ACTION(()=>Gl(this.sheetMapping,n.image,this.formulaAddress)),a=this.ACTION(()=>Gl(this.sheetMapping,i.image,this.formulaAddress));return o===void 0||a===void 0?this.ACTION(()=>Vl(`${n.image}:${i.image}`,new v(S.REF),n.leadingWhitespace)):o.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION(()=>Vl(`${n.image}:${i.image}`,new v(S.NAME),n.leadingWhitespace)):this.buildCellRange(o,a,(s=n.leadingWhitespace)===null||s===void 0?void 0:s.image)}),this.endOfRangeExpression=this.RULE("endOfRangeExpression",n=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[n]})},{ALT:()=>{var s;const i=this.SUBRULE(this.offsetProcedureExpression),o=this.ACTION(()=>Gl(this.sheetMapping,n.image,this.formulaAddress));return o===void 0?bi(new v(S.REF)):i.type===C.CELL_REFERENCE?this.buildCellRange(o,i.reference,(s=n.leadingWhitespace)===null||s===void 0?void 0:s.image):this.parsingError(Jt.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.cellRangeExpression=this.RULE("cellRangeExpression",()=>{const n=this.CONSUME(Ko);return this.CONSUME2(Rh),this.SUBRULE(this.endOfRangeExpression,{ARGS:[n]})}),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",n=>{const s=this.CONSUME(Ko),i=this.ACTION(()=>Gl(this.sheetMapping,s.image,this.formulaAddress));return i===void 0?this.ACTION(()=>bi(new v(S.REF))):this.buildCellRange(n.reference,i,n.leadingWhitespace)}),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",n=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[n]})},{ALT:()=>{const s=this.SUBRULE(this.offsetProcedureExpression);return s.type===C.CELL_REFERENCE?this.buildCellRange(n.reference,s.reference,n.leadingWhitespace):this.parsingError(Jt.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.offsetExpression=this.RULE("offsetExpression",()=>{const n=this.SUBRULE(this.offsetProcedureExpression);let s;return this.OPTION(()=>{this.CONSUME(Rh),n.type===C.CELL_RANGE?s=this.parsingError(Jt.RangeOffsetNotAllowed,"Range offset not allowed here"):s=this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[n]})}),s!==void 0?s:n}),this.insideArrayExpression=this.RULE("insideArrayExpression",()=>{const n=[[]];return n[n.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY(()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),n[n.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),n.push([]),n[n.length-1].push(this.SUBRULE3(this.booleanExpression))}}])}),jb(n)}),this.parenthesisExpression=this.RULE("parenthesisExpression",()=>{const n=this.CONSUME(QE),s=this.SUBRULE(this.booleanExpression),i=this.CONSUME(Yf);return QZ(s,n.leadingWhitespace,i.leadingWhitespace)}),this.arrayExpression=this.RULE("arrayExpression",()=>this.OR([{ALT:()=>{const n=this.CONSUME(jx),s=this.SUBRULE(this.insideArrayExpression),i=this.CONSUME(Kx);return jb(s.args,n.leadingWhitespace,i.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}])),this.numericStringToNumber=n=>{const s=n.replace(this.lexerConfig.decimalSeparator,".");return Number(s)},this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",()=>{var n;return this.OR((n=this.atomicExpCache)!==null&&n!==void 0?n:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{const s=this.CONSUME(this.lexerConfig.NumberLiteral);return MZ(this.numericStringToNumber(s.image),s.leadingWhitespace)}},{ALT:()=>{const s=this.CONSUME(Xx);return _Z(s)}},{ALT:()=>{const s=this.CONSUME(qx),i=s.image.toUpperCase(),o=this.lexerConfig.errorMapping[i];return o?bi(new v(o),s.leadingWhitespace):this.parsingError(Jt.ParserError,"Unknown error literal")}}])}),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",()=>{const n=this.SUBRULE(this.positiveAtomicExpression),s=this.OPTION(()=>this.CONSUME(kx));return s?KZ(n,s.leadingWhitespace):n}),this.atomicExpression=this.RULE("atomicExpression",()=>this.OR([{ALT:()=>{const n=this.CONSUME(wh),s=this.SUBRULE(this.atomicExpression);return Rt(n,jE)?jZ(s,n.leadingWhitespace):Rt(n,KE)?YZ(s,n.leadingWhitespace):(this.customParsingError=Gb(Jt.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}])),this.powerExpression=this.RULE("powerExpression",()=>{let n=this.SUBRULE(this.atomicExpression);return this.MANY(()=>{const s=this.CONSUME(XE),i=this.SUBRULE2(this.atomicExpression);Rt(s,XE)?n=zZ(n,i,s.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.multiplicationExpression=this.RULE("multiplicationExpression",()=>{let n=this.SUBRULE(this.powerExpression);return this.MANY(()=>{const s=this.CONSUME(eg),i=this.SUBRULE2(this.powerExpression);Rt(s,Vx)?n=$Z(n,i,s.leadingWhitespace):Rt(s,Ux)?n=GZ(n,i,s.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.additionExpression=this.RULE("additionExpression",()=>{let n=this.SUBRULE(this.multiplicationExpression);return this.MANY(()=>{const s=this.CONSUME(wh),i=this.SUBRULE2(this.multiplicationExpression);Rt(s,jE)?n=BZ(n,i,s.leadingWhitespace):Rt(s,KE)?n=WZ(n,i,s.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.concatenateExpression=this.RULE("concatenateExpression",()=>{let n=this.SUBRULE(this.additionExpression);return this.MANY(()=>{const s=this.CONSUME(Yx),i=this.SUBRULE2(this.additionExpression);n=PZ(n,i,s.leadingWhitespace)}),n}),this.booleanExpression=this.RULE("booleanExpression",()=>{let n=this.SUBRULE(this.concatenateExpression);return this.MANY(()=>{const s=this.CONSUME(da),i=this.SUBRULE2(this.concatenateExpression);Rt(s,qE)?n=FZ(n,i,s.leadingWhitespace):Rt(s,Bx)?n=DZ(n,i,s.leadingWhitespace):Rt(s,Wx)?n=HZ(n,i,s.leadingWhitespace):Rt(s,$x)?n=VZ(n,i,s.leadingWhitespace):Rt(s,Gx)?n=UZ(n,i,s.leadingWhitespace):Rt(s,zx)?n=kZ(n,i,s.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),n}),this.formula=this.RULE("formula",()=>(this.CONSUME(qE),this.SUBRULE(this.booleanExpression))),this.lexerConfig=e,this.sheetMapping=t,this.formulaAddress=he(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,t){this.input=e;let n=this.formulaWithContext(t),s=[];return this.customParsingError&&s.push(this.customParsingError),s=s.concat(this.errors.map(i=>({type:Jt.ParserError,message:i.message}))),s.length>0&&(n=YE()),{ast:n,errors:s}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,t,n){if(e.sheet===void 0&&t.sheet!==void 0)return this.parsingError(Jt.ParserError,"Malformed range expression");const{firstEnd:s,secondEnd:i,sheetRefType:o}=ru.fixSheetIdsForRangeEnds(e,t);return Yb(s,i,o,n)}static fixSheetIdsForRangeEnds(e,t){const n=ru.rangeSheetReferenceType(e.sheet,t.sheet),s=e.sheet!==void 0&&t.sheet===void 0?t.withSheet(e.sheet):t;return{firstEnd:e,secondEnd:s,sheetRefType:n}}handleOffsetHeuristic(e){const t=e[0];if(t.type!==C.CELL_REFERENCE)return this.parsingError(Jt.StaticOffsetError,"First argument to OFFSET is not a reference");const n=e[1];let s;if(n.type===C.NUMBER&&Number.isInteger(n.value))s=n.value;else if(n.type===C.PLUS_UNARY_OP&&n.value.type===C.NUMBER&&Number.isInteger(n.value.value))s=n.value.value;else if(n.type===C.MINUS_UNARY_OP&&n.value.type===C.NUMBER&&Number.isInteger(n.value.value))s=-n.value.value;else return this.parsingError(Jt.StaticOffsetError,"Second argument to OFFSET is not a static number");const i=e[2];let o;if(i.type===C.NUMBER&&Number.isInteger(i.value))o=i.value;else if(i.type===C.PLUS_UNARY_OP&&i.value.type===C.NUMBER&&Number.isInteger(i.value.value))o=i.value.value;else if(i.type===C.MINUS_UNARY_OP&&i.value.type===C.NUMBER&&Number.isInteger(i.value.value))o=-i.value.value;else return this.parsingError(Jt.StaticOffsetError,"Third argument to OFFSET is not a static number");const a=e[3];let l;if(a===void 0)l=1;else if(a.type===C.NUMBER){if(l=a.value,l<1)return this.parsingError(Jt.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(l))return this.parsingError(Jt.StaticOffsetError,"Fourth argument to OFFSET is not integer")}else return this.parsingError(Jt.StaticOffsetError,"Fourth argument to OFFSET is not a static number");const u=e[4];let c;if(u===void 0)c=1;else if(u.type===C.NUMBER){if(c=u.value,c<1)return this.parsingError(Jt.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(c))return this.parsingError(Jt.StaticOffsetError,"Fifth argument to OFFSET is not integer")}else return this.parsingError(Jt.StaticOffsetError,"Fifth argument to OFFSET is not a static number");const h=new St(t.reference.col+o,t.reference.row+s,t.reference.type);let d=h.col,m=h.row;if((t.reference.type===Et.CELL_REFERENCE_RELATIVE||t.reference.type===Et.CELL_REFERENCE_ABSOLUTE_COL)&&(m=m+this.formulaAddress.row),(t.reference.type===Et.CELL_REFERENCE_RELATIVE||t.reference.type===Et.CELL_REFERENCE_ABSOLUTE_ROW)&&(d=d+this.formulaAddress.col),d<0||m<0)return bi(new v(S.REF,N.OutOfSheet));if(c===1&&l===1)return zb(h);{const E=new St(h.col+c-1,h.row+l-1,h.type);return Yb(h,E,ws.RELATIVE)}}parsingError(e,t){return this.customParsingError=Gb(e,t),YE()}static rangeSheetReferenceType(e,t){return e===void 0?ws.RELATIVE:t===void 0?ws.START_ABSOLUTE:ws.BOTH_ABSOLUTE}}class zm{constructor(e){this.lexerConfig=e,this.lexer=new Hn(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){const t=this.lexer.tokenize(e);let n=t.tokens;return n=this.trimTrailingWhitespaces(n),n=this.skipWhitespacesInsideRanges(n),n=this.skipWhitespacesBeforeArgSeparators(n),t.tokens=n,t}skipWhitespacesInsideRanges(e){return zm.filterTokensByNeighbors(e,(t,n,s)=>(Rt(t,Ko)||Rt(t,Rh))&&Rt(n,this.lexerConfig.WhiteSpace)&&(Rt(s,Ko)||Rt(s,Rh)))}skipWhitespacesBeforeArgSeparators(e){return zm.filterTokensByNeighbors(e,(t,n,s)=>!Rt(t,this.lexerConfig.ArgSeparator)&&Rt(n,this.lexerConfig.WhiteSpace)&&Rt(s,this.lexerConfig.ArgSeparator))}static filterTokensByNeighbors(e,t){if(e.length<3)return e;let n=0;const s=[e[n++]];for(;n<e.length-1;)t(e[n-1],e[n],e[n+1])||s.push(e[n]),++n;return s.push(e[n]),s}trimTrailingWhitespaces(e){return e.length>0&&Rt(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Zx{constructor(e,t,n,s){this.config=e,this.lexerConfig=t,this.sheetMappingFn=n,this.namedExpressions=s}unparse(e,t){return"="+this.unparseAst(e,t)}unparseAst(e,t){var n,s;switch(e.type){case C.EMPTY:return ot("",e.leadingWhitespace);case C.NUMBER:return ot(Jx(e.value,this.config.decimalSeparator),e.leadingWhitespace);case C.STRING:return ot('"'+e.value+'"',e.leadingWhitespace);case C.FUNCTION_CALL:{const i=e.args.map(l=>l!==void 0?this.unparseAst(l,t):"").join(this.config.functionArgSeparator),a=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+i+ot(")",e.internalWhitespace);return ot(a,e.leadingWhitespace)}case C.NAMED_EXPRESSION:{const i=(n=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))===null||n===void 0?void 0:n.displayName;return ot(i||e.expressionName,e.leadingWhitespace)}case C.CELL_REFERENCE:{let i;return e.reference.sheet!==void 0?i=this.unparseSheetName(e.reference.sheet)+"!":i="",i+=(s=e.reference.unparse(t))!==null&&s!==void 0?s:this.config.translationPackage.getErrorTranslation(S.REF),ot(i,e.leadingWhitespace)}case C.COLUMN_RANGE:case C.ROW_RANGE:case C.CELL_RANGE:return ot(this.formatRange(e,t),e.leadingWhitespace);case C.PLUS_UNARY_OP:{const i=this.unparseAst(e.value,t);return ot("+",e.leadingWhitespace)+i}case C.MINUS_UNARY_OP:{const i=this.unparseAst(e.value,t);return ot("-",e.leadingWhitespace)+i}case C.PERCENT_OP:return this.unparseAst(e.value,t)+ot("%",e.leadingWhitespace);case C.ERROR:{const i=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:S.ERROR);return ot(i,e.leadingWhitespace)}case C.ERROR_WITH_RAW_INPUT:return ot(e.rawInput,e.leadingWhitespace);case C.PARENTHESIS:{const o="("+this.unparseAst(e.expression,t)+ot(")",e.internalWhitespace);return ot(o,e.leadingWhitespace)}case C.ARRAY:{const i="{"+e.args.map(o=>o.map(a=>this.unparseAst(a,t)).join(this.config.arrayColumnSeparator)).join(this.config.arrayRowSeparator)+ot("}",e.internalWhitespace);return ot(i,e.leadingWhitespace)}default:{const i=this.unparseAst(e.left,t),o=this.unparseAst(e.right,t);return i+ot(Hx[e.type],e.leadingWhitespace)+o}}}unparseSheetName(e){const t=X_(e,this.sheetMappingFn);if(t===void 0)throw new Gt(e);return t}formatRange(e,t){let n="",s="";e.start.sheet!==void 0&&e.sheetReferenceType!==ws.RELATIVE&&(n=this.unparseSheetName(e.start.sheet)+"!"),e.end.sheet!==void 0&&e.sheetReferenceType===ws.BOTH_ABSOLUTE&&(s=this.unparseSheetName(e.end.sheet)+"!");const i=e.start.unparse(t),o=e.end.unparse(t);return i===void 0||o===void 0?this.config.translationPackage.getErrorTranslation(S.REF):`${n}${i}:${s}${o}`}}function Jx(r,e){return r.toString().replace(".",e)}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class eh{constructor(e,t,n){this.config=e,this.functionRegistry=t,this.sheetMapping=n,this.statsCacheUsed=0,this.lexerConfig=NR(e),this.lexer=new zm(this.lexerConfig),this.formulaParser=new ru(this.lexerConfig,this.sheetMapping),this.cache=new JZ(this.functionRegistry)}parse(e,t){this.formulaAddress=t;const n=this.tokenizeFormula(e);if(n.errors.length>0){const h=n.errors.map(d=>({type:Jt.LexingError,message:d.message}));return{ast:YE(),errors:h,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}const s=this.computeHashFromTokens(n.tokens,t);let i=this.cache.get(s);if(i!==void 0)++this.statsCacheUsed;else{const h=this.bindWhitespacesToTokens(n.tokens),d=this.formulaParser.parseFromTokens(h,t);if(d.errors.length>0)return Object.assign(Object.assign({},d),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});i=this.cache.set(s,d.ast)}const{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:l}=i,u=this.convertReversedRangesToRegularRanges(o),c=tg(u,this.functionRegistry);return{ast:u,errors:[],hasVolatileFunction:a,hasStructuralChangeFunction:l,dependencies:c}}convertReversedRangesToRegularRanges(e){switch(e.type){case C.EMPTY:case C.NUMBER:case C.STRING:case C.ERROR:case C.ERROR_WITH_RAW_INPUT:case C.CELL_REFERENCE:case C.NAMED_EXPRESSION:return e;case C.CELL_RANGE:{const{start:t,end:n}=e,s=this.orderCellRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:s.start,end:s.end})}case C.COLUMN_RANGE:{const{start:t,end:n}=e,s=this.orderColumnRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:s.start,end:s.end})}case C.ROW_RANGE:{const{start:t,end:n}=e,s=this.orderRowRangeEnds(t,n);return Object.assign(Object.assign({},e),{start:s.start,end:s.end})}case C.PERCENT_OP:case C.PLUS_UNARY_OP:case C.MINUS_UNARY_OP:{const t=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:t})}case C.CONCATENATE_OP:case C.EQUALS_OP:case C.NOT_EQUAL_OP:case C.LESS_THAN_OP:case C.GREATER_THAN_OP:case C.LESS_THAN_OR_EQUAL_OP:case C.GREATER_THAN_OR_EQUAL_OP:case C.MINUS_OP:case C.PLUS_OP:case C.TIMES_OP:case C.DIV_OP:case C.POWER_OP:{const t=this.convertReversedRangesToRegularRanges(e.left),n=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:t,right:n})}case C.PARENTHESIS:{const t=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:t})}case C.FUNCTION_CALL:{const t=e.args.map(n=>this.convertReversedRangesToRegularRanges(n));return Object.assign(Object.assign({},e),{args:t})}case C.ARRAY:{const t=e.args.map(n=>n.map(s=>this.convertReversedRangesToRegularRanges(s)));return Object.assign(Object.assign({},e),{args:t})}}}orderCellRangeEnds(e,t){const n=[e,t],[s,i]=n.map(c=>c.toColumnAddress()).sort(mn.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=n.map(c=>c.toRowAddress()).sort(tn.compareByAbsoluteAddress(this.formulaAddress)),[l,u]=n.map(c=>c.sheet).sort(eh.compareSheetIds.bind(this));return{start:St.fromColAndRow(s,o,l),end:St.fromColAndRow(i,a,u)}}orderColumnRangeEnds(e,t){const n=[e,t],[s,i]=n.sort(mn.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=n.map(l=>l.sheet).sort(eh.compareSheetIds.bind(this));return{start:new mn(s.type,s.col,o),end:new mn(i.type,i.col,a)}}orderRowRangeEnds(e,t){const n=[e,t],[s,i]=n.sort(tn.compareByAbsoluteAddress(this.formulaAddress)),[o,a]=n.map(l=>l.sheet).sort(eh.compareSheetIds.bind(this));return{start:new tn(s.type,s.row,o),end:new tn(i.type,i.row,a)}}static compareSheetIds(e,t){return e=e??1/0,t=t??1/0,e-t}fetchCachedResultForAst(e){const t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}fetchCachedResult(e){const t=this.cache.get(e);if(t===void 0)throw new Error("There is no AST with such key in the cache");{const{ast:n,hasVolatileFunction:s,hasStructuralChangeFunction:i,relativeDependencies:o}=t;return{ast:n,errors:[],hasVolatileFunction:s,hasStructuralChangeFunction:i,dependencies:o}}}computeHashFromTokens(e,t){var n;let s="",i=0;for(;i<e.length;){const o=e[i];if(Rt(o,Ko)){const a=Gl(this.sheetMapping,o.image,t);a===void 0?s=s.concat(o.image):s=s.concat(a.hash(!0))}else if(Rt(o,bR)){const a=o.image.toUpperCase().slice(0,-1),l=(n=this.lexerConfig.functionMapping[a])!==null&&n!==void 0?n:a;s=s.concat(l,"(")}else if(Rt(o,CR)){const[a,l]=o.image.split(":"),u=xm(this.sheetMapping,a,t),c=xm(this.sheetMapping,l,t);u===void 0||c===void 0?s=s.concat("!REF"):s=s.concat(u.hash(!0),":",c.hash(!0))}else if(Rt(o,TR)){const[a,l]=o.image.split(":"),u=Lm(this.sheetMapping,a,t),c=Lm(this.sheetMapping,l,t);u===void 0||c===void 0?s=s.concat("!REF"):s=s.concat(u.hash(!0),":",c.hash(!0))}else s=s.concat(o.image);i++}return s}rememberNewAst(e){const t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case C.EMPTY:return e.leadingWhitespace||"";case C.NUMBER:return ot(Jx(e.value,this.config.decimalSeparator),e.leadingWhitespace);case C.STRING:return ot('"'+e.value+'"',e.leadingWhitespace);case C.NAMED_EXPRESSION:return ot(e.expressionName,e.leadingWhitespace);case C.FUNCTION_CALL:{const t=e.args.map(s=>this.computeHashOfAstNode(s)).join(this.config.functionArgSeparator),n=e.procedureName+"("+t+ot(")",e.internalWhitespace);return ot(n,e.leadingWhitespace)}case C.CELL_REFERENCE:return ot(e.reference.hash(!0),e.leadingWhitespace);case C.COLUMN_RANGE:case C.ROW_RANGE:case C.CELL_RANGE:{const t=e.start.hash(e.sheetReferenceType!==ws.RELATIVE),n=e.end.hash(e.sheetReferenceType===ws.BOTH_ABSOLUTE);return ot(t+":"+n,e.leadingWhitespace)}case C.MINUS_UNARY_OP:return ot("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case C.PLUS_UNARY_OP:return ot("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case C.PERCENT_OP:return this.computeHashOfAstNode(e.value)+ot("%",e.leadingWhitespace);case C.ERROR:{const t=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:S.ERROR);return ot(t,e.leadingWhitespace)}case C.ERROR_WITH_RAW_INPUT:return ot(e.rawInput,e.leadingWhitespace);case C.ARRAY:{const t=e.args.map(n=>n.map(s=>this.computeHashOfAstNode(s)).join(",")).join(";");return ot("{"+t+ot("}",e.internalWhitespace),e.leadingWhitespace)}case C.PARENTHESIS:{const n="("+this.computeHashOfAstNode(e.expression)+ot(")",e.internalWhitespace);return ot(n,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+ot(Hx[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){const t=[],n=e[0];Rt(n,this.lexerConfig.WhiteSpace)||t.push(n);for(let s=1;s<e.length;++s){const i=e[s];if(Rt(i,this.lexerConfig.WhiteSpace))continue;const o=e[s-1];Rt(o,this.lexerConfig.WhiteSpace)&&(i.leadingWhitespace=o),t.push(i)}return t}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const zl=(r,e,t,n)=>{switch(r.type){case C.EMPTY:case C.NUMBER:case C.STRING:case C.ERROR:return;case C.NAMED_EXPRESSION:{n&&t.push(new po(r.expressionName));return}case C.CELL_REFERENCE:{n&&t.push(new e1(r.reference));return}case C.CELL_RANGE:{n&&r.start.sheet===r.end.sheet&&t.push(new rJ(r.start,r.end));return}case C.COLUMN_RANGE:{n&&r.start.sheet===r.end.sheet&&t.push(new nJ(r.start,r.end));return}case C.ROW_RANGE:{n&&r.start.sheet===r.end.sheet&&t.push(new sJ(r.start,r.end));return}case C.PERCENT_OP:case C.PLUS_UNARY_OP:case C.MINUS_UNARY_OP:{zl(r.value,e,t,!0);return}case C.CONCATENATE_OP:case C.EQUALS_OP:case C.NOT_EQUAL_OP:case C.LESS_THAN_OP:case C.GREATER_THAN_OP:case C.LESS_THAN_OR_EQUAL_OP:case C.GREATER_THAN_OR_EQUAL_OP:case C.MINUS_OP:case C.PLUS_OP:case C.TIMES_OP:case C.DIV_OP:case C.POWER_OP:zl(r.left,e,t,!0),zl(r.right,e,t,!0);return;case C.PARENTHESIS:zl(r.expression,e,t,n);return;case C.FUNCTION_CALL:{const s=!e.doesFunctionNeedArgumentToBeComputed(r.procedureName);r.args.forEach(i=>zl(i,e,t,s));return}}},tg=(r,e)=>{const t=new Array;return zl(r,e,t,!0),t};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class e1{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}}class rJ{constructor(e,t){this.start=e,this.end=t}absolutize(e){return new we(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}class nJ{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleColumnAddress(e),n=this.end.toSimpleColumnAddress(e);return new Eo(t.sheet,t.col,n.col)}}class sJ{constructor(e,t){this.start=e,this.end=t}absolutize(e){const t=this.start.toSimpleRowAddress(e),n=this.end.toSimpleRowAddress(e);return new vo(t.sheet,t.row,n.row)}}class po{constructor(e){this.name=e}absolutize(e){return this}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Ni=(r,e)=>r.map(t=>t.absolutize(e)),iJ=r=>r.filter(e=>e instanceof po?!0:e instanceof we?!(Fn(e.start)||Fn(e.end)):!Fn(e));/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Xe=Symbol("Empty value");function le(r){return r instanceof Yi?r.val:r}class Yi{constructor(e,t){this.val=e,this.format=t}fromNumber(e){return new this.constructor(e)}}function AR(r,e){if(typeof r=="number")return e;{const t=r.fromNumber(e);return t.format=r.format,t}}class OR extends Yi{getDetailedType(){return ge.NUMBER_DATE}}class ZE extends Yi{getDetailedType(){return ge.NUMBER_CURRENCY}}class IR extends Yi{getDetailedType(){return ge.NUMBER_TIME}}class MR extends Yi{getDetailedType(){return ge.NUMBER_DATETIME}}class jf extends Yi{getDetailedType(){return ge.NUMBER_PERCENT}}function ct(r){return typeof r=="number"||r instanceof Yi}var ge;(function(r){r.NUMBER_RAW="NUMBER_RAW",r.NUMBER_DATE="NUMBER_DATE",r.NUMBER_TIME="NUMBER_TIME",r.NUMBER_DATETIME="NUMBER_DATETIME",r.NUMBER_CURRENCY="NUMBER_CURRENCY",r.NUMBER_PERCENT="NUMBER_PERCENT"})(ge||(ge={}));function oJ(r){return r instanceof Yi?r.getDetailedType():ge.NUMBER_RAW}function aJ(r){if(r instanceof Yi)return r.format}function Ym(r){return r instanceof Yi?{type:r.getDetailedType(),format:r.format}:{type:ge.NUMBER_RAW}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Ee{constructor(e,t,n,s){this._data=e,this.range=t,this.dependencyGraph=n,this._hasOnlyNumbers=s,this.size=e===void 0?new Ze(t.effectiveWidth(n),t.effectiveHeight(n)):new Ze(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,t,n){return new Ee(e,t,n,!0)}static onlyNumbers(e){return new Ee(e,void 0,void 0,!0)}static onlyValues(e){return new Ee(e,void 0,void 0,void 0)}static onlyRange(e,t){return new Ee(void 0,e,t,void 0)}static fromScalar(e){return new Ee([[e]],void 0,void 0,void 0)}isAdHoc(){return this.range===void 0}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();const e=[];for(let t=0;t<this._data.length;t++)for(let n=0;n<this._data[0].length;n++)e.push(this._data[t][n]);return e}*effectiveAddressesFromData(e){for(let t=0;t<this.data.length;++t){const n=this.data[t];for(let s=0;s<n.length;++s)yield he(e.sheet,e.col+s,e.row+t)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let t=0;t<this.size.height;++t)for(let n=0;n<this.size.width;++n)yield[this._data[t][n],he(e.sheet,e.col+n,e.row+t)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(this._hasOnlyNumbers===void 0){this._hasOnlyNumbers=!0;for(const e of this.data)for(const t of e)if(typeof t!="number")return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),(e=this._data)!==null&&e!==void 0?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){this._data===void 0&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,e=>{const t=this.dependencyGraph.getCellValue(e);return t instanceof Ee?(this._hasOnlyNumbers=!1,new v(S.VALUE,N.ScalarExpected)):(ct(t)||(this._hasOnlyNumbers=!1),t)}))}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class ea{constructor(){this.changes=new Map}static empty(){return new ea}addAll(e){for(const t of e.changes.values())this.add(t.address,t);return this}addChange(e,t,n){this.addInterpreterValue(e,t,n)}exportChanges(e){let t=[];return this.changes.forEach(n=>{const s=e.exportChange(n);Array.isArray(s)?t=t.concat(s):t.push(s)}),t}getChanges(){return Array.from(this.changes.values())}isEmpty(){return this.changes.size===0}add(e,t){const n=t.value;if(n instanceof Ee)for(const s of n.effectiveAddressesFromData(e))this.changes.delete(th(s));this.changes.set(th(e),t)}addInterpreterValue(e,t,n){this.add(t,{address:t,value:e,oldValue:n})}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Dn{constructor(e,t,n){if(this.sheet=e,this.rowStart=t,this.rowEnd=n,t<0)throw Error("Starting row cant be less than 0");if(n<t)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,t,n){return new Dn(e,t,t+n-1)}static fromRowStartAndEnd(e,t,n){return new Dn(e,t,n)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.rowStart,e.rowStart),n=Math.min(this.rowEnd,e.rowEnd);return t>n?null:new Dn(this.sheet,t,n)}firstRow(){return new Dn(this.sheet,this.rowStart,this.rowStart)}}class Xn{constructor(e,t,n){if(this.sheet=e,this.columnStart=t,this.columnEnd=n,t<0)throw Error("Starting column cant be less than 0");if(n<t)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,t,n){return new Xn(e,t,t+n-1)}static fromColumnStartAndEnd(e,t,n){return new Xn(e,t,n)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");const t=Math.max(this.columnStart,e.columnStart),n=Math.min(this.columnEnd,e.columnEnd);return t>n?null:new Xn(this.sheet,t,n)}firstColumn(){return new Xn(this.sheet,this.columnStart,this.columnStart)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var Ve;(function(r){r.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",r.PARSER="PARSER",r.GRAPH_BUILD="GRAPH_BUILD",r.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",r.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",r.TOP_SORT="TOP_SORT",r.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",r.EVALUATION="EVALUATION",r.VLOOKUP="VLOOKUP",r.TRANSFORM_ASTS="TRANSFORM_ASTS",r.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",r.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",r.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",r.ADJUSTING_RANGES="ADJUSTING_RANGES",r.ADJUSTING_GRAPH="ADJUSTING_GRAPH",r.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",r.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"})(Ve||(Ve={}));/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class t1{constructor(){this.stats=new Map([[Ve.CRITERION_FUNCTION_FULL_CACHE_USED,0],[Ve.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;const t=((e=this.stats.get(Ve.CRITERION_FUNCTION_FULL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(Ve.CRITERION_FUNCTION_FULL_CACHE_USED,t)}incrementCriterionFunctionPartialCacheUsed(){var e;const t=((e=this.stats.get(Ve.CRITERION_FUNCTION_PARTIAL_CACHE_USED))!==null&&e!==void 0?e:0)+1;this.stats.set(Ve.CRITERION_FUNCTION_PARTIAL_CACHE_USED,t)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(Ve.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(Ve.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var t;const n=Date.now(),s=this.startTimes.get(e);if(s){let i=(t=this.stats.get(e))!==null&&t!==void 0?t:0;i+=n-s,this.stats.set(e,i),this.startTimes.delete(e)}else throw Error(`Statistics ${e} not started`)}measure(e,t){this.start(e);const n=t();return this.end(e),n}snapshot(){return new Map(this.stats)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class lJ extends t1{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Gt extends Error{constructor(e){super(`There's no sheet with id = ${e}`)}}class r1 extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}}class Sh extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}}class Qa extends Error{constructor(){super("Sheet size limit exceeded")}}class Kf extends Error{constructor(){super("This is not a formula")}}class n1 extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}}class gr extends Error{constructor(e){super(`Invalid arguments, expected ${e}`)}}class Ch extends Error{constructor(e,t){super(`Sheets ${e} and ${t} are not equal.`)}}class s1 extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}}class i1 extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}}class Th extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}}class o1 extends Error{constructor(){super("There is no operation to undo")}}class a1 extends Error{constructor(){super("There is no operation to redo")}}class l1 extends Error{constructor(){super("There is nothing to paste")}}function uJ(r,e){switch(typeof e){case"function":case"symbol":return e.toString();case"bigint":return"BigInt("+e.toString()+")";default:return e instanceof RegExp?"RegExp("+e.toString()+")":e}}class u1 extends Error{constructor(e){super(`Unable to parse value: ${JSON.stringify(e,uJ,4)}`)}}class lt extends Error{constructor(e,t){super(`Expected value of type: ${e} for config parameter: ${t}`)}}class cJ extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}}class c1 extends Error{constructor(e,t){super(`Config parameter ${e} should be at least ${t}`)}}class h1 extends Error{constructor(e,t){super(`Config parameter ${e} should be at most ${t}`)}}class d1 extends Error{constructor(e,t){super(`Expected one of ${e} for config parameter: ${t}`)}}class f1 extends Error{constructor(){super("Computations are suspended")}}class Yl extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}}class m1 extends Error{constructor(e){super(`Cannot register translation for function with id: ${e}`)}}class JE extends Error{constructor(){super("Language not registered.")}}class p1 extends Error{constructor(){super("Language already registered.")}}class Mu extends Error{static functionNotDeclaredInPlugin(e,t){return new Mu(`Function with id ${e} not declared in plugin ${t}`)}static functionMethodNotFound(e,t){return new Mu(`Function method ${e} not found in plugin ${t}`)}}class Za extends Error{static cannotRegisterFunctionWithId(e){return new Za(`Cannot register function with id ${e}`)}static cannotUnregisterFunctionWithId(e){return new Za(`Cannot unregister function with id ${e}`)}static cannotUnregisterProtectedPlugin(){return new Za("Cannot unregister protected plugin")}}class nu extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}}class jm extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}}class _R extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}}class hJ extends Error{constructor(e,t){super(`Alias id ${e} in plugin ${t} already defined as a function or alias.`)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class dJ{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new Gt(e.sheet);return t.getCell(e)}fetchCell(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new Gt(e.sheet);const n=t.getCell(e);if(!n)throw Error("Vertex for address missing in AddressMapping");return n}strategyFor(e){const t=this.mapping.get(e);if(t===void 0)throw new Gt(e);return t}addSheet(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}autoAddSheet(e,t){const{height:n,width:s,fill:i}=t,o=this.policy.call(i);this.addSheet(e,new o(s,n))}getCellValue(e){const t=this.getCell(e);return t===void 0?Xe:t instanceof or?t.getArrayCellValue(e):t.getCellValue()}getRawValue(e){const t=this.getCell(e);return t instanceof ta?t.getValues().rawValue:t instanceof or?t.getArrayCellRawValue(e):null}setCell(e,t){const n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized");n.setCell(e,t)}moveCell(e,t){const n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized.");if(e.sheet!==t.sheet)throw Error("Cannot move cells between sheets.");if(n.has(t))throw new Error("Cannot move cell. Destination already occupied.");const s=n.getCell(e);if(s===void 0)throw new Error("Cannot move cell. No cell with such address.");this.setCell(t,s),this.removeCell(e)}removeCell(e){const t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}has(e){const t=this.mapping.get(e.sheet);return t===void 0?!1:t.has(e)}getHeight(e){const t=this.mapping.get(e);if(t===void 0)throw new Gt(e);return t.getHeight()}getWidth(e){const t=this.mapping.get(e);if(!t)throw new Gt(e);return t.getWidth()}addRows(e,t,n){const s=this.mapping.get(e);if(s===void 0)throw new Gt(e);s.addRows(t,n)}removeRows(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new Gt(e.sheet);t.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,t,n){const s=this.mapping.get(e);if(s===void 0)throw new Gt(e);s.addColumns(t,n)}removeColumns(e){const t=this.mapping.get(e.sheet);if(t===void 0)throw new Gt(e.sheet);t.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(const[e,t]of this.mapping.entries())yield*t.getEntries(e)}*sheetEntries(e){const t=this.mapping.get(e);if(t!==void 0)yield*t.getEntries(e);else throw new Gt(e)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class fJ{constructor(){this.arrayMapping=new Map}getArray(e){const t=this.getArrayByCorner(e.start);if(t!=null&&t.getRange().sameAs(e))return t}getArrayByCorner(e){return this.arrayMapping.get(th(e))}setArray(e,t){this.arrayMapping.set(th(e.start),t)}removeArray(e){typeof e=="string"?this.arrayMapping.delete(e):this.arrayMapping.delete(th(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(const[t,n]of this.arrayMapping.entries())n.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[t,n])}*arraysInCols(e){for(const[t,n]of this.arrayMapping.entries())n.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[t,n])}isFormulaArrayInRow(e,t){for(const n of this.arrayMapping.values())if(n.spansThroughSheetRows(e,t))return!0;return!1}isFormulaArrayInAllRows(e){let t=!0;for(const n of e.rows())this.isFormulaArrayInRow(e.sheet,n)||(t=!1);return t}isFormulaArrayInColumn(e,t){for(const n of this.arrayMapping.values())if(n.spansThroughSheetColumn(e,t))return!0;return!1}isFormulaArrayInAllColumns(e){let t=!0;for(const n of e.columns())this.isFormulaArrayInColumn(e.sheet,n)||(t=!1);return t}isFormulaArrayInRange(e){for(const t of this.arrayMapping.values())if(t.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(const t of this.arrayMapping.values())if(t.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,t,n){this.updateArrayVerticesInSheet(e,(s,i)=>{const o=i.getRange();return t<=o.start.row?[o.shifted(0,n),i]:void 0})}moveArrayVerticesAfterColumnByColumns(e,t,n){this.updateArrayVerticesInSheet(e,(s,i)=>{const o=i.getRange();return t<=o.start.col?[o.shifted(n,0),i]:void 0})}updateArrayVerticesInSheet(e,t){const n=Array();for(const[s,i]of this.arrayMapping.entries()){if(i.sheet!==e)continue;const o=t(s,i);o!==void 0&&(this.removeArray(s),n.push(o))}n.forEach(([s,i])=>{this.setArray(s,i)})}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Lc{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,t){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}}class _u{constructor(e){if(this.size=new Ze(e.length>0?e[0].length:0,e.length),this.array=e,this.size.width<=0||this.size.height<=0)throw Error("Incorrect array size")}static fromInterpreterValue(e){return e instanceof Ee?new _u(e.data):new _u([[e]])}simpleRangeValue(){return Ee.onlyValues(this.array)}addRows(e,t){this.array.splice(e,0,...this.nullArrays(t,this.width())),this.size.height+=t}addColumns(e,t){for(let n=0;n<this.height();n++)this.array[n].splice(e,0,...new Array(t).fill(Xe));this.size.width+=t}removeRows(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");const n=t-e+1;this.array.splice(e,n),this.size.height-=n}removeColumns(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");const n=t-e+1;for(const s of this.array)s.splice(e,n);this.size.width-=n}nullArrays(e,t){const n=[];for(let s=0;s<e;++s)n.push(new Array(t).fill(Xe));return n}get(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}set(e,t,n){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=n}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height||(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width))throw Error("Resizing to smaller array")}outOfBound(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}class Ly{constructor(e,t){this.error=e,this.size=t}get(e,t){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class qn{constructor(e,t,n){this.formula=e,this.cellAddress=t,this.version=n}get width(){return 1}get height(){return 1}static fromAst(e,t,n,s){return n.isScalar()?new Ii(e,t,s):new or(e,t,n,s)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){const[t,n,s]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=t,this.cellAddress=n,this.version=s}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}class or extends qn{constructor(e,t,n,s=0){super(e,t,s),n.isRef?this.array=new Ly(new v(S.REF,N.NoSpaceForArrayResult),Ze.error()):this.array=new Lc(n)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof v)return this.setErrorValue(e),e;const t=_u.fromInterpreterValue(e);return t.resize(this.array.size),this.array=t,e}getCellValue(){if(this.array instanceof Lc)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof Lc))return this.array.simpleRangeValue()}getArrayCellValue(e){const t=e.col-this.cellAddress.col,n=e.row-this.cellAddress.row;try{return this.array.get(t,n)}catch{return new v(S.REF)}}getArrayCellRawValue(e){const t=this.getArrayCellValue(e);if(!(t instanceof v||t===Xe))return le(t)}setArrayCellValue(e,t){const n=e.col-this.cellAddress.col,s=e.row-this.cellAddress.row;this.array instanceof _u&&this.array.set(n,s,t)}setNoSpace(){return this.array=new Ly(new v(S.SPILL,N.NoSpaceForArrayResult),Ze.error()),this.getCellValue()}getRange(){return we.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return we.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,t,n=t){return this.cellAddress.sheet===e&&this.cellAddress.row<=n&&t<this.cellAddress.row+this.height}spansThroughSheetColumn(e,t,n=t){return this.cellAddress.sheet===e&&this.cellAddress.col<=n&&t<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof Lc)}columnsFromArray(){return Xn.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return Dn.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return Nh(this.cellAddress,e)}setErrorValue(e){this.array=new Ly(e,this.array.size)}}class Ii extends qn{constructor(e,t,n){super(e,t,n)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(this.cachedCellValue!==void 0)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return this.cachedCellValue!==void 0}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class en{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,t){this.functionCache.set(e,t)}getCriterionFunctionValue(e,t){var n;return(n=this.getCriterionFunctionValues(e).get(t))===null||n===void 0?void 0:n[0]}getCriterionFunctionValues(e){var t;return(t=this.criterionFunctionCache.get(e))!==null&&t!==void 0?t:new Map}setCriterionFunctionValues(e,t){this.criterionFunctionCache.set(e,t)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(e=>e.criterionFunctionCache.clear()),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const mJ=(r,e,t,n,s)=>{if(e instanceof en){const a=e.range.intersectionWith(t);return a!==void 0?Array.from(a.addresses(s)):[]}let i,o;if(e instanceof qn)i=e.getFormula(n),o=e.getAddress(n);else return[];return tg(i,r).filter(a=>a instanceof e1).map(a=>a.dependency.toSimpleCellAddress(o)).filter(a=>t.addressInRange(a))};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var oo;(function(r){r[r.ON_STACK=0]="ON_STACK",r[r.PROCESSED=1]="PROCESSED",r[r.POPPED=2]="POPPED"})(oo||(oo={}));class pJ{constructor(e=[],t=[]){this.nodesSparseArray=e,this.edgesSparseArray=t,this.entranceTime=[],this.low=[],this.parent=[],this.inSCC=[],this.nodeStatus=[],this.order=[],this.sccNonSingletons=[],this.timeCounter=0}getTopSortedWithSccSubgraphFrom(e,t,n){const s=e.reverse();return s.forEach(i=>this.runDFS(i)),this.postprocess(s,n,t)}getAdjacentNodeIds(e){return this.edgesSparseArray[e].filter(t=>t!==void 0&&this.nodesSparseArray[t])}runDFS(e){if(this.nodeStatus[e]!==void 0)return;this.nodeStatus[e]=oo.ON_STACK;const t=[e],n=[];for(;t.length>0;){const s=t[t.length-1];switch(this.nodeStatus[s]){case oo.ON_STACK:{this.handleOnStack(s,n,t);break}case oo.PROCESSED:{this.handleProcessed(s,n,t);break}case oo.POPPED:{t.pop();break}}}}handleOnStack(e,t,n){this.entranceTime[e]=this.timeCounter,this.low[e]=this.timeCounter,this.timeCounter++,t.push(e),this.getAdjacentNodeIds(e).forEach(s=>{this.entranceTime[s]===void 0&&(n.push(s),this.parent[s]=e,this.nodeStatus[s]=oo.ON_STACK)}),this.nodeStatus[e]=oo.PROCESSED}handleProcessed(e,t,n){let s=this.entranceTime[e];if(this.getAdjacentNodeIds(e).forEach(i=>{this.inSCC[i]||(s=this.parent[i]===e?Math.min(s,this.low[i]):Math.min(s,this.entranceTime[i]))}),this.low[e]=s,s===this.entranceTime[e]){const i=[];do i.push(t[t.length-1]),t.pop();while(i[i.length-1]!==e);i.forEach(o=>{this.inSCC[o]=!0}),this.order.push(...i),i.length>1&&i.forEach(o=>{this.sccNonSingletons[o]=!0})}n.pop(),this.nodeStatus[e]=oo.POPPED}postprocess(e,t,n){const s=[];e.forEach(a=>{s[a]=!0});const i=[],o=[];return this.order.reverse(),this.order.forEach(a=>{const l=this.getAdjacentNodeIds(a);this.sccNonSingletons[a]||l.includes(a)?(o.push(this.nodesSparseArray[a]),t(this.nodesSparseArray[a]),l.forEach(u=>s[u]=!0)):(i.push(this.nodesSparseArray[a]),s[a]&&n(this.nodesSparseArray[a])&&l.forEach(u=>s[u]=!0))}),{sorted:i,cycled:o}}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class gJ{constructor(e,t){this.rawValue=e,this.processFn=t,this.processedValue=null}getProcessedValue(){return this.processedValue===null&&(this.processedValue=this.processFn(this.rawValue)),this.processedValue}markAsModified(){this.processedValue=null}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class yJ{constructor(e){this.dependencyQuery=e,this.nodesSparseArray=[],this.edgesSparseArray=[],this.nodesIds=new Map,this.dirtyAndVolatileNodeIds=new gJ({dirty:[],volatile:[]},t=>this.processDirtyAndVolatileNodeIds(t)),this.infiniteRangeIds=new Set,this.changingWithStructureNodeIds=[],this.nextId=0}getNodes(){return this.nodesSparseArray.filter(e=>e!==void 0)}hasNode(e){return this.nodesIds.has(e)}existsEdge(e,t){const n=this.getNodeId(e),s=this.getNodeId(t);return n===void 0||s===void 0?!1:this.edgesSparseArray[n].includes(s)}adjacentNodes(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return new Set(this.edgesSparseArray[t].filter(n=>n!==void 0).map(n=>this.nodesSparseArray[n]))}adjacentNodesCount(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);return this.fixEdgesArrayForNode(t).length}addNodeAndReturnId(e){const t=this.nodesIds.get(e);if(t!==void 0)return t;const n=this.nextId;return this.nextId++,this.nodesSparseArray[n]=e,this.edgesSparseArray[n]=[],this.nodesIds.set(e,n),n}addEdge(e,t){const n=this.getNodeIdIfNotNumber(e),s=this.getNodeIdIfNotNumber(t);if(n===void 0)throw this.missingNodeError(e);if(s===void 0)throw this.missingNodeError(t);this.edgesSparseArray[n].includes(s)||this.edgesSparseArray[n].push(s)}removeNode(e){const t=this.getNodeId(e);if(t===void 0)throw this.missingNodeError(e);this.edgesSparseArray[t].length>0&&(this.edgesSparseArray[t].forEach(s=>this.dirtyAndVolatileNodeIds.rawValue.dirty.push(s)),this.dirtyAndVolatileNodeIds.markAsModified());const n=this.removeDependencies(e);return delete this.nodesSparseArray[t],delete this.edgesSparseArray[t],this.infiniteRangeIds.delete(t),this.nodesIds.delete(e),n}removeEdge(e,t){const n=this.getNodeIdIfNotNumber(e),s=this.getNodeIdIfNotNumber(t);if(n===void 0)throw this.missingNodeError(e);if(s===void 0)throw this.missingNodeError(t);const i=this.edgesSparseArray[n].indexOf(s);if(i===-1)throw new Error("Edge does not exist");delete this.edgesSparseArray[n][i]}removeEdgeIfExists(e,t){const n=this.getNodeId(e),s=this.getNodeId(t);if(n===void 0||s===void 0)return;const i=this.edgesSparseArray[n].indexOf(s);i!==-1&&delete this.edgesSparseArray[n][i]}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(this.getNodes(),()=>!0,()=>{})}getTopSortedWithSccSubgraphFrom(e,t,n){const s=new pJ(this.nodesSparseArray,this.edgesSparseArray),i=e.map(o=>this.getNodeId(o)).filter(o=>o!==void 0);return s.getTopSortedWithSccSubgraphFrom(i,t,n)}markNodeAsVolatile(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.volatile.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsDirty(e){const t=this.getNodeId(e);t!==void 0&&(this.dirtyAndVolatileNodeIds.rawValue.dirty.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}getDirtyAndVolatileNodes(){return this.dirtyAndVolatileNodeIds.getProcessedValue()}clearDirtyNodes(){this.dirtyAndVolatileNodeIds.rawValue.dirty=[],this.dirtyAndVolatileNodeIds.markAsModified()}markNodeAsChangingWithStructure(e){const t=this.getNodeId(e);t!==void 0&&this.changingWithStructureNodeIds.push(t)}markChangingWithStructureNodesAsDirty(){this.changingWithStructureNodeIds.length<=0||(this.dirtyAndVolatileNodeIds.rawValue.dirty=[...this.dirtyAndVolatileNodeIds.rawValue.dirty,...this.changingWithStructureNodeIds],this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsInfiniteRange(e){const t=this.getNodeIdIfNotNumber(e);t!==void 0&&this.infiniteRangeIds.add(t)}getInfiniteRanges(){return[...this.infiniteRangeIds].map(e=>({node:this.nodesSparseArray[e],id:e}))}getNodeId(e){return this.nodesIds.get(e)}getNodeIdIfNotNumber(e){return typeof e=="number"?e:this.nodesIds.get(e)}fixEdgesArrayForNode(e){const t=this.edgesSparseArray[e];return this.edgesSparseArray[e]=t.filter(n=>n!==void 0&&this.nodesSparseArray[n]),this.edgesSparseArray[e]}removeDependencies(e){const t=this.dependencyQuery(e);return t.forEach(([n,s])=>{this.removeEdgeIfExists(s,e)}),t}processDirtyAndVolatileNodeIds({dirty:e,volatile:t}){return[...new Set([...e,...t])].map(n=>this.nodesSparseArray[n]).filter(n=>n!==void 0)}missingNodeError(e){return new Error(`Unknown node ${e}`)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class EJ{constructor(){this.rangeMapping=new Map}getMappingSize(e){var t,n;return(n=(t=this.rangeMapping.get(e))===null||t===void 0?void 0:t.size)!==null&&n!==void 0?n:0}setRange(e){let t=this.rangeMapping.get(e.getStart().sheet);t===void 0&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));const n=Xf(e.getStart(),e.getEnd());t.set(n,e)}removeRange(e){const t=e.getStart().sheet,n=this.rangeMapping.get(t);if(n===void 0)return;const s=Xf(e.getStart(),e.getEnd());n.delete(s),n.size===0&&this.rangeMapping.delete(t)}getRange(e,t){const n=this.rangeMapping.get(e.sheet),s=Xf(e,t);return n==null?void 0:n.get(s)}fetchRange(e,t){const n=this.getRange(e,t);if(!n)throw Error("Range does not exist");return n}truncateRanges(e,t){const n=Array(),s=Array(),i=Array(),o=e.sheet;for(const[l,u]of this.entriesFromSheet(e.sheet)){const c=u.range;e.start<=t(u.range.end)&&(c.removeSpan(e),c.shouldBeRemoved()?(this.removeByKey(o,l),n.push(u)):s.push([l,u]),i.push(u))}const a=[];s.sort((l,u)=>wJ(l[1],u[1],t));for(const[l,u]of s){const c=vJ(u.range);if(c===l)continue;const h=this.getByKey(o,c);this.removeByKey(o,l),h!==void 0&&u!=h?a.push([h,u]):this.setRange(u)}return{verticesToRemove:n,verticesToMerge:a,verticesWithChangedSize:i}}moveAllRangesInSheetAfterRowByRows(e,t,n){return this.updateVerticesFromSheet(e,(s,i)=>t<=i.start.row?(i.range.shiftByRows(n),{changedSize:!1,vertex:i}):t>i.start.row&&t<=i.end.row?(i.range.expandByRows(n),{changedSize:!0,vertex:i}):void 0)}moveAllRangesInSheetAfterColumnByColumns(e,t,n){return this.updateVerticesFromSheet(e,(s,i)=>t<=i.start.col?(i.range.shiftByColumns(n),{changedSize:!1,vertex:i}):t>i.start.col&&t<=i.end.col?(i.range.expandByColumns(n),{changedSize:!0,vertex:i}):void 0)}moveRangesInsideSourceRange(e,t,n,s){this.updateVerticesFromSheet(e.sheet,(i,o)=>{if(e.containsRange(o.range))return o.range.shiftByColumns(t),o.range.shiftByRows(n),o.range.moveToSheet(s),{changedSize:!1,vertex:o}})}removeRangesInSheet(e){if(this.rangeMapping.has(e)){const t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}*rangesInSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.values())}*rangeVerticesContainedInRange(e){for(const t of this.rangesInSheet(e.sheet))e.containsRange(t.range)&&(yield t)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){const t=he(e.end.sheet,e.end.col,e.end.row-1),n=this.getRange(e.start,t);if(n!==void 0){const s=we.fromSimpleCellAddresses(he(e.start.sheet,e.start.col,e.end.row),e.end);return{smallerRangeVertex:n,restRange:s}}}return{restRange:e}}*entriesFromSheet(e){const t=this.rangeMapping.get(e);t&&(yield*t.entries())}removeByKey(e,t){this.rangeMapping.get(e).delete(t)}getByKey(e,t){var n;return(n=this.rangeMapping.get(e))===null||n===void 0?void 0:n.get(t)}updateVerticesFromSheet(e,t){const n=Array();for(const[s,i]of this.entriesFromSheet(e)){const o=t(s,i);o!==void 0&&(this.removeByKey(e,s),n.push(o))}return n.forEach(s=>{this.setRange(s.vertex)}),{verticesWithChangedSize:n.filter(s=>s.changedSize).map(s=>s.vertex)}}}function Xf(r,e){return`${r.col},${r.row},${e.col},${e.row}`}function vJ(r){return Xf(r.start,r.end)}const wJ=(r,e,t)=>{const n=t(r.range.start),s=t(r.range.start);if(n===s){const i=t(r.range.end),o=t(e.range.end);return i-o}else return n-s};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class RJ{constructor(e,t,n){this.functions=e,this.errors=t,this.ui=n,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce((e,t)=>(e[this.functions[t]]=t,e),{})}buildErrorMapping(){return Object.keys(this.errors).reduce((e,t)=>(e[this.errors[t]]=t,e),{})}isFunctionTranslated(e){return this.functions[e]!==void 0}getFunctionTranslations(e){const t=[];for(const n of e)this.isFunctionTranslated(n)&&t.push(this.functions[n]);return t}getFunctionTranslation(e){const t=this.functions[e];if(t===void 0)throw new Yl(`functions.${e}`);return t}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===S.LIC)return`#${S.LIC}!`;const t=this.errors[e];if(t===void 0)throw new Yl(`errors.${e}`);return t}getUITranslation(e){const t=this.ui[e];if(t===void 0)throw new Yl(`ui.${e}`);return t}checkUI(){for(const e of Object.values(bh))if(!(e in this.ui))throw new Yl(`ui.${e}`)}checkErrors(){for(const e of Object.values(S))if(!(e in this.errors)&&e!==S.LIC)throw new Yl(`errors.${e}`)}checkFunctionTranslations(e){const t=new Set(Object.getOwnPropertyNames(e));for(const n of Object.getOwnPropertyNames(this._protectedTranslations))if(t.has(n))throw new m1(n)}}function SJ(r){return new RJ(Object.assign({},r.functions),Object.assign({},r.errors),Object.assign({},r.ui))}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var bh;(function(r){r.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"})(bh||(bh={}));/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function jl(r){return r.toLowerCase()}class CJ{constructor(e,t){this.id=e,this.displayName=t}get canonicalName(){return jl(this.displayName)}}class TJ{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=t=>{const n=this.mappingFromCanonicalName.get(jl(t));if(n===void 0)throw new r1(t);return n.id},this.get=t=>{var n;return(n=this.mappingFromCanonicalName.get(jl(t)))===null||n===void 0?void 0:n.id},this.fetchDisplayName=t=>this.fetchSheetById(t).displayName,this.sheetNamePrefix=e.getUITranslation(bh.NEW_SHEET_PREFIX)}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){const t=jl(e);if(this.mappingFromCanonicalName.has(t))throw new Sh(e);this.lastSheetId++;const n=new CJ(this.lastSheetId,e);return this.store(n),n.id}removeSheet(e){const t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}getDisplayName(e){var t;return(t=this.mappingFromId.get(e))===null||t===void 0?void 0:t.displayName}*displayNames(){for(const e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(jl(e))}renameSheet(e,t){const n=this.fetchSheetById(e),s=n.displayName;if(s===t)return;const i=this.mappingFromCanonicalName.get(jl(t));if(i!==void 0&&i.id!==n.id)throw new Sh(t);const o=n.canonicalName;return this.mappingFromCanonicalName.delete(o),n.displayName=t,this.store(n),s}sheetNames(){return Array.from(this.mappingFromId.values()).map(e=>e.displayName)}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){const t=this.mappingFromId.get(e);if(t===void 0)throw new Gt(e);return t}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class xR{constructor(e,t,n,s,i,o,a,l){this.addressMapping=e,this.rangeMapping=t,this.sheetMapping=n,this.arrayMapping=s,this.stats=i,this.lazilyTransformingAstService=o,this.functionRegistry=a,this.namedExpressions=l,this.changes=ea.empty(),this.dependencyQueryAddresses=u=>{if(u instanceof en)return this.rangeDependencyQuery(u).map(([c,h])=>c);{const c=this.formulaDependencyQuery(u);if(c!==void 0){const[h,d]=c;return d.map(m=>m instanceof po?this.namedExpressions.namedExpressionOrPlaceholder(m.name,h.sheet).address:Zt(m)?m:tv(m.start,m.end))}else return[]}},this.dependencyQueryVertices=u=>{if(u instanceof en)return this.rangeDependencyQuery(u);{const c=this.formulaDependencyQuery(u);if(c!==void 0){const[h,d]=c;return d.map(m=>{if(m instanceof we)return[m.start,this.rangeMapping.fetchRange(m.start,m.end)];if(m instanceof po){const E=this.namedExpressions.namedExpressionOrPlaceholder(m.name,h.sheet);return[E.address,this.addressMapping.fetchCell(E.address)]}else return[m,this.addressMapping.fetchCell(m)]})}else return[]}},this.rangeDependencyQuery=u=>{const c=[],{smallerRangeVertex:h,restRange:d}=this.rangeMapping.findSmallerRange(u.range);let m;h!==void 0&&this.graph.adjacentNodes(h).has(u)?(m=d,c.push([new we(h.start,h.end),h])):m=u.range;for(const E of m.addresses(this)){const g=this.addressMapping.getCell(E);g!==void 0&&c.push([E,g])}return c},this.formulaDependencyQuery=u=>{let c,h;if(u instanceof qn)h=u.getAddress(this.lazilyTransformingAstService),c=u.getFormula(this.lazilyTransformingAstService);else return;const d=tg(c,this.functionRegistry);return[h,Ni(d,h)]},this.graph=new yJ(this.dependencyQueryVertices)}static buildEmpty(e,t,n,s,i){return new xR(new dJ(t.chooseAddressMappingPolicy),new EJ,new TJ(t.translationPackage),new fJ,i,e,n,s)}setFormulaToCell(e,t,n,s,i,o){const a=qn.fromAst(t,e,s,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(a),this.processCellDependencies(n,a),this.graph.markNodeAsDirty(a),i&&this.markAsVolatile(a),o&&this.markAsDependentOnStructureChange(a),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,t){const n=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(n,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,t){const n=this.shrinkPossibleArrayAndGetCell(e);if(n instanceof or&&this.arrayMapping.removeArray(n.getRange()),n instanceof ta)n.getValues().rawValue!==t.rawValue&&(n.setValues(t),this.graph.markNodeAsDirty(n));else{const s=new ta(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(n,s),this.addressMapping.setCell(e,s),this.graph.markNodeAsDirty(s)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){const t=this.shrinkPossibleArrayAndGetCell(e);if(t===void 0)return ea.empty();if(this.graph.adjacentNodes(t).size>0){const n=new zo;this.exchangeGraphNode(t,n),this.graph.adjacentNodesCount(n)===0?(this.removeVertex(n),this.addressMapping.removeCell(e)):(this.graph.markNodeAsDirty(n),this.addressMapping.setCell(e,n))}else this.removeVertex(t),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}clearDirtyVertices(){this.graph.clearDirtyNodes()}verticesToRecompute(){return this.graph.getDirtyAndVolatileNodes()}processCellDependencies(e,t){const n=this.graph.getNodeId(t);e.forEach(s=>{if(s instanceof we){const i=s;let o=this.getRange(i.start,i.end);o===void 0&&(o=new en(i),this.rangeMapping.setRange(o)),this.graph.addNodeAndReturnId(o);const a=this.graph.getNodeId(o);i.isFinite()||this.graph.markNodeAsInfiniteRange(a);const{smallerRangeVertex:l,restRange:u}=this.rangeMapping.findSmallerRange(i);if(l!==void 0){if(this.graph.addEdge(l,a),o.bruteForce){o.bruteForce=!1;for(const h of i.addresses(this))this.graph.removeEdge(this.fetchCell(h),a)}}else o.bruteForce=!0;const c=this.arrayMapping.getArray(u);if(c!==void 0)this.graph.addEdge(c,a);else for(const h of u.addresses(this)){const{vertex:d,id:m}=this.fetchCellOrCreateEmpty(h);this.graph.addEdge(m??d,a)}this.graph.addEdge(a,n),i.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(o)}else if(s instanceof po){const i=t.getAddress(this.lazilyTransformingAstService).sheet,{vertex:o,id:a}=this.fetchNamedExpressionVertex(s.name,i);this.graph.addEdge(a??o,n)}else{const{vertex:i,id:o}=this.fetchCellOrCreateEmpty(s);this.graph.addEdge(o??i,n)}})}fetchNamedExpressionVertex(e,t){const n=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(n.address)}exchangeNode(e,t){const n=this.fetchCellOrCreateEmpty(e).vertex,s=this.fetchCellOrCreateEmpty(t).vertex;this.addressMapping.removeCell(e),this.exchangeGraphNode(n,s)}fetchCellOrCreateEmpty(e){const t=this.addressMapping.getCell(e);if(t!==void 0)return{vertex:t,id:void 0};const n=new zo,s=this.graph.addNodeAndReturnId(n);return this.addressMapping.setCell(e,n),{vertex:n,id:s}}removeRows(e){this.stats.measure(Ve.ADJUSTING_GRAPH,()=>{for(const[n,s]of this.addressMapping.entriesFromRowsSpan(e)){for(const i of this.graph.adjacentNodes(s))this.graph.markNodeAsDirty(i);if(s instanceof or)if(s.isLeftCorner(n))this.shrinkArrayToCorner(s),this.arrayMapping.removeArray(s.getRange());else continue;this.removeVertex(s)}}),this.stats.measure(Ve.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeRows(e)});const t=this.stats.measure(Ve.ADJUSTING_RANGES,()=>{const n=this.truncateRanges(e,s=>s.row);return this.getArrayVerticesRelatedToRanges(n)});return this.stats.measure(Ve.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}removeSheet(e){this.clearSheet(e);for(const[t,n]of this.addressMapping.sheetEntries(e)){for(const s of this.graph.adjacentNodes(n))this.graph.markNodeAsDirty(s);this.removeVertex(n),this.addressMapping.removeCell(t)}this.stats.measure(Ve.ADJUSTING_RANGES,()=>{const t=this.rangeMapping.removeRangesInSheet(e);for(const n of t)this.removeVertex(n);this.stats.measure(Ve.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeSheet(e)})})}clearSheet(e){const t=new Set;for(const[n,s]of this.addressMapping.sheetEntries(e))s instanceof or?t.add(s):this.setCellEmpty(n);for(const n of t.values())this.setArrayEmpty(n);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(Ve.ADJUSTING_GRAPH,()=>{for(const[n,s]of this.addressMapping.entriesFromColumnsSpan(e)){for(const i of this.graph.adjacentNodes(s))this.graph.markNodeAsDirty(i);if(s instanceof or)if(s.isLeftCorner(n))this.shrinkArrayToCorner(s),this.arrayMapping.removeArray(s.getRange());else continue;this.removeVertex(s)}}),this.stats.measure(Ve.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeColumns(e)});const t=this.stats.measure(Ve.ADJUSTING_RANGES,()=>{const n=this.truncateRanges(e,s=>s.col);return this.getArrayVerticesRelatedToRanges(n)});return this.stats.measure(Ve.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns)),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(Ve.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)});const t=this.stats.measure(Ve.ADJUSTING_RANGES,()=>{const n=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(n.verticesWithChangedSize)});this.stats.measure(Ve.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)});for(const n of this.addressMapping.verticesFromRowsSpan(e))this.graph.markNodeAsDirty(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:t}}addColumns(e){this.stats.measure(Ve.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)});const t=this.stats.measure(Ve.ADJUSTING_RANGES,()=>{const n=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(n.verticesWithChangedSize)});this.stats.measure(Ve.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns));for(const n of this.addressMapping.verticesFromColumnsSpan(e))this.graph.markNodeAsDirty(n);return this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}isThereSpaceForArray(e){const t=e.getRangeOrUndef();if(t===void 0)return!1;for(const n of t.addresses(this)){const s=this.addressMapping.getCell(n);if(s!==void 0&&!(s instanceof zo)&&s!==e)return!1}return!0}moveCells(e,t,n,s){for(const i of e.addressesWithDirection(t,n,this)){const o=he(s,i.col+t,i.row+n);let a=this.addressMapping.getCell(i);const l=this.addressMapping.getCell(o);if(this.addressMapping.removeCell(i),a!==void 0){this.graph.markNodeAsDirty(a),this.addressMapping.setCell(o,a);let u;for(const c of this.graph.adjacentNodes(a))c instanceof en&&!e.containsRange(c.range)&&(u=u??this.fetchCellOrCreateEmpty(i).vertex,this.graph.addEdge(u,c),this.graph.removeEdge(a,c));u&&(this.graph.markNodeAsDirty(u),this.addressMapping.setCell(i,u))}if(l!==void 0){a===void 0&&this.addressMapping.removeCell(o);for(const u of this.graph.adjacentNodes(l))a=a??this.fetchCellOrCreateEmpty(o).vertex,this.graph.addEdge(a,u),this.graph.markNodeAsDirty(a);this.removeVertex(l)}}for(const i of this.rangeMapping.rangeVerticesContainedInRange(e))for(const o of this.graph.adjacentNodes(i))if(o instanceof en&&!e.containsRange(o.range)){this.graph.removeEdge(i,o);for(const a of i.range.addresses(this)){const{vertex:l,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u??l,o),this.addressMapping.setCell(a,l),this.graph.markNodeAsDirty(l)}}this.rangeMapping.moveRangesInsideSourceRange(e,t,n,s)}setArrayEmpty(e){const t=we.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),n=this.graph.adjacentNodes(e);for(const s of t.addresses(this))this.addressMapping.removeCell(s);for(const s of n.values()){const i=mJ(this.functionRegistry,s,e.getRange(),this.lazilyTransformingAstService,this);for(const o of i){const{vertex:a,id:l}=this.fetchCellOrCreateEmpty(o);this.graph.addEdge(l??a,s)}i.length>0&&this.graph.markNodeAsDirty(s)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,t){this.graph.addNodeAndReturnId(t),this.addressMapping.setCell(e,t)}addArrayVertex(e,t){this.graph.addNodeAndReturnId(t),this.setAddressMappingForArrayVertex(t,e)}*arrayFormulaNodes(){for(const e of this.graph.getNodes())e instanceof or&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){const t=this.addressMapping.getCellValue(e);return t instanceof Ee?new v(S.VALUE,N.ScalarExpected):t}existsEdge(e,t){return this.graph.existsEdge(e,t)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}getRange(e,t){return this.rangeMapping.getRange(e,t)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsVolatile(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(const e of this.graph.getNodes())e instanceof Ii&&e.ensureRecentData(this.lazilyTransformingAstService)}*rawValuesFromRange(e){for(const t of e.addresses(this)){const n=this.getScalarValue(t);n!==Xe&&(yield[le(n),t])}}computeListOfValuesInRange(e){const t=[];for(const n of e.addresses(this)){const s=this.getScalarValue(n);t.push(s)}return t}shrinkArrayToCorner(e){this.cleanAddressMappingUnderArray(e);for(const t of this.adjacentArrayVertices(e)){let n;t instanceof qn?n=this.formulaDirectDependenciesToArray(t,e):n=this.rangeDirectDependenciesToArray(t,e);let s=!1;for(const[i,o]of n)e.isLeftCorner(i)&&(s=!0),this.graph.addEdge(o,t),this.graph.markNodeAsDirty(o);s||this.graph.removeEdge(e,t)}this.graph.markNodeAsDirty(e)}isArrayInternalCell(e){const t=this.getCell(e);return t instanceof or&&!t.isLeftCorner(e)}getAndClearContentChanges(){const e=this.changes;return this.changes=ea.empty(),e}getAdjacentNodesAddresses(e){const t=this.graph.adjacentNodes(e),n=[];return t.forEach(s=>{const i=s;i instanceof en?n.push(tv(i.start,i.end)):n.push(i.getAddress(this.lazilyTransformingAstService))}),n}exchangeGraphNode(e,t){this.graph.addNodeAndReturnId(t);const n=this.graph.adjacentNodes(e);this.removeVertex(e),n.forEach(s=>{this.graph.hasNode(s)&&this.graph.addEdge(t,s)})}setArray(e,t){this.arrayMapping.setArray(e,t)}correctInfiniteRangesDependency(e){const t=this.graph.getInfiniteRanges().filter(({node:o})=>o.range.addressInRange(e));if(t.length<=0)return;const{vertex:n,id:s}=this.fetchCellOrCreateEmpty(e),i=s??this.graph.getNodeId(n);t.forEach(({id:o})=>{this.graph.addEdge(i,o)})}exchangeOrAddGraphNode(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNodeAndReturnId(t)}getArrayVerticesRelatedToRanges(e){const t=new Set;return e.forEach(n=>{this.graph.hasNode(n)&&this.graph.adjacentNodes(n).forEach(s=>{s instanceof or&&t.add(s)})}),t}correctInfiniteRangesDependenciesByRangeVertex(e){this.graph.getInfiniteRanges().forEach(({id:t,node:n})=>{const s=e.range.intersectionWith(n.range);s!==void 0&&s.addresses(this).forEach(i=>{const{vertex:o,id:a}=this.fetchCellOrCreateEmpty(i);this.graph.addEdge(a??o,t)})})}cleanAddressMappingUnderArray(e){const t=e.getRange();for(const n of t.addresses(this)){const s=e.getArrayCellValue(n);this.getCell(n)===e?e.isLeftCorner(n)?this.changes.addChange(new v(S.REF),n,s):(this.addressMapping.removeCell(n),this.changes.addChange(Xe,n,s)):this.changes.addChange(Xe,n,s)}}*formulaDirectDependenciesToArray(e,t){var n;const[,s]=(n=this.formulaDependencyQuery(e))!==null&&n!==void 0?n:[];if(s!==void 0){for(const i of s)if(!(i instanceof po||i instanceof we)&&t.getRange().addressInRange(i)){const o=this.fetchCellOrCreateEmpty(i).vertex;yield[i,o]}}}*rangeDirectDependenciesToArray(e,t){const{restRange:n}=this.rangeMapping.findSmallerRange(e.range);for(const s of n.addresses(this))if(t.getRange().addressInRange(s)){const i=this.fetchCellOrCreateEmpty(s).vertex;yield[s,i]}}*adjacentArrayVertices(e){const t=this.graph.adjacentNodes(e);for(const n of t)(n instanceof qn||n instanceof en)&&(yield n)}addStructuralNodesToChangeSet(){this.graph.markChangingWithStructureNodesAsDirty()}fixRangesWhenAddingRows(e,t,n){const s=Array.from(this.rangeMapping.rangesInSheet(e));for(const i of s)if(i.range.includesRow(t+n))if(i.bruteForce){const o=i.range.rangeWithSameWidth(t,n);for(const a of o.addresses(this)){const{vertex:l,id:u}=this.fetchCellOrCreateEmpty(a);this.graph.addEdge(u??l,i)}}else{let o=i,a=this.rangeMapping.findSmallerRange(o.range);if(a.smallerRangeVertex!==void 0)continue;for(;a.smallerRangeVertex===void 0;){const l=new en(we.spanFrom(o.range.start,o.range.width(),o.range.height()-1));this.rangeMapping.setRange(l),this.graph.addNodeAndReturnId(l);const u=new we(he(o.range.start.sheet,o.range.start.col,o.range.end.row),o.range.end);this.addAllFromRange(u,o),this.graph.addEdge(l,o),o=l,a=this.rangeMapping.findSmallerRange(o.range)}this.graph.addEdge(a.smallerRangeVertex,o),this.addAllFromRange(a.restRange,o),this.graph.removeEdge(a.smallerRangeVertex,i)}}addAllFromRange(e,t){for(const n of e.addresses(this)){const{vertex:s,id:i}=this.fetchCellOrCreateEmpty(n);this.graph.addEdge(i??s,t)}}fixRangesWhenAddingColumns(e,t,n){for(const s of this.rangeMapping.rangesInSheet(e))if(s.range.includesColumn(t+n)){let i;s.bruteForce?i=s.range.rangeWithSameHeight(t,n):i=we.spanFrom(he(e,t,s.range.end.row),n,1);for(const o of i.addresses(this)){const{vertex:a,id:l}=this.fetchCellOrCreateEmpty(o);this.graph.addEdge(l??a,s)}}}exchangeOrAddFormulaVertex(e){const t=e.getAddress(this.lazilyTransformingAstService),n=we.spanFrom(t,e.width,e.height),s=this.shrinkPossibleArrayAndGetCell(t);if(e instanceof or&&this.setArray(n,e),this.exchangeOrAddGraphNode(s,e),this.addressMapping.setCell(t,e),e instanceof or){if(!this.isThereSpaceForArray(e))return;for(const i of n.addresses(this)){if(e.isLeftCorner(i))continue;const o=this.getCell(i);this.exchangeOrAddGraphNode(o,e)}}for(const i of n.addresses(this))this.addressMapping.setCell(i,e)}setAddressMappingForArrayVertex(e,t){if(this.addressMapping.setCell(t,e),!(e instanceof or))return;const n=we.spanFromOrUndef(t,e.width,e.height);if(n!==void 0&&(this.setArray(n,e),!!this.isThereSpaceForArray(e)))for(const s of n.addresses(this))this.addressMapping.setCell(s,e)}truncateRanges(e,t){const{verticesToRemove:n,verticesToMerge:s,verticesWithChangedSize:i}=this.rangeMapping.truncateRanges(e,t);for(const[o,a]of s)this.mergeRangeVertices(o,a);for(const o of n)this.removeVertexAndCleanupDependencies(o);return i}fixArraysAfterAddingRow(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,n),!(t<=0))for(const[,s]of this.arrayMapping.arraysInRows(Dn.fromRowStartAndEnd(e,t-1,t-1))){const i=s.getRange();for(let o=i.start.col;o<=i.end.col;++o)for(let a=t;a<=i.end.row;++a){const l=he(e,o,a),u=he(e,o,a+n),c=s.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(Xe,u,c)}}}fixArraysAfterRemovingRows(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-n),!(t<=0))for(const[,s]of this.arrayMapping.arraysInRows(Dn.fromRowStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(s))for(const i of s.getRange().addresses(this))this.addressMapping.setCell(i,s);else this.setNoSpaceIfArray(s)}fixArraysAfterAddingColumn(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,n),!(t<=0))for(const[,s]of this.arrayMapping.arraysInCols(Xn.fromColumnStartAndEnd(e,t-1,t-1))){const i=s.getRange();for(let o=i.start.row;o<=i.end.row;++o)for(let a=t;a<=i.end.col;++a){const l=he(e,a,o),u=he(e,a+n,o),c=s.getArrayCellValue(l);this.addressMapping.moveCell(u,l),this.changes.addChange(Xe,u,c)}}}fixArraysAfterRemovingColumns(e,t,n){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-n),!(t<=0))for(const[,s]of this.arrayMapping.arraysInCols(Xn.fromColumnStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(s))for(const i of s.getRange().addresses(this))this.addressMapping.setCell(i,s);else this.setNoSpaceIfArray(s)}shrinkPossibleArrayAndGetCell(e){const t=this.getCell(e);return t instanceof or?(this.setNoSpaceIfArray(t),this.getCell(e)):t}setNoSpaceIfArray(e){e instanceof or&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof en&&this.rangeMapping.removeRange(e)}mergeRangeVertices(e,t){const n=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.removeEdgeIfExists(e,t),n.forEach(s=>{this.graph.hasNode(s)&&this.graph.addEdge(e,s)})}removeVertexAndCleanupDependencies(e){const t=new Set(this.graph.removeNode(e));for(;t.size>0;){const n=t.values().next().value;t.delete(n);const[s,i]=n;this.graph.hasNode(i)&&this.graph.adjacentNodesCount(i)===0&&((i instanceof en||i instanceof zo)&&this.graph.removeNode(i).forEach(o=>t.add(o)),i instanceof en?this.rangeMapping.removeRange(i):i instanceof zo&&this.addressMapping.removeCell(s))}}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class zo{constructor(){}getCellValue(){return Xe}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class ta{constructor(e,t){this.parsedValue=e,this.rawValue=t}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}setCellValue(e){throw Error("SetCellValue is deprecated for ValueCellVertex")}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class vu{constructor(e,t){this.errors=e,this.rawInput=t}getCellValue(){const e=this.errors.map(t=>t.message).find(t=>t);return v.parsingError(e)}getFormula(){return this.rawInput}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class bJ{constructor(e,t){this.width=e,this.height=t,this.mapping=new Map}getCell(e){var t;return(t=this.mapping.get(e.col))===null||t===void 0?void 0:t.get(e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let n=this.mapping.get(e.col);n||(n=new Map,this.mapping.set(e.col,n)),n.set(e.row,t)}has(e){var t;return!!(!((t=this.mapping.get(e.col))===null||t===void 0)&&t.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var t;(t=this.mapping.get(e.col))===null||t===void 0||t.delete(e.row)}addRows(e,t){this.mapping.forEach(n=>{const s=new Map;n.forEach((i,o)=>{o>=e&&(s.set(o+t,i),n.delete(o))}),s.forEach((i,o)=>{n.set(o,i)})}),this.height+=t}addColumns(e,t){const n=new Map;this.mapping.forEach((s,i)=>{i>=e&&(n.set(i+t,s),this.mapping.delete(i))}),n.forEach((s,i)=>{this.mapping.set(i,s)}),this.width+=t}removeRows(e){this.mapping.forEach(s=>{const i=new Map;s.forEach((o,a)=>{a>=e.rowStart&&(s.delete(a),a>e.rowEnd&&i.set(a-e.numberOfRows,o))}),i.forEach((o,a)=>{s.set(a,o)})});const t=Math.min(this.height-1,e.rowEnd),n=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-n)}removeColumns(e){const t=new Map;this.mapping.forEach((i,o)=>{o>=e.columnStart&&(this.mapping.delete(o),o>e.columnEnd&&t.set(o-e.numberOfColumns,i))}),t.forEach((i,o)=>{this.mapping.set(o,i)});const n=Math.min(this.width-1,e.columnEnd),s=Math.max(0,n-e.columnStart+1);this.width=Math.max(0,this.width-s)}*getEntries(e){for(const[t,n]of this.mapping)for(const[s,i]of n)yield[he(e,t,s),i]}*verticesFromColumn(e){const t=this.mapping.get(e);if(t!==void 0)for(const[n,s]of t)yield s}*verticesFromRow(e){for(const t of this.mapping.values()){const n=t.get(e);n!==void 0&&(yield n)}}*verticesFromColumnsSpan(e){for(const t of e.columns()){const n=this.mapping.get(t);if(n!==void 0)for(const[s,i]of n)yield i}}*verticesFromRowsSpan(e){for(const t of this.mapping.values())for(const n of e.rows()){const s=t.get(n);s!==void 0&&(yield s)}}*entriesFromRowsSpan(e){for(const[t,n]of this.mapping.entries())for(const s of e.rows()){const i=n.get(s);i!==void 0&&(yield[he(e.sheet,t,s),i])}}*entriesFromColumnsSpan(e){for(const t of e.columns()){const n=this.mapping.get(t);if(n!==void 0)for(const[s,i]of n.entries())yield[he(e.sheet,t,s),i]}}*vertices(){for(const[e,t]of this.mapping)for(const[n,s]of t)s!==void 0&&(yield s)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class NJ{constructor(e,t){this.width=e,this.height=t,this.mapping=new Array(t);for(let n=0;n<t;n++)this.mapping[n]=new Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}has(e){const t=this.mapping[e.row];return t?!!t[e.col]:!1}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){this.mapping[e.row]!==void 0&&delete this.mapping[e.row][e.col]}addRows(e,t){const n=[];for(let s=0;s<t;s++)n.push(new Array(this.width));this.mapping.splice(e,0,...n),this.height+=t}addColumns(e,t){for(let n=0;n<this.height;n++)this.mapping[n]!==void 0&&this.mapping[n].splice(e,0,...new Array(t));this.width+=t}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);const t=Math.min(this.height-1,e.rowEnd),n=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-n)}removeColumns(e){for(let s=0;s<this.height;s++)this.mapping[s]!==void 0&&this.mapping[s].splice(e.columnStart,e.numberOfColumns);const t=Math.min(this.width-1,e.columnEnd),n=Math.max(0,t-e.columnStart+1);this.width=Math.max(0,this.width-n)}*getEntries(e){for(let t=0;t<this.height;++t)for(let n=0;n<this.width;++n){const s=this.getCellVertex(n,t);s&&(yield[he(e,n,t),s])}}*verticesFromColumn(e){for(let t=0;t<this.height;++t){const n=this.getCellVertex(e,t);n&&(yield n)}}*verticesFromRow(e){for(let t=0;t<this.width;++t){const n=this.getCellVertex(t,e);n&&(yield n)}}*verticesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let n=0;n<this.height;++n){const s=this.getCellVertex(t,n);s&&(yield s)}}*verticesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let n=e.rowStart;n<=e.rowEnd;++n){const s=this.getCellVertex(t,n);s&&(yield s)}}*entriesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let n=e.rowStart;n<=e.rowEnd;++n){const s=this.getCellVertex(t,n);s&&(yield[he(e.sheet,t,n),s])}}*entriesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let n=0;n<this.height;++n){const s=this.getCellVertex(t,n);s&&(yield[he(e.sheet,t,n),s])}}*vertices(){for(let e=0;e<this.height;++e)for(let t=0;t<this.width;++t){const n=this.getCellVertex(t,e);n&&(yield n)}}getCellVertex(e,t){var n;return(n=this.mapping[t])===null||n===void 0?void 0:n[e]}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var S;(function(r){r.DIV_BY_ZERO="DIV_BY_ZERO",r.NAME="NAME",r.VALUE="VALUE",r.NUM="NUM",r.NA="NA",r.CYCLE="CYCLE",r.REF="REF",r.SPILL="SPILL",r.LIC="LIC",r.ERROR="ERROR"})(S||(S={}));var _n;(function(r){r.FORMULA="FORMULA",r.VALUE="VALUE",r.ARRAY="ARRAY",r.EMPTY="EMPTY",r.ARRAYFORMULA="ARRAYFORMULA"})(_n||(_n={}));const AJ=(r,e)=>r instanceof or?r.isLeftCorner(e)?_n.ARRAYFORMULA:_n.ARRAY:r instanceof Ii||r instanceof vu?_n.FORMULA:r instanceof ta?_n.VALUE:_n.EMPTY;var Km;(function(r){r.EMPTY="EMPTY",r.NUMBER="NUMBER",r.STRING="STRING",r.BOOLEAN="BOOLEAN",r.ERROR="ERROR"})(Km||(Km={}));var ev;(function(r){r.NUMBER="NUMBER"})(ev||(ev={}));const Ks=Object.assign(Object.assign({},Km),ev),OJ=Object.assign(Object.assign({},Km),ge),Kb=r=>{switch(r){case Ks.EMPTY:return 0;case Ks.NUMBER:return 1;case Ks.STRING:return 2;case Ks.BOOLEAN:return 3;case Ks.ERROR:return 4}throw new Error("Cell value not computed")},Xm=r=>{if(r===Xe)return Ks.EMPTY;if(r instanceof v||r instanceof Ee)return Ks.ERROR;if(typeof r=="string")return Ks.STRING;if(ct(r))return Ks.NUMBER;if(typeof r=="boolean")return Ks.BOOLEAN;throw new Error("Cell value not computed")},IJ=r=>ct(r)?oJ(r):Xm(r),MJ=r=>{if(ct(r))return aJ(r)};class v{constructor(e,t,n){this.type=e,this.message=t,this.root=n}static parsingError(e){return new v(S.ERROR,`${N.ParseError}${e?" "+e:""}`)}attachRootVertex(e){return this.root===void 0?new v(this.type,this.message,e):this}}const g1=(r,e)=>({sheet:r,row:e}),_J=r=>r.row<0,y1=(r,e)=>({sheet:r,col:e}),xJ=r=>r.col<0,he=(r,e,t)=>({sheet:r,col:e,row:t}),Fn=r=>r.col<0||r.row<0,LJ=(r,e,t,n)=>he(e,r.col+t,r.row+n),th=r=>`${r.sheet},${r.row},${r.col}`;function Zt(r){var e,t,n;return r&&(typeof r=="object"||typeof r=="function")&&typeof((e=r)===null||e===void 0?void 0:e.sheet)=="number"&&typeof((t=r)===null||t===void 0?void 0:t.col)=="number"&&typeof((n=r)===null||n===void 0?void 0:n.row)=="number"}const ti=(r,e)=>{var t;return(t=r.sheet)!==null&&t!==void 0?t:e.sheet},Nh=(r,e)=>r.sheet===e.sheet&&r.col===e.col&&r.row===e.row;/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const PJ="AbsoluteCellRange: Wrong range size";function Gn(r){return r&&(typeof r=="object"||typeof r=="function")?"start"in r&&Zt(r.start)&&"end"in r&&Zt(r.end):!1}const tv=(r,e)=>({start:r,end:e});class we{constructor(e,t){if(e.sheet!==t.sheet)throw new Ch(e.sheet,t.sheet);this.start=he(e.sheet,e.col,e.row),this.end=he(t.sheet,t.col,t.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,t){if(e.sheet!==t.sheet)throw new Ch(e.sheet,t.sheet);const n=t.col-e.col,s=t.row-e.row;return Number.isFinite(s)&&Number.isFinite(n)?new we(e,t):Number.isFinite(s)?new vo(e.sheet,e.row,t.row):new Eo(e.sheet,e.col,t.col)}static fromAst(e,t){return e.type===C.CELL_RANGE?we.fromCellRange(e,t):e.type===C.COLUMN_RANGE?Eo.fromColumnRange(e,t):vo.fromRowRangeAst(e,t)}static fromAstOrUndef(e,t){try{return we.fromAst(e,t)}catch{return}}static fromCellRange(e,t){return new we(e.start.toSimpleCellAddress(t),e.end.toSimpleCellAddress(t))}static spanFrom(e,t,n){const s=we.spanFromOrUndef(e,t,n);if(s===void 0)throw new Error(PJ);return s}static spanFromOrUndef(e,t,n){if(!Number.isFinite(t)&&Number.isFinite(n))return e.col!==0?void 0:new vo(e.sheet,e.row,e.row+n-1);if(!Number.isFinite(n)&&Number.isFinite(t))return e.row!==0?void 0:new Eo(e.sheet,e.col,e.col+t-1);if(Number.isFinite(n)&&Number.isFinite(t))return new we(e,he(e.sheet,e.col+t-1,e.row+n-1))}static fromCoordinates(e,t,n,s,i){return new we(he(e,t,n),he(e,s,i))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return!(this.start.sheet!=e.start.sheet||this.end.row<e.start.row||this.start.row>e.end.row||this.end.col<e.start.col||this.start.col>e.end.col)}addressInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}columnInRange(e){return this.sheet!==e.sheet?!1:this.start.col<=e.col&&this.end.col>=e.col}rowInRange(e){return this.sheet!==e.sheet?!1:this.start.row<=e.row&&this.end.row>=e.row}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;const t=Math.max(this.start.row,e.start.row),n=Math.min(this.end.row,e.end.row),s=Math.max(this.start.col,e.start.col),i=Math.min(this.end.col,e.end.col);if(!(t>n||s>i))return new we(he(this.sheet,s,t),he(this.sheet,i,n))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,t){return we.spanFrom(he(this.sheet,this.start.col+e,this.start.row+t),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof Dn?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return this.width()<=0||this.height()<=0}rangeWithSameWidth(e,t){return we.spanFrom(he(this.sheet,this.start.col,e),this.width(),t)}rangeWithSameHeight(e,t){return we.spanFrom(he(this.sheet,e,this.start.row),t,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){const e=[];for(let t=0;t<this.height();++t){e[t]=[];for(let n=0;n<this.width();++n){const s=he(this.sheet,this.start.col+n,this.start.row+t);e[t].push(s)}}return e}withStart(e){return new we(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return Nh(this.start,e.start)&&Nh(this.end,e.end)}addressesArrayMap(e,t){const n=[];let s=this.start.row;for(;s<=this.effectiveEndRow(e);){let i=this.start.col;const o=[];for(;i<=this.effectiveEndColumn(e);)o.push(t(he(this.start.sheet,i,s))),i++;n.push(o),s++}return n}addresses(e){const t=[];let n=this.start.row;const s=this.effectiveEndRow(e),i=this.effectiveEndColumn(e);for(;n<=s;){let o=this.start.col;for(;o<=i;)t.push(he(this.start.sheet,o,n)),o++;n++}return t}*addressesWithDirection(e,t,n){if(e>0)if(t>0){let s=this.effectiveEndRow(n);for(;s>=this.start.row;){let i=this.effectiveEndColumn(n);for(;i>=this.start.col;)yield he(this.start.sheet,i,s),i-=1;s-=1}}else{let s=this.start.row;for(;s<=this.effectiveEndRow(n);){let i=this.effectiveEndColumn(n);for(;i>=this.start.col;)yield he(this.start.sheet,i,s),i-=1;s+=1}}else if(t>0){let s=this.effectiveEndRow(n);for(;s>=this.start.row;){let i=this.start.col;for(;i<=this.effectiveEndColumn(n);)yield he(this.start.sheet,i,s),i+=1;s-=1}}else{let s=this.start.row;for(;s<=this.effectiveEndRow(n);){let i=this.start.col;for(;i<=this.effectiveEndColumn(n);)yield he(this.start.sheet,i,s),i+=1;s+=1}}}getAddress(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return he(this.start.sheet,this.start.col+e,this.start.row+t)}exceedsSheetSizeLimits(e,t){return this.end.col>=e||this.end.row>=t}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,t){if(!(e>this.end.row)){if(t<this.start.row){const n=t-e+1;return this.shiftByRows(-n)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}removeColumns(e,t){if(!(e>this.end.col)){if(t<this.start.col){const n=t-e+1;return this.shiftByColumns(-n)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}}class Eo extends we{constructor(e,t,n){super(he(e,t,0),he(e,n,Number.POSITIVE_INFINITY))}static fromColumnRange(e,t){const n=e.start.toSimpleColumnAddress(t),s=e.end.toSimpleColumnAddress(t);if(n.sheet!==s.sheet)throw new Ch(n.sheet,s.sheet);return new Eo(n.sheet,n.col,s.col)}shouldBeRemoved(){return this.width()<=0}shiftByRows(e){}expandByRows(e){}shifted(e,t){return new Eo(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,t){return new Eo(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,t){}}class vo extends we{constructor(e,t,n){super(he(e,0,t),he(e,Number.POSITIVE_INFINITY,n))}static fromRowRangeAst(e,t){const n=e.start.toSimpleRowAddress(t),s=e.end.toSimpleRowAddress(t);if(n.sheet!==s.sheet)throw new Ch(n.sheet,s.sheet);return new vo(n.sheet,n.row,s.row)}shouldBeRemoved(){return this.height()<=0}shiftByColumns(e){}expandByColumns(e){}shifted(e,t){return new vo(this.sheet,this.start.row+t,this.end.row+t)}rangeWithSameWidth(e,t){return new vo(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.row>=t}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,t){}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class xi{constructor(e,t,n){this.formulaAddress=e,this.arraysFlag=t,this.formulaVertex=n}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function FJ(r){const e=r.caseSensitive?r.accentSensitive?"variant":"case":r.accentSensitive?"accent":"base",t=r.caseFirst,n=r.ignorePunctuation;return new Intl.Collator(r.localeLang,{sensitivity:e,caseFirst:t,ignorePunctuation:n})}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const DJ="i",HJ=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;class VJ{constructor(e,t,n){this.config=e,this.dateTimeHelper=t,this.numberLiteralsHelper=n,this.lt=(s,i)=>this.compare(s,i)<0,this.leq=(s,i)=>this.compare(s,i)<=0,this.gt=(s,i)=>this.compare(s,i)>0,this.geq=(s,i)=>this.compare(s,i)>=0,this.eq=(s,i)=>this.compare(s,i)===0,this.neq=(s,i)=>this.compare(s,i)!==0,this.pow=(s,i)=>Math.pow(le(s),le(i)),this.addWithEpsilonRaw=(s,i)=>{const o=s+i;return Math.abs(o)<this.actualEps*Math.abs(s)?0:o},this.addWithEpsilon=(s,i)=>{const o=Qb(s,i);return this.ExtendedNumberFactory(this.addWithEpsilonRaw(le(s),le(i)),o)},this.unaryMinus=s=>AR(s,-le(s)),this.unaryPlus=s=>s,this.unaryPercent=s=>new jf(le(s)/100),this.concat=(s,i)=>s.concat(i),this.nonstrictadd=(s,i)=>s instanceof v?s:i instanceof v?i:typeof s=="number"?typeof i=="number"?this.addWithEpsilonRaw(s,i):s:typeof i=="number"?i:0,this.subtract=(s,i)=>{const o=Qb(s,i),a=le(s),l=le(i);let u=a-l;return Math.abs(u)<this.actualEps*Math.abs(a)&&(u=0),this.ExtendedNumberFactory(u,o)},this.divide=(s,i)=>{const o=le(s),a=le(i);if(a===0)return new v(S.DIV_BY_ZERO);{const l=Zb(s,i);return this.ExtendedNumberFactory(o/a,l)}},this.multiply=(s,i)=>{const o=Zb(s,i);return this.ExtendedNumberFactory(le(s)*le(i),o)},this.manyToExactComplex=s=>{const i=[];for(const o of s){if(o instanceof v)return o;if(ct(o)||typeof o=="string"){const a=this.coerceScalarToComplex(o);a instanceof v||i.push(a)}}return i},this.coerceNumbersExactRanges=s=>this.manyToNumbers(s,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=s=>this.manyToNumbers(s,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=s=>{const i=[];for(const o of s){if(o instanceof v)return o;ct(o)&&i.push(le(o))}return i},this.manyToOnlyNumbersDropNulls=s=>{const i=[];for(const o of s){if(o instanceof v)return o;if(ct(o))i.push(le(o));else if(o!==Xe)return new v(S.VALUE,N.NumberExpected)}return i},this.manyToCoercedNumbersDropNulls=s=>{const i=[];for(const o of s){if(o instanceof v)return o;if(o===Xe)continue;const a=this.coerceScalarToNumberOrError(o);ct(a)&&i.push(le(a))}return i},this.collator=FJ(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){const t=this.buildRegex(e);return n=>typeof n=="string"&&t.test(this.normalizeString(n))}neqMatcherFunction(e){const t=this.buildRegex(e);return n=>typeof n!="string"||!t.test(this.normalizeString(n))}searchString(e,t){var n;const i=this.buildRegex(e,!1).exec(t);return(n=i==null?void 0:i.index)!==null&&n!==void 0?n:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let t=0;t<e.length;t++){const n=e.charAt(t);if(Ah(n)||this.config.useRegularExpressions&&Oh(n))return!0}return!1}floatCmp(e,t){const n=le(e),s=le(t),i=1+this.actualEps;return s>=0&&n*i>=s&&n<=s*i||s<=0&&n*i<=s&&n>=s*i?0:n>s?1:-1}coerceScalarToNumberOrError(e){var t;return e instanceof v?e:(t=this.coerceToMaybeNumber(e))!==null&&t!==void 0?t:new v(S.VALUE,N.NumberCoercion)}coerceToMaybeNumber(e){var t;return(t=this.coerceNonDateScalarToMaybeNumber(e))!==null&&t!==void 0?t:typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===Xe)return 0;if(typeof e=="string"){if(e==="")return 0;const t=this.coerceStringToMaybePercentNumber(e);if(t!==void 0)return t;const n=this.coerceStringToMaybeCurrencyNumber(e);return n!==void 0?n:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}else return ct(e)?e:typeof e=="boolean"?Number(e):void 0}coerceStringToMaybePercentNumber(e){const t=e.trim();if(t.endsWith("%")){const n=t.slice(0,t.length-1).trim(),s=this.numberLiteralsHelper.numericStringToMaybeNumber(n);if(s!==void 0)return new jf(s/100)}}coerceStringToMaybeCurrencyNumber(e){const t=this.currencyMatcher(e.trim());if(t!==void 0){const[n,s]=t,i=this.numberLiteralsHelper.numericStringToMaybeNumber(s);if(i!==void 0)return new ZE(i,n)}}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length).trim()];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length).trim()]}}coerceComplexExactRanges(e){const t=[];for(const s of e)if(s instanceof Ee)t.push(s);else if(s!==Xe){const i=this.coerceScalarToComplex(s);if(i instanceof v)return i;t.push(i)}const n=[];for(const s of t)if(s instanceof Ee){const i=this.manyToExactComplex(s.valuesFromTopLeftCorner());if(i instanceof v)return i;n.push(...i)}else n.push(s);return n}coerceScalarToComplex(e){return e instanceof v?e:e===Xe?[0,0]:ct(e)?[le(e),0]:typeof e=="string"?this.coerceStringToComplex(e):new v(S.NUM,N.ComplexNumberExpected)}ExtendedNumberFactory(e,t){const{type:n,format:s}=t;switch(n){case ge.NUMBER_RAW:return e;case ge.NUMBER_CURRENCY:return new ZE(e,s??this.config.currencySymbol[0]);case ge.NUMBER_DATE:return new OR(e,s);case ge.NUMBER_DATETIME:return new MR(e,s);case ge.NUMBER_TIME:return new IR(e,s);case ge.NUMBER_PERCENT:return new jf(e,s)}}buildRegex(e,t=!0){e=this.normalizeString(e);let n,s=this.config.useWildcards,i=this.config.useRegularExpressions;if(i)try{RegExp(e)}catch{i=!1,s=!1}return i?n=WJ(e,this.config.caseSensitive):s?n=kJ(e,this.config.caseSensitive):n=BJ(e,this.config.caseSensitive),this.config.matchWholeCell&&t?RegExp("^("+n+")$"):RegExp(n)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=S1(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,t){if(typeof e=="string"||typeof t=="string"){const n=typeof e=="string"?this.dateTimeHelper.dateStringToDateNumber(e):e,s=typeof t=="string"?this.dateTimeHelper.dateStringToDateNumber(t):t;if(ct(n)&&ct(s))return this.floatCmp(n,s)}return e===Xe?e=Xb(t):t===Xe&&(t=Xb(e)),typeof e=="string"&&typeof t=="string"?this.stringCmp(e,t):typeof e=="boolean"&&typeof t=="boolean"?qb(rv(e),rv(t)):ct(e)&&ct(t)?this.floatCmp(e,t):e===Xe&&t===Xe?0:qb(Kb(Xm(e)),Kb(Xm(t)))}stringCmp(e,t){return this.collator.compare(e,t)}manyToNumbers(e,t){const n=[];for(const i of e)if(i instanceof Ee)n.push(i);else{const o=le(this.coerceScalarToNumberOrError(i));if(o instanceof v)return o;n.push(o)}const s=[];for(const i of n)if(i instanceof Ee){const o=t(i.valuesFromTopLeftCorner());if(o instanceof v)return o;s.push(...o)}else s.push(i);return s}coerceStringToComplex(e){const t=HJ.exec(e);if(t===null)return new v(S.NUM,N.ComplexNumberExpected);let n;if(t[6]!==void 0?n=t[1]==="-"?[0,-1]:[0,1]:n=this.parseComplexToken(t[1]+t[3],t[5]),n instanceof v||t[8]===void 0)return n;let s;return t[14]!==void 0?s=t[9]==="-"?[0,-1]:[0,1]:s=this.parseComplexToken(t[9]+t[11],t[13]),s instanceof v?s:t[5]!==""||t[13]===""?new v(S.NUM,N.ComplexNumberExpected):t[8]==="+"?[n[0]+s[0],n[1]+s[1]]:[n[0]-s[0],n[1]-s[1]]}parseComplexToken(e,t){const n=le(this.coerceNonDateScalarToMaybeNumber(e));return n===void 0?new v(S.NUM,N.ComplexNumberExpected):t===""?[n,0]:[0,n]}}function Qt([r,e],t){if(!isFinite(r)||!isFinite(e))return new v(S.NUM,N.NaN);if(t=t??DJ,e===0)return`${r}`;const n=`${e===-1||e===1?"":Math.abs(e)}${t}`;return r===0?`${e<0?"-":""}${n}`:`${r}${e<0?"-":"+"}${n}`}function E1(r){return r instanceof Ee?r:Ee.fromScalar(r)}function rv(r){return Number(r)}function Xb(r){return typeof r=="string"?"":ct(r)?0:typeof r=="boolean"?!1:Xe}function v1(r){if(r instanceof v||typeof r=="boolean")return r;if(r===Xe)return!1;if(ct(r))return le(r)!==0;{const e=r.toUpperCase();return e==="TRUE"?!0:e==="FALSE"||e===""?!1:void 0}}function nv(r){return r instanceof v||typeof r=="string"?r:r===Xe?"":ct(r)?le(r).toString():r?"TRUE":"FALSE"}function Py(r){return r===Xe?0:r}function qb(r,e){const t=le(r),n=le(e);return t>n?1:t<n?-1:0}function w1(r){return isNaN(r)||r===1/0||r===-1/0}function R1(r){return r===0?0:r}function Ah(r){return["*","?"].includes(r)}const UJ=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function Oh(r){return UJ.includes(r)}function kJ(r,e){let t="";for(let n=0;n<r.length;n++){const s=r.charAt(n);if(s==="~"){if(n==r.length-1){t+="~";continue}const i=r.charAt(n+1);Ah(i)||Oh(i)?(t+="\\"+i,n++):(t+=i,n++)}else Ah(s)?t+="."+s:Oh(s)?t+="\\"+s:e?t+=s:t+=s.toLowerCase()}return t}function BJ(r,e){let t="";for(let n=0;n<r.length;n++){const s=r.charAt(n);Ah(s)||Oh(s)?t+="\\"+s:e?t+=s:t+=s.toLowerCase()}return t}function WJ(r,e){let t="";for(let n=0;n<r.length;n++){const s=r.charAt(n);Ah(s)||Oh(s)||e?t+=s:t+=s.toLowerCase()}return t}function Qb(r,e){const{type:t,format:n}=Ym(r),{type:s,format:i}=Ym(e);if(t===ge.NUMBER_RAW)return{type:s,format:i};if(s===ge.NUMBER_RAW)return{type:t,format:n};if((t===ge.NUMBER_DATETIME||t===ge.NUMBER_DATE)&&(s===ge.NUMBER_DATETIME||s===ge.NUMBER_DATE))return{type:ge.NUMBER_RAW};if(t===ge.NUMBER_TIME){if(s===ge.NUMBER_DATE)return{type:ge.NUMBER_DATETIME,format:`${i} ${n}`};if(s===ge.NUMBER_DATETIME)return{type:ge.NUMBER_DATETIME,format:i}}if(s===ge.NUMBER_TIME){if(t===ge.NUMBER_DATE)return{type:ge.NUMBER_DATETIME,format:`${n} ${i}`};if(t===ge.NUMBER_DATETIME)return{type:ge.NUMBER_DATETIME,format:n}}return{type:t,format:n}}function Zb(r,e){let{type:t,format:n}=Ym(r),{type:s,format:i}=Ym(e);return t===ge.NUMBER_PERCENT&&(t=ge.NUMBER_RAW,n=void 0),s===ge.NUMBER_PERCENT&&(s=ge.NUMBER_RAW,i=void 0),t===ge.NUMBER_RAW?{type:s,format:i}:s===ge.NUMBER_RAW?{type:t,format:n}:{type:ge.NUMBER_RAW}}function rh(r){return S1(r.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")}function qf(r,e){var t;if(r.isAdHoc())return(t=r.data[0])===null||t===void 0?void 0:t[0];const n=r.range;if(e.formulaAddress.sheet===n.sheet){if(n.width()===1){const s=e.formulaAddress.row-n.start.row;if(s>=0&&s<n.height())return r.data[s][0]}else if(n.height()===1){const s=e.formulaAddress.col-n.start.col;if(s>=0&&s<n.width())return r.data[0][s]}}}function S1(r,e){return r.normalize(e.toUpperCase())}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var f;(function(r){r.STRING="STRING",r.NUMBER="NUMBER",r.BOOLEAN="BOOLEAN",r.SCALAR="SCALAR",r.NOERROR="NOERROR",r.RANGE="RANGE",r.INTEGER="INTEGER",r.COMPLEX="COMPLEX",r.ANY="ANY"})(f||(f={}));class Be{constructor(e){this.coerceScalarToNumberOrError=t=>this.arithmeticHelper.coerceScalarToNumberOrError(t),this.runFunction=(t,n,s,i)=>{const o=this.evaluateArguments(t,n,s),a=o.map(([E,g])=>E),l=o.map(([E,g])=>g),u=this.buildMetadataForEachArgumentValue(a.length,s),c=n.arraysFlag&&!s.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(u,a.length))return new v(S.NA,N.WrongArgNumber);const[h,d]=c?this.calculateSizeOfVectorizedResultArray(a,u):[1,1];if(h===1&&d===1){const E=this.vectorizeAndBroadcastArgumentsIfNecessary(c,a,u,0,0);return this.calculateSingleCellOfResultArray(n,E,u,l,i,s.returnNumberType)}const m=[...Array(h).keys()].map(E=>[...Array(d).keys()].map(g=>{const O=this.vectorizeAndBroadcastArgumentsIfNecessary(c,a,u,E,g),T=this.calculateSingleCellOfResultArray(n,O,u,l,i,s.returnNumberType);if(T instanceof Ee)throw new Error("Function returning array cannot be vectorized.");return T}));return Ee.onlyValues(m)},this.runFunctionWithReferenceArgument=(t,n,s,i,o,a=()=>new v(S.NA,N.CellRefExpected))=>{if(t.length===0)return this.returnNumberWrapper(i(),s.returnNumberType);if(t.length>1)return new v(S.NA,N.WrongArgNumber);let l=t[0];for(;l.type===C.PARENTHESIS;)l=l.expression;let u;if(l.type===C.CELL_REFERENCE)u=l.reference.toSimpleCellAddress(n.formulaAddress);else if(l.type===C.CELL_RANGE||l.type===C.COLUMN_RANGE||l.type===C.ROW_RANGE)try{u=we.fromAst(l,n.formulaAddress).start}catch{return new v(S.REF,N.CellRefExpected)}return u!==void 0?this.returnNumberWrapper(o(u),s.returnNumberType):this.runFunction(t,n,s,a)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,t){return this.interpreter.evaluateAst(e,t)}arraySizeForAst(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}listOfScalarValues(e,t){const n=[];for(const s of e){const i=this.evaluateAst(s,t);if(i instanceof Ee)for(const o of i.valuesFromTopLeftCorner())n.push([o,!0]);else n.push([i,!1])}return n}coerceToType(e,t,n){let s;if(e instanceof Ee)switch(t.argumentType){case f.RANGE:case f.ANY:s=e;break;default:{const i=qf(e,n);if(i===void 0)return;e=i}}if(!(e instanceof Ee))switch(t.argumentType){case f.INTEGER:case f.NUMBER:const i=this.coerceScalarToNumberOrError(e);if(!ct(i)){s=i;break}const o=le(i);if(t.maxValue!==void 0&&o>t.maxValue)return new v(S.NUM,N.ValueLarge);if(t.minValue!==void 0&&o<t.minValue)return new v(S.NUM,N.ValueSmall);if(t.lessThan!==void 0&&o>=t.lessThan)return new v(S.NUM,N.ValueLarge);if(t.greaterThan!==void 0&&o<=t.greaterThan)return new v(S.NUM,N.ValueSmall);if(t.argumentType===f.INTEGER&&!Number.isInteger(o))return new v(S.NUM,N.IntegerExpected);s=i;break;case f.STRING:s=nv(e);break;case f.BOOLEAN:s=v1(e);break;case f.SCALAR:case f.NOERROR:case f.ANY:s=e;break;case f.RANGE:if(e instanceof v)return e;s=E1(e);break;case f.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex(le(e))}return t.passSubtype||s===void 0?s:le(s)}calculateSingleCellOfResultArray(e,t,n,s,i,o){const a=this.coerceArgumentsToRequiredTypes(e,t,n,s);if(a instanceof v)return a;const l=i(...a);return this.returnNumberWrapper(l,o)}coerceArgumentsToRequiredTypes(e,t,n,s){const i=[];for(let o=0;o<n.length;o++){const a=n[o],l=t[o]!==void 0?t[o]:a==null?void 0:a.defaultValue;if(l===void 0){i.push(void 0);continue}const u=this.coerceToType(l,a,e);if(u===void 0&&!s[o])return new v(S.VALUE,N.WrongType);if(u instanceof v&&a.argumentType!==f.SCALAR)return u;i.push(u)}return i}vectorizeAndBroadcastArgumentsIfNecessary(e,t,n,s,i){return t.map((o,a)=>e&&this.isRangePassedAsAScalarArgument(o,n[a])?this.vectorizeAndBroadcastRangeArgument(o,s,i):o)}vectorizeAndBroadcastRangeArgument(e,t,n){var s;const i=e.height()===1?0:t,o=e.width()===1?0:n;return(s=e.data[i])===null||s===void 0?void 0:s[o]}evaluateArguments(e,t,n){return n.expandRanges?this.listOfScalarValues(e,t):e.map(s=>[this.evaluateAst(s,t),!1])}buildMetadataForEachArgumentValue(e,t){const n=t.parameters?[...t.parameters]:[];if(t.repeatLastArgs!==void 0&&Number.isInteger(t.repeatLastArgs)&&t.repeatLastArgs>0)for(;e>n.length;)n.push(...n.slice(n.length-t.repeatLastArgs));return n}isNumberOfArgumentValuesValid(e,t){return t>e.length?!1:t<e.length?e.slice(t).every(i=>(i==null?void 0:i.optionalArg)||(i==null?void 0:i.defaultValue)!==void 0):!0}calculateSizeOfVectorizedResultArray(e,t){const n=e.filter((o,a)=>this.isRangePassedAsAScalarArgument(o,t[a])),s=Math.max(1,...n.map(o=>o.height())),i=Math.max(1,...n.map(o=>o.width()));return[s,i]}isRangePassedAsAScalarArgument(e,t){return e==null||t==null?!1:e instanceof Ee&&![f.RANGE,f.ANY].includes(t.argumentType)}metadata(e){const t=this.constructor.implementedFunctions[e];if(t!==void 0)return t;throw new Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,t,n){return t!==void 0&&ct(e)?this.arithmeticHelper.ExtendedNumberFactory(le(e),{type:t,format:n}):e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Ze{constructor(e,t,n=!1){this.width=e,this.height=t,this.isRef=n}static error(){return new Ze(1,1,!0)}static scalar(){return new Ze(1,1,!1)}isScalar(){return this.width===1&&this.height===1||this.isRef}}function $J(r,e){return new Ze(Math.max(r.width,e.width),Math.max(r.height,e.height))}function GJ(r){return new Ze(r.width,r.height)}class zJ{constructor(e,t){this.config=e,this.functionRegistry=t}checkArraySize(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,t){switch(e.type){case C.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case C.COLUMN_RANGE:case C.ROW_RANGE:case C.CELL_RANGE:{const n=we.fromAstOrUndef(e,t.formulaAddress);return n===void 0?Ze.error():new Ze(n.width(),n.height(),!0)}case C.ARRAY:{const n=[],s=[];for(const a of e.args){const l=a.map(h=>this.checkArraySizeForAst(h,t)),u=Math.min(...l.map(h=>h.height)),c=l.reduce((h,d)=>h+d.width,0);n.push(u),s.push(c)}const i=n.reduce((a,l)=>a+l,0),o=Math.min(...s);return new Ze(o,i)}case C.STRING:case C.NUMBER:return Ze.scalar();case C.CELL_REFERENCE:return new Ze(1,1,!0);case C.DIV_OP:case C.CONCATENATE_OP:case C.EQUALS_OP:case C.GREATER_THAN_OP:case C.GREATER_THAN_OR_EQUAL_OP:case C.LESS_THAN_OP:case C.LESS_THAN_OR_EQUAL_OP:case C.MINUS_OP:case C.NOT_EQUAL_OP:case C.PLUS_OP:case C.POWER_OP:case C.TIMES_OP:{const n=this.checkArraySizeForAst(e.left,t),s=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(n.height>1||n.width>1||s.height>1||s.width>1)?Ze.error():$J(n,s)}case C.MINUS_UNARY_OP:case C.PLUS_UNARY_OP:case C.PERCENT_OP:{const n=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(n.height>1||n.width>1)?Ze.error():GJ(n)}case C.PARENTHESIS:return this.checkArraySizeForAst(e.expression,t);case C.EMPTY:return Ze.error();default:return Ze.error()}}checkArraySizeForFunction(e,t){const n=this.functionRegistry.getArraySizeFunction(e.procedureName);if(n!==void 0)return n(e,t);const s=this.functionRegistry.getMetadata(e.procedureName);if(s===void 0||s.expandRanges||!t.arraysFlag||s.vectorizationForbidden||s.parameters===void 0)return new Ze(1,1);const i=e.args.map(u=>{var c;return this.checkArraySizeForAst(u,new xi(t.formulaAddress,t.arraysFlag||((c=s==null?void 0:s.arrayFunction)!==null&&c!==void 0?c:!1)))}),o=[...s.parameters];if(s.repeatLastArgs!==void 0&&o.length<i.length&&(i.length-o.length)%s.repeatLastArgs!==0)return Ze.error();for(;o.length<i.length;){if(s.repeatLastArgs===void 0)return Ze.error();o.push(...o.slice(o.length-s.repeatLastArgs))}let a=1,l=1;for(let u=0;u<i.length;u++)o[u].argumentType!==f.RANGE&&o[u].argumentType!==f.ANY&&(l=Math.max(l,i[u].height),a=Math.max(a,i[u].width));return new Ze(a,l)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class C1{constructor(e,t,n){var s;this.value=t,this.address=n,this.type=e.type,this.message=(s=e.message)!==null&&s!==void 0?s:""}toString(){return this.value}valueOf(){return this.value}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function pt(r,e,t){if(typeof r>"u")return Wr.defaultConfig[t];if(typeof e=="string"){if(typeof r===e)return r;throw new lt(e,t)}else{if(e.includes(r))return r;throw new d1(e.map(n=>`'${n}'`).join(" "),t)}}function Ul(r,e,t){if(r<t)throw new c1(e,t)}function YJ(r,e,t){if(r>t)throw new h1(e,t)}function cf(r,e,t,n){if(e(r))return r;if(typeof r>"u")return Wr.defaultConfig[n];throw new lt(t,n)}function Jb(...r){const e=new Map;r.forEach(n=>{const s=e.get(n.value)||[];s.push(n.name),e.set(n.value,s)});const t=[];for(const n of e.values())n.length>1&&t.push(n);if(t.length>0){t.forEach(s=>s.sort());const n=t.map(s=>`[${s}]`).join("; ");throw new Error(`Config initialization failed. Parameters in conflict: ${n}`)}}function J(r,e,t){if(typeof r!==e)throw new lt(e,t)}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const LR=new RegExp("^ss(\\.(s+|0+))?$"),jJ=new RegExp("^[0-9/.\\-: ]+[ap]?m?$"),KJ=new RegExp("\\s+"),T1=new RegExp("[ /.-]"),sv=":",eN=1e3,XJ=b1(ZJ),qJ=b1(JJ);function QJ(r,e,t){if(e===void 0&&t===void 0)return;let n=r.replace(KJ," ").trim().toLowerCase();if(!eee(n))return;let s=n.substring(n.length-2);s==="am"||s==="pm"?n=n.substring(0,n.length-2).trim():(s=n.substring(n.length-1),s==="a"||s==="p"?n=n.substring(0,n.length-1).trim():s=void 0);const i=n.split(T1);i.length>=2&&i[i.length-2].includes(sv)&&(i[i.length-2]=i[i.length-2]+"."+i[i.length-1],i.pop());const o=i[i.length-1].split(sv);if(s!==void 0&&o.push(s),i.length===1)return tN(o,t);if(o.length===1)return rN(i,e);const a=rN(i.slice(0,i.length-1),e),l=tN(o,t);if(a!==void 0)return l===void 0?void 0:Object.assign(Object.assign({},a),l)}function tN(r,e){var t,n,s;if(e===void 0)return;const{itemsCount:i,hourItem:o,minuteItem:a,secondItem:l}=XJ(e);let u;if(r[r.length-1]==="am"||r[r.length-1]==="a"?(u=!1,r.pop()):(r[r.length-1]==="pm"||r[r.length-1]==="p")&&(u=!0,r.pop()),r.length!==i)return;const c=Number((t=r[l])!==null&&t!==void 0?t:"0");if(!Number.isFinite(c))return;const h=Math.round(c*eN)/eN,d=Number((n=r[a])!==null&&n!==void 0?n:"0");if(!(Number.isFinite(d)&&Number.isInteger(d)))return;const m=Number((s=r[o])!==null&&s!==void 0?s:"0");return!(Number.isFinite(m)&&Number.isInteger(m))||u!==void 0&&(m<0||m>12)?void 0:{hours:u!==void 0?m%12+(u?12:0):m,minutes:d,seconds:h}}function rN(r,e){var t;if(e===void 0)return;const{itemsCount:n,dayItem:s,monthItem:i,shortYearItem:o,longYearItem:a}=qJ(e);if(r.length!==n)return;const l=Number(r[s]);if(!(Number.isFinite(l)&&Number.isInteger(l)))return;const u=Number(r[i]);if(!(Number.isFinite(u)&&Number.isInteger(u))||r[a]&&r[o])return;const c=Number((t=r[a])!==null&&t!==void 0?t:r[o]);if(Number.isFinite(c)&&Number.isInteger(c)&&!(r[a]&&(c<1e3||c>9999))&&!(r[o]&&(c<0||c>99)))return{year:c,month:u,day:l}}function ZJ(r){const e=r.toLowerCase().trim(),n=(e.endsWith("am/pm")?e.substring(0,e.length-5):e.endsWith("a/p")?e.substring(0,r.length-3):e).trim().split(sv);return{itemsCount:n.length,hourItem:n.indexOf("hh"),minuteItem:n.indexOf("mm"),secondItem:n.findIndex(s=>LR.test(s))}}function JJ(r){const e=r.toLowerCase().trim().split(T1);return{itemsCount:e.length,dayItem:e.indexOf("dd"),monthItem:e.indexOf("mm"),shortYearItem:e.indexOf("yy"),longYearItem:e.indexOf("yyyy")}}function eee(r){return jJ.test(r)}function b1(r){const e={};return t=>{const n=e[t];if(n!==void 0)return n;const s=r(t);return e[t]=s,s}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const iv=[31,28,31,30,31,30,31,31,30,31,30,31],su=[0,31,59,90,120,151,181,212,243,273,304,334],hf=60,df=60,ov=24;function nh(r){return r&&(typeof r=="object"||typeof r=="function")?"year"in r&&typeof r.year=="number"&&"month"in r&&typeof r.month=="number"&&"day"in r&&typeof r.day=="number":!1}function N1(r){return r&&(typeof r=="object"||typeof r=="function")?"hours"in r&&typeof r.hours=="number"&&"minutes"in r&&typeof r.minutes=="number"&&"seconds"in r&&typeof r.seconds=="number":!1}const tee={year:9999,month:12,day:31};class ree{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(tee),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){const{dateTime:t,dateFormat:n="",timeFormat:s=""}=this.parseDateTimeFromConfigFormats(e);if(t!==void 0)return N1(t)?nh(t)?new MR(Ru(t)+this.dateToNumber(t),n+" "+s):new IR(Ru(t),s):nh(t)?new OR(this.dateToNumber(t),n):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1?!1:this.isLeapYear(e.year)&&e.month===2?e.day<=29:e.day<=iv[e.month-1]}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-(this.leapYear1900?1:0)}numberToSimpleDate(e){const t=Math.floor(e)+this.minDateAbsoluteValue;let n=Math.floor(t/365.2425);this.dateToNumberFromZero({year:n+1,month:1,day:1})<=t?n++:this.dateToNumberFromZero({year:n-1,month:1,day:1})>t&&n--;const s=t-this.dateToNumberFromZero({year:n,month:1,day:1}),i=nee(s-(this.isLeapYear(n)&&s>=59?1:0)),o=s-su[i]-(this.isLeapYear(n)&&i>1?1:0);return{year:n,month:i+1,day:o+1}}numberToSimpleDateTime(e){const t=wu(e%1),n=Math.floor(t.hours/ov);t.hours=t.hours%ov;const s=this.numberToSimpleDate(Math.floor(e)+n);return Object.assign(Object.assign({},s),t)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,t){return this.isLeapYear(e)&&t===2?29:iv[t-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,t){return e.day===31&&(e.day=30),e.day===30&&t.day===31&&(t.day=30),e.month===2&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,t.month===2&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}yearLengthForBasis(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,t,n){const s=this.parseDateTime(e,t,n);if(!(nh(s)&&(s.year>=0&&s.year<100&&(s.year<this.getNullYear()?s.year+=2e3:s.year+=1900),!this.isValidDate(s))))return s}parseDateTimeFromFormats(e,t,n){const s=t.length===0?[void 0]:t,i=n.length===0?[void 0]:n;for(const o of s)for(const a of i){const l=this.parseSingleFormat(e,o,a);if(l!==void 0)return{dateTime:l,timeFormat:a,dateFormat:o}}return{}}countLeapDays(e){return e.month>2||e.month===2&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+su[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return e%4?!1:e%100?!0:e%400?e===1900&&this.config.leapYear1900:!0}}function nee(r){let e=0;return su[e+6]<=r&&(e+=6),su[e+3]<=r&&(e+=3),su[e+2]<=r?e+=2:su[e+1]<=r&&(e+=1),e}function nN(r,e){const t=12*r.year+r.month-1+e;return{year:Math.floor(t/12),month:t%12+1,day:r.day}}function see(r){return{year:r.year,month:r.month,day:Math.min(r.day,iv[r.month-1])}}function Fy(r){return Math.round(r*3600*24)/(3600*24)}function iee(r,e=1){return Math.round(r*e)/e}function wu(r){const e=r*ov*df*hf,t=iee(e%hf,1e5)%hf,n=(e-t)/hf,s=Math.round(n%df)%df,i=(n-s)/df;return{hours:Math.round(i),minutes:s,seconds:t}}function Ru(r){return((r.seconds/60+r.minutes)/60+r.hours)/24}function sN(r){return{year:r.year,month:r.month,day:Math.min(30,r.day)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class oee{call(){return NJ}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const iN=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,oN=/(\\.|[#0]+(\.[#0]*)?)/g;var Mi;(function(r){r.FORMAT="FORMAT",r.FREE_TEXT="FREE_TEXT"})(Mi||(Mi={}));function ff(r,e){return{type:r,value:e}}var qm;(function(r){r.DATE="DATE",r.NUMBER="NUMBER",r.STRING="STRING"})(qm||(qm={}));function aee(r){iN.lastIndex=0;const e=[];let t;do t=iN.exec(r),t!==null&&e.push(t);while(t);return e}function lee(r){oN.lastIndex=0;const e=oN.exec(r);return e!==null?[e]:[]}function A1(r,e){const t=[];let n=0;for(let i=0;i<r.length;++i){const o=r[i];if(o.index!==n){const a=e.substr(n,o.index-n);t.push(ff(Mi.FREE_TEXT,a))}o[0].startsWith("\\")?t.push(ff(Mi.FREE_TEXT,o[0])):t.push(ff(Mi.FORMAT,o[0])),n=o.index+o[0].length}const s=r[r.length-1];if(s.index+s[0].length<e.length){const i=e.substr(s.index+s[0].length,e.length);t.push(ff(Mi.FREE_TEXT,i))}return t}function O1(r){const e=aee(r);if(!e.every(t=>I1(t)))return{type:qm.DATE,tokens:A1(e,r)}}function uee(r){const e=lee(r);if(!e.every(t=>I1(t)))return{type:qm.NUMBER,tokens:A1(e,r)}}function I1(r){return r[0].startsWith("\\")}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function cee(r,e,t,n){const s=t.stringifyDateTime(n.numberToSimpleDateTime(r),e);if(s!==void 0)return s;const i=t.stringifyDuration(wu(r),e);if(i!==void 0)return i;const o=uee(e);return o!==void 0?dee(o.tokens,r):e}function xn(r,e){let t=`${r}`;for(;t.length<e;)t="0"+t;return t}function hee(r,e){let t=`${r}`;for(;t.length<e;)t=t+"0";return t}function aN(r,e){return r.split(e).length-1}function dee(r,e){let t="";for(let n=0;n<r.length;++n){const s=r[n];if(s.type===Mi.FREE_TEXT){t+=s.value;continue}const i=s.value.split("."),o=i[0],a=i[1]||"",l=i[1]?".":"",u=Number(e.toFixed(a.length)).toString().split(".");let c=u[0]||"",h=u[1]||"";if(o.length>c.length){const m=aN(o.substr(0,o.length-c.length),"0");c=xn(c,m+c.length)}const d=aN(a.substr(h.length,a.length-h.length),"0");h=hee(h,d+h.length),t+=c+l+h}return t}function fee(r,e){const t=O1(e);if(t===void 0)return;const n=t.tokens;let s="";for(const i of n){if(i.type===Mi.FREE_TEXT){s+=i.value;continue}switch(i.value.toLowerCase()){case"h":case"hh":{s+=xn(r.hours,i.value.length),r.hours=0;break}case"[hh]":{s+=xn(r.hours,i.value.length-2),r.hours=0;break}case"m":case"mm":{s+=xn(r.minutes,i.value.length),r.minutes=0;break}case"[mm]":{s+=xn(r.minutes+60*r.hours,i.value.length-2),r.minutes=0,r.hours=0;break}case"s":case"ss":{s+=xn(Math.floor(r.seconds),i.value.length);break}default:{if(LR.test(i.value)){const o=Math.max(i.value.length-3,0);s+=`${r.seconds<10?"0":""}${Math.floor(r.seconds*Math.pow(10,o))/Math.pow(10,o)}`;continue}return}}}return s}function mee(r,e){const t=O1(e);if(t===void 0)return;const n=t.tokens;let s="",i=!1;const o=n.some(a=>a.type===Mi.FORMAT&&(a.value==="a/p"||a.value==="A/P"||a.value==="am/pm"||a.value==="AM/PM"));for(let a=0;a<n.length;a++){const l=n[a];if(l.type===Mi.FREE_TEXT){s+=l.value;continue}switch(l.value.toLowerCase()){case"h":case"hh":{i=!0,s+=xn(o?(r.hours+11)%12+1:r.hours,l.value.length);break}case"d":case"dd":{s+=xn(r.day,l.value.length);break}case"s":case"ss":{s+=xn(Math.floor(r.seconds),l.value.length);break}case"m":case"mm":{a+1<n.length&&n[a+1].value.startsWith(":")&&(i=!0),i?s+=xn(r.minutes,l.value.length):s+=xn(r.month,l.value.length),i=!0;break}case"yy":{s+=xn(r.year%100,l.value.length);break}case"yyyy":{s+=r.year;break}case"am/pm":case"a/p":{const[u,c]=l.value.split("/");s+=r.hours<12?u:c;break}default:{if(LR.test(l.value)){const u=l.value.length-3;s+=`${r.seconds<10?"0":""}${Math.floor(r.seconds*Math.pow(10,u))/Math.pow(10,u)}`;continue}return}}}return s}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const av="length",sh=r=>parseInt(r,16),lN=r=>parseInt(r,10),Dy=r=>(r+"").replace(/\-/g,""),Qm=(r,e,t)=>r.substr(e,t),$s=r=>r.codePointAt(0)-65;function pee(r){return Dy(r)[av]===25?sh(Qm(Dy(r),sh("12"),$s("F")))/(sh(Qm(Dy(r),$s("C"),$s("Y")>>4))||(~~![][av]<<3)+1):0}function gee(r){if(r=(r+"").replace(/\-/g,""),r[av]!==$s("Z"))return!1;let e=0;return[[0,$s("G")+1],[$s("H"),$s("H")-1],[$s("G")+$s("H"),$s("G")]].reduce((t,[n,s],i)=>(t|=(lN(`${lN(sh(Qm(r,e+n-(i===0?0:2),s+(i?2:0)))+(sh(Qm(r,e+n+s,2))+[]).padStart(2,"0"))}`)%97||2)>>1,e+=2,t),$s("A"))==="1">>1}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const yee={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:r})=>`The license key for HyperFormula expired on ${r}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."};let uN=!1;function Eee(r){const e={template:"missing",vars:{}};if(r==="gpl-v3"||r==="internal-use-in-handsontable")e.template="valid";else if(typeof r=="string"&&gee(r)){const[t,n,s]="18/07/2024".split("/"),i=Math.floor(new Date(`${n}/${t}/${s}`).getTime()/864e5),o=pee(r);e.vars.keyValidityDate=vee(new Date((o+1)*864e5)),i>o?e.template="expired":e.template="valid"}else r!==""&&(e.template="invalid");return!uN&&e.template!=="valid"&&(console.warn(yee[e.template](e.vars)),uN=!0),e.template}function vee(r){const t=["January","February","March","April","May","June","July","August","September","October","November","December"][r.getMonth()],n=r.getDate(),s=r.getFullYear();return`${t} ${n}, ${s}`}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var Ut;(function(r){class e{constructor(l){this.value=l,this.value=AR(this.value,R1(le(this.value)))}}r.Number=e;class t{constructor(l){this.value=l}}r.String=t;class n{constructor(l){this.value=l}}r.Boolean=n;class s{static getSingletonInstance(){return s.instance||(s.instance=new s),s.instance}}r.Empty=s;class i{constructor(l){this.formula=l}}r.Formula=i;class o{constructor(l,u){this.value=new v(l,u)}}r.Error=o})(Ut||(Ut={}));function wee(r){return r.startsWith("=")}function Ree(r){const e=r.toLowerCase();return e==="true"||e==="false"}function See(r,e){const t=r.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(t)&&Object.prototype.hasOwnProperty.call(e,t)}class Cee{constructor(e,t,n){this.config=e,this.dateHelper=t,this.numberLiteralsHelper=n}parse(e){if(e==null)return Ut.Empty.getSingletonInstance();if(typeof e=="number")return w1(e)?new Ut.Error(S.NUM,N.ValueLarge):new Ut.Number(e);if(typeof e=="boolean")return new Ut.Boolean(e);if(e instanceof Date){const t=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}),n=Ru({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3}),s=t+n;return s<0?new Ut.Error(S.NUM,N.DateBounds):s%1===0?new Ut.Number(new OR(s,"Date()")):s<1?new Ut.Number(new IR(s,"Date()")):new Ut.Number(new MR(s,"Date()"))}else if(typeof e=="string"){if(Ree(e))return new Ut.Boolean(e.toLowerCase()==="true");if(wee(e))return new Ut.Formula(e);if(See(e,this.config.errorMapping))return new Ut.Error(this.config.errorMapping[e.toUpperCase()]);{let t=e.trim(),n=0,s;if(t.endsWith("%"))n=1,t=t.slice(0,t.length-1);else{const a=this.currencyMatcher(t);a!==void 0&&(n=2,[s,t]=a)}const i=this.numberLiteralsHelper.numericStringToMaybeNumber(t);if(i!==void 0){let a;return n===1?a=new jf(i/100):n===2?a=new ZE(i,s):a=i,new Ut.Number(a)}const o=this.dateHelper.dateStringToDateNumber(t);return o!==void 0?new Ut.Number(o):new Ut.String(e.startsWith("'")?e.slice(1):e)}}else throw new u1(e)}currencyMatcher(e){for(const t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length)];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length)]}}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var za;(function(r){r[r.COPY=0]="COPY",r[r.CUT=1]="CUT"})(za||(za={}));var kr;(function(r){r[r.VALUE=0]="VALUE",r[r.EMPTY=1]="EMPTY",r[r.FORMULA=2]="FORMULA",r[r.PARSING_ERROR=3]="PARSING_ERROR"})(kr||(kr={}));class cN{constructor(e,t,n,s,i){this.sourceLeftCorner=e,this.width=t,this.height=n,this.type=s,this.content=i}*getContent(e){if(this.content!==void 0)for(let t=0;t<this.height;++t)for(let n=0;n<this.width;++n)yield[he(e.sheet,e.col+n,e.row+t),this.content[t][n]]}}class Tee{constructor(e,t,n){this.dependencyGraph=t,this.operations=n,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,t,n){this.clipboard=new cN(e,t,n,za.CUT)}copy(e,t,n){const s=[];for(let i=0;i<n;++i){s[i]=[];for(let o=0;o<t;++o){const a=this.operations.getClipboardCell(he(e.sheet,e.col+o,e.row+i));s[i].push(a)}}this.clipboard=new cN(e,t,n,za.COPY,s)}abortCut(){this.clipboard&&this.clipboard.type===za.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(this.clipboard===void 0)return;if(Fn(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new gr("a valid target address.");const t=we.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Qa;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new Error("It is not possible to paste onto an array")}isCutClipboard(){return this.clipboard!==void 0&&this.clipboard.type===za.CUT}isCopyClipboard(){return this.clipboard!==void 0&&this.clipboard.type===za.COPY}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Zm{constructor(e,t,n,s){this.displayName=e,this.address=t,this.added=n,this.options=s}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new Zm(this.displayName,this.address,this.added,this.options)}}class bee{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){const t=this.normalizeExpressionName(e),n=this.mapping.get(t);return!(n&&n.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){const t=this.mapping.get(this.normalizeExpressionName(e));if(t&&t.added)return t}remove(e){const t=this.normalizeExpressionName(e),n=this.mapping.get(t);n&&(n.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}normalizeExpressionName(e){return e.toLowerCase()}}class hN{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}isNameAvailable(e){const t=this.normalizeExpressionName(e);return!this.mapping.has(t)}remove(e){const t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}normalizeExpressionName(e){return e.toLowerCase()}}class ll{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new bee,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,t){var n,s;return t===void 0?this.workbookStore.isNameAvailable(e):(s=(n=this.worksheetStore(t))===null||n===void 0?void 0:n.isNameAvailable(e))!==null&&s!==void 0?s:!0}namedExpressionInAddress(e){const t=this.addressCache.get(e);if(t&&t.added)return t}namedExpressionForScope(e,t){var n;return t===void 0?this.workbookStore.getExisting(e):(n=this.worksheetStore(t))===null||n===void 0?void 0:n.get(e)}nearestNamedExpression(e,t){var n,s;return(s=(n=this.worksheetStore(t))===null||n===void 0?void 0:n.get(e))!==null&&s!==void 0?s:this.workbookStore.getExisting(e)}isExpressionInScope(e,t){var n,s;return(s=(n=this.worksheetStore(t))===null||n===void 0?void 0:n.has(e))!==null&&s!==void 0?s:!1}isNameValid(e){const t=new RegExp(`^${G_}$`),n=new RegExp(`^${z_}$`),s=new RegExp(`^${Y_}$`);return t.test(e)||n.test(e)?!1:s.test(e)}addNamedExpression(e,t,n){const s=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);let i=s.get(e);return i!==void 0?(i.added=!0,i.displayName=e,i.options=n):(i=new Zm(e,this.nextAddress(),!0,n),s.add(i)),this.addressCache.set(i.address.row,i),i}restoreNamedExpression(e,t){const n=t===void 0?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,n.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,t){var n;return(n=this.worksheetStoreOrCreate(t).get(e))!==null&&n!==void 0?n:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let t=this.workbookStore.get(e);return t===void 0&&(t=new Zm(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}remove(e,t){let n;t===void 0?n=this.workbookStore:n=this.worksheetStore(t);const s=n==null?void 0:n.get(e);if(n===void 0||s===void 0||!s.added)throw Error("Named expression does not exist");n.remove(e),n instanceof hN&&n.mapping.size===0&&this.worksheetStores.delete(t),this.addressCache.delete(s.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter(({scope:t})=>t===e).map(t=>t.expression.displayName)}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map(e=>e.expression.displayName)}getAllNamedExpressions(){const e=[];return this.workbookStore.getAllNamedExpressions().forEach(t=>{e.push({expression:t,scope:void 0})}),this.worksheetStores.forEach((t,n)=>{t.getAllNamedExpressions().forEach(s=>{e.push({expression:s,scope:n})})}),e}getAllNamedExpressionsForScope(e){var t,n;return e===void 0?this.workbookStore.getAllNamedExpressions():(n=(t=this.worksheetStores.get(e))===null||t===void 0?void 0:t.getAllNamedExpressions())!==null&&n!==void 0?n:[]}worksheetStoreOrCreate(e){let t=this.worksheetStores.get(e);return t||(t=new hN,this.worksheetStores.set(e,t)),t}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return he(ll.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}ll.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;const Wo=r=>{switch(r.type){case C.EMPTY:case C.NUMBER:case C.STRING:case C.ERROR:case C.ERROR_WITH_RAW_INPUT:return!1;case C.CELL_REFERENCE:return!r.reference.isAbsolute();case C.CELL_RANGE:case C.COLUMN_RANGE:case C.ROW_RANGE:return!r.start.isAbsolute();case C.NAMED_EXPRESSION:return!1;case C.PERCENT_OP:case C.PLUS_UNARY_OP:case C.MINUS_UNARY_OP:return Wo(r.value);case C.CONCATENATE_OP:case C.EQUALS_OP:case C.NOT_EQUAL_OP:case C.LESS_THAN_OP:case C.GREATER_THAN_OP:case C.LESS_THAN_OR_EQUAL_OP:case C.GREATER_THAN_OR_EQUAL_OP:case C.MINUS_OP:case C.PLUS_OP:case C.TIMES_OP:case C.DIV_OP:case C.POWER_OP:return Wo(r.left)||Wo(r.right);case C.PARENTHESIS:return Wo(r.expression);case C.FUNCTION_CALL:return r.args.some(e=>Wo(e));case C.ARRAY:return r.args.some(e=>e.some(t=>Wo(t)))}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class fa{performEagerTransformations(e,t){for(const n of e.arrayFormulaNodes()){const[s,i]=this.transformSingleAst(n.getFormula(e.lazilyTransformingAstService),n.getAddress(e.lazilyTransformingAstService)),o=t.rememberNewAst(s);n.setFormula(o),n.setAddress(i)}}transformSingleAst(e,t){const n=this.transformAst(e,t),s=this.fixNodeAddress(t);return[n,s]}transformAst(e,t){switch(e.type){case C.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case C.CELL_RANGE:return this.transformCellRangeAst(e,t);case C.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case C.ROW_RANGE:return this.transformRowRangeAst(e,t);case C.EMPTY:case C.ERROR:case C.NUMBER:case C.NAMED_EXPRESSION:case C.ERROR_WITH_RAW_INPUT:case C.STRING:return e;case C.PERCENT_OP:case C.MINUS_UNARY_OP:case C.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case C.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(n=>this.transformAst(n,t))});case C.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case C.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(n=>n.map(s=>this.transformAst(s,t)))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}transformCellReferenceAst(e,t){const n=this.transformCellAddress(e.reference,t);return n instanceof St?Object.assign(Object.assign({},e),{reference:n}):n===S.REF?bi(new v(S.REF)):e}transformCellRangeAst(e,t){const n=this.transformCellRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===S.REF?bi(new v(S.REF)):e}transformColumnRangeAst(e,t){const n=this.transformColumnRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===S.REF?bi(new v(S.REF)):e}transformRowRangeAst(e,t){const n=this.transformRowRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===S.REF?bi(new v(S.REF)):e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Nee extends fa{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){throw Error("Not implemented")}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformCellAddress(e,t){const n=ti(e,t);if(n!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;const s=e.toSimpleColumnAddress(t);return n===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=s.col?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1:t.sheet===this.columnsSpan.sheet&&n!==this.columnsSpan.sheet?e.isColumnAbsolute()||t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?e.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?t.col<this.columnsSpan.columnStart?!1:e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart?e.shiftedByColumns(this.columnsSpan.numberOfColumns):!1}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,t,n){const s=this.transformCellAddress(e,n),i=this.transformCellAddress(t,n);return s===S.REF||i===S.REF?S.REF:s||i?[s||e,i||t]:!1}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class lv extends fa{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){throw Error("Not implemented")}transformCellAddress(e,t){const n=ti(e,t);if(n!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;const s=e.toSimpleRowAddress(t);return n===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=s.row?e.shiftedByRows(this.rowsSpan.numberOfRows):!1:t.sheet===this.rowsSpan.sheet&&n!==this.rowsSpan.sheet?e.isRowAbsolute()||t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?e.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(this.rowsSpan.numberOfRows):s.row<this.rowsSpan.rowStart?t.row<this.rowsSpan.rowStart?!1:e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart?e.shiftedByRows(this.rowsSpan.numberOfRows):!1}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,t,n){const s=this.transformCellAddress(e,n),i=this.transformCellAddress(t,n);return s===S.REF||i===S.REF?S.REF:s||i?[s||e,i||t]:!1}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Aee extends fa{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return e.isInvalid(t)?S.REF:!1}transformCellRange(e,t,n){return e.isInvalid(n)||t.isInvalid(n)?S.REF:!1}transformColumnRange(e,t,n){return e.isInvalid(n)||t.isInvalid(n)?S.REF:!1}transformRowRange(e,t,n){return e.isInvalid(n)||t.isInvalid(n)?S.REF:!1}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Oee extends fa{constructor(e,t,n,s){super(),this.sourceRange=e,this.toRight=t,this.toBottom=n,this.toSheet=s,this.dependentFormulaTransformer=new Iee(e,t,n,s)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,t){return this.sourceRange.addressInRange(t)?[this.transformAst(e,t),this.fixNodeAddress(t)]:this.dependentFormulaTransformer.transformSingleAst(e,t)}fixNodeAddress(e){return he(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,t){return this.transformAddress(e,t)}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformAddress(e,t){const n=this.sourceRange;if(e instanceof St){const s=e.toSimpleCellAddress(t);if(n.addressInRange(s))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,t,n){const s=this.sourceRange;if(e instanceof St&&t instanceof St){const i=e.toSimpleCellAddress(n),o=t.toSimpleCellAddress(n);if(s.addressInRange(i)&&s.addressInRange(o))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}class Iee extends fa{constructor(e,t,n,s){super(),this.sourceRange=e,this.toRight=t,this.toBottom=n,this.toSheet=s}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.shouldMove(e,t)?e.moved(this.toSheet,this.toRight,this.toBottom):!1}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}shouldMove(e,t){return e instanceof St?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof tn?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}transformRange(e,t,n){const s=this.transformCellAddress(e,n),i=this.transformCellAddress(t,n);return s&&i?[s,i]:!1}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Mee extends fa{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,t){return e}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){throw Error("Not implemented")}transformColumnRange(e,t,n){return this.transformRange(e,t,n)}transformCellAddress(e,t){const n=ti(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==n)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===n){const s=e.toSimpleColumnAddress(t);if(s.col<this.columnsSpan.columnStart)return!1;if(s.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==n){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===n)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{const s=e.toSimpleColumnAddress(t);if(s.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(s.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return S.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,t,n){const s=ti(e,n);let i=e,o=t;if(this.columnsSpan.sheet===s){const u=e.toSimpleColumnAddress(n),c=t.toSimpleColumnAddress(n);if(this.columnsSpan.columnStart<=u.col&&this.columnsSpan.columnEnd>=c.col)return S.REF;u.col>=this.columnsSpan.columnStart&&u.col<=this.columnsSpan.columnEnd&&(i=e.shiftedByColumns(this.columnsSpan.columnEnd-u.col+1)),c.col>=this.columnsSpan.columnStart&&c.col<=this.columnsSpan.columnEnd&&(o=t.shiftedByColumns(-(c.col-this.columnsSpan.columnStart+1)))}const a=this.transformCellAddress(i,n),l=this.transformCellAddress(o,n);if(a===!1&&l===!1)return[i,o];if(a===S.REF||l===S.REF)throw Error("Cannot happen");return[a||i,l||o]}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class uv extends fa{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,t){return e}transformCellAddress(e,t){const n=ti(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==n)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===n){const s=e.toSimpleRowAddress(t);if(s.row<this.rowsSpan.rowStart)return!1;if(s.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==n){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===n)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{const s=e.toSimpleRowAddress(t);if(s.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(s.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return S.REF}transformCellRange(e,t,n){return this.transformRange(e,t,n)}transformRowRange(e,t,n){return this.transformRange(e,t,n)}transformColumnRange(e,t,n){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,t,n){const s=ti(e,n);let i=e,o=t;if(this.rowsSpan.sheet===s){const u=e.toSimpleRowAddress(n),c=t.toSimpleRowAddress(n);if(this.rowsSpan.rowStart<=u.row&&this.rowsSpan.rowEnd>=c.row)return S.REF;u.row>=this.rowsSpan.rowStart&&u.row<=this.rowsSpan.rowEnd&&(i=e.shiftedByRows(this.rowsSpan.rowEnd-u.row+1)),c.row>=this.rowsSpan.rowStart&&c.row<=this.rowsSpan.rowEnd&&(o=t.shiftedByRows(-(c.row-this.rowsSpan.rowStart+1)))}const a=this.transformCellAddress(i,n),l=this.transformCellAddress(o,n);return a===!1&&l===!1?[i,o]:a===S.REF||l===S.REF?S.REF:[a||i,l||o]}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class _ee extends fa{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,t){for(const n of e.arrayFormulaNodes()){const[s]=this.transformSingleAst(n.getFormula(e.lazilyTransformingAstService),n.getAddress(e.lazilyTransformingAstService));n.setFormula(s)}}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.transformAddress(e)}transformCellRange(e,t,n){return this.transformAddress(e)}transformColumnRange(e,t,n){return this.transformAddress(e)}transformRowRange(e,t,n){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet?S.REF:!1}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function M1(r){if(!Array.isArray(r))throw new gr("an array of arrays.");for(let e=0;e<r.length;e++)if(!Array.isArray(r[e]))throw new gr("an array of arrays.")}function Jm(r){let e=0,t=0,n=0;for(let i=0;i<r.length;i++){let o=0;for(let a=0;a<r[i].length;a++){const l=r[i][a];l!=null&&(o=a+1,++n)}e=Math.max(e,o),o>0&&(t=i+1)}const s=e*t;return{height:t,width:e,fill:s===0?0:n/s}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class _1{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return ep(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>Dn.fromNumberOfRows(this.sheet,e[0],e[1]))}}class x1{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return tp(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>Dn.fromNumberOfRows(this.sheet,e[0],e[1]))}}class L1{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return tp(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>Xn.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class P1{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return ep(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>Xn.fromNumberOfColumns(this.sheet,e[0],e[1]))}}class xee{constructor(e,t,n,s,i,o,a,l,u){this.dependencyGraph=t,this.columnSearch=n,this.cellContentParser=s,this.parser=i,this.stats=o,this.lazilyTransformingAstService=a,this.namedExpressions=l,this.arraySizePredictor=u,this.changes=ea.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){const t=[];for(const n of e.rowsSpans()){const s=this.doRemoveRows(n);s&&t.push(s)}return t}addRows(e){for(const t of e.rowsSpans())this.doAddRows(t)}addColumns(e){for(const t of e.columnsSpans())this.doAddColumns(t)}removeColumns(e){const t=[];for(const n of e.columnsSpans()){const s=this.doRemoveColumns(n);s&&t.push(s)}return t}removeSheet(e){this.dependencyGraph.removeSheet(e);let t=0;this.stats.measure(Ve.TRANSFORM_ASTS,()=>{const s=new _ee(e);s.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(s)}),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);const n=this.namedExpressions.getAllNamedExpressionsForScope(e).map(s=>this.removeNamedExpression(s.normalizeExpressionName(),e));return{version:t,scopedNamedExpressions:n}}removeSheetByName(e){const t=this.sheetMapping.fetch(e);return this.removeSheet(t)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){const t=this.sheetMapping.addSheet(e),n=[];return this.dependencyGraph.addressMapping.autoAddSheet(t,Jm(n)),this.sheetMapping.fetchDisplayName(t)}renameSheet(e,t){return this.sheetMapping.renameSheet(e,t)}moveRows(e,t,n,s){const i=Dn.fromNumberOfRows(e,s,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(i),s<t&&(t+=n);const o=he(e,0,t),a=he(e,0,s);this.moveCells(o,Number.POSITIVE_INFINITY,n,a);const l=Dn.fromNumberOfRows(e,t,n);return this.doRemoveRows(l),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,t,n,s){const i=Xn.fromNumberOfColumns(e,s,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(i),s<t&&(t+=n);const o=he(e,t,0),a=he(e,s,0);this.moveCells(o,n,Number.POSITIVE_INFINITY,a);const l=Xn.fromNumberOfColumns(e,t,n);return this.doRemoveColumns(l),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,t,n,s){this.ensureItIsPossibleToMoveCells(e,t,n,s);const i=we.spanFrom(e,t,n),o=we.spanFrom(s,t,n),a=s.col-e.col,l=s.row-e.row,u=s.sheet,c=this.getRangeClipboardCells(o),h=this.dependencyGraph.rawValuesFromRange(o);this.columnSearch.removeValues(h);const d=this.dependencyGraph.rawValuesFromRange(i);this.columnSearch.moveValues(d,a,l,u);let m=0;this.stats.measure(Ve.TRANSFORM_ASTS,()=>{const g=new Oee(i,a,l,u);g.performEagerTransformations(this.dependencyGraph,this.parser),m=this.lazilyTransformingAstService.addTransformation(g)}),this.dependencyGraph.moveCells(i,a,l,u);const E=this.updateNamedExpressionsForMovedCells(e,t,n,s);return{version:m,overwrittenCellsData:c,addedGlobalNamedExpressions:E}}setRowOrder(e,t){const n=[];let s=[];for(const[i,o]of t)if(i!==o){const a=we.spanFrom({sheet:e,col:0,row:i},1/0,1),l=this.getRangeClipboardCells(a);s=s.concat(l),n.push(l.map(([{sheet:u,col:c},h])=>[{sheet:u,col:c,row:o},h]))}return n.forEach(i=>this.restoreClipboardCells(e,i.values())),s}setColumnOrder(e,t){const n=[];let s=[];for(const[i,o]of t)if(i!==o){const a=we.spanFrom({sheet:e,col:i,row:0},1,1/0),l=this.getRangeClipboardCells(a);s=s.concat(l),n.push(l.map(([{sheet:u,col:c,row:h},d])=>[{sheet:u,col:o,row:h},d]))}return n.forEach(i=>this.restoreClipboardCells(e,i.values())),s}addNamedExpression(e,t,n,s){const i=this.namedExpressions.addNamedExpression(e,n,s);this.storeNamedExpressionInCell(i.address,t),this.adjustNamedExpressionEdges(i,e,n)}restoreNamedExpression(e,t,n){const s=e.displayName;this.restoreCell(e.address,t);const i=this.namedExpressions.restoreNamedExpression(e,n);this.adjustNamedExpressionEdges(i,s,n)}changeNamedExpressionExpression(e,t,n,s){const i=this.namedExpressions.namedExpressionForScope(e,n);if(!i)throw new Th(e);const o=i.copy();i.options=s;const a=this.getClipboardCell(i.address);return this.storeNamedExpressionInCell(i.address,t),[o,a]}removeNamedExpression(e,t){const n=this.namedExpressions.namedExpressionForScope(e,t);if(!n)throw new Th(e);this.namedExpressions.remove(n.displayName,t);const s=this.getClipboardCell(n.address);if(t!==void 0){const i=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(n.address,i.address)}else this.dependencyGraph.setCellEmpty(n.address);return[n,s]}ensureItIsPossibleToMoveCells(e,t,n,s){if(Fn(e)||!(rp(t)&&rp(n)||Lee(e,t,n))||Fn(s)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(s.sheet))throw new gr("a valid range of cells to move.");const i=we.spanFrom(e,t,n),o=we.spanFrom(s,t,n);if(o.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Qa;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(i))throw new nu;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new jm}restoreClipboardCells(e,t){const n=[];for(const[s,i]of t)if(this.restoreCell(s,i),i.type===kr.FORMULA){const{dependencies:o}=this.parser.fetchCachedResult(i.hash);n.push(...this.updateNamedExpressionsForTargetAddress(e,s,o))}return n}restoreCell(e,t){switch(t.type){case kr.VALUE:{this.setValueToCell(t,e);break}case kr.FORMULA:{this.setFormulaToCellFromCache(t.hash,e);break}case kr.EMPTY:{this.setCellEmpty(e);break}case kr.PARSING_ERROR:{this.setParsingErrorToCell(t.rawInput,t.errors,e);break}}}getOldContent(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof zo)return[e,{type:kr.EMPTY}];if(t instanceof ta)return[e,Object.assign({type:kr.VALUE},t.getValues())];if(t instanceof qn)return[t.getAddress(this.lazilyTransformingAstService),{type:kr.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof vu)return[e,{type:kr.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){const t=this.dependencyGraph.getCell(e);if(t===void 0||t instanceof zo)return{type:kr.EMPTY};if(t instanceof ta)return Object.assign({type:kr.VALUE},t.getValues());if(t instanceof or){const n=t.getArrayCellValue(e);return n===Xe?{type:kr.EMPTY}:{type:kr.VALUE,parsedValue:n,rawValue:t.getArrayCellRawValue(e)}}else{if(t instanceof Ii)return{type:kr.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof vu)return{type:kr.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}}throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){const t=this.dependencyGraph.getSheetHeight(e),n=this.dependencyGraph.getSheetWidth(e),s=new Array(t);for(let i=0;i<t;i++){s[i]=new Array(n);for(let o=0;o<n;o++){const a=he(e,o,i);s[i][o]=this.getClipboardCell(a)}}return s}getRangeClipboardCells(e){const t=[];for(const n of e.addresses(this.dependencyGraph))t.push([n,this.getClipboardCell(n)]);return t}setCellContent(e,t){const n=this.cellContentParser.parse(t),s=this.getOldContent(e);if(n instanceof Ut.Formula){const i=this.parser.parse(n.formula,e),{ast:o,errors:a}=i;if(a.length>0)this.setParsingErrorToCell(n.formula,a,e);else try{const l=this.arraySizePredictor.checkArraySize(o,e);if(l.width<=0||l.height<=0)throw Error("Incorrect array size");this.setFormulaToCell(e,l,i)}catch(l){if(!l.message)throw l;const u={type:Jt.InvalidRangeSize,message:"Invalid range size."};this.setParsingErrorToCell(n.formula,[u],e)}}else n instanceof Ut.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:t},e);return s}setSheetContent(e,t){this.clearSheet(e);for(let n=0;n<t.length;n++)for(let s=0;s<t[n].length;s++){const i=he(e,s,n);this.setCellContent(i,t[n][s])}}setParsingErrorToCell(e,t,n){const s=this.dependencyGraph.getCellValue(n),i=new vu(t,e),o=this.dependencyGraph.setParsingErrorToCell(n,i);this.columnSearch.remove(le(s),n),this.columnSearch.applyChanges(o.getChanges()),this.changes.addAll(o),this.changes.addChange(i.getCellValue(),n)}setFormulaToCell(e,t,{ast:n,hasVolatileFunction:s,hasStructuralChangeFunction:i,dependencies:o}){const a=this.dependencyGraph.getCellValue(e),l=this.dependencyGraph.setFormulaToCell(e,n,Ni(o,e),t,s,i);this.columnSearch.remove(le(a),e),this.columnSearch.applyChanges(l.getChanges()),this.changes.addAll(l)}setValueToCell(e,t){const n=this.dependencyGraph.getCellValue(t),s=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.change(le(n),le(e.parsedValue),t),this.columnSearch.applyChanges(s.getChanges().filter(i=>!Nh(i.address,t))),this.changes.addAll(s),this.changes.addChange(e.parsedValue,t)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;const t=this.dependencyGraph.getCellValue(e),n=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove(le(t),e),this.columnSearch.applyChanges(n.getChanges()),this.changes.addAll(n),this.changes.addChange(Xe,e)}setFormulaToCellFromCache(e,t){const{ast:n,hasVolatileFunction:s,hasStructuralChangeFunction:i,dependencies:o}=this.parser.fetchCachedResult(e),a=Ni(o,t),[l]=new Aee(t.sheet).transformSingleAst(n,t);this.parser.rememberNewAst(l);const u=iJ(a),c=this.arraySizePredictor.checkArraySize(n,t);this.dependencyGraph.setFormulaToCell(t,l,u,c,s,i)}rowEffectivelyNotInSheet(e,t){const n=this.dependencyGraph.addressMapping.getHeight(t);return e>=n}getAndClearContentChanges(){const e=this.changes;return this.changes=ea.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const t=[];for(const[o]of this.dependencyGraph.entriesFromRowsSpan(e))t.push({address:o,cellType:this.getClipboardCell(o)});const{affectedArrays:n,contentChanges:s}=this.dependencyGraph.removeRows(e);this.columnSearch.applyChanges(s.getChanges());let i=0;return this.stats.measure(Ve.TRANSFORM_ASTS,()=>{const o=new uv(e);o.performEagerTransformations(this.dependencyGraph,this.parser),i=this.lazilyTransformingAstService.addTransformation(o)}),this.rewriteAffectedArrays(n),{version:i,removedCells:t,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const t=[];for(const[o]of this.dependencyGraph.entriesFromColumnsSpan(e))t.push({address:o,cellType:this.getClipboardCell(o)});const{affectedArrays:n,contentChanges:s}=this.dependencyGraph.removeColumns(e);this.columnSearch.applyChanges(s.getChanges()),this.columnSearch.removeColumns(e);let i=0;return this.stats.measure(Ve.TRANSFORM_ASTS,()=>{const o=new Mee(e);o.performEagerTransformations(this.dependencyGraph,this.parser),i=this.lazilyTransformingAstService.addTransformation(o)}),this.rewriteAffectedArrays(n),{version:i,removedCells:t,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;const{affectedArrays:t}=this.dependencyGraph.addRows(e);this.stats.measure(Ve.TRANSFORM_ASTS,()=>{const n=new lv(e);n.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(n)}),this.rewriteAffectedArrays(t)}rewriteAffectedArrays(e){for(const t of e.values()){if(t.array.size.isRef)continue;const n=t.getFormula(this.lazilyTransformingAstService),s=t.getAddress(this.lazilyTransformingAstService),i=this.parser.computeHashFromAst(n);this.setFormulaToCellFromCache(i,s)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;const{affectedArrays:t,contentChanges:n}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(n.getChanges()),this.stats.measure(Ve.TRANSFORM_ASTS,()=>{const s=new Nee(e);s.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(s)}),this.rewriteAffectedArrays(t)}columnEffectivelyNotInSheet(e,t){const n=this.dependencyGraph.addressMapping.getWidth(t);return e>=n}adjustNamedExpressionEdges(e,t,n){if(n===void 0)return;const{vertex:s,id:i}=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),o=i??this.dependencyGraph.graph.getNodeId(s),a=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),{vertex:l,id:u}=this.dependencyGraph.fetchCellOrCreateEmpty(a.address),c=u??this.dependencyGraph.graph.getNodeId(l);for(const h of this.dependencyGraph.graph.adjacentNodes(l))if(h instanceof Ii&&h.getAddress(this.lazilyTransformingAstService).sheet===n){const d=h.getFormula(this.lazilyTransformingAstService),m=h.getAddress(this.lazilyTransformingAstService),{dependencies:E}=this.parser.fetchCachedResultForAst(d);for(const g of Ni(E,m))g instanceof po&&g.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(c,h),this.dependencyGraph.graph.addEdge(o,h))}}storeNamedExpressionInCell(e,t){const n=this.cellContentParser.parse(t);if(n instanceof Ut.Formula){const s=this.parser.parse(n.formula,he(-1,0,0));if(Wo(s.ast))throw new _R;const{ast:i,hasVolatileFunction:o,hasStructuralChangeFunction:a,dependencies:l}=s;this.dependencyGraph.setFormulaToCell(e,i,Ni(l,e),Ze.scalar(),o,a)}else n instanceof Ut.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:t},e)}updateNamedExpressionsForMovedCells(e,t,n,s){if(e.sheet===s.sheet)return[];const i=[],o=we.spanFrom(s,t,n);for(const a of o.addresses(this.dependencyGraph)){const l=this.addressMapping.fetchCell(a);if(l instanceof Ii&&a.sheet!==e.sheet){const u=l.getFormula(this.lazilyTransformingAstService),{dependencies:c}=this.parser.fetchCachedResultForAst(u);i.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,a,c))}}return i}updateNamedExpressionsForTargetAddress(e,t,n){if(e===t.sheet)return[];const s=[],i=this.addressMapping.fetchCell(t);for(const o of Ni(n,t)){if(!(o instanceof po))continue;const a=o.name,l=this.dependencyGraph.fetchNamedExpressionVertex(a,e).vertex,c=this.namedExpressions.isExpressionInScope(a,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(a,t.sheet).vertex:this.copyOrFetchGlobalNamedExpressionVertex(a,l,s);c!==l&&(this.dependencyGraph.graph.removeEdgeIfExists(l,i),this.dependencyGraph.graph.addEdge(c,i))}return s}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(ll.SHEET_FOR_WORKBOOK_EXPRESSIONS,new bJ(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,t,n){let s=this.namedExpressions.namedExpressionForScope(e);if(s===void 0)if(s=this.namedExpressions.addNamedExpression(e),n.push(s.normalizeExpressionName()),t instanceof Ii){const i=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),{ast:o,hasVolatileFunction:a,hasStructuralChangeFunction:l,dependencies:u}=i;this.dependencyGraph.setFormulaToCell(s.address,o,Ni(u,s.address),Ze.scalar(),a,l)}else t instanceof zo?this.setCellEmpty(s.address):t instanceof ta&&this.setValueToCell(t.getValues(),s.address);return this.dependencyGraph.fetchCellOrCreateEmpty(s.address).vertex}}function ep(r){if(r.length<=1)return r;const e=[...r].sort(([s],[i])=>s-i),t=e.reduce((s,[i,o])=>{const a=s[s.length-1],l=a[0]+a[1];return i<=l?a[1]+=Math.max(0,o-(l-i)):s.push([i,o]),s},[e[0]]);let n=0;for(let s=0;s<t.length;++s)t[s][0]-=n,n+=t[s][1];return t}function tp(r){if(r.length<=1)return r;const e=[...r].sort(([s],[i])=>s-i),t=e.reduce((s,[i,o])=>{const a=s[s.length-1];return i===a[0]?a[1]=Math.max(a[1],o):s.push([i,o]),s},[e[0]]);let n=0;for(let s=0;s<t.length;++s)t[s][0]+=n,n+=t[s][1];return t}function rp(r){return Number.isInteger(r)&&r>0}function Lee(r,e,t){return r.row===0&&rp(e)&&t===Number.POSITIVE_INFINITY||r.col===0&&rp(t)&&e===Number.POSITIVE_INFINITY}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class wr{}class Pee extends wr{constructor(e,t){super(),this.command=e,this.rowsRemovals=t}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}}class Fee extends wr{constructor(e,t,n,s,i,o,a){super(),this.sourceLeftCorner=e,this.width=t,this.height=n,this.destinationLeftCorner=s,this.overwrittenCellsData=i,this.addedGlobalNamedExpressions=o,this.version=a}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}}class Dee extends wr{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}}class Hee extends wr{constructor(e,t,n){super(),this.sheetId=e,this.rowMapping=t,this.oldContent=n}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}}class Vee extends wr{constructor(e,t,n){super(),this.sheetId=e,this.columnMapping=t,this.oldContent=n}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}}class Uee extends wr{constructor(e,t,n){super(),this.sheetId=e,this.oldSheetContent=t,this.newSheetContent=n}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}}class kee extends wr{constructor(e,t,n,s,i){super(),this.sheet=e,this.startRow=t,this.numberOfRows=n,this.targetRow=s,this.version=i,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}}class Bee extends wr{constructor(e,t,n,s,i){super(),this.sheet=e,this.startColumn=t,this.numberOfColumns=n,this.targetColumn=s,this.version=i,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}}class Wee extends wr{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}}class $ee extends wr{constructor(e,t){super(),this.command=e,this.columnsRemovals=t}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}}class Gee extends wr{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}}class zee extends wr{constructor(e,t,n,s,i){super(),this.sheetName=e,this.sheetId=t,this.oldSheetContent=n,this.scopedNamedExpressions=s,this.version=i}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}}class Yee extends wr{constructor(e,t,n){super(),this.sheetId=e,this.oldName=t,this.newName=n}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}}class jee extends wr{constructor(e,t){super(),this.sheetId=e,this.oldSheetContent=t}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}}class Kee extends wr{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}}class Xee extends wr{constructor(e,t,n,s){super(),this.targetLeftCorner=e,this.oldContent=t,this.newContent=n,this.addedGlobalNamedExpressions=s}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}}class qee extends wr{constructor(e,t,n,s){super(),this.name=e,this.newContent=t,this.scope=n,this.options=s}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}}class Qee extends wr{constructor(e,t,n){super(),this.namedExpression=e,this.content=t,this.scope=n}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}}class Zee extends wr{constructor(e,t,n,s,i){super(),this.namedExpression=e,this.newContent=t,this.oldContent=n,this.scope=s,this.options=i}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}}class Jee extends wr{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}class ete{constructor(e,t){this.operations=t,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){this.batchUndoEntry!==void 0?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new Jee}commitBatchMode(){if(this.batchUndoEntry===void 0)throw Error("Batch mode wasn't started");this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,t,n){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([t,n])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return this.undoStack.length===0}isRedoStackEmpty(){return this.redoStack.length===0}undo(){const e=this.undoStack.pop();if(!e)throw Error("Attempted to undo without operation on stack");this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(const t of e.reversedOperations())this.undoEntry(t)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},rowsRemovals:n}=e;for(let s=n.length-1;s>=0;--s){const i=n[s];this.operations.addRows(new x1(t,[[i.rowFrom,i.rowCount]]));for(const{address:o,cellType:a}of i.removedCells)this.operations.restoreCell(o,a);this.restoreOldDataFromVersion(i.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();const{command:{sheet:t},columnsRemovals:n}=e;for(let s=n.length-1;s>=0;--s){const i=n[s];this.operations.addColumns(new L1(t,[[i.columnFrom,i.columnCount]]));for(const{address:o,cellType:a}of i.removedCells)this.operations.restoreCell(o,a);this.restoreOldDataFromVersion(i.version-1)}}undoAddRows(e){const t=e.command.rowsSpans();for(let n=t.length-1;n>=0;--n){const s=t[n];this.operations.removeRows(new _1(e.command.sheet,[[s.rowStart,s.numberOfRows]]))}}undoAddColumns(e){const t=e.command.columnsSpans();for(let n=t.length-1;n>=0;--n){const s=t[n];this.operations.removeColumns(new P1(e.command.sheet,[[s.columnStart,s.numberOfColumns]]))}}undoSetCellContents(e){for(const t of e.cellContents){const n=t.address,[s,i]=t.oldContent;Nh(n,s)||this.operations.setCellEmpty(n),this.operations.restoreCell(s,i)}}undoPaste(e){this.restoreOperationOldContent(e.oldContent);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoMoveRows(e){const{sheet:t}=e;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){const{sheet:t}=e;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);for(const t of e.addedGlobalNamedExpressions)this.operations.removeNamedExpression(t)}undoAddSheet(e){const{sheetName:t}=e;this.operations.removeSheetByName(t)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();const{oldSheetContent:t,sheetId:n}=e;this.operations.addSheet(e.sheetName);for(let s=0;s<t.length;s++){const i=t[s];for(let o=0;o<i.length;o++){const a=i[o],l=he(n,o,s);this.operations.restoreCell(l,a)}}for(const[s,i]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(s,i,n);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){const{oldSheetContent:t,sheetId:n}=e;for(let s=0;s<t.length;s++){const i=t[s];for(let o=0;o<i.length;o++){const a=i[o],l=he(n,o,s);this.operations.restoreCell(l,a)}}}undoSetSheetContent(e){const{oldSheetContent:t,sheetId:n}=e;this.operations.clearSheet(n);for(let s=0;s<t.length;s++){const i=t[s];for(let o=0;o<i.length;o++){const a=i[o],l=he(n,o,s);this.operations.restoreCell(l,a)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){const e=this.redoStack.pop();if(!e)throw Error("Attempted to redo without operation on stack");this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(const t of e.operations)this.redoEntry(t)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){const{targetLeftCorner:t,newContent:n}=e,s=n.length,i=n[0].length;for(let o=0;o<s;++o)for(let a=0;a<i;++a){const l=he(t.sheet,t.col+a,t.row+o);this.operations.restoreCell(l,n[o][a])}}redoSetCellContents(e){for(const t of e.cellContents)this.operations.setCellContent(t.address,t.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){const{sheetId:t,newSheetContent:n}=e;this.operations.setSheetContent(t,n)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(const[t,n]of e)this.operations.restoreCell(t,n)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){const t=this.oldData.get(e)||[];for(const n of t){const[s,i]=n;this.operations.setFormulaToCellFromCache(i,s)}}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class tte{constructor(e,t,n,s,i,o,a,l,u,c){this.operations=t,this.undoRedo=n,this.clipboardOperations=s,this.dependencyGraph=i,this.columnSearch=o,this.parser=a,this.cellContentParser=l,this.lazilyTransformingAstService=u,this.namedExpressions=c,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...t){const n=new x1(e,t);this.ensureItIsPossibleToAddRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(n),this.undoRedo.saveOperation(new Dee(n))}removeRows(e,...t){const n=new _1(e,t);this.ensureItIsPossibleToRemoveRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const s=this.operations.removeRows(n);this.undoRedo.saveOperation(new Pee(n,s))}addColumns(e,...t){const n=new L1(e,t);this.ensureItIsPossibleToAddColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(n),this.undoRedo.saveOperation(new Wee(n))}removeColumns(e,...t){const n=new P1(e,t);this.ensureItIsPossibleToRemoveColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const s=this.operations.removeColumns(n);this.undoRedo.saveOperation(new $ee(n,s))}moveCells(e,t,n,s){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const{version:i,overwrittenCellsData:o,addedGlobalNamedExpressions:a}=this.operations.moveCells(e,t,n,s);this.undoRedo.saveOperation(new Fee(e,t,n,s,o,a,i))}moveRows(e,t,n,s){this.ensureItIsPossibleToMoveRows(e,t,n,s),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const i=this.operations.moveRows(e,t,n,s);this.undoRedo.saveOperation(new kee(e,t,n,s,i))}moveColumns(e,t,n,s){this.ensureItIsPossibleToMoveColumns(e,t,n,s),this.undoRedo.clearRedoStack();const i=this.operations.moveColumns(e,t,n,s);this.undoRedo.saveOperation(new Bee(e,t,n,s,i))}cut(e,t,n){this.clipboardOperations.cut(e,t,n)}ensureItIsPossibleToCopy(e,t,n){if(!kl(t))throw new gr("width to be positive integer.");if(!kl(n))throw new gr("height to be positive integer.")}copy(e,t,n){this.ensureItIsPossibleToCopy(e,t,n),this.clipboardOperations.copy(e,t,n)}paste(e){const t=this.clipboardOperations.clipboard;if(t===void 0)throw new l1;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);const n=we.spanFrom(e,t.width,t.height),s=this.operations.getRangeClipboardCells(n);this.undoRedo.clearRedoStack();const i=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new Xee(e,s,t.content,i))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return this.clipboardOperations.clipboard===void 0}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){e!==void 0&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();const t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new Gee(t)),t}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.sheetMapping.fetchDisplayName(e),n=this.operations.getSheetClipboardCells(e),{version:s,scopedNamedExpressions:i}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new zee(t,e,n,i,s))}renameSheet(e,t){this.ensureItIsPossibleToRenameSheet(e,t);const n=this.operations.renameSheet(e,t);return n!==void 0&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new Yee(e,n,t))),n}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new jee(e,t))}setCellContents(e,t){if(!(t instanceof Array))t=[[t]];else for(let s=0;s<t.length;s++)if(!(t[s]instanceof Array))throw new gr("an array of arrays or a raw cell value.");this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();const n=[];for(let s=0;s<t.length;s++)for(let i=0;i<t[s].length;i++){const o={sheet:e.sheet,row:e.row+s,col:e.col+i},a=t[s][i];this.clipboardOperations.abortCut();const l=this.operations.setCellContent(o,a);n.push({address:o,newContent:a,oldContent:l})}this.undoRedo.saveOperation(new Kee(n))}setSheetContent(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),M1(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new Uee(e,n,t))}setRowOrder(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new Hee(e,t,n))}validateSwapRowIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new Gt(e);this.validateRowOrColumnMapping(e,t,"row")}testColumnOrderForArrays(e,t){for(const[n,s]of t)if(n!==s){const i=we.spanFrom({sheet:e,col:n,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(i))throw new nu}}setColumnOrder(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();const n=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new Vee(e,t,n))}validateSwapColumnIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new Gt(e);this.validateRowOrColumnMapping(e,t,"column")}testRowOrderForArrays(e,t){for(const[n,s]of t)if(n!==s){const i=we.spanFrom({sheet:e,col:0,row:n},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(i))throw new nu}}mappingFromOrder(e,t,n){if(!this.sheetMapping.hasSheetWithId(e))throw new Gt(e);const s=n==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==s)throw new gr(`number of ${n}s provided to be sheet ${n==="row"?"height":"width"}.`);const i=[];for(let o=0;o<s;o++)t[o]!==o&&i.push([o,t[o]]);return i}undo(){if(this.undoRedo.isUndoStackEmpty())throw new o1;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new a1;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,t,n,s){this.ensureItIsPossibleToAddNamedExpression(e,t,n),this.operations.addNamedExpression(e,t,n,s),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new qee(e,t,n,s))}changeNamedExpressionExpression(e,t,n,s){this.ensureItIsPossibleToChangeNamedExpression(e,n,t);const[i,o]=this.operations.changeNamedExpressionExpression(e,n,t,s);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Zee(i,n,o,t,s))}removeNamedExpression(e,t){this.ensureScopeIdIsValid(t);const[n,s]=this.operations.removeNamedExpression(e,t);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Qee(n,s,t)),n}ensureItIsPossibleToAddNamedExpression(e,t,n){this.ensureScopeIdIsValid(n),this.ensureNamedExpressionNameIsValid(e,n),this.ensureNamedExpressionIsValid(t)}ensureItIsPossibleToChangeNamedExpression(e,t,n){if(this.ensureScopeIdIsValid(n),this.namedExpressions.namedExpressionForScope(e,n)===void 0)throw new Th(e);this.ensureNamedExpressionIsValid(t)}isItPossibleToRemoveNamedExpression(e,t){if(this.ensureScopeIdIsValid(t),this.namedExpressions.namedExpressionForScope(e,t)===void 0)throw new Th(e)}ensureItIsPossibleToAddRows(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new Gt(e);const n=this.dependencyGraph.getSheetHeight(e),s=t.map(i=>i[1]).reduce((i,o)=>i+o,0);if(n+s>this.maxRows)throw new Qa;for(const[i,o]of t)if(!Ha(i)||!kl(o))throw new gr("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...t){for(const[n,s]of t){const i=n+s-1;if(!Ha(n)||!Ha(i))throw new gr("starting and ending row to be nonnegative.");if(i<n)throw new gr("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new Gt(e)}}ensureItIsPossibleToAddColumns(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new Gt(e);const n=this.dependencyGraph.getSheetWidth(e),s=t.map(i=>i[1]).reduce((i,o)=>i+o,0);if(n+s>this.maxColumns)throw new Qa;for(const[i,o]of t)if(!Ha(i)||!kl(o))throw new gr("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...t){for(const[n,s]of t){const i=n+s-1;if(!Ha(n)||!Ha(i))throw new gr("starting and ending column to be nonnegative.");if(i<n)throw new gr("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new Gt(e)}}ensureItIsPossibleToMoveRows(e,t,n,s){this.ensureItIsPossibleToAddRows(e,[s,n]);const i=he(e,0,t),o=he(e,0,s);if(!this.sheetMapping.hasSheetWithId(e)||Fn(i)||Fn(o)||!kl(n)||s<=t+n&&s>=t)throw new gr("a valid range of rows to move.");const a=this.dependencyGraph.getSheetWidth(e),l=we.spanFrom(i,a,n);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new nu;if(s>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(Dn.fromNumberOfRows(e,s-1,2)))throw new jm}ensureItIsPossibleToMoveColumns(e,t,n,s){this.ensureItIsPossibleToAddColumns(e,[s,n]);const i=he(e,t,0),o=he(e,s,0);if(!this.sheetMapping.hasSheetWithId(e)||Fn(i)||Fn(o)||!kl(n)||s<=t+n&&s>=t)throw new gr("a valid range of columns to move.");const a=this.dependencyGraph.getSheetHeight(e),l=we.spanFrom(i,n,a);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(l))throw new nu;if(s>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(Xn.fromNumberOfColumns(e,s-1,2)))throw new jm}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new Sh(e)}ensureItIsPossibleToRenameSheet(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new Gt(e);const n=this.sheetMapping.get(t);if(n!==void 0&&n!==e)throw new Sh(t)}ensureItIsPossibleToChangeContent(e){if(Fn(e))throw new n1(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new Gt(e.sheet)}ensureItIsPossibleToChangeCellContents(e,t){const n=Jm(t),s=we.spanFrom(e,n.width,n.height);this.ensureRangeInSizeLimits(s);for(const i of s.addresses(this.dependencyGraph))this.ensureItIsPossibleToChangeContent(i)}ensureItIsPossibleToChangeSheetContents(e,t){const n=Jm(t),s=we.spanFrom(he(e,0,0),n.width,n.height);this.ensureRangeInSizeLimits(s)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new Qa}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(e!==void 0&&!this.sheetMapping.hasSheetWithId(e))throw new Gt(e)}validateRowOrColumnMapping(e,t,n){const s=n==="row"?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),i=t.map(([a,l])=>a).sort((a,l)=>a-l),o=t.map(([a,l])=>l).sort((a,l)=>a-l);for(let a=0;a<i.length;a++){if(!Ha(i[a])||i[a]>=s)throw new gr(`${n} numbers to be nonnegative integers and less than sheet ${n==="row"?"height":"width"}.`);if(i[a]===i[a+1])throw new gr(`source ${n} numbers to be unique.`);if(i[a]!==o[a])throw new gr(`target ${n} numbers to be permutation of source ${n} numbers.`)}}ensureNamedExpressionNameIsValid(e,t){if(!this.namedExpressions.isNameValid(e))throw new i1(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new s1(e)}ensureNamedExpressionIsValid(e){const t=this.cellContentParser.parse(e);if(t instanceof Ut.Formula){const n=this.parser.parse(t.formula,he(-1,0,0));if(Wo(n.ast))throw new _R}}}function kl(r){return Number.isInteger(r)&&r>0}function Ha(r){return Number.isInteger(r)&&r>=0}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class rte{constructor(e,t,n,s,i,o){this.config=e,this.stats=t,this.interpreter=n,this.lazilyTransformingAstService=s,this.dependencyGraph=i,this.columnSearch=o}run(){this.stats.start(Ve.TOP_SORT);const{sorted:e,cycled:t}=this.dependencyGraph.topSortWithScc();this.stats.end(Ve.TOP_SORT),this.stats.measure(Ve.EVALUATION,()=>{this.recomputeFormulas(t,e)})}partialRun(e){const t=ea.empty();return this.stats.measure(Ve.EVALUATION,()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,n=>{if(n instanceof qn){const s=n.isComputed()?n.getCellValue():void 0,i=this.recomputeFormulaVertexValue(n);if(i!==s){const o=n.getAddress(this.lazilyTransformingAstService);return t.addChange(i,o),this.columnSearch.change(le(s),le(i),o),!0}return!1}else return n instanceof en&&n.clearCache(),!0},n=>{if(n instanceof en)n.clearCache();else if(n instanceof qn){const s=n.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove(le(n.valueOrUndef()),s);const i=new v(S.CYCLE,void 0,n);n.setCellValue(i),t.addChange(i,s)}})}),t}runAndForget(e,t,n){const s=[];for(const o of Ni(n,t))if(o instanceof we){const a=o;if(this.dependencyGraph.getRange(a.start,a.end)===void 0){const l=new en(a);this.dependencyGraph.rangeMapping.setRange(l),s.push(l)}}const i=this.evaluateAstToCellValue(e,new xi(t,this.config.useArrayArithmetic));return s.forEach(o=>{this.dependencyGraph.rangeMapping.removeRange(o)}),i}recomputeFormulas(e,t){e.forEach(n=>{n instanceof qn&&n.setCellValue(new v(S.CYCLE,void 0,n))}),t.forEach(n=>{if(n instanceof qn){const s=this.recomputeFormulaVertexValue(n),i=n.getAddress(this.lazilyTransformingAstService);this.columnSearch.add(le(s),i)}else n instanceof en&&n.clearCache()})}recomputeFormulaVertexValue(e){const t=e.getAddress(this.lazilyTransformingAstService);if(e instanceof or&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{const n=e.getFormula(this.lazilyTransformingAstService),s=this.evaluateAstToCellValue(n,new xi(t,this.config.useArrayArithmetic,e));return e.setCellValue(s)}}evaluateAstToCellValue(e,t){const n=this.interpreter.evaluateAst(e,t);return n instanceof Ee?n:n===Xe&&this.config.evaluateNullToZero?0:n}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class cv{constructor(e,t){this.address=e,this.newValue=t}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}class F1{constructor(e,t){this.name=e,this.newValue=t}}class nte{constructor(e,t,n,s){this.config=e,this.namedExpressions=t,this.sheetIndexMapping=n,this.lazilyTransformingService=s}exportChange(e){const t=e.value,n=e.address;if(n.sheet===ll.SHEET_FOR_WORKBOOK_EXPRESSIONS){const s=this.namedExpressions.namedExpressionInAddress(n.row);if(!s)throw new Error("Missing named expression");return new F1(s.displayName,this.exportScalarOrRange(t))}else if(t instanceof Ee){const s=[];for(const[i,o]of t.entriesFromTopLeftCorner(n))s.push(new cv(o,this.exportValue(i)));return s}else return new cv(n,this.exportValue(t))}exportValue(e){return e instanceof Ee?this.detailedError(new v(S.VALUE,N.ScalarExpected)):this.config.smartRounding&&ct(e)?this.cellValueRounding(le(e)):e instanceof v?this.detailedError(e):e===Xe?null:le(e)}exportScalarOrRange(e){return e instanceof Ee?e.rawData().map(t=>t.map(n=>this.exportValue(n))):this.exportValue(e)}detailedError(e){var t,n;let s;const i=(t=e.root)===null||t===void 0?void 0:t.getAddress(this.lazilyTransformingService);return i!==void 0&&(i.sheet===ll.SHEET_FOR_WORKBOOK_EXPRESSIONS?s=(n=this.namedExpressions.namedExpressionInAddress(i.row))===null||n===void 0?void 0:n.displayName:s=Pm(this.sheetIndexMapping,i,-1)),new C1(e,this.config.translationPackage.getErrorTranslation(e.type),s)}cellValueRounding(e){if(e===0)return e;const t=Math.floor(Math.log10(Math.abs(e))),n=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*n)/n:Math.round(e*n)/n}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class ste{constructor(e,t,n,s,i,o){this.dependencyGraph=e,this.columnSearch=t,this.parser=n,this.cellContentParser=s,this.stats=i,this.arraySizePredictor=o,this.buildStrategy=new ite(e,t,n,i,s,o)}buildGraph(e,t){const n=t.measure(Ve.COLLECT_DEPENDENCIES,()=>this.buildStrategy.run(e));this.dependencyGraph.getAndClearContentChanges(),t.measure(Ve.PROCESS_DEPENDENCIES,()=>this.processDependencies(n))}processDependencies(e){e.forEach((t,n)=>{this.dependencyGraph.processCellDependencies(t,n)})}}class ite{constructor(e,t,n,s,i,o){this.dependencyGraph=e,this.columnIndex=t,this.parser=n,this.stats=s,this.cellContentParser=i,this.arraySizePredictor=o}run(e){const t=new Map;for(const n in e){const s=this.dependencyGraph.getSheetId(n),i=e[n];for(let o=0;o<i.length;++o){const a=i[o];for(let l=0;l<a.length;++l){const u=a[l],c=he(s,l,o),h=this.cellContentParser.parse(u);if(h instanceof Ut.Formula){const d=this.stats.measure(Ve.PARSER,()=>this.parser.parse(h.formula,c));if(d.errors.length>0){this.shrinkArrayIfNeeded(c);const m=new vu(d.errors,h.formula);this.dependencyGraph.addVertex(c,m)}else{this.shrinkArrayIfNeeded(c);const m=this.arraySizePredictor.checkArraySize(d.ast,c);if(m.isScalar()){const E=new Ii(d.ast,c,0);t.set(E,Ni(d.dependencies,c)),this.dependencyGraph.addVertex(c,E),d.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(E),d.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(E)}else{const E=new or(d.ast,c,new Ze(m.width,m.height));t.set(E,Ni(d.dependencies,c)),this.dependencyGraph.addArrayVertex(c,E)}}}else if(!(h instanceof Ut.Empty)){this.shrinkArrayIfNeeded(c);const d=new ta(h.value,u);this.columnIndex.add(le(h.value),c),this.dependencyGraph.addVertex(c,d)}}}}return t}shrinkArrayIfNeeded(e){const t=this.dependencyGraph.getCell(e);t instanceof or&&this.dependencyGraph.shrinkArrayToCorner(t)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const mf=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class D1 extends Be{version(e,t){return this.runFunction(e.args,t,this.metadata("VERSION"),()=>{const{licenseKeyValidityState:n,licenseKey:s}=this.config;let i;return mf.has(s)?i=mf.get(s):mf.has(n)?i=mf.get(n):n==="valid"&&(i=s.slice(-5)),`HyperFormula v${Yr.version}, ${i}`})}}D1.implementedFunctions={VERSION:{method:"version",parameters:[]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function Hy(r,e){var t;let n=e.implementedFunctions[r];const s=(t=e.aliases)===null||t===void 0?void 0:t[r];if(s!==void 0){if(n!==void 0)throw new hJ(r,e.name);n=e.implementedFunctions[s]}if(n===void 0)throw Mu.functionNotDeclaredInPlugin(r,e.name);return n}class br{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=t=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(t),this.isFunctionVolatile=t=>this.volatileFunctions.has(t),this.isArrayFunction=t=>this.arrayFunctions.has(t),this.isFunctionDependentOnSheetStructureChange=t=>this.structuralChangeFunctions.has(t),e.functionPlugins.length>0){this.instancePlugins=new Map;for(const t of e.functionPlugins)br.loadPluginFunctions(t,this.instancePlugins)}else this.instancePlugins=new Map(br.plugins);for(const[t,n]of br.protectedFunctions())br.loadFunctionUnprotected(n,t,this.instancePlugins);for(const[t,n]of this.instancePlugins.entries())this.categorizeFunction(t,Hy(t,n))}static registerFunctionPlugin(e,t){this.loadPluginFunctions(e,this.plugins),t!==void 0&&this.loadTranslations(t)}static registerFunction(e,t,n){this.loadPluginFunction(t,e,this.plugins),n!==void 0&&this.loadTranslations(n)}static unregisterFunction(e){if(this.functionIsProtected(e))throw Za.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(const t of this.protectedPlugins())if(t===e)throw Za.cannotUnregisterProtectedPlugin();for(const[t,n]of this.plugins.entries())n===e&&this.plugins.delete(t)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){if(!this.functionIsProtected(e))return this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){const t=new Set(Yr.getRegisteredLanguagesCodes());Object.keys(e).forEach(n=>{t.has(n)&&Yr.getLanguage(n).extendFunctions(e[n])})}static loadPluginFunctions(e,t){Object.keys(e.implementedFunctions).forEach(n=>{this.loadPluginFunction(e,n,t)}),e.aliases!==void 0&&Object.keys(e.aliases).forEach(n=>{this.loadPluginFunction(e,n,t)})}static loadPluginFunction(e,t,n){if(this.functionIsProtected(t))throw Za.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,n)}static loadFunctionUnprotected(e,t,n){const s=Hy(t,e).method;if(Object.prototype.hasOwnProperty.call(e.prototype,s))n.set(t,e);else throw Mu.functionMethodNotFound(s,e.name)}static*protectedFunctions(){for(const[e,t]of this._protectedPlugins)t!==void 0&&(yield[e,t])}static*protectedPlugins(){for(const[,e]of this._protectedPlugins)e!==void 0&&(yield e)}initializePlugins(e){const t=[];for(const[n,s]of this.instancePlugins.entries()){let i=t.find(u=>u instanceof s);i===void 0&&(i=new s(e),t.push(i));const o=Hy(n,s),a=o.method;this.functions.set(n,[a,i]);const l=o.arraySizeMethod;l!==void 0&&this.arraySizeFunctions.set(n,[l,i])}}getFunctionPlugin(e){if(!br.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){const t=this.functions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[n,s]=t;return(i,o)=>s[n](i,o)}else return}getArraySizeFunction(e){const t=this.arraySizeFunctions.get(e);if(t!==void 0&&this.config.translationPackage.isFunctionTranslated(e)){const[n,s]=t;return(i,o)=>s[n](i,o)}else return}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){const e=new Set;for(const[t,n]of this.instancePlugins)br.functionIsProtected(t)||e.add(n);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.arrayFunction&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}br.plugins=new Map;br._protectedPlugins=new Map([["VERSION",D1],["OFFSET",void 0]]);/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var Pr;(function(r){r.GREATER_THAN="GREATER_THAN",r.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",r.LESS_THAN="LESS_THAN",r.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",r.NOT_EQUAL="NOT_EQUAL",r.EQUAL="EQUAL"})(Pr||(Pr={}));const pf=(r,e)=>({operator:r,value:e});class ote{constructor(e){var t,n,s,i;this.trueString=(n=(t=e.translationPackage.getMaybeFunctionTranslation("TRUE"))===null||t===void 0?void 0:t.toLowerCase())!==null&&n!==void 0?n:"true",this.falseString=(i=(s=e.translationPackage.getMaybeFunctionTranslation("FALSE"))===null||s===void 0?void 0:s.toLowerCase())!==null&&i!==void 0?i:"false"}fromCellValue(e,t){if(typeof e!="string"&&typeof e!="boolean"&&typeof e!="number")return;const n=this.parseCriterion(e,t);if(n!==void 0)return{raw:e,lambda:ute(n,t)}}parseCriterion(e,t){if(typeof e=="number"||typeof e=="boolean")return pf(Pr.EQUAL,e);if(typeof e=="string"){const n=ate.exec(e);let s,i;n?(i=lte(n[1]),s=n[2]):(i=Pr.EQUAL,s=e);const o=t.coerceToMaybeNumber(s),a=s.toLowerCase()===this.trueString?!0:s.toLowerCase()===this.falseString?!1:void 0;if(i===void 0)return;if(s==="")return pf(i,null);if(o===void 0){if(i===Pr.EQUAL||i===Pr.NOT_EQUAL)return pf(i,a??s)}else return pf(i,le(o))}}}const ate=/([<>=]+)(.*)/;function lte(r){switch(r){case">":return Pr.GREATER_THAN;case">=":return Pr.GREATER_THAN_OR_EQUAL;case"<":return Pr.LESS_THAN;case"<=":return Pr.LESS_THAN_OR_EQUAL;case"<>":return Pr.NOT_EQUAL;case"=":return Pr.EQUAL;default:return}}const ute=(r,e)=>{switch(r.operator){case Pr.GREATER_THAN:return typeof r.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,r.value)>0:t=>!1;case Pr.GREATER_THAN_OR_EQUAL:return typeof r.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,r.value)>=0:t=>!1;case Pr.LESS_THAN:return typeof r.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,r.value)<0:t=>!1;case Pr.LESS_THAN_OR_EQUAL:return typeof r.value=="number"?t=>typeof t=="number"&&e.floatCmp(t,r.value)<=0:t=>!1;case Pr.EQUAL:return typeof r.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,r.value)===0;if(typeof t=="string"){if(t==="")return!1;const n=e.coerceToMaybeNumber(t);return n===void 0?!1:e.floatCmp(n,r.value)===0}else return!1}:typeof r.value=="string"?e.eqMatcherFunction(r.value):typeof r.value=="boolean"?t=>typeof t=="boolean"&&t===r.value:t=>t===Xe;case Pr.NOT_EQUAL:return typeof r.value=="number"?t=>{if(typeof t=="number")return e.floatCmp(t,r.value)!==0;if(typeof t=="string"){if(t==="")return!0;const n=e.coerceToMaybeNumber(t);return n===void 0?!0:e.floatCmp(n,r.value)!==0}else return!0}:typeof r.value=="string"?e.neqMatcherFunction(r.value):typeof r.value=="boolean"?t=>typeof t!="boolean"||t!==r.value:t=>t!==Xe}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class cte{constructor(e,t,n,s,i,o,a,l,u,c){this.config=e,this.dependencyGraph=t,this.columnSearch=n,this.stats=s,this.arithmeticHelper=i,this.functionRegistry=o,this.namedExpressions=a,this.serialization=l,this.arraySizePredictor=u,this.dateTimeHelper=c,this.equalOp=(h,d)=>fs(this.arithmeticHelper.eq,h,d),this.notEqualOp=(h,d)=>fs(this.arithmeticHelper.neq,h,d),this.greaterThanOp=(h,d)=>fs(this.arithmeticHelper.gt,h,d),this.lessThanOp=(h,d)=>fs(this.arithmeticHelper.lt,h,d),this.greaterThanOrEqualOp=(h,d)=>fs(this.arithmeticHelper.geq,h,d),this.lessThanOrEqualOp=(h,d)=>fs(this.arithmeticHelper.leq,h,d),this.concatOp=(h,d)=>fs(this.arithmeticHelper.concat,nv(h),nv(d)),this.plusOp=(h,d)=>fs(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(h),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.minusOp=(h,d)=>fs(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(h),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.timesOp=(h,d)=>fs(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(h),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.powerOp=(h,d)=>fs(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(h),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.divOp=(h,d)=>fs(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(h),this.arithmeticHelper.coerceScalarToNumberOrError(d)),this.unaryMinusOp=h=>dN(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.percentOp=h=>dN(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(h)),this.unaryPlusOp=h=>this.arithmeticHelper.unaryPlus(h),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new ote(e)}evaluateAst(e,t){let n=this.evaluateAstWithoutPostprocessing(e,t);if(ct(n)){if(w1(le(n)))return new v(S.NUM,N.NaN);n=AR(n,R1(le(n)))}return n instanceof Ee&&n.height()===1&&n.width()===1&&([[n]]=n.data),hte(n,t.formulaVertex)}evaluateAstWithoutPostprocessing(e,t){switch(e.type){case C.EMPTY:return Xe;case C.CELL_REFERENCE:{const n=e.reference.toSimpleCellAddress(t.formulaAddress);return Fn(n)?new v(S.REF,N.BadRef):this.dependencyGraph.getCellValue(n)}case C.NUMBER:case C.STRING:return e.value;case C.CONCATENATE_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.concatOp,n,s,t)}case C.EQUALS_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.equalOp,n,s,t)}case C.NOT_EQUAL_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.notEqualOp,n,s,t)}case C.GREATER_THAN_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOp,n,s,t)}case C.LESS_THAN_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOp,n,s,t)}case C.GREATER_THAN_OR_EQUAL_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,n,s,t)}case C.LESS_THAN_OR_EQUAL_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOrEqualOp,n,s,t)}case C.PLUS_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.plusOp,n,s,t)}case C.MINUS_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.minusOp,n,s,t)}case C.TIMES_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.timesOp,n,s,t)}case C.POWER_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.powerOp,n,s,t)}case C.DIV_OP:{const n=this.evaluateAst(e.left,t),s=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.divOp,n,s,t)}case C.PLUS_UNARY_OP:{const n=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryPlusOp,n,t)}case C.MINUS_UNARY_OP:{const n=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryMinusOp,n,t)}case C.PERCENT_OP:{const n=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.percentOp,n,t)}case C.FUNCTION_CALL:{if(this.config.licenseKeyValidityState!=="valid"&&!br.functionIsProtected(e.procedureName))return new v(S.LIC,N.LicenseKey(this.config.licenseKeyValidityState));const n=this.functionRegistry.getFunction(e.procedureName);return n!==void 0?n(e,new xi(t.formulaAddress,t.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),t.formulaVertex)):new v(S.NAME,N.FunctionName(e.procedureName))}case C.NAMED_EXPRESSION:{const n=this.namedExpressions.nearestNamedExpression(e.expressionName,t.formulaAddress.sheet);return n?this.dependencyGraph.getCellValue(n.address):new v(S.NAME,N.NamedExpressionName(e.expressionName))}case C.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new v(S.REF,N.RangeManySheets);const n=we.fromCellRange(e,t.formulaAddress),s=this.dependencyGraph.getArray(n);if(s){const i=s.array;if(i instanceof Lc)throw new Error("Array should be already computed");if(i instanceof v)return i;if(i instanceof _u)return Ee.fromRange(i.raw(),n,this.dependencyGraph);throw new Error("Unknown array")}else return Ee.onlyRange(n,this.dependencyGraph)}case C.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new v(S.REF,N.RangeManySheets);const n=Eo.fromColumnRange(e,t.formulaAddress);return Ee.onlyRange(n,this.dependencyGraph)}case C.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new v(S.REF,N.RangeManySheets);const n=vo.fromRowRangeAst(e,t.formulaAddress);return Ee.onlyRange(n,this.dependencyGraph)}case C.PARENTHESIS:return this.evaluateAst(e.expression,t);case C.ARRAY:{let n;const s=[];for(const i of e.args){let o;const a=[];for(const u of i){const c=E1(this.evaluateAst(u,t)),h=c.height();if(o===void 0)o=h,a.push(...c.data);else if(o===h)for(let d=0;d<h;d++)a[d].push(...c.data[d]);else return new v(S.REF,N.SizeMismatch)}const l=a[0].length;if(n===void 0)n=l,s.push(...a);else if(n===l)s.push(...a);else return new v(S.REF,N.SizeMismatch)}return Ee.onlyValues(s)}case C.ERROR_WITH_RAW_INPUT:case C.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,t,n){var s;if(t instanceof Ee&&!n.arraysFlag&&(t=(s=qf(t,n))!==null&&s!==void 0?s:new v(S.VALUE,N.ScalarExpected)),t instanceof v)return t;if(t instanceof Ee){const i=t.data.map(o=>o.map(e));return Ee.onlyValues(i)}return e(t)}binaryRangeWrapper(e,t,n,s){var i,o;if(t instanceof Ee&&!s.arraysFlag&&(t=(i=qf(t,s))!==null&&i!==void 0?i:new v(S.VALUE,N.ScalarExpected)),t instanceof v)return t;if(n instanceof Ee&&!s.arraysFlag&&(n=(o=qf(n,s))!==null&&o!==void 0?o:new v(S.VALUE,N.ScalarExpected)),n instanceof v)return n;if(t instanceof Ee||n instanceof Ee){if(!(t instanceof Ee))if(n.isAdHoc()){const c=n.data;for(let h=0;h<c.length;h++)for(let d=0;d<c[0].length;d++)c[h][d]=e(t,c[h][d]);return Ee.onlyValues(c)}else t=Ee.fromScalar(t);if(!(n instanceof Ee))if(t.isAdHoc()){const c=t.data;for(let h=0;h<c.length;h++)for(let d=0;d<c[0].length;d++)c[h][d]=e(c[h][d],n);return Ee.onlyValues(c)}else n=Ee.fromScalar(n);if(t.width()===n.width()&&t.height()===n.height()){if(t.isAdHoc()){const c=t.data,h=n.data;for(let d=0;d<c.length;d++)for(let m=0;m<c[0].length;m++)c[d][m]=e(c[d][m],h[d][m]);return Ee.onlyValues(c)}if(n.isAdHoc()){const c=t.data,h=n.data;for(let d=0;d<c.length;d++)for(let m=0;m<c[0].length;m++)h[d][m]=e(c[d][m],h[d][m]);return Ee.onlyValues(h)}}const a=Math.max(t.width(),n.width()),l=Math.max(t.height(),n.height()),u=Array(l);for(let c=0;c<l;c++)u[c]=Array(a);for(let c=0;c<l;c++){const h=t.height()!==1?c:0,d=n.height()!==1?c:0;for(let m=0;m<a;m++){const E=t.width()!==1?m:0,g=n.width()!==1?m:0;h<t.height()&&d<n.height()&&E<t.width()&&g<n.width()?u[c][m]=e(t.data[h][E],n.data[d][g]):u[c][m]=new v(S.NA)}}return Ee.onlyValues(u)}return e(t,n)}}function dN(r,e){return e instanceof v?e:r(e)}function fs(r,e,t){return e instanceof v?e:t instanceof v?t:r(e,t)}function hte(r,e){return r instanceof v&&e!==void 0?r.attachRootVertex(e):r}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class dte{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,t){this.transformations.forEach(n=>n.performEagerTransformations(e,t))}transformSingleAst(e,t){let[n,s]=[e,t];return this.transformations.forEach(i=>{[n,s]=i.transformSingleAst(n,s)}),[n,s]}isIrreversible(){return!0}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class fte{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return this.combinedTransformer!==void 0?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new dte(e)}commitCombinedMode(){if(this.combinedTransformer===void 0)throw Error("Combined mode wasn't started");return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,t,n){this.stats.start(Ve.TRANSFORM_ASTS_POSTPONED);for(let i=n;i<this.transformations.length;i++){const o=this.transformations[i];o.isIrreversible()&&(this.undoRedo.storeDataForVersion(i,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));const[a,l]=o.transformSingleAst(e,t);e=a,t=l}const s=this.parser.rememberNewAst(e);return this.stats.end(Ve.TRANSFORM_ASTS_POSTPONED),[s,t,this.transformations.length]}*getTransformationsFrom(e,t){for(let n=e;n<this.transformations.length;n++){const s=this.transformations[n];(!t||t(s))&&(yield s)}}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Qf=-1;function mte(r,e,{searchCoordinate:t,orderingDirection:n,matchExactly:s},i){const o=e.start[t],a=t==="col"?e.effectiveEndColumn(i):e.effectiveEndRow(i),l=t==="col"?d=>le(i.getCellValue(he(e.sheet,d,e.start.row))):d=>le(i.getCellValue(he(e.sheet,e.start.col,d))),u=n==="asc"?(d,m)=>fN(d,m):(d,m)=>-fN(d,m),c=pte(d=>u(r,l(d))>=0,o,a),h=l(c);return c===Qf||typeof h!=typeof r||s&&h!==r?Qf:c-o}function pte(r,e,t){let n=e,s=t;for(;n<s;){const i=Math.ceil((n+s)/2);r(i)?n=i:s=i-1}return n===s&&r(n)?n:Qf}function fN(r,e){return typeof r==typeof e?r===Xe?0:r<e?-1:r>e?1:0:r===Xe?-1:e===Xe?1:e instanceof v||typeof r=="number"&&typeof e=="string"||typeof r=="number"&&typeof e=="boolean"?-1:typeof r=="string"&&typeof e=="number"?1:typeof r=="string"&&typeof e=="boolean"?-1:1}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class H1{constructor(e){this.dependencyGraph=e}advancedFind(e,t){let n;const s=t.range;s===void 0?n=t.valuesFromTopLeftCorner():n=this.dependencyGraph.computeListOfValuesInRange(s);for(let i=0;i<n.length;i++)if(e(le(n[i])))return i;return-1}basicFind(e,t,n,{ordering:s,matchExactly:i}){const o=typeof e=="string"?rh(e):e,a=t.range;return a===void 0?this.findNormalizedValue(o,t.valuesFromTopLeftCorner()):s==="none"?this.findNormalizedValue(o,this.dependencyGraph.computeListOfValuesInRange(a)):mte(o,a,{searchCoordinate:n,orderingDirection:s,matchExactly:i},this.dependencyGraph)}findNormalizedValue(e,t){return t.map(le).map(n=>typeof n=="string"?rh(n):n).indexOf(e)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class V1 extends H1{constructor(e){super(e),this.dependencyGraph=e}add(e,t){}remove(e,t){}change(e,t,n){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,t,n,s){}removeValues(e){}find(e,t,n){return this.basicFind(e,t,"row",n)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Ya{constructor(e,t,n){this.dependencyGraph=e,this.config=t,this.stats=n,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new V1(e)}add(e,t){if(!(e===Xe||e instanceof v))if(e instanceof Ee)for(const[n,s]of e.entriesFromTopLeftCorner(t))this.addSingleCellValue(le(n),s);else this.addSingleCellValue(e,t)}remove(e,t){if(e!==void 0)if(e instanceof Ee)for(const[n,s]of e.entriesFromTopLeftCorner(t))this.removeSingleValue(le(n),s);else this.removeSingleValue(e,t)}change(e,t,n){e!==t&&(this.remove(e,n),this.add(t,n))}applyChanges(e){for(const t of e)t.oldValue!==void 0&&this.change(le(t.oldValue),le(t.value),t.address)}moveValues(e,t,n,s){for(const[i,o]of e){const a=LJ(o,s,t,n);this.remove(i,o),this.add(i,a)}}removeValues(e){for(const[t,n]of e)this.remove(t,n)}find(e,t,{ordering:n,matchExactly:s}){const i=s===!0?"findFirst":"findLast",o=this.findUsingColumnIndex(e,t,i);return o!==void 0?o:this.binarySearchStrategy.find(e,t,{ordering:n,matchExactly:s})}findUsingColumnIndex(e,t,n){const s=t.range;if(s===void 0)return;this.ensureRecentData(s.sheet,s.start.col,e);const i=this.getColumnMap(s.sheet,s.start.col);if(!i)return-1;const o=typeof e=="string"?rh(e):e,a=i.get(o);if(!a||!a.index||a.index.length===0)return;const l=Ya.findRowBelongingToRange(a,s,n);return l!==void 0?l-s.start.row:void 0}static findRowBelongingToRange(e,t,n){const s=t.start.row,i=t.end.row,o=n==="findFirst"?Va(s,e.index,"upperBound"):Va(i,e.index,"lowerBound");if(o===-1)return;const a=e.index[o];return a>=s&&a<=i?a:void 0}advancedFind(e,t){return this.binarySearchStrategy.advancedFind(e,t)}addColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){const t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,t){this.index.has(e)||this.index.set(e,[]);const n=this.index.get(e);let s=n[t];return s||(s=new Map,n[t]=s),s}getValueIndex(e,t,n){const s=this.getColumnMap(e,t);let i=this.getColumnMap(e,t).get(n);return i||(i={version:this.transformingService.version(),index:[]},s.set(n,i)),i}ensureRecentData(e,t,n){const s=this.getValueIndex(e,t,n),i=this.transformingService.version();if(s.version===i)return;const o=this.transformingService.getTransformationsFrom(s.version,a=>a.sheet===e&&(a instanceof lv||a instanceof uv));for(const a of o)a instanceof lv?this.addRows(t,a.rowsSpan,n):a instanceof uv&&this.removeRows(t,a.rowsSpan,n);s.version=i}addSingleCellValue(e,t){this.stats.measure(Ve.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e),typeof e=="string"&&(e=rh(e));const n=this.getValueIndex(t.sheet,t.col,e);Ya.addValue(n,t.row)})}removeSingleValue(e,t){this.stats.measure(Ve.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e);const n=this.getColumnMap(t.sheet,t.col);typeof e=="string"&&(e=rh(e));const s=n.get(e);if(!s)return;const i=Va(t.row,s.index);i>-1&&s.index.splice(i,1),s.index.length===0&&n.delete(e),n.size===0&&delete this.index.get(t.sheet)[t.col]})}addRows(e,t,n){const s=this.getValueIndex(t.sheet,e,n);Ya.shiftRows(s,t.rowStart,t.numberOfRows)}removeRows(e,t,n){const s=this.getValueIndex(t.sheet,e,n);Ya.removeRowsFromValues(s,t),Ya.shiftRows(s,t.rowEnd+1,-t.numberOfRows)}static addValue(e,t){const n=Va(t,e.index,"lowerBound");e.index[n]===t||e.index.splice(n+1,0,t)}static removeRowsFromValues(e,t){const n=Va(t.rowStart,e.index,"upperBound"),s=Va(t.rowEnd,e.index,"lowerBound");n>-1&&s>-1&&n<=s&&e.index[n]<=t.rowEnd&&e.index.splice(n,s-n+1)}static shiftRows(e,t,n){const s=Va(t,e.index,"upperBound");if(s!==-1)for(let i=s;i<e.index.length;++i)e.index[i]+=n}}function Va(r,e,t="upperBound"){let n=0,s=e.length-1;for(;n<=s;){const a=Math.floor((n+s)/2);if(r>e[a])n=a+1;else if(r<e[a])s=a-1;else return a}const i=t==="lowerBound"?s:n;return i>=0&&i<=e.length?i:-1}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function gte(r,e,t){return e.useColumnIndex?new Ya(r,e,t):new V1(r)}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class yte{constructor(e){this.config=e;const t=this.config.thousandSeparator==="."?`\\${this.config.thousandSeparator}`:this.config.thousandSeparator,n=this.config.decimalSeparator==="."?`\\${this.config.decimalSeparator}`:this.config.decimalSeparator;this.numberPattern=new RegExp(`^([+-]?((${n}\\d+)|(\\d+(${t}\\d{3,})*(${n}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=new RegExp(`${t}`,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){const t=this.numericStringToNumber(e);return isNaN(t)?void 0:t}}numericStringToNumber(e){const t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class PR{constructor(e,t,n){this.dependencyGraph=e,this.unparser=t,this.exporter=n}getCellHyperlink(e){const t=this.dependencyGraph.getCell(e);if(t instanceof Ii){const n=t.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(n.procedureName==="HYPERLINK")return n.hyperlink}}getCellFormula(e,t){const n=this.dependencyGraph.getCell(e);if(n instanceof Ii){const s=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);return t=t??e,this.unparser.unparse(s,t)}else if(n instanceof or){const s=n.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(s.row!==e.row||s.col!==e.col||s.sheet!==e.sheet)return;t=t??e;const i=n.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(i!==void 0)return this.unparser.unparse(i,t)}else if(n instanceof vu)return n.getFormula()}getCellSerialized(e,t){var n;return(n=this.getCellFormula(e,t))!==null&&n!==void 0?n:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,t=>this.getCellValue(t))}getSheetFormulas(e){return this.genericSheetGetter(e,t=>this.getCellFormula(t))}genericSheetGetter(e,t){const n=this.dependencyGraph.getSheetHeight(e),s=this.dependencyGraph.getSheetWidth(e),i=new Array(n);for(let o=0;o<n;o++){i[o]=new Array(s);for(let a=0;a<s;a++){const l=he(e,a,o);i[o][a]=t(l)}for(let a=s-1;a>=0&&(i[o][a]===null||i[o][a]===void 0);a--)i[o].pop()}for(let o=n-1;o>=0&&i[o].length===0;o--)i.pop();return i}genericAllSheetsGetter(e){const t={};for(const n of this.dependencyGraph.sheetMapping.displayNames()){const s=this.dependencyGraph.sheetMapping.fetch(n);t[n]=e(s)}return t}getSheetSerialized(e){return this.genericSheetGetter(e,t=>this.getCellSerialized(t))}getAllSheetsValues(){return this.genericAllSheetsGetter(e=>this.getSheetValues(e))}getAllSheetsFormulas(){return this.genericAllSheetsGetter(e=>this.getSheetFormulas(e))}getAllSheetsSerialized(){return this.genericAllSheetsGetter(e=>this.getSheetSerialized(e))}getAllNamedExpressionsSerialized(){const e=[];let t=0;for(const n of this.dependencyGraph.sheetMapping.displayNames()){const s=this.dependencyGraph.sheetMapping.fetch(n);e[s]=t,t++}return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(n=>({name:n.expression.displayName,expression:this.getCellSerialized(n.expression.address),scope:n.scope!==void 0?e[n.scope]:void 0,options:n.expression.options}))}withNewConfig(e,t){const n=new Zx(e,NR(e),this.dependencyGraph.sheetMapping.fetchDisplayName,t);return new PR(this.dependencyGraph,n,this.exporter)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class gf{static buildFromSheets(e,t={},n=[]){const s=new Wr(t);return this.buildEngine(s,e,n)}static buildFromSheet(e,t={},n=[]){const s=new Wr(t),i=s.translationPackage.getUITranslation(bh.NEW_SHEET_PREFIX)+"1";return this.buildEngine(s,{[i]:e},n)}static buildEmpty(e={},t=[]){return this.buildEngine(new Wr(e),{},t)}static rebuildWithConfig(e,t,n,s){return this.buildEngine(e,t,n,s)}static buildEngine(e,t={},n=[],s=e.useStats?new t1:new lJ){s.start(Ve.BUILD_ENGINE_TOTAL);const i=new ll,o=new br(e),a=new fte(s),l=xR.buildEmpty(a,e,o,i,s),u=gte(l,e,s),c=l.sheetMapping,h=l.addressMapping;for(const _e in t)if(Object.prototype.hasOwnProperty.call(t,_e)){const tt=t[_e];M1(tt);const Ge=Jm(tt);if(Ge.height>e.maxRows||Ge.width>e.maxColumns)throw new Qa;const ke=c.addSheet(_e);h.autoAddSheet(ke,Ge)}const d=new eh(e,o,c.get);a.parser=d;const m=new Zx(e,NR(e),c.fetchDisplayName,i),E=new ree(e),g=new yte(e),O=new VJ(e,E,g),T=new Cee(e,E,g),_=new zJ(e,o),V=new xee(e,l,u,T,d,s,a,i,_),H=new ete(e,V);a.undoRedo=H;const Q=new Tee(e,l,V),oe=new tte(e,V,H,Q,l,u,d,T,a,i);n.forEach(_e=>{oe.ensureItIsPossibleToAddNamedExpression(_e.name,_e.expression,_e.scope),oe.operations.addNamedExpression(_e.name,_e.expression,_e.scope,_e.options)});const re=new nte(e,i,c.fetchDisplayName,a),ie=new PR(l,m,re),Fe=new cte(e,l,u,s,O,o,i,ie,_,E);s.measure(Ve.GRAPH_BUILD,()=>{new ste(l,u,d,T,s,_).buildGraph(t,s)});const Ie=new rte(e,s,Fe,a,l,u);return Ie.run(),s.end(Ve.BUILD_ENGINE_TOTAL),{config:e,stats:s,dependencyGraph:l,columnSearch:u,parser:d,unparser:m,cellContentParser:T,evaluator:Ie,lazilyTransformingAstService:a,crudOperations:oe,exporter:re,namedExpressions:i,serialization:ie,functionRegistry:o}}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function Ete(r){for(const[e,t]of Object.entries(r))t instanceof Function?r[e]=vte(t):delete r[e]}function vte(r){return()=>{throw new Error(`The "${r}" method cannot be called because this HyperFormula instance has been destroyed`)}}var U1={exports:{}};function FR(){}FR.prototype={on:function(r,e,t){var n=this.e||(this.e={});return(n[r]||(n[r]=[])).push({fn:e,ctx:t}),this},once:function(r,e,t){var n=this;function s(){n.off(r,s),e.apply(t,arguments)}return s._=e,this.on(r,s,t)},emit:function(r){var e=[].slice.call(arguments,1),t=((this.e||(this.e={}))[r]||[]).slice(),n=0,s=t.length;for(n;n<s;n++)t[n].fn.apply(t[n].ctx,e);return this},off:function(r,e){var t=this.e||(this.e={}),n=t[r],s=[];if(n&&e)for(var i=0,o=n.length;i<o;i++)n[i].fn!==e&&n[i].fn._!==e&&s.push(n[i]);return s.length?t[r]=s:delete t[r],this}};U1.exports=FR;var wte=U1.exports.TinyEmitter=FR;/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var Ci;(function(r){r.SheetAdded="sheetAdded",r.SheetRemoved="sheetRemoved",r.SheetRenamed="sheetRenamed",r.NamedExpressionAdded="namedExpressionAdded",r.NamedExpressionRemoved="namedExpressionRemoved",r.ValuesUpdated="valuesUpdated",r.EvaluationSuspended="evaluationSuspended",r.EvaluationResumed="evaluationResumed"})(Ci||(Ci={}));class Rte extends wte{emit(e,...t){return super.emit(e,...t),this}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Yr{constructor(e,t,n,s,i,o,a,l,u,c,h,d,m,E){this._config=e,this._stats=t,this._dependencyGraph=n,this._columnSearch=s,this._parser=i,this._unparser=o,this._cellContentParser=a,this._evaluator=l,this._lazilyTransformingAstService=u,this._crudOperations=c,this._exporter=h,this._namedExpressions=d,this._serialization=m,this._functionRegistry=E,this._emitter=new Rte,this._evaluationSuspended=!1}static get defaultConfig(){return Ste()}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,t={},n=[]){return this.buildFromEngineState(gf.buildFromSheet(e,t,n))}static buildFromSheets(e,t={},n=[]){return this.buildFromEngineState(gf.buildFromSheets(e,t,n))}static buildEmpty(e={},t=[]){return this.buildFromEngineState(gf.buildEmpty(e,t))}static getLanguage(e){J(e,"string","languageCode");const t=this.registeredLanguages.get(e);if(t===void 0)throw new JE;return t}static registerLanguage(e,t){if(J(e,"string","languageCode"),this.registeredLanguages.has(e))throw new p1;this.registeredLanguages.set(e,SJ(t))}static unregisterLanguage(e){if(J(e,"string","languageCode"),this.registeredLanguages.has(e))this.registeredLanguages.delete(e);else throw new JE}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,t){br.registerFunctionPlugin(e,t)}static unregisterFunctionPlugin(e){br.unregisterFunctionPlugin(e)}static registerFunction(e,t,n){J(e,"string","functionId"),br.registerFunction(e,t,n)}static unregisterFunction(e){J(e,"string","functionId"),br.unregisterFunction(e)}static unregisterAllFunctions(){br.unregisterAll()}static getRegisteredFunctionNames(e){J(e,"string","code");const t=br.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}static getFunctionPlugin(e){return J(e,"string","functionId"),br.getFunctionPlugin(e)}static getAllFunctionPlugins(){return br.getPlugins()}static buildFromEngineState(e){return new Yr(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!Zt(e))throw new lt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!Zt(e))throw new lt("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellHyperlink(e){if(!Zt(e))throw new lt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellHyperlink(e)}getCellSerialized(e){if(!Zt(e))throw new lt("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return J(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return J(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return J(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter(e=>this.getSheetDimensions(e))}getSheetDimensions(e){return J(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){Object.entries(e).every(([n,s])=>this._config[n]===s)||this.rebuildWithConfig(e)}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.rebuildWithConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let t;if(Zt(e))t=new we(e,e);else if(Gn(e))t=new we(e.start,e.end);else throw new lt("SimpleCellAddress | SimpleCellRange","address");try{this._crudOperations.ensureRangeInSizeLimits(t);for(const n of t.addresses(this._dependencyGraph))this._crudOperations.ensureItIsPossibleToChangeContent(n)}catch{return!1}return!0}setCellContents(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,t){return J(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,t){J(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch{return!1}}setRowOrder(e,t){J(e,"number","sheetId");const n=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,n)}isItPossibleToSetRowOrder(e,t){J(e,"number","sheetId");try{const n=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,n),this._crudOperations.testRowOrderForArrays(e,n),!0}catch{return!1}}swapColumnIndexes(e,t){return J(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,t){J(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch{return!1}}setColumnOrder(e,t){J(e,"number","sheetId");const n=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,n)}isItPossibleToSetColumnOrder(e,t){J(e,"number","sheetId");try{const n=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,n),this._crudOperations.testColumnOrderForArrays(e,n),!0}catch{return!1}}isItPossibleToAddRows(e,...t){J(e,"number","sheetId");const n=tp(t);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...n),!0}catch{return!1}}addRows(e,...t){return J(e,"number","sheetId"),this._crudOperations.addRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...t){J(e,"number","sheetId");const n=ep(t);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...n),!0}catch{return!1}}removeRows(e,...t){return J(e,"number","sheetId"),this._crudOperations.removeRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...t){J(e,"number","sheetId");const n=tp(t);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...n),!0}catch{return!1}}addColumns(e,...t){return J(e,"number","sheetId"),this._crudOperations.addColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...t){J(e,"number","sheetId");const n=ep(t);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...n),!0}catch{return!1}}removeColumns(e,...t){return J(e,"number","sheetId"),this._crudOperations.removeColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,t){if(!Zt(t))throw new lt("SimpleCellAddress","destinationLeftCorner");if(!Gn(e))throw new lt("SimpleCellRange","source");try{const n=new we(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(n.start,n.width(),n.height(),t),!0}catch{return!1}}moveCells(e,t){if(!Zt(t))throw new lt("SimpleCellAddress","destinationLeftCorner");if(!Gn(e))throw new lt("SimpleCellRange","source");const n=new we(e.start,e.end);return this._crudOperations.moveCells(n.start,n.width(),n.height(),t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,t,n,s){J(e,"number","sheetId"),J(t,"number","startRow"),J(n,"number","numberOfRows"),J(s,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,n,s),!0}catch{return!1}}moveRows(e,t,n,s){return J(e,"number","sheetId"),J(t,"number","startRow"),J(n,"number","numberOfRows"),J(s,"number","targetRow"),this._crudOperations.moveRows(e,t,n,s),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,t,n,s){J(e,"number","sheetId"),J(t,"number","startColumn"),J(n,"number","numberOfColumns"),J(s,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,n,s),!0}catch{return!1}}moveColumns(e,t,n,s){return J(e,"number","sheetId"),J(t,"number","startColumn"),J(n,"number","numberOfColumns"),J(s,"number","targetColumn"),this._crudOperations.moveColumns(e,t,n,s),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!Gn(e))throw new lt("SimpleCellRange","source");const t=new we(e.start,e.end);return this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e)}cut(e){if(!Gn(e))throw new lt("SimpleCellRange","source");const t=new we(e.start,e.end);return this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e)}paste(e){if(!Zt(e))throw new lt("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!Gn(e))throw new lt("SimpleCellRange","source");return new we(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(s=>this.getCellValue(s)))}getRangeFormulas(e){if(!Gn(e))throw new lt("SimpleCellRange","source");return new we(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(s=>this.getCellFormula(s)))}getRangeSerialized(e){if(!Gn(e))throw new lt("SimpleCellRange","source");return new we(e.start,e.end).arrayOfAddressesInRange().map(n=>n.map(s=>this.getCellSerialized(s)))}getFillRangeData(e,t,n=!1){if(!Gn(e))throw new lt("SimpleCellRange","source");if(!Gn(t))throw new lt("SimpleCellRange","target");const s=new we(e.start,e.end),i=new we(t.start,t.end);return this.ensureEvaluationIsNotSuspended(),i.arrayOfAddressesInRange().map(o=>o.map(a=>{const l=((a.row-(n?t:e).start.row)%s.height()+s.height())%s.height()+e.start.row,u=((a.col-(n?t:e).start.col)%s.width()+s.width())%s.width()+e.start.col;return this._serialization.getCellSerialized({row:l,col:u,sheet:s.sheet},a)}))}isItPossibleToAddSheet(e){J(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch{return!1}}addSheet(e){e!==void 0&&J(e,"string","sheetName");const t=this._crudOperations.addSheet(e);return this._emitter.emit(Ci.SheetAdded,t),t}isItPossibleToRemoveSheet(e){J(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}removeSheet(e){J(e,"number","sheetId");const t=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);const n=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Ci.SheetRemoved,t,n),n}isItPossibleToClearSheet(e){J(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch{return!1}}clearSheet(e){return J(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,t){J(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch{return!1}}setSheetContent(e,t){return J(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,t){return J(e,"string","cellAddress"),J(t,"number","sheetId"),kE(this.sheetMapping.get,e,t)}simpleCellRangeFromString(e,t){return J(e,"string","cellRange"),J(t,"number","sheetId"),lq(this.sheetMapping.get,e,t)}simpleCellAddressToString(e,t){if(!Zt(e))throw new lt("SimpleCellAddress","cellAddress");return J(t,"number","sheetId"),Pm(this.sheetMapping.fetchDisplayName,e,t)}simpleCellRangeToString(e,t){if(!Gn(e))throw new lt("SimpleCellRange","cellRange");return J(t,"number","sheetId"),uq(this.sheetMapping.fetchDisplayName,e,t)}getCellDependents(e){let t;if(Zt(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(Gn(e))t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new lt("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}getCellPrecedents(e){let t;if(Zt(e))t=this._dependencyGraph.addressMapping.getCell(e);else if(Gn(e))t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end);else throw new lt("SimpleCellAddress | SimpleCellRange",e);return t===void 0?[]:this._dependencyGraph.dependencyQueryAddresses(t)}getSheetName(e){return J(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return J(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return J(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!Zt(e))throw new lt("SimpleCellAddress","cellAddress");const t=this.dependencyGraph.getCell(e);return AJ(t,e)}doesCellHaveSimpleValue(e){if(!Zt(e))throw new lt("SimpleCellAddress","cellAddress");return this.getCellType(e)===_n.VALUE}doesCellHaveFormula(e){if(!Zt(e))throw new lt("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===_n.FORMULA||t===_n.ARRAYFORMULA}isCellEmpty(e){if(!Zt(e))throw new lt("SimpleCellAddress","cellAddress");return this.getCellType(e)===_n.EMPTY}isCellPartOfArray(e){if(!Zt(e))throw new lt("SimpleCellAddress","cellAddress");const t=this.getCellType(e);return t===_n.ARRAY||t===_n.ARRAYFORMULA}getCellValueType(e){if(!Zt(e))throw new lt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return Xm(t)}getCellValueDetailedType(e){if(!Zt(e))throw new lt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return IJ(t)}getCellValueFormat(e){if(!Zt(e))throw new lt("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();const t=this.dependencyGraph.getCellValue(e);return MJ(t)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,t){J(e,"number","sheetId"),J(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch{return!1}}renameSheet(e,t){J(e,"number","sheetId"),J(t,"string","newName");const n=this._crudOperations.renameSheet(e,t);n!==void 0&&this._emitter.emit(Ci.SheetRenamed,n,t)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(t){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),t}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(Ci.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;const e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Ci.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,t,n){J(e,"string","expressionName"),n!==void 0&&J(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,n),!0}catch{return!1}}addNamedExpression(e,t,n,s){J(e,"string","expressionName"),n!==void 0&&J(n,"number","scope"),this._crudOperations.addNamedExpression(e,t,n,s);const i=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Ci.NamedExpressionAdded,e,i),i}getNamedExpressionValue(e,t){J(e,"string","expressionName"),t!==void 0&&J(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);const n=this._namedExpressions.namedExpressionForScope(e,t);if(n)return this._serialization.getCellValue(n.address)}getNamedExpressionFormula(e,t){J(e,"string","expressionName"),t!==void 0&&J(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);const n=this._namedExpressions.namedExpressionForScope(e,t);if(n!==void 0)return this._serialization.getCellFormula(n.address)}getNamedExpression(e,t){J(e,"string","expressionName"),t!==void 0&&J(t,"number","scope");const n=this._namedExpressions.namedExpressionForScope(e,t);if(n===void 0)return;const s=this._serialization.getCellFormula(n.address);return{name:e,scope:t,expression:s,options:n.options}}isItPossibleToChangeNamedExpression(e,t,n){J(e,"string","expressionName"),n!==void 0&&J(n,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,n),!0}catch{return!1}}changeNamedExpression(e,t,n,s){return J(e,"string","expressionName"),n!==void 0&&J(n,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,n,t,s),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,t){J(e,"string","expressionName"),t!==void 0&&J(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch{return!1}}removeNamedExpression(e,t){J(e,"string","expressionName"),t!==void 0&&J(t,"number","scope");const n=this._crudOperations.removeNamedExpression(e,t);if(n){const s=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Ci.NamedExpressionRemoved,n.displayName,s),s}else return[]}listNamedExpressions(e){return e!==void 0&&J(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){J(e,"string","formulaString");const{ast:t,address:n}=this.extractTemporaryFormula(e);if(t===void 0)throw new Kf;return this._unparser.unparse(t,n)}calculateFormula(e,t){J(e,"string","formulaString"),J(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);const{ast:n,address:s,dependencies:i}=this.extractTemporaryFormula(e,t);if(n===void 0)throw new Kf;const o=this.evaluator.runAndForget(n,s,i);return this._exporter.exportScalarOrRange(o)}getNamedExpressionsFromFormula(e){J(e,"string","formulaString");const{ast:t,dependencies:n}=this.extractTemporaryFormula(e);if(t===void 0)throw new Kf;const s=n.filter(o=>o instanceof po).map(o=>o.name);return[...new Set(s)]}validateFormula(e){J(e,"string","formulaString");const{ast:t}=this.extractTemporaryFormula(e);return t!==void 0}getRegisteredFunctionNames(){return Yr.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return J(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return J(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return J(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return J(e,"number","val"),wu(e)}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}destroy(){Ete(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new f1}extractTemporaryFormula(e,t=1){const n=this._cellContentParser.parse(e),s={sheet:t,col:0,row:0};if(!(n instanceof Ut.Formula))return{address:s,dependencies:[]};const{ast:i,errors:o,dependencies:a}=this._parser.parse(n.formula,s);return o.length>0?{address:s,dependencies:[]}:{ast:i,address:s,dependencies:a}}rebuildWithConfig(e){const t=this._config.mergeConfig(e),n=this._config.mergeConfig({language:e.language}),s=this._serialization.withNewConfig(n,this._namedExpressions).getAllSheetsSerialized(),i=this._serialization.getAllNamedExpressionsSerialized(),o=gf.rebuildWithConfig(t,s,i,this._stats);this._config=o.config,this._stats=o.stats,this._dependencyGraph=o.dependencyGraph,this._columnSearch=o.columnSearch,this._parser=o.parser,this._unparser=o.unparser,this._cellContentParser=o.cellContentParser,this._evaluator=o.evaluator,this._lazilyTransformingAstService=o.lazilyTransformingAstService,this._crudOperations=o.crudOperations,this._exporter=o.exporter,this._namedExpressions=o.namedExpressions,this._serialization=o.serialization,this._functionRegistry=o.functionRegistry}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{const e=this._crudOperations.getAndClearContentChanges(),t=this.dependencyGraph.verticesToRecompute();this.dependencyGraph.clearDirtyVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));const n=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(Ci.ValuesUpdated,n),n}}}Yr.version="2.7.1";Yr.buildDate="18/07/2024 11:23:17";Yr.releaseDate="18/07/2024";Yr.languages={};Yr.registeredLanguages=new Map;/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const mN=new WeakMap;class Wr{constructor(e={},t=!0){const{accentSensitive:n,binarySearchThreshold:s,caseSensitive:i,caseFirst:o,chooseAddressMappingPolicy:a,context:l,currencySymbol:u,dateFormats:c,decimalSeparator:h,evaluateNullToZero:d,functionArgSeparator:m,functionPlugins:E,ignorePunctuation:g,leapYear1900:O,localeLang:T,language:_,ignoreWhiteSpace:V,licenseKey:H,matchWholeCell:Q,arrayColumnSeparator:oe,arrayRowSeparator:re,maxRows:ie,maxColumns:Fe,nullYear:Ie,nullDate:_e,parseDateTime:tt,precisionEpsilon:Ge,precisionRounding:ke,stringifyDateTime:nt,stringifyDuration:je,smartRounding:Ne,timeFormats:ue,thousandSeparator:Ae,useArrayArithmetic:bt,useStats:p,undoLimit:y,useColumnIndex:R,useRegularExpressions:x,useWildcards:P}=e;t&&Wr.warnDeprecatedOptions(e),this.useArrayArithmetic=pt(bt,"boolean","useArrayArithmetic"),this.accentSensitive=pt(n,"boolean","accentSensitive"),this.caseSensitive=pt(i,"boolean","caseSensitive"),this.caseFirst=pt(o,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=pt(g,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=a??Wr.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...cf(c,Array.isArray,"array","dateFormats")],this.timeFormats=[...cf(ue,Array.isArray,"array","timeFormats")],this.functionArgSeparator=pt(m,"string","functionArgSeparator"),this.decimalSeparator=pt(h,[".",","],"decimalSeparator"),this.language=pt(_,"string","language"),this.ignoreWhiteSpace=pt(V,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=pt(H,"string","licenseKey"),this.thousandSeparator=pt(Ae,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=pt(oe,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=pt(re,[";","|"],"arrayRowSeparator"),this.localeLang=pt(T,"string","localeLang"),this.functionPlugins=[...E??Wr.defaultConfig.functionPlugins],this.smartRounding=pt(Ne,"boolean","smartRounding"),this.evaluateNullToZero=pt(d,"boolean","evaluateNullToZero"),this.nullYear=pt(Ie,"number","nullYear"),Ul(this.nullYear,"nullYear",0),YJ(this.nullYear,"nullYear",100),this.precisionRounding=pt(ke,"number","precisionRounding"),Ul(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=pt(Ge,"number","precisionEpsilon"),Ul(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=pt(R,"boolean","useColumnIndex"),this.useStats=pt(p,"boolean","useStats"),this.binarySearchThreshold=s??Wr.defaultConfig.binarySearchThreshold,this.parseDateTime=pt(tt,"function","parseDateTime"),this.stringifyDateTime=pt(nt,"function","stringifyDateTime"),this.stringifyDuration=pt(je,"function","stringifyDuration"),this.translationPackage=Yr.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=cf(_e,nh,"IDate","nullDate"),this.leapYear1900=pt(O,"boolean","leapYear1900"),this.undoLimit=pt(y,"number","undoLimit"),this.useRegularExpressions=pt(x,"boolean","useRegularExpressions"),this.useWildcards=pt(P,"boolean","useWildcards"),this.matchWholeCell=pt(Q,"boolean","matchWholeCell"),Ul(this.undoLimit,"undoLimit",0),this.maxRows=pt(ie,"number","maxRows"),Ul(this.maxRows,"maxRows",1),this.maxColumns=pt(Fe,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(u),Ul(this.maxColumns,"maxColumns",1),this.context=l,mN.set(this,{licenseKeyValidityState:Eee(this.licenseKey)}),Jb({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),Jb({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){const t=[...cf(e,Array.isArray,"array","currencySymbol")];return t.forEach(n=>{if(typeof n!="string")throw new lt("string[]","currencySymbol");if(n==="")throw new cJ("currencySymbol")}),t}get licenseKeyValidityState(){return mN.get(this).licenseKeyValidityState}getConfig(){return k1(this)}mergeConfig(e){const t=Object.assign({},this.getConfig(),e);return Wr.warnDeprecatedOptions(e),new Wr(t,!1)}static warnDeprecatedOptions(e){Wr.warnDeprecatedIfUsed(e.binarySearchThreshold,"binarySearchThreshold","1.1")}static warnDeprecatedIfUsed(e,t,n,s){e!==void 0&&console.warn(s===void 0?`${t} option is deprecated since ${n}`:`${t} option is deprecated since ${n}, please use ${s}`)}}Wr.defaultConfig={accentSensitive:!1,binarySearchThreshold:20,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",context:void 0,chooseAddressMappingPolicy:new oee,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:QJ,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,stringifyDateTime:mee,stringifyDuration:fee,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1};function k1(r){var e;const t={};for(const n in Wr.defaultConfig){const s=(e=r[n])!==null&&e!==void 0?e:Wr.defaultConfig[n];Array.isArray(s)?t[n]=[...s]:t[n]=s}return t}function Ste(){return k1({})}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const hv={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ADDRESS:"ADDRESS",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",HYPERLINK:"HYPERLINK",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",IFS:"IFS",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */var $o;(function(r){r[r.FullyAbsolute=1]="FullyAbsolute",r[r.RowAbsoluteColRelative=2]="RowAbsoluteColRelative",r[r.RowRelativeColAbsolute=3]="RowRelativeColAbsolute",r[r.FullyRelative=4]="FullyRelative"})($o||($o={}));class B1 extends Be{verifyAddressArguments(e,t,n,s){if(s){if(e<1||t<1)return new v(S.VALUE,N.LessThanOne)}else if($o.FullyAbsolute==n){if(e<1||t<1)return new v(S.VALUE,N.LessThanOne)}else if($o.RowAbsoluteColRelative==n){if(e<1)return new v(S.VALUE,N.LessThanOne)}else if($o.RowRelativeColAbsolute==n&&t<1)return new v(S.VALUE,N.LessThanOne)}address(e,t){return this.runFunction(e.args,t,this.metadata("ADDRESS"),(n,s,i,o,a)=>{const l=this.verifyAddressArguments(n,s,i,o);if(l!==void 0)return l;const u=Gp(s-1);let c="";a!=null&&(c=`${a}!`);const h=s==0?"C":`C[${s}]`,d=n==0?"R":`R[${n}]`;return $o.FullyRelative==i?o?`${c}${u}${n}`:`${c}${d}${h}`:$o.RowRelativeColAbsolute==i?o?`${c}$${u}${n}`:`${c}${d}C${s}`:$o.RowAbsoluteColRelative==i?o?`${c}${u}$${n}`:`${c}R${n}${h}`:o?`${c}$${u}$${n}`:`${c}R${n}C${s}`})}}B1.implementedFunctions={ADDRESS:{method:"address",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER,optionalArg:!0,defaultValue:1,minValue:1,maxValue:4},{argumentType:f.BOOLEAN,optionalArg:!0,defaultValue:!0},{argumentType:f.STRING,optionalArg:!0}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class W1 extends Be{arrayformula(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),n=>n)}arrayformulaArraySize(e,t){if(e.args.length!==1)return Ze.error();const n=this.metadata("ARRAYFORMULA");return e.args.map(i=>{var o;return this.arraySizeForAst(i,new xi(t.formulaAddress,t.arraysFlag||((o=n==null?void 0:n.arrayFunction)!==null&&o!==void 0?o:!1)))})[0]}arrayconstrain(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),(n,s,i)=>{s=Math.min(s,n.height()),i=Math.min(i,n.width());const o=n.data,a=[];for(let l=0;l<s;l++)a.push(o[l].slice(0,i));return Ee.onlyValues(a)})}arrayconstrainArraySize(e,t){if(e.args.length!==3)return Ze.error();const n=this.metadata("ARRAY_CONSTRAIN"),s=e.args.map(a=>{var l;return this.arraySizeForAst(a,new xi(t.formulaAddress,t.arraysFlag||((l=n==null?void 0:n.arrayFunction)!==null&&l!==void 0?l:!1)))});let{height:i,width:o}=s[0];return e.args[1].type===C.NUMBER&&(i=Math.min(i,e.args[1].value)),e.args[2].type===C.NUMBER&&(o=Math.min(o,e.args[2].value)),i<1||o<1||!Number.isInteger(i)||!Number.isInteger(o)?Ze.error():new Ze(o,i)}filter(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),(n,...s)=>{for(const a of s)if(n.width()!==a.width()||n.height()!==a.height())return new v(S.NA,N.EqualLength);if(n.width()>1&&n.height()>1)return new v(S.NA,N.WrongDimension);const i=n.data,o=[];for(let a=0;a<n.height();a++){const l=[];for(let u=0;u<n.width();u++){let c=!0;for(const h of s)if(v1(h.data[a][u])!==!0){c=!1;break}c&&l.push(i[a][u])}l.length>0&&o.push(l)}return o.length>0?Ee.onlyValues(o):new v(S.NA,N.EmptyRange)})}filterArraySize(e,t){if(e.args.length<=1)return Ze.error();const n=this.metadata("FILTER"),s=e.args.map(a=>{var l;return this.arraySizeForAst(a,new xi(t.formulaAddress,t.arraysFlag||((l=n==null?void 0:n.arrayFunction)!==null&&l!==void 0?l:!1)))}),i=Math.max(...s.map(a=>a.width)),o=Math.max(...s.map(a=>a.height));return new Ze(i,o)}}W1.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:f.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:f.RANGE},{argumentType:f.INTEGER,minValue:1},{argumentType:f.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:f.RANGE},{argumentType:f.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class $1 extends Be{abs(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}$1.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:f.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Cte=0xffffffffffff,pN=-53,gN=53;class G1 extends Be{bitlshift(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),z1)}bitrshift(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),Y1)}}G1.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:f.INTEGER,minValue:0},{argumentType:f.INTEGER,minValue:pN,maxValue:gN}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:f.INTEGER,minValue:0},{argumentType:f.INTEGER,minValue:pN,maxValue:gN}]}};function z1(r,e){return e<0?Y1(r,-e):j1(r*Math.pow(2,e))}function Y1(r,e){return e<0?z1(r,-e):j1(Math.floor(r/Math.pow(2,e)))}function j1(r){return r>Cte?new v(S.NUM,N.BitshiftLong):r}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class K1 extends Be{bitand(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),(n,s)=>n&s)}bitor(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),(n,s)=>n|s)}bitxor(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),(n,s)=>n^s)}}K1.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:f.INTEGER,minValue:0},{argumentType:f.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:f.INTEGER,minValue:0},{argumentType:f.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:f.INTEGER,minValue:0},{argumentType:f.INTEGER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class X1 extends Be{literalTrue(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),()=>!0)}literalFalse(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),()=>!1)}conditionalIf(e,t){return this.runFunction(e.args,t,this.metadata("IF"),(n,s,i)=>n?s:i)}ifs(e,t){return this.runFunction(e.args,t,this.metadata("IFS"),(...n)=>{for(let s=0;s<n.length;s+=2)if(n[s])return n[s+1];return new v(S.NA,N.NoConditionMet)})}and(e,t){return this.runFunction(e.args,t,this.metadata("AND"),(...n)=>n.filter(s=>s!==void 0).every(s=>!!s))}or(e,t){return this.runFunction(e.args,t,this.metadata("OR"),(...n)=>n.filter(s=>s!==void 0).some(s=>s))}not(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),n=>!n)}xor(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),(...n)=>{let s=0;return n.filter(i=>i!==void 0).forEach(i=>{i&&s++}),s%2===1})}switch(e,t){return this.runFunction(e.args,t,this.metadata("SWITCH"),(n,...s)=>{const i=s.length;let o=0;for(;o+1<i;o+=2)if(!(s[o]instanceof v)&&this.arithmeticHelper.eq(n,s[o]))return s[o+1];return o<i?s[o]:new v(S.NA,N.NoDefault)})}iferror(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),(n,s)=>n instanceof v?s:n)}ifna(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),(n,s)=>n instanceof v&&n.type===S.NA?s:n)}choose(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),(n,...s)=>n>s.length?new v(S.NUM,N.Selector):s[n-1])}}X1.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:f.BOOLEAN},{argumentType:f.SCALAR,passSubtype:!0},{argumentType:f.SCALAR,defaultValue:!1,passSubtype:!0}]},IFS:{method:"ifs",parameters:[{argumentType:f.BOOLEAN},{argumentType:f.SCALAR,passSubtype:!0}],repeatLastArgs:2},AND:{method:"and",parameters:[{argumentType:f.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:f.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:f.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:f.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:f.NOERROR},{argumentType:f.SCALAR,passSubtype:!0},{argumentType:f.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:f.SCALAR,passSubtype:!0},{argumentType:f.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:f.SCALAR,passSubtype:!0},{argumentType:f.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:f.INTEGER,minValue:1},{argumentType:f.SCALAR,passSubtype:!0}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class q1 extends Be{char(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),n=>n<1||n>=256?new v(S.VALUE,N.CharacterCodeBounds):String.fromCharCode(Math.trunc(n)))}unichar(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),n=>n<1||n>=1114112?new v(S.VALUE,N.CharacterCodeBounds):String.fromCodePoint(Math.trunc(n)))}}q1.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:f.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:f.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Q1 extends Be{code(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),n=>n.length===0?new v(S.VALUE,N.EmptyString):n.charCodeAt(0))}unicode(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),n=>{var s;return(s=n.codePointAt(0))!==null&&s!==void 0?s:new v(S.VALUE,N.EmptyString)})}}Q1.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:f.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:f.STRING}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Z1 extends Be{countblank(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),(...n)=>{let s=0;return n.forEach(i=>{i===Xe&&s++}),s})}}Z1.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:f.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class J1 extends Be{countunique(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),(...n)=>{const s=new Set,i=new Set;for(const o of n)o instanceof v?i.add(o.type):o!==""&&s.add(o);return s.size+i.size})}}J1.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:f.SCALAR}],repeatLastArgs:1,expandRanges:!0}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class eL extends Be{constructor(){super(...arguments),this.isoweeknumCore=e=>{const t=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),n=this.dateTimeHelper.numberToSimpleDate(e),s=this.dateTimeHelper.dateToNumber({year:n.year,month:1,day:1}),i=this.dateTimeHelper.relativeNumberToAbsoluteNumber(s),o=i+((4-i)%7+7)%7,a=Math.floor((t-1)/7)-Math.floor((o-1)/7)+1;return a===0?this.isoweeknumCore(e-7)+1:a},this.days360Core=(e,t,n)=>{const s=this.dateTimeHelper.numberToSimpleDate(e),i=this.dateTimeHelper.numberToSimpleDate(t);let o,a;return n?(o=sN(s),a=sN(i)):[o,a]=this.dateTimeHelper.toBasisUS(s,i),360*(a.year-o.year)+30*(a.month-o.month)+a.day-o.day}}date(e,t){return this.runFunction(e.args,t,this.metadata("DATE"),(n,s,i)=>{const o=Math.trunc(i);let a=Math.trunc(s),l=Math.trunc(n);l<this.dateTimeHelper.getEpochYearZero()&&(l+=this.dateTimeHelper.getEpochYearZero());const u=Math.floor((a-1)/12);l+=u,a-=u*12;const c={year:l,month:a,day:1};if(this.dateTimeHelper.isValidDate(c)){let h=this.dateTimeHelper.dateToNumber(c)+(o-1);return h=this.dateTimeHelper.getWithinBounds(h),h===void 0?new v(S.NUM,N.DateBounds):h}return new v(S.VALUE,N.InvalidDate)})}time(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),(n,s,i)=>{const o=Ru({hours:Math.trunc(n),minutes:Math.trunc(s),seconds:Math.trunc(i)});return o<0?new v(S.NUM,N.NegativeTime):o%1})}eomonth(e,t){return this.runFunction(e.args,t,this.metadata("EOMONTH"),(n,s)=>{const i=this.dateTimeHelper.numberToSimpleDate(n);let o=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth(nN(i,s)));return o=this.dateTimeHelper.getWithinBounds(o),o===void 0?new v(S.NUM,N.DateBounds):o})}day(e,t){return this.runFunction(e.args,t,this.metadata("DAY"),n=>this.dateTimeHelper.numberToSimpleDate(n).day)}days(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),(n,s)=>Math.trunc(n)-Math.trunc(s))}month(e,t){return this.runFunction(e.args,t,this.metadata("MONTH"),n=>this.dateTimeHelper.numberToSimpleDate(n).month)}year(e,t){return this.runFunction(e.args,t,this.metadata("YEAR"),n=>this.dateTimeHelper.numberToSimpleDate(n).year)}hour(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),n=>wu(Fy(n)%1).hours)}minute(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),n=>wu(Fy(n)%1).minutes)}second(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),n=>wu(Fy(n)%1).seconds)}text(e,t){return this.runFunction(e.args,t,this.metadata("TEXT"),(n,s)=>cee(n,s,this.config,this.dateTimeHelper))}weekday(e,t){return this.runFunction(e.args,t,this.metadata("WEEKDAY"),(n,s)=>{const i=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(n));if(s===3)return(i-1)%7;const o=vN.get(s);return o===void 0?new v(S.NUM,N.BadMode):(i-o)%7+1})}weeknum(e,t){return this.runFunction(e.args,t,this.metadata("WEEKNUM"),(n,s)=>{const i=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(n)),o=this.dateTimeHelper.numberToSimpleDate(n),a=this.dateTimeHelper.dateToNumber({year:o.year,month:1,day:1}),l=this.dateTimeHelper.relativeNumberToAbsoluteNumber(a);if(s===21)return this.isoweeknumCore(n);const u=vN.get(s);return u===void 0?new v(S.NUM,N.BadMode):Math.floor((i-u)/7)-Math.floor((l-u)/7)+1})}isoweeknum(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,t){return this.runFunction(e.args,t,this.metadata("DATEVALUE"),n=>{const{dateTime:s}=this.dateTimeHelper.parseDateTimeFromConfigFormats(n);return s===void 0?new v(S.VALUE,N.IncorrectDateTime):nh(s)?(N1(s)?Math.trunc(Ru(s)):0)+this.dateTimeHelper.dateToNumber(s):0})}timevalue(e,t){return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),n=>{const s=this.dateTimeHelper.dateStringToDateNumber(n);return s===void 0?new v(S.VALUE,N.IncorrectDateTime):le(s)%1})}now(e,t){return this.runFunction(e.args,t,this.metadata("NOW"),()=>{const n=new Date(Date.now());return Ru({hours:n.getHours(),minutes:n.getMinutes(),seconds:n.getSeconds()})+this.dateTimeHelper.dateToNumber({year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate()})})}today(e,t){return this.runFunction(e.args,t,this.metadata("TODAY"),()=>{const n=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:n.getFullYear(),month:n.getMonth()+1,day:n.getDate()})})}edate(e,t){return this.runFunction(e.args,t,this.metadata("EDATE"),(n,s)=>{const i=this.dateTimeHelper.numberToSimpleDate(n),o=see(nN(i,s));let a=this.dateTimeHelper.dateToNumber(o);return a=this.dateTimeHelper.getWithinBounds(a),a===void 0?new v(S.NUM,N.DateBounds):a})}datedif(e,t){return this.runFunction(e.args,t,this.metadata("DATEDIF"),(n,s,i)=>{if(n>s)return new v(S.NUM,N.StartEndDate);if(i==="D")return Math.floor(s)-Math.floor(n);const o=this.dateTimeHelper.numberToSimpleDate(n),a=this.dateTimeHelper.numberToSimpleDate(s);switch(i){case"M":return(a.year-o.year)*12+(a.month-o.month)-(a.day<o.day?1:0);case"YM":return(12+(a.month-o.month)-(a.day<o.day?1:0))%12;case"Y":return a.month>o.month||a.month===o.month&&a.day>=o.day?a.year-o.year:a.year-o.year-1;case"MD":if(a.day>=o.day)return a.day-o.day;{const l=a.month===1?12:a.month-1,u=a.month===1?a.year-1:a.year;return this.dateTimeHelper.daysInMonth(u,l)+a.day-o.day}case"YD":return a.month>o.month||a.month===o.month&&a.day>=o.day?Math.floor(s)-this.dateTimeHelper.dateToNumber({year:a.year,month:o.month,day:o.day}):Math.floor(s)-Math.floor(n)-365*(a.year-o.year-1)-this.dateTimeHelper.leapYearsCount(a.year-1)+this.dateTimeHelper.leapYearsCount(o.year);default:return new v(S.NUM,N.BadMode)}})}days360(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,t){return this.runFunction(e.args,t,this.metadata("YEARFRAC"),(n,s,i)=>{switch(n=Math.trunc(n),s=Math.trunc(s),n>s&&([n,s]=[s,n]),i){case 0:return this.days360Core(n,s,!1)/360;case 1:return(s-n)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(n),this.dateTimeHelper.numberToSimpleDate(s));case 2:return(s-n)/360;case 3:return(s-n)/365;case 4:return this.days360Core(n,s,!0)/360}throw new Error("Should not be reachable.")})}interval(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),n=>{n=Math.trunc(n);const s=n%60;n=Math.trunc(n/60);const i=n%60;n=Math.trunc(n/60);const o=n%24;n=Math.trunc(n/24);const a=n%30;n=Math.trunc(n/30);const l=n%12,u=Math.trunc(n/12);return"P"+(u>0?`${u}Y`:"")+(l>0?`${l}M`:"")+(a>0?`${a}D`:"")+"T"+(o>0?`${o}H`:"")+(i>0?`${i}M`:"")+(s>0?`${s}S`:"")})}networkdays(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),(n,s,i)=>this.networkdayscore(n,s,1,i))}networkdaysintl(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),(n,s,i,o)=>this.networkdayscore(n,s,i,o))}workday(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY"),(n,s,i)=>this.workdaycore(n,s,1,i))}workdayintl(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),(n,s,i,o)=>this.workdaycore(n,s,i,o))}networkdayscore(e,t,n,s){e=Math.trunc(e),t=Math.trunc(t);let i=1;e>t&&([e,t]=[t,e],i=-1);const o=EN(n);if(o instanceof v)return o;const a=this.simpleRangeToFilteredHolidays(o,s);return a instanceof v?a:i*this.countWorkdays(e,t,o,a)}workdaycore(e,t,n,s){e=Math.trunc(e),t=Math.trunc(t);const i=EN(n);if(i instanceof v)return i;const o=this.simpleRangeToFilteredHolidays(i,s);if(o instanceof v)return o;if(t>0){let a=1;for(;this.countWorkdays(e+1,e+a,i,o)<t;)a*=2;let l=1;for(;l+1<a;){const u=Math.trunc((l+a)/2);this.countWorkdays(e+1,e+u,i,o)<t?l=u:a=u}return e+a}else if(t<0){t*=-1;let a=1;for(;this.countWorkdays(e-a,e-1,i,o)<t;)a*=2;let l=1;for(;l+1<a;){const u=Math.trunc((l+a)/2);this.countWorkdays(e-u,e-1,i,o)<t?l=u:a=u}return e-a}else return e}countWorkdays(e,t,n,s){const i=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),o=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));let a=0;for(let l=0;l<7;l++)n.charAt(l)==="0"&&(a+=Math.floor((i+6-l)/7),a-=Math.floor((o-1+6-l)/7));return a-=yN(t+1,s)-yN(e,s),a}simpleRangeToFilteredHolidays(e,t){var n;const s=(n=t==null?void 0:t.valuesFromTopLeftCorner())!==null&&n!==void 0?n:[];for(const o of s)if(o instanceof v)return o;const i=[];for(const o of s)if(o!==Xe)if(ct(o))i.push(Math.trunc(le(o)));else return new v(S.VALUE,N.WrongType);return[...new Set(i)].sort((o,a)=>o-a).filter(o=>{const l=(this.dateTimeHelper.relativeNumberToAbsoluteNumber(o)-1)%7;return e.charAt(l)==="0"})}}eL.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER}],returnNumberType:ge.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER}],returnNumberType:ge.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:f.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:f.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:f.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:f.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:f.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:f.NUMBER},{argumentType:f.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER}],returnNumberType:ge.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:f.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:f.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:f.STRING}],returnNumberType:ge.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:f.STRING}],returnNumberType:ge.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:ge.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:ge.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER}],returnNumberType:ge.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:0},{argumentType:f.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:0},{argumentType:f.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:0},{argumentType:f.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:f.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:0},{argumentType:f.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:0},{argumentType:f.NOERROR,defaultValue:1},{argumentType:f.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER},{argumentType:f.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER},{argumentType:f.NOERROR,defaultValue:1},{argumentType:f.RANGE,optionalArg:!0}]}};function yN(r,e){if(e.length===0||r<=e[0])return 0;if(e[e.length-1]<r)return e.length;let t=0,n=e.length-1;for(;t+1<n;){const s=Math.floor((n+t)/2);e[s]>=r?n=s:t=s}return n}function EN(r){var e;return typeof r!="number"&&typeof r!="string"?new v(S.VALUE,N.WrongType):typeof r=="string"?r.length!==7||!/^(0|1)*$/.test(r)||r==="1111111"?new v(S.NUM,N.WeekendString):r:(e=Tte.get(r))!==null&&e!==void 0?e:new v(S.NUM,N.BadMode)}const vN=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),Tte=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class tL extends Be{degrees(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),n=>n*(180/Math.PI))}}tL.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:f.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class rL extends Be{delta(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),(n,s)=>n===s?1:0)}}rL.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,defaultValue:0}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class nL extends Be{exp(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}nL.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:f.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class sL extends Be{pmt(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),DR)}ipmt(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),dv)}ppmt(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),wN)}fv(e,t){return this.runFunction(e.args,t,this.metadata("FV"),fv)}cumipmt(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),(n,s,i,o,a,l)=>{if(o>a)return new v(S.NUM,N.EndStartPeriod);let u=0;for(let c=o;c<=a;c++)u+=dv(n,c,s,i,0,l);return u})}cumprinc(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),(n,s,i,o,a,l)=>{if(o>a)return new v(S.NUM,N.EndStartPeriod);let u=0;for(let c=o;c<=a;c++)u+=wN(n,c,s,i,0,l);return u})}db(e,t){return this.runFunction(e.args,t,this.metadata("DB"),(n,s,i,o,a)=>{if(a===12&&o>i||o>i+1)return new v(S.NUM,N.PeriodLong);if(s>=n)return 0;const l=Math.round((1-Math.pow(s/n,1/i))*1e3)/1e3,u=n*l*a/12;if(o===1)return u;let c=u;for(let h=0;h<o-2;h++)c+=(n-c)*l;return o===i+1?(n-c)*l*(12-a)/12:(n-c)*l})}ddb(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),(n,s,i,o,a)=>{if(o>i)return new v(S.NUM);let l=a/i,u;l>=1?(l=1,o===1?u=n:u=0):u=n*Math.pow(1-l,o-1);const c=n*Math.pow(1-l,o);return Math.max(u-Math.max(s,c),0)})}dollarde(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),(n,s)=>{if(s<1)return new v(S.DIV_BY_ZERO);for(s=Math.trunc(s);s>10;)s/=10;return Math.trunc(n)+(n-Math.trunc(n))*10/s})}dollarfr(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),(n,s)=>{if(s<1)return new v(S.DIV_BY_ZERO);for(s=Math.trunc(s);s>10;)s/=10;return Math.trunc(n)+(n-Math.trunc(n))*s/10})}effect(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),(n,s)=>(s=Math.trunc(s),Math.pow(1+n/s,s)-1))}ispmt(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),(n,s,i,o)=>i===0?new v(S.DIV_BY_ZERO):o*n*(s/i-1))}nominal(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),(n,s)=>(s=Math.trunc(s),(Math.pow(n+1,1/s)-1)*s))}nper(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),(n,s,i,o,a)=>n===0?s===0?new v(S.DIV_BY_ZERO):(-i-o)/s:(a&&(s*=1+n),Math.log((s-o*n)/(i*n+s))/Math.log(1+n)))}rate(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),(n,s,i,o,a,l)=>{if(l<=-1)return new v(S.VALUE);const u=1e-7,c=50;let h=l;a=a?1:0;for(let d=0;d<c;d++){if(h<=-1)return new v(S.NUM);let m;if(Math.abs(h)<u)m=i*(1+n*h)+s*(1+h*a)*n+o;else{const g=Math.pow(1+h,n);m=i*g+s*(1/h+a)*(g-1)+o}if(Math.abs(m)<u)return h;let E;if(Math.abs(h)<u)E=i*n+s*a*n;else{const g=Math.pow(1+h,n),O=n*Math.pow(1+h,n-1);E=i*O+s*(1/h+a)*O+s*(-1/(h*h))*(g-1)}h-=m/E}return new v(S.NUM)})}pv(e,t){return this.runFunction(e.args,t,this.metadata("PV"),(n,s,i,o,a)=>(a=a?1:0,n===-1?s===0?new v(S.NUM):new v(S.DIV_BY_ZERO):n===0?-i*s-o:((1-Math.pow(1+n,s))*i*(1+n*a)/n-o)/Math.pow(1+n,s)))}rri(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),(n,s,i)=>s===0||i<0&&s>0||i>0&&s<0?new v(S.NUM):Math.pow(i/s,1/n)-1)}sln(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),(n,s,i)=>i===0?new v(S.DIV_BY_ZERO):(n-s)/i)}syd(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),(n,s,i,o)=>o>i?new v(S.NUM):(n-s)*(i-o+1)*2/(i*(i+1)))}tbilleq(e,t){return this.runFunction(e.args,t,this.metadata("TBILLEQ"),(n,s,i)=>{if(n=Math.round(n),s=Math.round(s),n>=s)return new v(S.NUM);const o=this.dateTimeHelper.numberToSimpleDate(n),a=this.dateTimeHelper.numberToSimpleDate(s);if(a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day))return new v(S.NUM);const l=360-i*(s-n);return l===0?0:l<0?new v(S.NUM):365*i/l})}tbillprice(e,t){return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),(n,s,i)=>{if(n=Math.round(n),s=Math.round(s),n>=s)return new v(S.NUM);const o=this.dateTimeHelper.numberToSimpleDate(n),a=this.dateTimeHelper.numberToSimpleDate(s);if(a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day))return new v(S.NUM);const l=360-i*(s-n);return l===0?0:l<0?new v(S.NUM):100*(1-i*(s-n)/360)})}tbillyield(e,t){return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),(n,s,i)=>{if(n=Math.round(n),s=Math.round(s),n>=s)return new v(S.NUM);const o=this.dateTimeHelper.numberToSimpleDate(n),a=this.dateTimeHelper.numberToSimpleDate(s);return a.year>o.year+1||a.year===o.year+1&&(a.month>o.month||a.month===o.month&&a.day>o.day)?new v(S.NUM):(100-i)*360/(i*(s-n))})}fvschedule(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),(n,s)=>{const i=s.valuesFromTopLeftCorner();for(const o of i)if(o instanceof v)return o;for(const o of i)if(ct(o))n*=1+le(o);else if(o!==Xe)return new v(S.VALUE,N.NumberExpected);return n})}npv(e,t){return this.runFunction(e.args,t,this.metadata("NPV"),(n,...s)=>{const i=this.arithmeticHelper.coerceNumbersExactRanges(s);return i instanceof v?i:Vy(n,i)})}mirr(e,t){return this.runFunction(e.args,t,this.metadata("MIRR"),(n,s,i)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());if(o instanceof v)return o;let a=!1,l=!1;const u=[],c=[];for(const E of o)E>0?(a=!0,u.push(E),c.push(0)):E<0?(l=!0,c.push(E),u.push(0)):(c.push(0),u.push(0));if(!a||!l)return new v(S.DIV_BY_ZERO);const h=o.length,d=Vy(i,u);if(d instanceof v)return d;const m=Vy(s,c);return m instanceof v?m:Math.pow(-d*Math.pow(1+i,h)/m/(1+s),1/(h-1))-1})}pduration(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),(n,s,i)=>(Math.log(i)-Math.log(s))/Math.log(1+n))}xnpv(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),(n,s,i)=>{const o=s.valuesFromTopLeftCorner();for(const d of o)if(typeof d!="number")return new v(S.VALUE,N.NumberExpected);const a=o,l=i.valuesFromTopLeftCorner();for(const d of l)if(typeof d!="number")return new v(S.VALUE,N.NumberExpected);const u=l;if(u.length!==a.length)return new v(S.NUM,N.EqualLength);const c=u.length;let h=0;if(u[0]<0)return new v(S.NUM,N.ValueSmall);for(let d=0;d<c;d++){if(u[d]=Math.floor(u[d]),u[d]<u[0])return new v(S.NUM,N.ValueSmall);h+=a[d]/Math.pow(1+n,(u[d]-u[0])/365)}return h})}}sL.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER,defaultValue:0},{argumentType:f.NUMBER,defaultValue:0}],returnNumberType:ge.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER,defaultValue:0},{argumentType:f.NUMBER,defaultValue:0}],returnNumberType:ge.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER,defaultValue:0},{argumentType:f.NUMBER,defaultValue:0}],returnNumberType:ge.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER,defaultValue:0},{argumentType:f.NUMBER,defaultValue:0}],returnNumberType:ge.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.INTEGER,minValue:1},{argumentType:f.INTEGER,minValue:1},{argumentType:f.INTEGER,minValue:0,maxValue:1}],returnNumberType:ge.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.INTEGER,minValue:1},{argumentType:f.INTEGER,minValue:1},{argumentType:f.INTEGER,minValue:0,maxValue:1}],returnNumberType:ge.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:0},{argumentType:f.INTEGER,minValue:0},{argumentType:f.INTEGER,minValue:0},{argumentType:f.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:ge.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:0},{argumentType:f.INTEGER,minValue:0},{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:ge.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:1}],returnNumberType:ge.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:1}],returnNumberType:ge.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER,defaultValue:0},{argumentType:f.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER,defaultValue:0},{argumentType:f.NUMBER,defaultValue:0}],returnNumberType:ge.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER,defaultValue:0},{argumentType:f.NUMBER,defaultValue:0},{argumentType:f.NUMBER,defaultValue:.1}],returnNumberType:ge.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER},{argumentType:f.NUMBER}],returnNumberType:ge.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER}],returnNumberType:ge.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER,greaterThan:0}],returnNumberType:ge.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,greaterThan:0}],returnNumberType:ge.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,greaterThan:0}],returnNumberType:ge.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,greaterThan:0}],returnNumberType:ge.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:f.NUMBER},{argumentType:f.RANGE}],returnNumberType:ge.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:f.NUMBER},{argumentType:f.ANY}],repeatLastArgs:1,returnNumberType:ge.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:f.RANGE},{argumentType:f.NUMBER},{argumentType:f.NUMBER}],returnNumberType:ge.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:f.NUMBER,greaterThan:-1},{argumentType:f.RANGE},{argumentType:f.RANGE}]}};function DR(r,e,t,n,s){if(r===0)return(-t-n)/e;{const i=Math.pow(1+r,e);return(n*r+t*r*i)*(s?1/(1+r):1)/(1-i)}}function dv(r,e,t,n,s,i){const o=DR(r,t,n,s,i);return e===1?r*(i?0:-n):r*(i?fv(r,e-2,o,n,i)-o:fv(r,e-1,o,n,i))}function fv(r,e,t,n,s){if(r===0)return-n-t*e;{const i=Math.pow(1+r,e);return t*(s?1+r:1)*(1-i)/r-n*i}}function wN(r,e,t,n,s,i){return DR(r,t,n,s,i)-dv(r,e,t,n,s,i)}function Vy(r,e){let t=0;for(let n=e.length-1;n>=0;n--){if(t+=e[n],r===-1){if(t===0)continue;return new v(S.DIV_BY_ZERO)}t/=1+r}return t}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class iL extends Be{formulatext(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),()=>new v(S.NA,N.WrongArgNumber),n=>{var s;return(s=this.serialization.getCellFormula(n))!==null&&s!==void 0?s:new v(S.NA,N.Formula)})}}iL.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:f.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class oL extends Be{hyperlink(e,t){return this.runFunction(e.args,t,this.metadata("HYPERLINK"),(n,s)=>(e.hyperlink=n,s??n))}}oL.implementedFunctions={HYPERLINK:{method:"hyperlink",parameters:[{argumentType:f.STRING},{argumentType:f.STRING,optionalArg:!0}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class aL extends Be{isbinary(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),n=>/^[01]{1,10}$/.test(n))}iserr(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),n=>n instanceof v&&n.type!==S.NA)}iserror(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),n=>n instanceof v)}isformula(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),()=>new v(S.NA,N.WrongArgNumber),n=>this.dependencyGraph.addressMapping.getCell(n)instanceof qn)}isblank(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),n=>n===Xe)}isna(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),n=>n instanceof v&&n.type==S.NA)}isnumber(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),ct)}islogical(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),n=>typeof n=="boolean")}isref(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),n=>n instanceof v&&(n.type==S.REF||n.type==S.CYCLE))}istext(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),n=>typeof n=="string")}isnontext(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),n=>typeof n!="string")}column(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),()=>t.formulaAddress.col+1,n=>n.col+1)}columns(e,t){if(e.args.length!==1)return new v(S.NA,N.WrongArgNumber);if(e.args.some(s=>s.type===C.EMPTY))return new v(S.NUM,N.EmptyArg);let n=e.args[0];for(;n.type===C.PARENTHESIS;)n=n.expression;if(n.type===C.CELL_RANGE||n.type===C.COLUMN_RANGE)return n.end.col-n.start.col+1;if(n.type===C.CELL_REFERENCE)return 1;if(n.type===C.ROW_RANGE)return this.config.maxColumns;{const s=this.evaluateAst(n,t);return s instanceof Ee?s.width():s instanceof v?s:1}}row(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),()=>t.formulaAddress.row+1,n=>n.row+1)}rows(e,t){if(e.args.length!==1)return new v(S.NA,N.WrongArgNumber);if(e.args.some(s=>s.type===C.EMPTY))return new v(S.NUM,N.EmptyArg);let n=e.args[0];for(;n.type===C.PARENTHESIS;)n=n.expression;if(n.type===C.CELL_RANGE||n.type===C.ROW_RANGE)return n.end.row-n.start.row+1;if(n.type===C.CELL_REFERENCE)return 1;if(n.type===C.COLUMN_RANGE)return this.config.maxRows;{const s=this.evaluateAst(n,t);return s instanceof Ee?s.height():s instanceof v?s:1}}index(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),(n,s,i)=>{var o,a,l,u,c,h;return i<1||s<1?new v(S.VALUE,N.LessThanOne):i>n.width()||s>n.height()?new v(S.NUM,N.ValueLarge):(h=(l=(a=(o=n==null?void 0:n.data)===null||o===void 0?void 0:o[s-1])===null||a===void 0?void 0:a[i-1])!==null&&l!==void 0?l:(c=(u=n==null?void 0:n.data)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c[0])!==null&&h!==void 0?h:new v(S.VALUE,N.CellRangeExpected)})}na(e,t){return new v(S.NA)}sheet(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),()=>t.formulaAddress.sheet+1,n=>n.sheet+1,n=>{const s=this.dependencyGraph.sheetMapping.get(n);return s!==void 0?s+1:new v(S.NA,N.SheetRef)})}sheets(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),()=>this.dependencyGraph.sheetMapping.numberOfSheets(),()=>1,()=>new v(S.VALUE,N.CellRefExpected))}}aL.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:f.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:f.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:f.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:f.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:f.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:f.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:f.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:f.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:f.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:f.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:f.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:f.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:f.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:f.RANGE},{argumentType:f.NUMBER},{argumentType:f.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:f.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:f.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:f.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:f.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class lL extends Be{iseven(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),n=>n%2===0)}}lL.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:f.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class uL extends Be{isodd(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),n=>n%2===1)}}uL.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:f.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class cL extends Be{log10(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}log(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),(n,s)=>Math.log(n)/Math.log(s))}ln(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}cL.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:f.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:f.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const mv=parseFloat(Math.PI.toFixed(14));class hL extends Be{pi(e,t){return this.runFunction(e.args,t,this.metadata("PI"),()=>mv)}sqrtpi(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),n=>Math.sqrt(mv*n))}}hL.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:f.NUMBER,minValue:0}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function RN(r,e){return new Ze(e.width,r.height)}function Uy(r,e,t){return new Ze(1+(r.width-e)/t,1+(r.height-e)/t)}class dL extends Be{mmult(e,t){return this.runFunction(e.args,t,this.metadata("MMULT"),(n,s)=>{if(!n.hasOnlyNumbers()||!s.hasOnlyNumbers())return new v(S.VALUE,N.NumberRange);if(s.height()!==n.width())return new v(S.VALUE,N.ArrayDimensions);const i=RN(n.size,s.size),o=this.createKernel(function(a,l,u){let c=0;for(let h=0;h<u;++h)c+=a[this.thread.y][h]*l[h][this.thread.x];return c},i)(n.rawNumbers(),s.rawNumbers(),n.width());return Ee.onlyNumbers(o)})}mmultArraySize(e,t){if(e.args.length!==2)return Ze.error();const n=this.metadata("MMULT"),s=e.args.map(a=>{var l;return this.arraySizeForAst(a,new xi(t.formulaAddress,t.arraysFlag||((l=n==null?void 0:n.arrayFunction)!==null&&l!==void 0?l:!1)))}),[i,o]=s;return RN(i,o)}maxpool(e,t){return this.runFunction(e.args,t,this.metadata("MAXPOOL"),(n,s,i=s)=>{if(!n.hasOnlyNumbers())return new v(S.VALUE,N.NumberRange);const o=Uy(n.size,s,i),a=this.createKernel(function(l,u,c){const h=this.thread.x*c,d=this.thread.y*c;let m=l[d][h];for(let E=0;E<u;E++)for(let g=0;g<u;g++)m=Math.max(m,l[d+E][h+g]);return m},o)(n.rawNumbers(),s,i);return Ee.onlyNumbers(a)})}medianpool(e,t){return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),(n,s,i=s)=>{if(!n.hasOnlyNumbers())return new v(S.VALUE,N.NumberRange);const o=Uy(n.size,s,i),a=this.createKernel(function(l,u,c){const h=this.thread.x*c,d=this.thread.y*c;let m=l[d][h];for(let V=0;V<u;V++)for(let H=0;H<u;H++)m=Math.max(m,l[d+V][h+H]);let E=l[d][h];for(let V=0;V<u;V++)for(let H=0;H<u;H++)E=Math.min(E,l[d+V][h+H]);const g=u*u;let O=E,T=m,_=42;for(let V=0;V<32;V++){const H=(O+T)/2;let Q=0;for(let oe=0;oe<u;oe++)for(let re=0;re<u;re++)l[d+oe][h+re]>H&&Q++;if(u%2===0)if(Q===g/2){_=H;break}else Q>g/2?O=H:T=H;else if(Q===(g-1)/2){_=H;break}else Q>(g-1)/2?O=H:T=H}return _},o)(n.rawNumbers(),s,i);return Ee.onlyNumbers(a)})}maxpoolArraySize(e,t){if(e.args.length<2||e.args.length>3)return Ze.error();const n=this.metadata("MAXPOOL"),i=e.args.map(u=>{var c;return this.arraySizeForAst(u,new xi(t.formulaAddress,t.arraysFlag||((c=n==null?void 0:n.arrayFunction)!==null&&c!==void 0?c:!1)))})[0],o=e.args[1];let a;o.type===C.NUMBER?a=o.value:a=1;let l=a;if(e.args.length===3){const u=e.args[2];u.type===C.NUMBER?l=u.value:l=1}return a>i.width||a>i.height||l>a||(i.width-a)%l!==0||(i.height-a)%l!==0?Ze.error():Uy(i,a,l)}medianpoolArraySize(e,t){return this.maxpoolArraySize(e,t)}transpose(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),n=>{const s=n.rawData(),i=n.size,o=[];for(let a=0;a<i.width;++a){o[a]=[];for(let l=0;l<i.height;++l)o[a][l]=s[l][a]}return Ee.onlyValues(o)})}transposeArraySize(e,t){if(e.args.length!==1)return Ze.error();const n=this.metadata("TRANSPOSE"),s=e.args.map(o=>{var a;return this.arraySizeForAst(o,new xi(t.formulaAddress,t.arraysFlag||((a=n==null?void 0:n.arrayFunction)!==null&&a!==void 0?a:!1)))}),[i]=s;return new Ze(i.height,i.width)}createKernel(e,t){return function(...n){const s=[];for(let i=0;i<t.height;++i){s.push([]);for(let o=0;o<t.width;++o)s[i][o]=e.apply({thread:{x:o,y:i}},n)}return s}}}dL.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:f.RANGE},{argumentType:f.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:f.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:f.RANGE},{argumentType:f.NUMBER},{argumentType:f.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:f.RANGE},{argumentType:f.NUMBER},{argumentType:f.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class fL extends Be{median(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);return s instanceof v?s:s.length===0?new v(S.NUM,N.OneValue):(s.sort((i,o)=>i-o),s.length%2===0?(s[s.length/2-1]+s[s.length/2])/2:s[Math.floor(s.length/2)])})}large(e,t){return this.runFunction(e.args,t,this.metadata("LARGE"),(n,s)=>{const i=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());return i instanceof v?i:(i.sort((o,a)=>o-a),s=Math.trunc(s),s>i.length?new v(S.NUM,N.ValueLarge):i[i.length-s])})}small(e,t){return this.runFunction(e.args,t,this.metadata("SMALL"),(n,s)=>{const i=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());return i instanceof v?i:(i.sort((o,a)=>o-a),s=Math.trunc(s),s>i.length?new v(S.NUM,N.ValueLarge):i[s-1])})}}fL.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:f.RANGE},{argumentType:f.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:f.RANGE},{argumentType:f.NUMBER,minValue:1}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class mL extends Be{mod(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),(n,s)=>s===0?new v(S.DIV_BY_ZERO):n%s)}}mL.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function yf(r){return ct(r)&&!Number.isFinite(le(r))?0:r}class js{constructor(e,t,n){this.sumsq=e,this.sum=t,this.count=n}static single(e){return new js(e*e,e,1)}compose(e){return new js(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}varSValue(){if(this.count>1)return(this.sumsq-this.sum*this.sum/this.count)/(this.count-1)}varPValue(){if(this.count>0)return(this.sumsq-this.sum*this.sum/this.count)/this.count}}js.empty=new js(0,0,0);class HR extends Be{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,t)=>this.arithmeticHelper.addWithEpsilonRaw(e,t)}sum(e,t){return this.doSum(e.args,t)}sumsq(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,n=>Math.pow(le(n),2),Bl)}max(e,t){return this.doMax(e.args,t)}maxa(e,t){const n=this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",(s,i)=>Math.max(s,i),le,Ef);return yf(n)}min(e,t){return this.doMin(e.args,t)}mina(e,t){const n=this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",(s,i)=>Math.min(s,i),le,Ef);return yf(n)}count(e,t){return this.doCount(e.args,t)}counta(e,t){return this.doCounta(e.args,t)}average(e,t){return this.doAverage(e.args,t)}averagea(e,t){var n;const s=this.reduce(e.args,t,js.empty,"_AGGREGATE_A",(i,o)=>i.compose(o),i=>js.single(le(i)),Ef);return s instanceof v?s:(n=s.averageValue())!==null&&n!==void 0?n:new v(S.DIV_BY_ZERO)}vars(e,t){return this.doVarS(e.args,t)}varp(e,t){return this.doVarP(e.args,t)}vara(e,t){var n;const s=this.reduceAggregateA(e.args,t);return s instanceof v?s:(n=s.varSValue())!==null&&n!==void 0?n:new v(S.DIV_BY_ZERO)}varpa(e,t){var n;const s=this.reduceAggregateA(e.args,t);return s instanceof v?s:(n=s.varPValue())!==null&&n!==void 0?n:new v(S.DIV_BY_ZERO)}stdevs(e,t){return this.doStdevS(e.args,t)}stdevp(e,t){return this.doStdevP(e.args,t)}stdeva(e,t){const n=this.reduceAggregateA(e.args,t);if(n instanceof v)return n;{const s=n.varSValue();return s===void 0?new v(S.DIV_BY_ZERO):Math.sqrt(s)}}stdevpa(e,t){const n=this.reduceAggregateA(e.args,t);if(n instanceof v)return n;{const s=n.varPValue();return s===void 0?new v(S.DIV_BY_ZERO):Math.sqrt(s)}}product(e,t){return this.doProduct(e.args,t)}subtotal(e,t){if(e.args.length<2)return new v(S.NA,N.WrongArgNumber);const n=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:f.NUMBER},t),s=e.args.slice(1);switch(n){case 1:case 101:return this.doAverage(s,t);case 2:case 102:return this.doCount(s,t);case 3:case 103:return this.doCounta(s,t);case 4:case 104:return this.doMax(s,t);case 5:case 105:return this.doMin(s,t);case 6:case 106:return this.doProduct(s,t);case 7:case 107:return this.doStdevS(s,t);case 8:case 108:return this.doStdevP(s,t);case 9:case 109:return this.doSum(s,t);case 10:case 110:return this.doVarS(s,t);case 11:case 111:return this.doVarP(s,t);default:return new v(S.VALUE,N.BadMode)}}reduceAggregate(e,t){return this.reduce(e,t,js.empty,"_AGGREGATE",(n,s)=>n.compose(s),n=>js.single(le(n)),Bl)}reduceAggregateA(e,t){return this.reduce(e,t,js.empty,"_AGGREGATE_A",(n,s)=>n.compose(s),n=>js.single(le(n)),Ef)}doAverage(e,t){var n;const s=this.reduceAggregate(e,t);return s instanceof v?s:(n=s.averageValue())!==null&&n!==void 0?n:new v(S.DIV_BY_ZERO)}doVarS(e,t){var n;const s=this.reduceAggregate(e,t);return s instanceof v?s:(n=s.varSValue())!==null&&n!==void 0?n:new v(S.DIV_BY_ZERO)}doVarP(e,t){var n;const s=this.reduceAggregate(e,t);return s instanceof v?s:(n=s.varPValue())!==null&&n!==void 0?n:new v(S.DIV_BY_ZERO)}doStdevS(e,t){const n=this.reduceAggregate(e,t);if(n instanceof v)return n;{const s=n.varSValue();return s===void 0?new v(S.DIV_BY_ZERO):Math.sqrt(s)}}doStdevP(e,t){const n=this.reduceAggregate(e,t);if(n instanceof v)return n;{const s=n.varPValue();return s===void 0?new v(S.DIV_BY_ZERO):Math.sqrt(s)}}doCount(e,t){return this.reduce(e,t,0,"COUNT",(n,s)=>n+s,le,n=>ct(n)?1:0)}doCounta(e,t){return this.reduce(e,t,0,"COUNTA",(n,s)=>n+s,le,n=>n===Xe?0:1)}doMax(e,t){const n=this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",(s,i)=>Math.max(s,i),le,Bl);return yf(n)}doMin(e,t){const n=this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",(s,i)=>Math.min(s,i),le,Bl);return yf(n)}doSum(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,le,Bl)}doProduct(e,t){return this.reduce(e,t,1,"PRODUCT",(n,s)=>n*s,le,Bl)}reduce(e,t,n,s,i,o,a){return e.length<1?new v(S.NA,N.WrongArgNumber):e.reduce((l,u)=>{if(l instanceof v)return l;if(u.type===C.CELL_RANGE||u.type===C.COLUMN_RANGE||u.type===C.ROW_RANGE){const h=this.evaluateRange(u,t,n,s,i,o,a);return h instanceof v?h:i(h,l)}let c;if(c=this.evaluateAst(u,t),c instanceof Ee)return Array.from(c.valuesFromTopLeftCorner()).map(a).filter(d=>d!==void 0).map(d=>d instanceof v?d:o(d)).reduce((d,m)=>d instanceof v?d:m instanceof v?m:i(d,m),l);if(u.type===C.CELL_REFERENCE){if(c=a(c),c===void 0)return l}else if(c=this.coerceScalarToNumberOrError(c),c=a(c),c===void 0)return l;return c instanceof v?c:i(l,o(c))},n)}evaluateRange(e,t,n,s,i,o,a){let l;try{l=we.fromAst(e,t.formulaAddress)}catch(h){if(h instanceof Ch)return new v(S.REF,N.RangeManySheets);throw h}const u=this.dependencyGraph.getRange(l.start,l.end);if(u===void 0)throw new Error("Range does not exists in graph");let c=u.getFunctionValue(s);return c===void 0&&(c=this.getRangeValues(s,l,u,o,a).reduce((d,m)=>d instanceof v?d:m instanceof v?m:i(d,m),n),u.setFunctionValue(s,c)),c}getRangeValues(e,t,n,s,i){const o=[],{smallerRangeVertex:a,restRange:l}=this.dependencyGraph.rangeMapping.findSmallerRange(t);let u;if(a!==void 0&&this.dependencyGraph.existsEdge(a,n)){const c=a.getFunctionValue(e);if(c!==void 0)o.push(c);else for(const h of a.range.addresses(this.dependencyGraph)){const d=i(this.dependencyGraph.getScalarValue(h));d instanceof v?o.push(d):d!==void 0&&o.push(s(d))}u=l}else u=t;for(const c of u.addresses(this.dependencyGraph)){const h=i(this.dependencyGraph.getScalarValue(c));h instanceof v?o.push(h):h!==void 0&&o.push(s(h))}return o}}HR.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:f.NUMBER},{argumentType:f.ANY}],repeatLastArgs:1}};HR.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};function Bl(r){if(ct(r)||r instanceof v)return r}function Ef(r){return typeof r=="boolean"?rv(r):ct(r)||r instanceof v?r:typeof r=="string"?0:void 0}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class pL extends Be{power(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}pL.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class gL extends Be{radians(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),n=>n*(Math.PI/180))}}gL.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:f.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Lr=10,yL=255,SN=2,CN=36,bte="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";class EL extends Be{dec2bin(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),(n,s)=>ro(n,2,s))}dec2oct(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),(n,s)=>ro(n,8,s))}dec2hex(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),(n,s)=>ro(n,16,s))}bin2dec(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),n=>{const s=vi(n,2,Lr);return s===void 0?new v(S.NUM,N.NotBinary):no(s,2)})}bin2oct(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),(n,s)=>{const i=vi(n,2,Lr);return i===void 0?new v(S.NUM,N.NotBinary):ro(no(i,2),8,s)})}bin2hex(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),(n,s)=>{const i=vi(n,2,Lr);return i===void 0?new v(S.NUM,N.NotBinary):ro(no(i,2),16,s)})}oct2dec(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),n=>{const s=vi(n,8,Lr);return s===void 0?new v(S.NUM,N.NotOctal):no(s,8)})}oct2bin(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),(n,s)=>{const i=vi(n,8,Lr);return i===void 0?new v(S.NUM,N.NotOctal):ro(no(i,8),2,s)})}oct2hex(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),(n,s)=>{const i=vi(n,8,Lr);return i===void 0?new v(S.NUM,N.NotOctal):ro(no(i,8),16,s)})}hex2dec(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),n=>{const s=vi(n,16,Lr);return s===void 0?new v(S.NUM,N.NotHex):no(s,16)})}hex2bin(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),(n,s)=>{const i=vi(n,16,Lr);return i===void 0?new v(S.NUM,N.NotHex):ro(no(i,16),2,s)})}hex2oct(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),(n,s)=>{const i=vi(n,16,Lr);return i===void 0?new v(S.NUM,N.NotHex):ro(no(i,16),8,s)})}base(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),Ate)}decimal(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),(n,s)=>{const i=vi(n,s,yL);return i===void 0?new v(S.NUM,N.NotHex):parseInt(i,s)})}}EL.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:f.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:f.STRING},{argumentType:f.NUMBER,optionalArg:!0,minValue:0,maxValue:Lr}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:f.STRING},{argumentType:f.NUMBER,optionalArg:!0,minValue:0,maxValue:Lr}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:f.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:f.STRING},{argumentType:f.NUMBER,optionalArg:!0,minValue:0,maxValue:Lr}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:f.STRING},{argumentType:f.NUMBER,optionalArg:!0,minValue:0,maxValue:Lr}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:f.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:f.STRING},{argumentType:f.NUMBER,optionalArg:!0,minValue:0,maxValue:Lr}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:f.STRING},{argumentType:f.NUMBER,optionalArg:!0,minValue:0,maxValue:Lr}]},DECIMAL:{method:"decimal",parameters:[{argumentType:f.STRING},{argumentType:f.NUMBER,minValue:SN,maxValue:CN}]},BASE:{method:"base",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:SN,maxValue:CN},{argumentType:f.NUMBER,optionalArg:!0,minValue:0,maxValue:yL}]}};function vi(r,e,t){const n=bte.substr(0,e),s=new RegExp(`^[${n}]+$`);if(!(r.length>t||!s.test(r)))return r}function ro(r,e,t){if(r>Nte(e))return new v(S.NUM,N.ValueBaseLarge);if(r<vL(e))return new v(S.NUM,N.ValueBaseSmall);const n=wL(r,e);return t===void 0||r<0?n:n.length>t?new v(S.NUM,N.ValueBaseLong):xn(n,t)}function vL(r){return-Math.pow(r,Lr)/2}function Nte(r){return-vL(r)-1}function Ate(r,e,t){const n=wL(r,e);return t!==void 0&&t>n.length?xn(n,t):n}function wL(r,e){const t=r<0?Math.pow(e,Lr):0;return(r+t).toString(e).toUpperCase()}function no(r,e){const t=parseInt(r,e),n=Math.pow(e,Lr);return t>=n/2?t-n:t}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class RL extends Be{rand(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}randbetween(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),(n,s)=>s<n?new v(S.NUM,N.WrongOrder):(n=Math.ceil(n),s=Math.floor(s)+1,n===s&&(s+=1),n+Math.floor(Math.random()*(s-n))))}}RL.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER}],isVolatile:!0}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function TN(r){const e=Math.ceil(r);return e%2===1?e:e+1}function bN(r){const e=Math.ceil(r);return e%2===0?e:e+1}class VR extends Be{roundup(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(n,s)=>{const i=Math.pow(10,s);return n<0?-Math.ceil(-n*i)/i:Math.ceil(n*i)/i})}rounddown(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(n,s)=>{const i=Math.pow(10,s);return n<0?-Math.floor(-n*i)/i:Math.floor(n*i)/i})}round(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),(n,s)=>{const i=Math.pow(10,s);return n<0?-Math.round(-n*i)/i:Math.round(n*i)/i})}intFunc(e,t){return this.runFunction(e.args,t,this.metadata("INT"),n=>n<0?-Math.floor(-n):Math.floor(n))}even(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),n=>n<0?-bN(-n):bN(n))}odd(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),n=>n<0?-TN(-n):TN(n))}ceilingmath(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),(n,s,i)=>s===0||n===0?0:(s=Math.abs(s),i===1&&n<0&&(s=-s),Math.ceil(n/s)*s))}ceiling(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),(n,s)=>n===0?0:s===0?new v(S.DIV_BY_ZERO):n>0&&s<0?new v(S.NUM,N.DistinctSigns):Math.ceil(n/s)*s)}ceilingprecise(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),(n,s)=>s===0||n===0?0:(s=Math.abs(s),Math.ceil(n/s)*s))}floormath(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),(n,s,i)=>s===0||n===0?0:(s=Math.abs(s),i===1&&n<0&&(s*=-1),Math.floor(n/s)*s))}floor(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),(n,s)=>n===0?0:s===0?new v(S.DIV_BY_ZERO):n>0&&s<0?new v(S.NUM,N.DistinctSigns):Math.floor(n/s)*s)}floorprecise(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),(n,s)=>s===0||n===0?0:(s=Math.abs(s),Math.floor(n/s)*s))}}VR.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:f.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:f.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:f.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,defaultValue:1},{argumentType:f.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,defaultValue:1},{argumentType:f.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,defaultValue:1}]}};VR.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class SL extends Be{sqrt(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}SL.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:f.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */function*Ote(){}function Ite(r){const e=r[Symbol.iterator](),{done:t,value:n}=e.next();return t?{rest:Ote()}:{value:n,rest:e}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const Mte=(r,e,t)=>{if(t.end.row>t.start.row){const n=he(t.end.sheet,t.end.col,t.end.row-1),s=r.getRange(t.start,n);if(s!==void 0)return{smallerRangeVertex:s,restValuesRange:t.withStart(he(t.start.sheet,t.start.col,t.end.row)),restConditionRanges:e.map(i=>i.withStart(he(i.start.sheet,i.start.col,i.end.row)))}}return{restValuesRange:t,restConditionRanges:e}};class _te{constructor(e,t,n,s,i){this.interpreter=e,this.cacheKey=t,this.reduceInitialValue=n,this.composeFunction=s,this.mapFunction=i,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,t){for(const i of t)if(!i.conditionRange.sameDimensionsAs(e))return new v(S.VALUE,N.EqualLength);const n=this.tryToGetRangeVertexForRangeValue(e),s=t.map(i=>this.tryToGetRangeVertexForRangeValue(i.conditionRange));if(n&&s.every(i=>i!==void 0)){const i=t.map(l=>l.criterionPackage.raw).join(","),o=this.findAlreadyComputedValueInCache(n,this.cacheKey(t),i);if(o!==void 0)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),o;const a=this.buildNewCriterionCache(this.cacheKey(t),t.map(l=>l.conditionRange.range),e.range);return a.has(i)||a.set(i,[this.evaluateRangeValue(e,t),t.map(l=>l.criterionPackage.lambda)]),n.setCriterionFunctionValues(this.cacheKey(t),a),s.forEach(l=>{l!==void 0&&l.addDependentCacheRange(n)}),a.get(i)[0]}else return this.evaluateRangeValue(e,t)}tryToGetRangeVertexForRangeValue(e){const t=e.range;if(t!==void 0)return this.dependencyGraph.getRange(t.start,t.end)}reduceFunction(e){let t=this.reduceInitialValue;for(const n of e)t=this.composeFunction(t,n);return t}findAlreadyComputedValueInCache(e,t,n){return e.getCriterionFunctionValue(t,n)}evaluateRangeValue(e,t){const n=t.map(a=>a.criterionPackage.lambda),s=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),i=t.map(a=>a.conditionRange.iterateValuesFromTopLeftCorner()),o=AN(n,i,s);return this.reduceFunction(o)}buildNewCriterionCache(e,t,n){const s=this.dependencyGraph.getRange(n.start,n.end),{smallerRangeVertex:i,restConditionRanges:o,restValuesRange:a}=Mte(this.dependencyGraph,t,n);let l;i!==void 0&&this.dependencyGraph.existsEdge(i,s)?l=i.getCriterionFunctionValues(e):l=new Map;const u=new Map;return l.forEach(([c,h],d)=>{const m=AN(h,o.map(g=>NN(this.dependencyGraph,g)),Array.from(NN(this.dependencyGraph,a)).map(this.mapFunction)[Symbol.iterator]()),E=this.composeFunction(c,this.reduceFunction(m));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),u.set(d,[E,h])}),u}}class xte{constructor(e,t){this.conditionRange=e,this.criterionPackage=t}}function*NN(r,e){for(const t of e.addresses(r))yield le(r.getScalarValue(t))}function*AN(r,e,t){for(const n of t){const s=e.map(o=>Ite(o));if(!s.every(o=>Object.prototype.hasOwnProperty.call(o,"value")))return;const i=s.map(o=>le(o.value));Lte(i,r).every(([o,a])=>a(o))&&(yield n),e=s.map(o=>o.rest)}}function Lte(r,e){const t=[];for(let n=0;n<Math.min(r.length,e.length);n++)t.push([r[n],e[n]]);return t}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class ra{constructor(e,t){this.sum=e,this.count=t}static single(e){return new ra(e,1)}compose(e){return new ra(this.sum+e.sum,this.count+e.count)}averageValue(){if(this.count>0)return this.sum/this.count}}ra.empty=new ra(0,0);function Pte(r){return e=>{const t=e.map(n=>`${n.conditionRange.range.sheet},${n.conditionRange.range.start.col},${n.conditionRange.range.start.row}`);return[r,...t].join(",")}}function ON(r){return ct(r)&&!Number.isFinite(le(r))?0:r}function vf(r){if(r instanceof v)return r;if(ct(r))return le(r)}class CL extends Be{sumif(e,t){const n="SUMIF",s=(i,o,a)=>this.computeConditionalAggregationFunction(a??i,[i,o],n,0,(l,u)=>this.arithmeticHelper.nonstrictadd(l,u),vf);return this.runFunction(e.args,t,this.metadata(n),s)}sumifs(e,t){const n="SUMIFS",s=(i,...o)=>this.computeConditionalAggregationFunction(i,o,n,0,(a,l)=>this.arithmeticHelper.nonstrictadd(a,l),vf);return this.runFunction(e.args,t,this.metadata(n),s)}averageif(e,t){const n="AVERAGEIF",s=(i,o,a)=>{const l=this.computeConditionalAggregationFunction(a??i,[i,o],n,ra.empty,(u,c)=>u.compose(c),u=>ct(u)?ra.single(le(u)):ra.empty);return l instanceof v?l:l.averageValue()||new v(S.DIV_BY_ZERO)};return this.runFunction(e.args,t,this.metadata(n),s)}countif(e,t){const n="COUNTIF",s=(i,o)=>this.computeConditionalAggregationFunction(i,[i,o],n,0,(a,l)=>a+l,()=>1);return this.runFunction(e.args,t,this.metadata(n),s)}countifs(e,t){const n="COUNTIFS",s=(...i)=>this.computeConditionalAggregationFunction(i[0],i,n,0,(o,a)=>o+a,()=>1);return this.runFunction(e.args,t,this.metadata(n),s)}minifs(e,t){const n="MINIFS",s=(o,a)=>a===void 0||o===void 0?a===void 0?o:a:Math.min(o,a),i=(o,...a)=>{const l=this.computeConditionalAggregationFunction(o,a,n,Number.POSITIVE_INFINITY,s,vf);return ON(l)};return this.runFunction(e.args,t,this.metadata(n),i)}maxifs(e,t){const n="MAXIFS",s=(o,a)=>a===void 0||o===void 0?a===void 0?o:a:Math.max(o,a),i=(o,...a)=>{const l=this.computeConditionalAggregationFunction(o,a,n,Number.NEGATIVE_INFINITY,s,vf);return ON(l)};return this.runFunction(e.args,t,this.metadata(n),i)}computeConditionalAggregationFunction(e,t,n,s,i,o){const a=[];for(let l=0;l<t.length;l+=2){const u=t[l],c=this.interpreter.criterionBuilder.fromCellValue(t[l+1],this.arithmeticHelper);if(c===void 0)return new v(S.VALUE,N.BadCriterion);a.push(new xte(u,c))}return new _te(this.interpreter,Pte(n),s,i,o).compute(e,a)}}CL.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:f.RANGE},{argumentType:f.NOERROR},{argumentType:f.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:f.RANGE},{argumentType:f.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:f.RANGE},{argumentType:f.NOERROR},{argumentType:f.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:f.RANGE},{argumentType:f.RANGE},{argumentType:f.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:f.RANGE},{argumentType:f.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:f.RANGE},{argumentType:f.RANGE},{argumentType:f.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:f.RANGE},{argumentType:f.RANGE},{argumentType:f.NOERROR}],repeatLastArgs:2}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class TL extends Be{sumproduct(e,t){return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),(...n)=>{const s=n[0].width(),i=n[0].height();for(const l of n)if(l.width()!==s||l.height()!==i)return new v(S.VALUE,N.EqualLength);let o=0;const a=n.map(l=>l.iterateValuesFromTopLeftCorner());for(let l=0;l<s*i;l++){let u=1;for(const c of a){const h=c.next().value;if(h instanceof v)return h;const d=this.coerceScalarToNumberOrError(h);ct(d)?u*=le(d):u=0}o+=u}return o})}}TL.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:f.RANGE}],repeatLastArgs:1}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class bL extends Be{concatenate(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),(...n)=>"".concat(...n))}split(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),(n,s)=>{const i=n.split(" ");return s>=i.length||s<0?new v(S.VALUE,N.IndexBounds):i[s]})}len(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),n=>n.length)}lower(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),n=>n.toLowerCase())}trim(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),n=>n.replace(/^ +| +$/g,"").replace(/ +/g," "))}proper(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),n=>n.replace(new RegExp("\\p{L}+","gu"),s=>s.charAt(0).toUpperCase()+s.substring(1).toLowerCase()))}clean(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),n=>n.replace(/[\u0000-\u001F]/g,""))}exact(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),(n,s)=>n===s)}rept(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),(n,s)=>s<0?new v(S.VALUE,N.NegativeCount):n.repeat(s))}right(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),(n,s)=>s<0?new v(S.VALUE,N.NegativeLength):s===0?"":n.slice(-s))}left(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),(n,s)=>s<0?new v(S.VALUE,N.NegativeLength):n.slice(0,s))}mid(e,t){return this.runFunction(e.args,t,this.metadata("MID"),(n,s,i)=>s<1?new v(S.VALUE,N.LessThanOne):i<0?new v(S.VALUE,N.NegativeLength):n.substring(s-1,s+i-1))}replace(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),(n,s,i,o)=>s<1?new v(S.VALUE,N.LessThanOne):i<0?new v(S.VALUE,N.NegativeLength):n.substring(0,s-1)+o+n.substring(s+i-1))}search(e,t){return this.runFunction(e.args,t,this.metadata("SEARCH"),(n,s,i)=>{if(i<1||i>s.length)return new v(S.VALUE,N.LengthBounds);const o=n.toLowerCase(),a=s.substring(i-1).toLowerCase(),l=this.arithmeticHelper.requiresRegex(o)?this.arithmeticHelper.searchString(o,a):a.indexOf(o);return l>-1?l+i:new v(S.VALUE,N.PatternNotFound)})}substitute(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),(n,s,i,o)=>{const a=this.escapeRegExpSpecialCharacters(s),l=new RegExp(a,"g");if(o===void 0)return n.replace(l,i);if(o<1)return new v(S.VALUE,N.LessThanOne);let u,c=0;for(;(u=l.exec(n))!==null;)if(o===++c)return n.substring(0,u.index)+i+n.substring(l.lastIndex);return n})}find(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),(n,s,i)=>{if(i<1||i>s.length)return new v(S.VALUE,N.IndexBounds);const a=s.substring(i-1).indexOf(n)+i;return a>0?a:new v(S.VALUE,N.PatternNotFound)})}t(e,t){return this.runFunction(e.args,t,this.metadata("T"),n=>n instanceof v||typeof n=="string"?n:"")}upper(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),n=>n.toUpperCase())}escapeRegExpSpecialCharacters(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}bL.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:f.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:f.STRING},{argumentType:f.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:f.STRING},{argumentType:f.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:f.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:f.STRING}]},MID:{method:"mid",parameters:[{argumentType:f.STRING},{argumentType:f.NUMBER},{argumentType:f.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:f.STRING}]},T:{method:"t",parameters:[{argumentType:f.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:f.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:f.STRING}]},REPT:{method:"rept",parameters:[{argumentType:f.STRING},{argumentType:f.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:f.STRING},{argumentType:f.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:f.STRING},{argumentType:f.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:f.STRING},{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:f.STRING},{argumentType:f.STRING},{argumentType:f.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:f.STRING},{argumentType:f.STRING},{argumentType:f.STRING},{argumentType:f.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:f.STRING},{argumentType:f.STRING},{argumentType:f.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:f.STRING}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class NL extends Be{acos(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}asin(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}cos(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}sin(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}tan(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}atan(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}atan2(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),(n,s)=>n===0&&s===0?new v(S.DIV_BY_ZERO):Math.atan2(s,n))}cot(e,t){return this.runFunction(e.args,t,this.metadata("COT"),n=>n===0?new v(S.DIV_BY_ZERO):1/Math.tan(n))}acot(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),n=>n===0?mv/2:Math.atan(1/n))}sec(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),n=>1/Math.cos(n))}csc(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),n=>n===0?new v(S.DIV_BY_ZERO):1/Math.sin(n))}sinh(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}asinh(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}cosh(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}acosh(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}tanh(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}atanh(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}coth(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),n=>n===0?new v(S.DIV_BY_ZERO):1/Math.tanh(n))}acoth(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),n=>n===0?new v(S.NUM,N.NonZero):Math.atanh(1/n))}sech(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),n=>1/Math.cosh(n))}csch(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),n=>n===0?new v(S.DIV_BY_ZERO):1/Math.sinh(n))}}NL.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:f.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:f.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:f.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:f.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:f.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:f.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:f.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:f.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:f.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:f.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:f.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:f.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:f.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:f.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:f.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:f.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:f.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:f.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:f.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:f.NUMBER}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Fte extends H1{constructor(e){super(e),this.dependencyGraph=e}find(e,t,n){return this.basicFind(e,t,"col",n)}}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class AL extends Be{constructor(){super(...arguments),this.rowSearch=new Fte(this.dependencyGraph)}vlookup(e,t){return this.runFunction(e.args,t,this.metadata("VLOOKUP"),(n,s,i,o)=>{const a=s.range;return a===void 0?new v(S.VALUE,N.WrongType):i<1?new v(S.VALUE,N.LessThanOne):i>a.width()?new v(S.REF,N.IndexLarge):this.doVlookup(Py(n),s,i-1,o)})}hlookup(e,t){return this.runFunction(e.args,t,this.metadata("HLOOKUP"),(n,s,i,o)=>{const a=s.range;return a===void 0?new v(S.VALUE,N.WrongType):i<1?new v(S.VALUE,N.LessThanOne):i>a.height()?new v(S.REF,N.IndexLarge):this.doHlookup(Py(n),s,i-1,o)})}match(e,t){return this.runFunction(e.args,t,this.metadata("MATCH"),(n,s,i)=>this.doMatch(Py(n),s,i))}searchInRange(e,t,n,s){if(!n&&typeof e=="string"&&this.arithmeticHelper.requiresRegex(e))return s.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t);{const i=n?{ordering:"asc"}:{ordering:"none",matchExactly:!0};return s.find(e,t,i)}}doVlookup(e,t,n,s){this.dependencyGraph.stats.start(Ve.VLOOKUP);const i=t.range;let o;i===void 0?o=Ee.onlyValues(t.data.map(u=>[u[0]])):o=Ee.onlyRange(we.spanFrom(i.start,1,i.height()),this.dependencyGraph);const a=this.searchInRange(e,o,s,this.columnSearch);if(this.dependencyGraph.stats.end(Ve.VLOOKUP),a===-1)return new v(S.NA,N.ValueNotFound);let l;if(i===void 0)l=t.data[a][n];else{const u=he(i.sheet,i.start.col+n,i.start.row+a);l=this.dependencyGraph.getCellValue(u)}return l instanceof Ee?new v(S.VALUE,N.WrongType):l}doHlookup(e,t,n,s){const i=t.range;let o;i===void 0?o=Ee.onlyValues([t.data[0]]):o=Ee.onlyRange(we.spanFrom(i.start,i.width(),1),this.dependencyGraph);const a=this.searchInRange(e,o,s,this.rowSearch);if(a===-1)return new v(S.NA,N.ValueNotFound);let l;if(i===void 0)l=t.data[n][a];else{const u=he(i.sheet,i.start.col+a,i.start.row+n);l=this.dependencyGraph.getCellValue(u)}return l instanceof Ee?new v(S.VALUE,N.WrongType):l}doMatch(e,t,n){if(![-1,0,1].includes(n))return new v(S.VALUE,N.BadMode);if(t.width()>1&&t.height()>1)return new v(S.NA);const s=t.width()===1?this.columnSearch:this.rowSearch,i=n===0?{ordering:"none",matchExactly:!0}:{ordering:n===-1?"desc":"asc"},o=s.find(e,t,i);return o===-1?new v(S.NA,N.ValueNotFound):o+1}}AL.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:f.NOERROR},{argumentType:f.RANGE},{argumentType:f.NUMBER},{argumentType:f.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:f.NOERROR},{argumentType:f.RANGE},{argumentType:f.NUMBER},{argumentType:f.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:f.NOERROR},{argumentType:f.RANGE},{argumentType:f.NUMBER,defaultValue:1}]}};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class OL extends Be{roman(e,t){return this.runFunction(e.args,t,this.metadata("ROMAN"),(n,s)=>(n=Math.trunc(n),s===!1?s=4:s===!0&&(s=0),s=le(this.coerceScalarToNumberOrError(s)),s instanceof v?s:(s=Math.trunc(s),s<0?new v(S.VALUE,N.ValueSmall):s>4?new v(S.VALUE,N.ValueLarge):Dte(n,s))))}arabic(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),n=>{n=n.trim().toUpperCase();let s=!1;if(n.startsWith("-")&&(n=n.slice(1),s=!0,n===""))return new v(S.VALUE,N.InvalidRoman);const i={input:n,acc:0};return wi(i,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),wi(i,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),wi(i,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),wi(i,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),wi(i,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),wi(i,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),wi(i,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),wi(i,{token:"IX",val:9}),wi(i,{token:"V",val:5},{token:"IV",val:4}),wi(i,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),i.input!==""?new v(S.VALUE,N.InvalidRoman):s?-i.acc:i.acc})}}OL.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:f.NUMBER,minValue:1,lessThan:4e3},{argumentType:f.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:f.STRING}]}};function wi(r,...e){for(const t of e)if(r.input.startsWith(t.token)){r.input=r.input.slice(t.token.length),r.acc+=t.val;break}}function Dte(r,e){const t={val:r%1e3,acc:"M".repeat(Math.floor(r/1e3))};return e===4&&(nr(t,"IM",999,1e3),nr(t,"ID",499,500)),e>=3&&(nr(t,"VM",995,1e3),nr(t,"VD",495,500)),e>=2&&(nr(t,"XM",990,1e3),nr(t,"XD",490,500)),e>=1&&(nr(t,"LM",950,1e3),nr(t,"LD",450,500)),nr(t,"CM",900,1e3),nr(t,"CD",400,500),nr(t,"D",500,900),t.acc+="C".repeat(Math.floor(t.val/100)),t.val%=100,e>=2&&(nr(t,"IC",99,100),nr(t,"IL",49,50)),e>=1&&(nr(t,"VC",95,100),nr(t,"VL",45,50)),nr(t,"XC",90,100),nr(t,"XL",40,50),nr(t,"L",50,90),t.acc+="X".repeat(Math.floor(t.val/10)),t.val%=10,nr(t,"IX",9,10),nr(t,"IV",4,5),nr(t,"V",5,9),t.acc+="I".repeat(t.val),t.acc}function nr(r,e,t,n){r.val>=t&&r.val<n&&(r.val-=t,r.acc+=e)}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class IL extends Be{add(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}IL.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:f.NUMBER,passSubtype:!0},{argumentType:f.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:f.STRING,passSubtype:!0},{argumentType:f.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:f.NUMBER,passSubtype:!0},{argumentType:f.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:f.NOERROR,passSubtype:!0},{argumentType:f.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:f.NOERROR,passSubtype:!0},{argumentType:f.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:f.NOERROR,passSubtype:!0},{argumentType:f.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:f.NOERROR,passSubtype:!0},{argumentType:f.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:f.NOERROR,passSubtype:!0},{argumentType:f.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:f.NUMBER,passSubtype:!0},{argumentType:f.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:f.NUMBER,passSubtype:!0},{argumentType:f.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:f.NOERROR,passSubtype:!0},{argumentType:f.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:f.NUMBER,passSubtype:!0},{argumentType:f.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:f.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:f.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:f.NUMBER,passSubtype:!0}]}};/**
 * @license
 bessel.js (C) 2013-present SheetJS -- http://sheetjs.com

 Apache License
 Version 2.0, January 2004
 http://www.apache.org/licenses/

 TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

 1. Definitions.

 "License" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 "Licensor" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 "Legal Entity" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 "control" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 "You" (or "Your") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 "Source" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 "Object" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 "Work" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 "Derivative Works" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 "Contribution" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, "submitted"
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as "Not a Contribution."

 "Contributor" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a "NOTICE" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
 or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
 negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

 APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets "{}"
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same "printed page" as the copyright notice for easier
 identification within third-party archives.

 Copyright (C) 2013-present   SheetJS LLC

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 */var $e=Math;function Wt(r,e){for(var t=0,n=0;t<r.length;++t)n=e*n+r[t];return n}function ML(r,e,t,n,s){if(e===0)return t;if(e===1)return n;for(var i=2/r,o=n,a=1;a<e;++a)o=n*a*i+s*t,t=n,n=o;return o}function _L(r,e,t,n,s){return function(o,a){if(n){if(o===0)return n==1?-1/0:1/0;if(o<0)return NaN}if(a===0)return r(o);if(a===1)return e(o);if(a<0)return NaN;a|=0;var l=r(o),u=e(o);return ML(o,a,l,u,s)}}var pv=function(){var r=.636619772,e=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),t=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),s=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function i(h){var d=0,m=0,E=0,g=h*h;if(h<8)m=Wt(e,g),E=Wt(t,g),d=m/E;else{var O=h-.785398164;g=64/g,m=Wt(n,g),E=Wt(s,g),d=$e.sqrt(r/h)*($e.cos(O)*m-$e.sin(O)*E*8/h)}return d}var o=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),a=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function c(h){var d=0,m=0,E=0,g=h*h,O=$e.abs(h)-2.356194491;return Math.abs(h)<8?(m=h*Wt(o,g),E=Wt(a,g),d=m/E):(g=64/g,m=Wt(l,g),E=Wt(u,g),d=$e.sqrt(r/$e.abs(h))*($e.cos(O)*m-$e.sin(O)*E*8/$e.abs(h)),h<0&&(d=-d)),d}return function h(d,m){if(m=Math.round(m),!isFinite(d))return isNaN(d)?d:0;if(m<0)return(m%2?-1:1)*h(d,-m);if(d<0)return(m%2?-1:1)*h(-d,m);if(m===0)return i(d);if(m===1)return c(d);if(d===0)return 0;var E=0;if(d>m)E=ML(d,m,i(d),c(d),-1);else{for(var g=2*$e.floor((m+$e.floor($e.sqrt(40*m)))/2),O=!1,T=0,_=0,V=1,H=0,Q=2/d,oe=g;oe>0;oe--)H=oe*Q*V-T,T=V,V=H,$e.abs(V)>1e10&&(V*=1e-10,T*=1e-10,E*=1e-10,_*=1e-10),O&&(_+=V),O=!O,oe==m&&(E=T);_=2*_-V,E/=_}return E}}(),Hte=function(){var r=.636619772,e=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),t=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),s=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function i(h){var d=0,m=0,E=0,g=h*h,O=h-.785398164;return h<8?(m=Wt(e,g),E=Wt(t,g),d=m/E+r*pv(h,0)*$e.log(h)):(g=64/g,m=Wt(n,g),E=Wt(s,g),d=$e.sqrt(r/h)*($e.sin(O)*m+$e.cos(O)*E*8/h)),d}var o=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),a=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),l=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),u=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function c(h){var d=0,m=0,E=0,g=h*h,O=h-2.356194491;return h<8?(m=h*Wt(o,g),E=Wt(a,g),d=m/E+r*(pv(h,1)*$e.log(h)-1/h)):(g=64/g,m=Wt(l,g),E=Wt(u,g),d=$e.sqrt(r/h)*($e.sin(O)*m+$e.cos(O)*E*8/h)),d}return _L(i,c,"BESSELY",1,-1)}(),gv=function(){var r=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),e=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function t(o){return o<=3.75?Wt(r,o*o/(3.75*3.75)):$e.exp($e.abs(o))/$e.sqrt($e.abs(o))*Wt(e,3.75/$e.abs(o))}var n=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),s=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function i(o){return o<3.75?o*Wt(n,o*o/(3.75*3.75)):(o<0?-1:1)*$e.exp($e.abs(o))/$e.sqrt($e.abs(o))*Wt(s,3.75/$e.abs(o))}return function o(a,l){if(l=Math.round(l),l===0)return t(a);if(l===1)return i(a);if(l<0)return NaN;if($e.abs(a)===0)return 0;if(a==1/0)return 1/0;var u=0,c,h=2/$e.abs(a),d=0,m=1,E=0,g=2*$e.round((l+$e.round($e.sqrt(40*l)))/2);for(c=g;c>0;c--)E=c*h*m+d,d=m,m=E,$e.abs(m)>1e10&&(m*=1e-10,d*=1e-10,u*=1e-10),c==l&&(u=d);return u*=o(a,0)/m,a<0&&l%2?-u:u}}(),Vte=function(){var r=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),e=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function t(o){return o<=2?-$e.log(o/2)*gv(o,0)+Wt(r,o*o/4):$e.exp(-o)/$e.sqrt(o)*Wt(e,2/o)}var n=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),s=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function i(o){return o<=2?$e.log(o/2)*gv(o,1)+1/o*Wt(n,o*o/4):$e.exp(-o)/$e.sqrt(o)*Wt(s,2/o)}return _L(t,i,"BESSELK",2,1)}();/**
 * @license
 Copyright (c) 2013 jStat

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */function Su(r){const e=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18];let t=e.length-1,n=!1,s=0,i=0,o,a,l,u;if(r===0)return 0;for(r<0&&(r=-r,n=!0),o=2/(2+r),a=4*o-2;t>0;t--)l=s,s=a*s-i+e[t],i=l;return u=o*Math.exp(-r*r+.5*(e[0]+a*s)-i),n?u-1:1-u}function xL(r){return 1-Su(r)}function LL(r){let e=0,t,n,s,i;if(r>=2)return-100;if(r<=0)return 100;for(i=r<1?r:2-r,s=Math.sqrt(-2*Math.log(i/2)),t=-.70711*((2.30753+s*.27061)/(1+s*(.99229+s*.04481))-s);e<2;e++)n=xL(t)-i,t+=n/(1.1283791670955126*Math.exp(-t*t)-t*n);return r<1?t:-t}const IN={pdf:(r,e)=>r<0?0:e*Math.exp(-e*r),cdf:(r,e)=>r<0?0:1-Math.exp(-e*r)};function ih(r){const e=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],t=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535];let n=!1,s=0,i=0,o=0,a=r,l,u,c,h;if(r>171.6243769536076)return 1/0;if(a<=0)if(h=a%1,h)n=(a&1?-1:1)*Math.PI/Math.sin(Math.PI*h),a=1-a;else return 1/0;for(c=a,a<1?u=a++:u=(a-=s=(a|0)-1)-1,l=0;l<8;++l)o=(o+e[l])*u,i=i*u+t[l];if(h=o/i+1,c<a)h/=c;else if(c>a)for(l=0;l<s;++l)h*=a,a++;return n&&(h=n/h),h}const ky={pdf:function(e,t,n){return e<0?0:e===0&&t===1?1/n:Math.exp((t-1)*Math.log(e)-e/n-Dr(t)-t*Math.log(n))},cdf:function(e,t,n){return e<0?0:UR(t,e/n)},inv:function(r,e,t){return PL(r,e)*t}};function Dr(r){let e=0;const t=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let n=1.000000000190015,s,i,o;for(o=(i=s=r)+5.5,o-=(s+.5)*Math.log(o);e<6;e++)n+=t[e]/++i;return Math.log(2.5066282746310007*n/s)-o}function UR(r,e){const t=Dr(r);let n=r,s=1/r,i=s,o=e+1-r,a=1/1e-30,l=1/o,u=l,c=1;const h=-~(Math.log(r>=1?r:1/r)*8.5+r*.4+17);let d;if(e<0||r<=0)return NaN;if(e<r+1){for(;c<=h;c++)s+=i*=e/++n;return s*Math.exp(-e+r*Math.log(e)-t)}for(;c<=h;c++)d=-c*(c-r),o+=2,l=d*l+o,a=o+d/a,l=1/l,u*=l*a;return 1-u*Math.exp(-e+r*Math.log(e)-t)}function PL(r,e){let t=0;const n=e-1,s=1e-8,i=Dr(e);let o,a,l,u,c,h,d;if(r>=1)return Math.max(100,e+100*Math.sqrt(e));if(r<=0)return 0;for(e>1?(h=Math.log(n),d=Math.exp(n*(h-1)-i),c=r<.5?r:1-r,l=Math.sqrt(-2*Math.log(c)),o=(2.30753+l*.27061)/(1+l*(.99229+l*.04481))-l,r<.5&&(o=-o),o=Math.max(.001,e*Math.pow(1-1/(9*e)-o/(3*Math.sqrt(e)),3))):(l=1-e*(.253+e*.12),r<l?o=Math.pow(r/l,1/e):o=1-Math.log(1-(r-l)/(1-l)));t<12;t++){if(o<=0)return 0;if(a=UR(e,o)-r,e>1?l=d*Math.exp(-(o-n)+n*(Math.log(o)-h)):l=Math.exp(-o+n*Math.log(o)-i),u=a/l,o-=l=u/(1-.5*Math.min(1,u*((e-1)/o-1))),o<=0&&(o=.5*(o+l)),Math.abs(l)<s*o)break}return o}const Gs={pdf:function(e,t,n){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(e-t,2)/(2*n*n))},cdf:function(e,t,n){return .5*(1+Su((e-t)/Math.sqrt(2*n*n)))},inv:function(r,e,t){return-1.4142135623730951*t*LL(2*r)+e}},By={pdf:function(e,t,n){return e>1||e<0?0:t==1&&n==1?1:t<512&&n<512?Math.pow(e,t-1)*Math.pow(1-e,n-1)/kR(t,n):Math.exp((t-1)*Math.log(e)+(n-1)*Math.log(1-e)-FL(t,n))},cdf:function(e,t,n){return e>1||e<0?+(e>1):rg(e,t,n)},inv:function(e,t,n){return BR(e,t,n)}};function kR(r,e){if(!(r<=0||e<=0))return r+e>170?Math.exp(FL(r,e)):ih(r)*ih(e)/ih(r+e)}function FL(r,e){return Dr(r)+Dr(e)-Dr(r+e)}function BR(r,e,t){var n=1e-8,s=e-1,i=t-1,o=0,a,l,u,c,h,d,m,E,g,O,T;if(r<=0)return 0;if(r>=1)return 1;for(e>=1&&t>=1?(u=r<.5?r:1-r,c=Math.sqrt(-2*Math.log(u)),m=(2.30753+c*.27061)/(1+c*(.99229+c*.04481))-c,r<.5&&(m=-m),E=(m*m-3)/6,g=2/(1/(2*e-1)+1/(2*t-1)),O=m*Math.sqrt(E+g)/g-(1/(2*t-1)-1/(2*e-1))*(E+5/6-2/(3*g)),m=e/(e+t*Math.exp(2*O))):(a=Math.log(e/(e+t)),l=Math.log(t/(e+t)),c=Math.exp(e*a)/e,h=Math.exp(t*l)/t,O=c+h,r<c/O?m=Math.pow(e*O*r,1/e):m=1-Math.pow(t*O*(1-r),1/t)),T=-Dr(e)-Dr(t)+Dr(e+t);o<10;o++){if(m===0||m===1)return m;if(d=rg(m,e,t)-r,c=Math.exp(s*Math.log(m)+i*Math.log(1-m)+T),h=d/c,m-=c=h/(1-.5*Math.min(1,h*(s/m-i/(1-m)))),m<=0&&(m=.5*(m+c)),m>=1&&(m=.5*(m+c+1)),Math.abs(c)<n*m&&o>0)break}return m}function rg(r,e,t){var n=r===0||r===1?0:Math.exp(Dr(e+t)-Dr(e)-Dr(t)+e*Math.log(r)+t*Math.log(1-r));return r<0||r>1?!1:r<(e+1)/(e+t+2)?n*MN(r,e,t)/e:1-n*MN(1-r,t,e)/t}function MN(r,e,t){var n=1e-30,s=1,i=e+t,o=e+1,a=e-1,l=1,u=1-i*r/o,c,h,d,m;for(Math.abs(u)<n&&(u=n),u=1/u,m=u;s<=100&&(c=2*s,h=s*(t-s)*r/((a+c)*(e+c)),u=1+h*u,Math.abs(u)<n&&(u=n),l=1+h/l,Math.abs(l)<n&&(l=n),u=1/u,m*=u*l,h=-(e+s)*(i+s)*r/((e+c)*(o+c)),u=1+h*u,Math.abs(u)<n&&(u=n),l=1+h/l,Math.abs(l)<n&&(l=n),u=1/u,d=u*l,m*=d,!(Math.abs(d-1)<3e-7));s++);return m}const Zf={pdf:function(r,e,t){return t===0||t===1?e*t===r?1:0:DL(e,r)*Math.pow(t,r)*Math.pow(1-t,e-r)},cdf:function(r,e,t){var n,s=1e-10;if(r<0)return 0;if(r>=e)return 1;if(t<0||t>1||e<=0)return NaN;r=Math.floor(r);var i=t,o=r+1,a=e-r,l=o+a,u=Math.exp(Dr(l)-Dr(a)-Dr(o)+o*Math.log(i)+a*Math.log(1-i));return i<(o+1)/(l+2)?n=u*_N(i,o,a,s):n=1-u*_N(1-i,a,o,s),Math.round((1-n)*(1/s))/(1/s)}};function _N(r,e,t,n){for(var s=0,i=1,o=1,a=1,l=0,u=0,c;Math.abs((o-u)/o)>n;)u=o,c=-(e+l)*(e+t+l)*r/(e+2*l)/(e+2*l+1),s=o+c*s,i=a+c*i,l=l+1,c=l*(t-l)*r/(e+2*l-1)/(e+2*l),o=s+c*o,a=i+c*a,s=s/a,i=i/a,o=o/a,a=1;return o/e}function DL(r,e){return r>170||e>170?Math.exp(Ute(r,e)):Jf(r)/Jf(e)/Jf(r-e)}function Ute(r,e){return Wy(r)-Wy(e)-Wy(r-e)}function Wy(r){return r<0?NaN:Dr(r+1)}function Jf(r){return r<0?NaN:ih(r+1)}const Kl={pdf:function(e,t){return e<0?0:e===0&&t===2?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-Dr(t/2))},cdf:function(e,t){return e<0?0:UR(t/2,e/2)},inv:function(r,e){return 2*PL(r,.5*e)}},Xl={pdf:function(e,t,n){var s,i,o;return e<0?0:t<=2?e===0&&t<2?1/0:e===0&&t===2?1:1/kR(t/2,n/2)*Math.pow(t/n,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/n*e,-(t+n)/2):(s=t*e/(n+e*t),i=n/(n+e*t),o=t*i/2,o*Zf.pdf((t-2)/2,(t+n-2)/2,s))},cdf:function(e,t,n){return e<0?0:rg(t*e/(t*e+n),t/2,n/2)},inv:function(e,t,n){return n/(t*(1/BR(e,t/2,n/2)-1))}},xN={pdf:function(e,t,n){return e<0||t<0||n<0?0:n/t*Math.pow(e/t,n-1)*Math.exp(-Math.pow(e/t,n))},cdf:function(e,t,n){return e<0?0:1-Math.exp(-Math.pow(e/t,n))}},yv={pdf:function(e,t){return t<0||e%1!==0||e<0?0:Math.pow(t,e)*Math.exp(-t)/Jf(e)},cdf:function(e,t){var n=0;if(e<0)return 0;for(var s=0;n<=e;n++)s+=yv.pdf(n,t);return s}},ao={pdf:function(e,t,n,s){if(e<0||e<n-(t-s))return 0;if(e>s||e>n)return 0;if(n*2>t)return s*2>t?ao.pdf(t-n-s+e,t,t-n,t-s):ao.pdf(s-e,t,t-n,s);if(s*2>t)return ao.pdf(n-e,t,n,t-s);if(n<s)return ao.pdf(e,t,s,n);for(var i=1,o=0,a=0;a<e;a++){for(;i>1&&o<s;)i*=1-n/(t-o),o++;i*=(s-a)*(n-a)/((a+1)*(t-n-s+a+1))}for(;o<s;o++)i*=1-n/(t-o);return Math.min(1,Math.max(0,i))},cdf:function r(e,t,n,s){if(e<0||e<n-(t-s))return 0;if(e>=s||e>=n)return 1;if(n*2>t)return s*2>t?r(t-n-s+e,t,t-n,t-s):1-ao.cdf(s-e-1,t,t-n,s);if(s*2>t)return 1-ao.cdf(n-e-1,t,n,t-s);if(n<s)return ao.cdf(e,t,s,n);for(var i=1,o=1,a=0,l=0;l<e;l++){for(;i>1&&a<s;){var u=1-n/(t-a);o*=u,i*=u,a++}o*=(s-l)*(n-l)/((l+1)*(t-n-s+l+1)),i+=o}for(;a<s;a++)i*=1-n/(t-a);return Math.min(1,Math.max(0,i))}},gs={pdf:function(e,t){return t=t>1e100?1e100:t,1/(Math.sqrt(t)*kR(.5,t/2))*Math.pow(1+e*e/t,-((t+1)/2))},cdf:function(e,t){var n=t/2;return rg((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),n,n)},inv:function(r,e){var t=BR(2*Math.min(r,1-r),.5*e,.5);return t=Math.sqrt(e*(1-t)/t),r>.5?t:-t}},$y={pdf:function(e,t,n){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(Math.log(e)-t,2)/(2*n*n))},cdf:function(e,t,n){return e<0?0:.5+.5*Su((Math.log(e)-t)/Math.sqrt(2*n*n))},inv:function(r,e,t){return Math.exp(-1.4142135623730951*t*LL(2*r)+e)}},Ev={pdf:function(e,t,n){return e!==e>>>0?!1:e<0?0:DL(e+t-1,t-1)*Math.pow(1-n,e)*Math.pow(n,t)},cdf:function(e,t,n){var s=0,i=0;if(e<0)return 0;for(;i<=e;i++)s+=Ev.pdf(i,t,n);return s}};function HL(r){for(var e=0,t=r.length;--t>=0;)e+=r[t];return e}function ms(r){return HL(r)/r.length}function Wa(r){for(var e=ms(r),t=0,n=r.length,s;--n>=0;)s=r[n]-e,t+=s*s;return t}function Pc(r,e){return Wa(r)/(r.length-(e?1:0))}function Xo(r,e){return Math.sqrt(Pc(r,e))}function kte(){var r=[].slice.call(arguments),e=new Array(2),t;return r.length===4?t=Math.abs(Gs.inv(r[1]/2,0,1)*r[2]/Math.sqrt(r[3])):t=Math.abs(Gs.inv(r[1]/2,0,1)*Xo(r[2])/Math.sqrt(r[2].length)),e[0]=r[0]-t,e[1]=r[0]+t,e}function Bte(){var r=[].slice.call(arguments),e=new Array(2),t;return r.length===4?t=Math.abs(gs.inv(r[1]/2,r[3]-1)*r[2]/Math.sqrt(r[3])):t=Math.abs(gs.inv(r[1]/2,r[2].length-1)*Xo(r[2],!0)/Math.sqrt(r[2].length)),e[0]=r[0]-t,e[1]=r[0]+t,e}function Wte(r){for(var e=1,t=r.length;--t>=0;)e*=r[t];return e}function $te(r){return Math.pow(Wte(r),1/r.length)}function Fc(r,e){var t=ms(r),n=ms(e),s=r.length,i=new Array(s),o;for(o=0;o<s;o++)i[o]=(r[o]-t)*(e[o]-n);return HL(i)/(s-1)}function LN(r,e){return Fc(r,e)/Xo(r,1)/Xo(e,1)}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class WR extends Be{erf(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),(n,s)=>s===void 0?Su(n):Su(s)-Su(n))}erfc(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),xL)}expondist(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),(n,s,i)=>i?IN.cdf(n,s):IN.pdf(n,s))}fisher(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),n=>Math.log((1+n)/(1-n))/2)}fisherinv(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),n=>1-2/(Math.exp(2*n)+1))}gamma(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),ih)}gammadist(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),(n,s,i,o)=>o?ky.cdf(n,s,i):ky.pdf(n,s,i))}gammaln(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),Dr)}gammainv(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),ky.inv)}gauss(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),n=>Gs.cdf(n,0,1)-.5)}betadist(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),(n,s,i,o,a,l)=>n<=a?new v(S.NUM,N.ValueSmall):n>=l?new v(S.NUM,N.ValueLarge):(n=(n-a)/(l-a),o?By.cdf(n,s,i):By.pdf(n,s,i)))}betainv(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),(n,s,i,o,a)=>o>=a?new v(S.NUM,N.WrongOrder):By.inv(n,s,i)*(a-o)+o)}binomialdist(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),(n,s,i,o)=>n>s?new v(S.NUM,N.WrongOrder):(n=Math.trunc(n),s=Math.trunc(s),o?Zf.cdf(n,s,i):Zf.pdf(n,s,i)))}binomialinv(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),(n,s,i)=>{n=Math.trunc(n);let o=-1,a=n;for(;a>o+1;){const l=Math.trunc((o+a)/2);Zf.cdf(l,n,s)>=i?a=l:o=l}return a})}besselifn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),(n,s)=>gv(n,Math.trunc(s)))}besseljfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),(n,s)=>pv(n,Math.trunc(s)))}besselkfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),(n,s)=>Vte(n,Math.trunc(s)))}besselyfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),(n,s)=>Hte(n,Math.trunc(s)))}chisqdist(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),(n,s,i)=>(s=Math.trunc(s),i?Kl.cdf(n,s):Kl.pdf(n,s)))}chisqdistrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),(n,s)=>1-Kl.cdf(n,Math.trunc(s)))}chisqinv(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),(n,s)=>Kl.inv(n,Math.trunc(s)))}chisqinvrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),(n,s)=>Kl.inv(1-n,Math.trunc(s)))}fdist(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),(n,s,i,o)=>(s=Math.trunc(s),i=Math.trunc(i),o?Xl.cdf(n,s,i):Xl.pdf(n,s,i)))}fdistrt(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),(n,s,i)=>1-Xl.cdf(n,Math.trunc(s),Math.trunc(i)))}finv(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),(n,s,i)=>Xl.inv(n,Math.trunc(s),Math.trunc(i)))}finvrt(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),(n,s,i)=>Xl.inv(1-n,Math.trunc(s),Math.trunc(i)))}weibulldist(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),(n,s,i,o)=>o?xN.cdf(n,i,s):xN.pdf(n,i,s))}poissondist(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),(n,s,i)=>(n=Math.trunc(n),i?yv.cdf(n,s):yv.pdf(n,s)))}hypgeomdist(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),(n,s,i,o,a)=>n>s||n>i||s>o||i>o?new v(S.NUM,N.ValueLarge):n+o<i+s?new v(S.NUM,N.ValueLarge):(n=Math.trunc(n),s=Math.trunc(s),i=Math.trunc(i),o=Math.trunc(o),a?ao.cdf(n,o,i,s):ao.pdf(n,o,i,s)))}tdist(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),(n,s,i)=>(s=Math.trunc(s),i?gs.cdf(n,s):gs.pdf(n,s)))}tdist2t(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),(n,s)=>(1-gs.cdf(n,Math.trunc(s)))*2)}tdistrt(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),(n,s)=>1-gs.cdf(n,Math.trunc(s)))}tdistold(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),(n,s,i)=>i*(1-gs.cdf(n,Math.trunc(s))))}tinv(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),(n,s)=>gs.inv(n,Math.trunc(s)))}tinv2t(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),(n,s)=>gs.inv(1-n/2,Math.trunc(s)))}lognormdist(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),(n,s,i,o)=>o?$y.cdf(n,s,i):$y.pdf(n,s,i))}lognorminv(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),(n,s,i)=>$y.inv(n,s,i))}normdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),(n,s,i,o)=>o?Gs.cdf(n,s,i):Gs.pdf(n,s,i))}norminv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),(n,s,i)=>Gs.inv(n,s,i))}normsdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),(n,s)=>s?Gs.cdf(n,0,1):Gs.pdf(n,0,1))}normsinv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),n=>Gs.inv(n,0,1))}phi(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),n=>Gs.pdf(n,0,1))}negbinomdist(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),(n,s,i,o)=>(n=Math.trunc(n),s=Math.trunc(s),o?Ev.cdf(n,s,i):Ev.pdf(n,s,i)))}confidencenorm(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),(n,s,i)=>kte(1,n,s,Math.trunc(i))[1]-1)}confidencet(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),(n,s,i)=>(i=Math.trunc(i),i===1?new v(S.DIV_BY_ZERO):Bte(1,n,s,i)[1]-1))}standardize(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),(n,s,i)=>(n-s)/i)}}WR.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:f.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:f.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:f.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:f.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:f.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:f.NUMBER,minValue:0,lessThan:1},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:f.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.BOOLEAN},{argumentType:f.NUMBER,defaultValue:0},{argumentType:f.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:f.NUMBER,greaterThan:0,maxValue:1},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER,defaultValue:0},{argumentType:f.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:0,maxValue:1},{argumentType:f.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:0,maxValue:1},{argumentType:f.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,minValue:1,maxValue:1e10},{argumentType:f.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:f.NUMBER,minValue:0,maxValue:1},{argumentType:f.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:f.NUMBER,minValue:0,maxValue:1},{argumentType:f.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:1},{argumentType:f.NUMBER,minValue:1},{argumentType:f.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:1},{argumentType:f.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:f.NUMBER,minValue:0,maxValue:1},{argumentType:f.NUMBER,minValue:1},{argumentType:f.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:f.NUMBER,minValue:0,maxValue:1},{argumentType:f.NUMBER,minValue:1},{argumentType:f.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:0},{argumentType:f.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,minValue:1},{argumentType:f.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:1},{argumentType:f.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:f.NUMBER,greaterThan:0,lessThan:1},{argumentType:f.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:f.NUMBER,greaterThan:0,maxValue:1},{argumentType:f.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:f.NUMBER,greaterThan:0,lessThan:1},{argumentType:f.NUMBER},{argumentType:f.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:f.NUMBER,greaterThan:0,lessThan:1},{argumentType:f.NUMBER},{argumentType:f.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:f.NUMBER},{argumentType:f.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:f.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:f.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:1},{argumentType:f.NUMBER,minValue:0,maxValue:1},{argumentType:f.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:f.NUMBER,greaterThan:0,lessThan:1},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:f.NUMBER,greaterThan:0,lessThan:1},{argumentType:f.NUMBER,greaterThan:0},{argumentType:f.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER,greaterThan:0}]}};WR.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class VL extends Be{fact(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),n=>{n=Math.trunc(n);let s=1;for(let i=1;i<=n;i++)s*=i;return s})}factdouble(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),n=>{n=Math.trunc(n);let s=1;for(let i=n;i>=1;i-=2)s*=i;return s})}combin(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),(n,s)=>s>n?new v(S.NUM,N.WrongOrder):(n=Math.trunc(n),s=Math.trunc(s),PN(n,s)))}combina(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),(n,s)=>(n=Math.trunc(n),s=Math.trunc(s),n+s-1>=1030?new v(S.NUM,N.ValueLarge):n===0&&s===0?1:PN(n+s-1,s)))}gcd(e,t){return this.runFunction(e.args,t,this.metadata("GCD"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(n);if(s instanceof v)return s;let i=0;for(const o of s){if(o<0)return new v(S.NUM,N.ValueSmall);i=UL(i,Math.trunc(o))}return i>Number.MAX_SAFE_INTEGER?new v(S.NUM,N.ValueLarge):i})}lcm(e,t){return this.runFunction(e.args,t,this.metadata("LCM"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(n);if(s instanceof v)return s;let i=1;for(const o of s){if(o<0)return new v(S.NUM,N.ValueSmall);i=Gte(i,Math.trunc(o))}return i>Number.MAX_SAFE_INTEGER?new v(S.NUM,N.ValueLarge):i})}mround(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),(n,s)=>s===0?0:n>0&&s<0||n<0&&s>0?new v(S.NUM,N.DistinctSigns):Math.round(n/s)*s)}multinomial(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),(...n)=>{let s=0,i=1;for(let o of n){if(o<0)return new v(S.NUM,N.ValueSmall);o=Math.trunc(o);for(let a=1;a<=o;a++)i*=(s+a)/a;s+=o}return Math.round(i)})}quotient(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),(n,s)=>s===0?new v(S.DIV_BY_ZERO):Math.trunc(n/s))}seriessum(e,t){return this.runFunction(e.args,t,this.metadata("SERIESSUM"),(n,s,i,o)=>{const a=this.arithmeticHelper.manyToOnlyNumbersDropNulls(o.valuesFromTopLeftCorner());if(a instanceof v)return a;let l=0;a.reverse();for(const u of a)l*=Math.pow(n,i),l+=u;return l*Math.pow(n,s)})}sign(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),n=>n>0?1:n<0?-1:0)}sumx2my2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),(n,s)=>{const i=n.valuesFromTopLeftCorner(),o=s.valuesFromTopLeftCorner();if(i.length!==o.length)return new v(S.NA,N.EqualLength);const a=i.length;let l=0;for(let u=0;u<a;u++){const c=i[u],h=o[u];if(c instanceof v)return c;if(h instanceof v)return h;typeof c=="number"&&typeof h=="number"&&(l+=Math.pow(c,2)-Math.pow(h,2))}return l})}sumx2py2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),(n,s)=>{const i=n.valuesFromTopLeftCorner(),o=s.valuesFromTopLeftCorner();if(i.length!==o.length)return new v(S.NA,N.EqualLength);const a=i.length;let l=0;for(let u=0;u<a;u++){const c=i[u],h=o[u];if(c instanceof v)return c;if(h instanceof v)return h;typeof c=="number"&&typeof h=="number"&&(l+=Math.pow(c,2)+Math.pow(h,2))}return l})}sumxmy2(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),(n,s)=>{const i=n.valuesFromTopLeftCorner(),o=s.valuesFromTopLeftCorner();if(i.length!==o.length)return new v(S.NA,N.EqualLength);const a=i.length;let l=0;for(let u=0;u<a;u++){const c=i[u],h=o[u];if(c instanceof v)return c;if(h instanceof v)return h;typeof c=="number"&&typeof h=="number"&&(l+=Math.pow(c-h,2))}return l})}}VL.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:f.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:f.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:f.NUMBER,minValue:0,lessThan:1030},{argumentType:f.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:f.NUMBER,minValue:0},{argumentType:f.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:f.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:f.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:f.RANGE},{argumentType:f.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:f.RANGE},{argumentType:f.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:f.RANGE},{argumentType:f.RANGE}]}};function PN(r,e){2*e>r&&(e=r-e);let t=1;for(let n=1;n<=e;n++)t*=(r-e+n)/n;return Math.round(t)}function UL(r,e){for(r<e&&([r,e]=[e,r]);e>0;)[r,e]=[e,r%e];return r}function Gte(r,e){return r===0||e===0?0:r*(e/UL(r,e))}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class kL extends Be{complex(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),(n,s,i)=>i!=="i"&&i!=="j"?new v(S.VALUE,N.ShouldBeIorJ):Qt([n,s],i))}imabs(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),$L)}imaginary(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),([n,s])=>s)}imreal(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),([n,s])=>n)}imargument(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),([n,s])=>n===0&&s===0?new v(S.DIV_BY_ZERO):Math.atan2(s,n))}imconjugate(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),([n,s])=>Qt([n,-s]))}imcos(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),n=>Qt(wf(n)))}imcosh(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),n=>Qt(FN(n)))}imcot(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),n=>Qt(Ua(wf(n),Rf(n))))}imcsc(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),n=>Qt(Ua([1,0],Rf(n))))}imcsch(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),n=>Qt(Ua([1,0],DN(n))))}imsec(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),n=>Qt(Ua([1,0],wf(n))))}imsech(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),n=>Qt(Ua([1,0],FN(n))))}imsin(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),n=>Qt(Rf(n)))}imsinh(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),n=>Qt(DN(n)))}imtan(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),n=>Qt(Ua(Rf(n),wf(n))))}imdiv(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),(n,s)=>Qt(Ua(n,s)))}improduct(e,t){return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),(...n)=>{const s=this.arithmeticHelper.coerceComplexExactRanges(n);if(s instanceof v)return s;let i=[1,0];for(const o of s)i=BL(i,o);return Qt(i)})}imsum(e,t){return this.runFunction(e.args,t,this.metadata("IMSUM"),(...n)=>{const s=this.arithmeticHelper.coerceComplexExactRanges(n);if(s instanceof v)return s;let i=[0,0];for(const o of s)i=zte(i,o);return Qt(i)})}imsub(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),(n,s)=>Qt(Yte(n,s)))}imexp(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),n=>Qt(WL(n)))}imln(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),n=>Qt(em(n)))}imlog10(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),n=>{const[s,i]=em(n),o=Math.log(10);return Qt([s/o,i/o])})}imlog2(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),n=>{const[s,i]=em(n),o=Math.log(2);return Qt([s/o,i/o])})}impower(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),(n,s)=>Qt(HN(n,s)))}imsqrt(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),n=>Qt(HN(n,.5)))}}kL.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:f.NUMBER},{argumentType:f.NUMBER},{argumentType:f.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:f.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:f.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:f.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:f.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:f.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:f.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:f.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:f.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:f.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:f.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:f.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:f.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:f.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:f.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:f.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:f.COMPLEX},{argumentType:f.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:f.COMPLEX},{argumentType:f.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:f.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:f.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:f.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:f.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:f.COMPLEX},{argumentType:f.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:f.COMPLEX}]}};function zte([r,e],[t,n]){return[r+t,e+n]}function Yte([r,e],[t,n]){return[r-t,e-n]}function BL([r,e],[t,n]){return[r*t-e*n,r*n+t*e]}function Ua([r,e],[t,n]){const s=Math.pow(t,2)+Math.pow(n,2),[i,o]=BL([r,e],[t,-n]);return[i/s,o/s]}function wf([r,e]){return[Math.cos(r)*Math.cosh(e),-Math.sin(r)*Math.sinh(e)]}function FN([r,e]){return[Math.cosh(r)*Math.cos(e),Math.sinh(r)*Math.sin(e)]}function Rf([r,e]){return[Math.sin(r)*Math.cosh(e),Math.cos(r)*Math.sinh(e)]}function DN([r,e]){return[Math.sinh(r)*Math.cos(e),Math.cosh(r)*Math.sin(e)]}function WL([r,e]){return[Math.exp(r)*Math.cos(e),Math.exp(r)*Math.sin(e)]}function $L([r,e]){return Math.sqrt(r*r+e*e)}function em([r,e]){return[Math.log($L([r,e])),Math.atan2(e,r)]}function HN(r,e){const[t,n]=em(r);return WL([e*t,e*n])}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class $R extends Be{avedev(e,t){return this.runFunction(e.args,t,this.metadata("AVEDEV"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);if(s instanceof v)return s;if(s.length===0)return new v(S.DIV_BY_ZERO);const i=ms(s);return s.reduce((o,a)=>o+Math.abs(a-i),0)/s.length})}devsq(e,t){return this.runFunction(e.args,t,this.metadata("DEVSQ"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);return s instanceof v?s:s.length===0?0:Wa(s)})}geomean(e,t){return this.runFunction(e.args,t,this.metadata("GEOMEAN"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);if(s instanceof v)return s;if(s.length===0)return new v(S.NUM,N.OneValue);for(const i of s)if(i<=0)return new v(S.NUM,N.ValueSmall);return $te(s)})}harmean(e,t){return this.runFunction(e.args,t,this.metadata("HARMEAN"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);if(s instanceof v)return s;if(s.length===0)return new v(S.NUM,N.OneValue);for(const i of s)if(i<=0)return new v(S.NUM,N.ValueSmall);return s.length/s.reduce((i,o)=>i+1/o,0)})}correl(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),(n,s)=>{if(n.numberOfElements()!==s.numberOfElements())return new v(S.NA,N.EqualLength);const i=ka(n,s);return i instanceof v?i:i[0].length<=1?new v(S.DIV_BY_ZERO,N.TwoValues):LN(i[0],i[1])})}rsq(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),(n,s)=>{if(n.numberOfElements()!==s.numberOfElements())return new v(S.NA,N.EqualLength);const i=ka(n,s);return i instanceof v?i:i[0].length<=1?new v(S.DIV_BY_ZERO,N.TwoValues):Math.pow(LN(i[0],i[1]),2)})}covariancep(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),(n,s)=>{if(n.numberOfElements()!==s.numberOfElements())return new v(S.NA,N.EqualLength);const i=ka(n,s);if(i instanceof v)return i;const o=i[0].length;return o<1?new v(S.DIV_BY_ZERO,N.OneValue):o===1?0:Fc(i[0],i[1])*(o-1)/o})}covariances(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),(n,s)=>{if(n.numberOfElements()!==s.numberOfElements())return new v(S.NA,N.EqualLength);const i=ka(n,s);return i instanceof v?i:i[0].length<=1?new v(S.DIV_BY_ZERO,N.TwoValues):Fc(i[0],i[1])})}ztest(e,t){return this.runFunction(e.args,t,this.metadata("Z.TEST"),(n,s,i)=>{const o=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner());if(o instanceof v)return o;const a=o.length;if(i===void 0){if(a<2)return new v(S.DIV_BY_ZERO,N.TwoValues);i=Xo(o,!0)}return a<1?new v(S.NA,N.OneValue):i===0?new v(S.DIV_BY_ZERO):1-Gs.cdf((ms(o)-s)/(i/Math.sqrt(a)),0,1)})}ftest(e,t){return this.runFunction(e.args,t,this.metadata("F.TEST"),(n,s)=>{const i=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner()),o=this.arithmeticHelper.manyToExactNumbers(s.valuesFromTopLeftCorner());if(i instanceof v)return i;if(o instanceof v)return o;if(i.length<=1||o.length<=1)return new v(S.DIV_BY_ZERO);const a=Pc(i,!0),l=Pc(o,!0);if(a===0||l===0)return new v(S.DIV_BY_ZERO);const u=a/l,c=Xl.cdf(u,i.length-1,o.length-1);return 2*Math.min(c,1-c)})}steyx(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),(n,s)=>{if(n.numberOfElements()!==s.numberOfElements())return new v(S.NA,N.EqualLength);const i=ka(n,s);if(i instanceof v)return i;const o=i[0].length;return o<=2?new v(S.DIV_BY_ZERO,N.ThreeValues):Math.sqrt((Wa(i[0])-Math.pow(Fc(i[0],i[1])*(o-1),2)/Wa(i[1]))/(o-2))})}slope(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),(n,s)=>{if(n.numberOfElements()!==s.numberOfElements())return new v(S.NA,N.EqualLength);const i=ka(n,s);if(i instanceof v)return i;const o=i[0].length;return o<=1?new v(S.DIV_BY_ZERO,N.TwoValues):Fc(i[0],i[1])*(o-1)/Wa(i[1])})}chisqtest(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),(n,s)=>{const i=n.height(),o=n.width();if(s.height()!==i||s.width()!==o)return new v(S.NA,N.EqualLength);const a=ka(n,s);if(a instanceof v)return a;if(a[0].length<=1)return new v(S.DIV_BY_ZERO,N.TwoValues);let l=0;for(let u=0;u<a[0].length;u++){if(a[1][u]===0)return new v(S.DIV_BY_ZERO);l+=Math.pow(a[0][u]-a[1][u],2)/a[1][u]}return l<0?new v(S.NUM,N.NaN):1-Kl.cdf(l,i>1&&o>1?(i-1)*(o-1):i*o-1)})}ttest(e,t){return this.runFunction(e.args,t,this.metadata("T.TEST"),(n,s,i,o)=>{const a=this.arithmeticHelper.manyToExactNumbers(n.valuesFromTopLeftCorner()),l=this.arithmeticHelper.manyToExactNumbers(s.valuesFromTopLeftCorner());if(a instanceof v)return a;if(l instanceof v)return l;const u=a.length,c=l.length;if(o===1){if(c!==u)return new v(S.NA,N.EqualLength);if(u<=1)return new v(S.DIV_BY_ZERO,N.TwoValues);const h=Array(u);for(let E=0;E<u;E++)h[E]=a[E]-l[E];const d=Xo(h,!0);if(d===0)return new v(S.DIV_BY_ZERO);const m=Math.abs(Math.sqrt(u)*ms(h)/d);return i*(1-gs.cdf(m,u-1))}else if(o===2){if(u<=1||c<=1)return new v(S.DIV_BY_ZERO,N.TwoValues);const h=(Wa(a)+Wa(l))/(u+c-2);if(h===0)return new v(S.DIV_BY_ZERO);const d=Math.abs((ms(a)-ms(l))/Math.sqrt(h*(1/u+1/c)));return i*(1-gs.cdf(d,u+c-2))}else{if(u<=1||c<=1)return new v(S.DIV_BY_ZERO,N.TwoValues);const h=Pc(a,!0),d=Pc(l,!0);if(h===0&&d===0)return new v(S.DIV_BY_ZERO);const m=Math.abs((ms(a)-ms(l))/Math.sqrt(h/u+d/c)),E=Math.pow(h/u+d/c,2)/(Math.pow(h/u,2)/(u-1)+Math.pow(d/c,2)/(c-1));return i*(1-gs.cdf(m,E))}})}skew(e,t){return this.runFunction(e.args,t,this.metadata("SKEW"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);if(s instanceof v)return s;const i=s.length;if(i<3)return new v(S.DIV_BY_ZERO,N.ThreeValues);const o=ms(s),a=Xo(s,!0);return a===0?new v(S.DIV_BY_ZERO):s.reduce((l,u)=>l+Math.pow((u-o)/a,3),0)*i/(i-1)/(i-2)})}skewp(e,t){return this.runFunction(e.args,t,this.metadata("SKEW.P"),(...n)=>{const s=this.arithmeticHelper.coerceNumbersExactRanges(n);if(s instanceof v)return s;const i=s.length;if(i<3)return new v(S.DIV_BY_ZERO,N.ThreeValues);const o=ms(s),a=Xo(s,!1);return a===0?new v(S.DIV_BY_ZERO):s.reduce((l,u)=>l+Math.pow((u-o)/a,3),0)/i})}}$R.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:f.RANGE},{argumentType:f.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:f.RANGE},{argumentType:f.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:f.RANGE},{argumentType:f.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:f.RANGE},{argumentType:f.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:f.RANGE},{argumentType:f.NUMBER},{argumentType:f.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:f.RANGE},{argumentType:f.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:f.RANGE},{argumentType:f.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:f.RANGE},{argumentType:f.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:f.RANGE},{argumentType:f.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:f.RANGE},{argumentType:f.RANGE},{argumentType:f.INTEGER,minValue:1,maxValue:2},{argumentType:f.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:f.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:f.ANY}],repeatLastArgs:1}};$R.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};function ka(r,e){const t=r.iterateValuesFromTopLeftCorner(),n=e.iterateValuesFromTopLeftCorner();let s,i;const o=[],a=[];for(;s=t.next(),i=n.next(),!s.done&&!i.done;){const l=s.value,u=i.value;if(l instanceof v)return l;if(u instanceof v)return u;ct(l)&&ct(u)&&(o.push(le(l)),a.push(le(u)))}return[o,a]}/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */const VN=Object.freeze(Object.defineProperty({__proto__:null,AbsPlugin:$1,AddressPlugin:B1,ArrayPlugin:W1,BitShiftPlugin:G1,BitwiseLogicOperationsPlugin:K1,BooleanPlugin:X1,CharPlugin:q1,CodePlugin:Q1,ComplexPlugin:kL,ConditionalAggregationPlugin:CL,CountBlankPlugin:Z1,CountUniquePlugin:J1,DateTimePlugin:eL,DegreesPlugin:tL,DeltaPlugin:rL,ExpPlugin:nL,FinancialPlugin:sL,FormulaTextPlugin:iL,HyperlinkPlugin:oL,InformationPlugin:aL,IsEvenPlugin:lL,IsOddPlugin:uL,LogarithmPlugin:cL,LookupPlugin:AL,MathConstantsPlugin:hL,MathPlugin:VL,MatrixPlugin:dL,MedianPlugin:fL,ModuloPlugin:mL,NumericAggregationPlugin:HR,PowerPlugin:pL,RadiansPlugin:gL,RadixConversionPlugin:EL,RandomPlugin:RL,RomanPlugin:OL,RoundingPlugin:VR,SimpleArithmerticPlugin:IL,SqrtPlugin:SL,StatisticalAggregationPlugin:$R,StatisticalPlugin:WR,SumprodPlugin:TL,TextPlugin:bL,TrigonometryPlugin:NL},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright (c) 2024 Handsoncode. All rights reserved.
 */class Ye extends Yr{}Ye.HyperFormula=Yr;Ye.ErrorType=S;Ye.CellError=v;Ye.CellType=_n;Ye.CellValueType=Ks;Ye.CellValueDetailedType=OJ;Ye.DetailedCellError=C1;Ye.ExportedCellChange=cv;Ye.ExportedNamedExpressionChange=F1;Ye.ConfigValueTooBigError=h1;Ye.ConfigValueTooSmallError=c1;Ye.EvaluationSuspendedError=f1;Ye.ExpectedOneOfValuesError=d1;Ye.ExpectedValueOfTypeError=lt;Ye.ArraySize=Ze;Ye.SimpleRangeValue=Ee;Ye.EmptyValue=Xe;Ye.FunctionPlugin=Be;Ye.FunctionArgumentType=f;Ye.FunctionPluginValidationError=Mu;Ye.InvalidAddressError=n1;Ye.InvalidArgumentsError=gr;Ye.LanguageNotRegisteredError=JE;Ye.LanguageAlreadyRegisteredError=p1;Ye.MissingTranslationError=Yl;Ye.NamedExpressionDoesNotExistError=Th;Ye.NamedExpressionNameIsAlreadyTakenError=s1;Ye.NamedExpressionNameIsInvalidError=i1;Ye.NoOperationToRedoError=a1;Ye.NoOperationToUndoError=o1;Ye.NoRelativeAddressesAllowedError=_R;Ye.NoSheetWithIdError=Gt;Ye.NoSheetWithNameError=r1;Ye.NotAFormulaError=Kf;Ye.NothingToPasteError=l1;Ye.ProtectedFunctionTranslationError=m1;Ye.SheetNameAlreadyTakenError=Sh;Ye.SheetSizeLimitExceededError=Qa;Ye.SourceLocationHasArrayError=nu;Ye.TargetLocationHasArrayError=jm;Ye.UnableToParseError=u1;const jte=Wr.defaultConfig.language;Yr.registerLanguage(jte,hv);Yr.languages[hv.langCode]=hv;for(const r of Object.getOwnPropertyNames(VN))r.startsWith("_")||Yr.registerFunctionPlugin(VN[r]);const Kte={class:"left"},Xte={class:"tabs"},qte=["onClick","onDblclick","title"],Qte={class:"right"},Zte=["value"],Jte={class:"btn ghost",title:"Importar CSV"},ere={class:"celladdr"},tre=["onKeydown"],rre={style:{display:"grid",gap:"6px","min-width":"260px"}},nre={style:{display:"grid",gap:"4px"}},sre=["onKeydown"],ire={style:{display:"grid",gap:"4px"}},ore=["onKeydown"],are={class:"border-grid"},lre={style:{display:"flex",gap:"8px","align-items":"center","margin-top":"8px"}},ure={style:{display:"flex",gap:"6px","align-items":"center"}},cre={style:{display:"flex",gap:"6px","align-items":"center"}},hre={style:{display:"flex",gap:"6px","align-items":"center"}},dre={key:1,class:"empty"},fre=Lv({__name:"App",setup(r){tD(A=>({"57b97aad":m.value+"px"}));const e=Ye.buildEmpty({licenseKey:"gpl-v3"}),t=Ws(Z7());!t.activeId&&t.sheets.length&&(t.activeId=t.sheets[0].id);const n=Ri(()=>t.sheets),s=Ri({get:()=>t.activeId,set:A=>t.activeId=A}),i=Ri(()=>t.sheets.find(A=>A.id===t.activeId)||null),o=$t(),a=$t(null),l=$t(null),u=$t(null),c=$t(null),h=$t(null),d=$t(null),m=$t(300),E=Ws({rowHeaders:!0,colHeaders:!0,contextMenu:!0,dropdownMenu:!0,filters:!0,mergeCells:!0,customBorders:!0,hiddenRows:!0,hiddenColumns:!0,search:!0,persistentState:!0,fillHandle:{autoInsertRow:!0},copyPaste:!0,manualColumnResize:!0,manualRowResize:!0,manualColumnMove:!0,manualRowMove:!0,columnSorting:!0,selectionMode:"multiple",undo:!0,outsideClickDeselects:!1,minRows:100,minCols:26,height:"auto",formulas:{engine:e},licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!0,minSpareRows:1,afterSelectionEnd:(A,w)=>rr(A,w),afterBeginEditing:(A,w)=>XL(),beforeChange:A=>eP(A),afterInit:()=>je(),afterRender:()=>je()});function g(A){s.value=A}function O(){const A=t.sheets.length+1,w=Bf("Planilha "+A);t.sheets.push(w),s.value=w.id}function T(A){const w=prompt("Renomear planilha",A.name||"Planilha");w&&(A.name=w)}async function _(){var w;if(!i.value||!confirm("Apagar esta planilha?"))return;const A=t.sheets.findIndex(I=>I.id===i.value.id);A>=0&&t.sheets.splice(A,1),s.value=((w=t.sheets[0])==null?void 0:w.id)||null}function V(){var I,Z;const A=(I=o.value)==null?void 0:I.hotInstance;if(!A)return;A.getPlugin("exportFile").downloadFile("csv",{filename:(((Z=i.value)==null?void 0:Z.name)||"planilha").replace(/\s+/g,"_")})}function H(A){var Z;const w=(Z=A.target.files)==null?void 0:Z[0];if(!w)return;const I=new FileReader;I.onload=()=>{const X=String(I.result||"").split(/\r?\n/).map(He=>He.split(","));i.value&&(i.value.data=X)},I.readAsText(w)}Wc(t,()=>J7(t),{deep:!0});const Q=$t(null),oe=Ws({left:12,top:44});let re=null;const ie=Ri(()=>({left:oe.left+"px",top:oe.top+"px"}));function Fe(A,w){if(Q.value===A){Q.value=null;return}if(_e("menu"),Q.value=A,w&&(re=w.currentTarget,re)){const I=re.getBoundingClientRect();oe.left=Math.round(I.left),oe.top=Math.round(I.bottom)}}kc(()=>document.addEventListener("click",Ie)),Nc(()=>document.removeEventListener("click",Ie));function Ie(A){A.target.closest(".menubar, .toolbar, .dropdown, .formula")||(Q.value=null,ss.value=!1,rt.value=!1,Rl.value=!1,Cl.value=!1)}function _e(A){A!=="menu"&&(Q.value=null),A!=="search"&&(ss.value=!1),A!=="border"&&(rt.value=!1),A!=="align"&&(Rl.value=!1),A!=="format"&&(Cl.value=!1)}kc(()=>{const A=w=>{w.key==="Escape"&&_e()};window.addEventListener("keydown",A),Nc(()=>window.removeEventListener("keydown",A))});function tt(A){const w=A.target;if(w){const I=w.tagName;if(I==="INPUT"||I==="SELECT"||I==="TEXTAREA"||w.isContentEditable){A.stopPropagation();return}}A.preventDefault(),A.stopPropagation()}function Ge(){var I;if(!l.value)return;m.value=Math.max(200,Math.round(window.innerWidth*.7));const w=(I=o.value)==null?void 0:I.hotInstance;w&&(w.updateSettings({height:m.value}),w.render()),Cn()}kc(()=>{Mv(()=>{Ge()});const A=new ResizeObserver(()=>Ge());u.value&&A.observe(u.value),c.value&&A.observe(c.value),h.value&&A.observe(h.value),l.value&&A.observe(l.value),window.addEventListener("resize",Ge),window.addEventListener("scroll",Cn,!0),d.value&&d.value.addEventListener("scroll",Cn,{passive:!0})}),Nc(()=>{if(window.removeEventListener("resize",Ge),window.removeEventListener("scroll",Cn,!0),d.value&&d.value.removeEventListener("scroll",Cn),nt)try{nt()}catch{}});function ke(A){const w=A.getSelectedLast();if(!w)return null;const[I,Z,te,X]=w,He=Math.min(I,te),yt=Math.max(I,te),et=Math.min(Z,X),Wn=Math.max(Z,X);return{rStart:He,rEnd:yt,cStart:et,cEnd:Wn}}let nt=null;function je(){var A;try{if(nt){try{nt()}catch{}nt=null}const w=(A=o.value)==null?void 0:A.hotInstance,I=w==null?void 0:w.rootElement;if(!I)return;const Z=I.querySelectorAll(".wtHolder"),te=[];Z.forEach(X=>{const He=()=>Cn();X.addEventListener("scroll",He,{passive:!0}),te.push(()=>X.removeEventListener("scroll",He))}),nt=()=>te.forEach(X=>X())}catch{}}function Ne(A){var Z;const w=(Z=o.value)==null?void 0:Z.hotInstance;if(!w)return;const I=ke(w);if(I){for(let te=I.rStart;te<=I.rEnd;te++)for(let X=I.cStart;X<=I.cEnd;X++)A(w,te,X);w.render()}}function ue(A){Ne((w,I,Z)=>{const te=w.getCellMeta(I,Z).className||"",X=new Set(te.split(/\s+/).filter(Boolean));X.has(A)?X.delete(A):X.add(A),w.setCellMeta(I,Z,"className",Array.from(X).join(" "))})}function Ae(A){const w=new Set(["htLeft","htCenter","htRight"]);Ne((I,Z,te)=>{const X=I.getCellMeta(Z,te).className||"",He=new Set(X.split(/\s+/).filter(Boolean));for(const yt of w)He.delete(yt);He.add(A),I.setCellMeta(Z,te,"className",Array.from(He).join(" "))})}function bt(A){Ne((w,I,Z)=>{w.setCellMeta(I,Z,"type","numeric"),w.setCellMeta(I,Z,"numericFormat",{pattern:A})})}function p(){Ne((A,w,I)=>{const Z=A.getCellMeta(w,I);A.setCellMeta(w,I,"className",""),A.setCellMeta(w,I,"type",null),A.setCellMeta(w,I,"numericFormat",null),Z.customBorders&&A.setCellMeta(w,I,"customBorders",null)})}function y(){var Z;const A=(Z=o.value)==null?void 0:Z.hotInstance;if(!A)return;const w=ke(A);if(!w)return;const I=[];for(let te=w.rStart;te<=w.rEnd;te++)for(let X=w.cStart;X<=w.cEnd;X++)I.push([te,X,""]);A.setDataAtCell(I)}function R(){var A,w;(w=(A=o.value)==null?void 0:A.hotInstance)==null||w.undo()}function x(){var A,w;(w=(A=o.value)==null?void 0:A.hotInstance)==null||w.redo()}function P(){var I;const A=(I=o.value)==null?void 0:I.hotInstance;if(!A)return;const w=ke(A);w&&A.alter("insert_row_above",w.rStart,w.rEnd-w.rStart+1)}function U(){var I;const A=(I=o.value)==null?void 0:I.hotInstance;if(!A)return;const w=ke(A);w&&A.alter("insert_row_below",w.rEnd,w.rEnd-w.rStart+1)}function G(){var I;const A=(I=o.value)==null?void 0:I.hotInstance;if(!A)return;const w=ke(A);w&&A.alter("insert_col_start",w.cStart,w.cEnd-w.cStart+1)}function j(){var I;const A=(I=o.value)==null?void 0:I.hotInstance;if(!A)return;const w=ke(A);w&&A.alter("insert_col_end",w.cEnd,w.cEnd-w.cStart+1)}function fe(){var I;const A=(I=o.value)==null?void 0:I.hotInstance;if(!A)return;const w=ke(A);w&&A.getPlugin("columnSorting").sort({column:w.cStart,sortOrder:"asc"})}function me(){var I;const A=(I=o.value)==null?void 0:I.hotInstance;if(!A)return;const w=ke(A);w&&A.getPlugin("columnSorting").sort({column:w.cStart,sortOrder:"desc"})}function ne(){var A,w,I,Z;(Z=(I=(w=(A=o.value)==null?void 0:A.hotInstance)==null?void 0:w.getPlugin("mergeCells"))==null?void 0:I.mergeSelection)==null||Z.call(I)}function b(){var A,w,I,Z;(Z=(I=(w=(A=o.value)==null?void 0:A.hotInstance)==null?void 0:w.getPlugin("mergeCells"))==null?void 0:I.unmergeSelection)==null||Z.call(I)}function M(){ue("htBold")}function D(){ue("htItalic")}function W(){ue("htUnderline")}function k(){Ae("htLeft")}function $(){Ae("htCenter")}function K(){Ae("htRight")}function Y(){ue("htTop")}function z(){ue("htMiddle")}function B(){ue("htBottom")}function ae(){bt("R$ 0,0.00")}function se(){bt("0,0%")}function ye(){bt("0,0")}function Se(){bt("0,0.0")}function xe(){bt("0,0.00")}function De(){Ne((A,w,I)=>{A.setCellMeta(w,I,"type","text")})}function Le(){Ne((A,w,I)=>{A.setCellMeta(w,I,"type","numeric")})}function Kt(){Ne((A,w,I)=>{A.setCellMeta(w,I,"type","date"),A.setCellMeta(w,I,"dateFormat","YYYY-MM-DD")})}const Ht=$t(13);function Rr(){const A=`fs-${Ht.value}`;Ne((w,I,Z)=>{const te=w.getCellMeta(I,Z).className||"",X=new Set(te.split(/\s+/).filter(Boolean));["fs-10","fs-11","fs-12","fs-13","fs-14","fs-16","fs-18"].forEach(He=>X.delete(He)),X.add(A),w.setCellMeta(I,Z,"className",Array.from(X).join(" "))})}function It(){ue("htWrap")}const Sr=$t(1),cr=$t("solid"),gt=$t("#1f2937"),rt=$t(!1),Nt=Ws({left:12,top:100});let Sn=null;const Lo=Ri(()=>({left:Nt.left+"px",top:Nt.top+"px"}));function ng(A){const w=!rt.value;if(_e(w?"border":void 0),rt.value=w,A){Sn=A.currentTarget;const I=Sn.getBoundingClientRect();Nt.left=Math.round(I.left),Nt.top=Math.round(I.bottom+4)}}function Cn(){try{if(Rl.value&&ad){const A=ad.getBoundingClientRect();Sl.left=Math.round(A.left),Sl.top=Math.round(A.bottom+4)}if(Cl.value&&ld){const A=ld.getBoundingClientRect();Tl.left=Math.round(A.left),Tl.top=Math.round(A.bottom+4)}if(ss.value&&ya){const A=ya.getBoundingClientRect();Xr.left=Math.round(A.left),Xr.top=Math.round(A.bottom+4)}if(rt.value&&Sn){const A=Sn.getBoundingClientRect();Nt.left=Math.round(A.left),Nt.top=Math.round(A.bottom+4)}if(Q.value&&re){const A=re.getBoundingClientRect();oe.left=Math.round(A.left),oe.top=Math.round(A.bottom)}}catch{}}function td(A){return{width:A??Sr.value,color:gt.value,style:cr.value}}function sg(){Kr("all")}function hr(){Kr("outline")}function Po(){var Z;const A=(Z=o.value)==null?void 0:Z.hotInstance;if(!A)return;const w=ke(A);if(!w)return;const I=A.getPlugin("customBorders");if(I&&typeof I.clearBorders=="function")I.clearBorders({row:w.rStart,col:w.cStart,width:w.cEnd-w.cStart+1,height:w.rEnd-w.rStart+1});else for(let te=w.rStart;te<=w.rEnd;te++)for(let X=w.cStart;X<=w.cEnd;X++)A.getCellMeta(te,X).customBorders&&A.setCellMeta(te,X,"customBorders",null);A.render()}function ns(A,w,I,Z){const te=A.getPlugin("customBorders"),X={};I.left&&(X.left=Z),I.right&&(X.right=Z),I.top&&(X.top=Z),I.bottom&&(X.bottom=Z),Object.keys(X).length&&te.setBorders(w,X)}function Kr(A){var ud;const w=(ud=o.value)==null?void 0:ud.hotInstance;if(!w)return;const I=ke(w);if(!I)return;const Z=A==="thickOutline"?td(3):td(),te={width:Z.width,color:Z.color},{rStart:X,rEnd:He,cStart:yt,cEnd:et}=I,Wn=w.getPlugin("customBorders");if(A==="clear"){Wn.clearBorders({row:X,col:yt,width:et-yt+1,height:He-X+1}),w.render();return}const Ls=He>X,is=et>yt,os=()=>{ns(w,{row:X,col:yt,width:et-yt+1,height:1},{top:!0},te),ns(w,{row:He,col:yt,width:et-yt+1,height:1},{bottom:!0},te),ns(w,{row:X,col:yt,width:1,height:He-X+1},{left:!0},te),ns(w,{row:X,col:et,width:1,height:He-X+1},{right:!0},te)},ji=()=>{if(Ls)for(let ci=X;ci<He;ci++)ns(w,{row:ci,col:yt,width:et-yt+1,height:1},{bottom:!0},te)},va=()=>{if(is)for(let ci=yt;ci<et;ci++)ns(w,{row:X,col:ci,width:1,height:He-X+1},{right:!0},te)};switch(A){case"outline":os();break;case"thickOutline":os();break;case"inner":ji(),va();break;case"innerHorizontal":ji();break;case"innerVertical":va();break;case"all":os(),ji(),va();break;case"left":ns(w,{row:X,col:yt,width:1,height:He-X+1},{left:!0},te);break;case"right":ns(w,{row:X,col:et,width:1,height:He-X+1},{right:!0},te);break;case"top":ns(w,{row:X,col:yt,width:et-yt+1,height:1},{top:!0},te);break;case"bottom":ns(w,{row:He,col:yt,width:et-yt+1,height:1},{bottom:!0},te);break}w.render()}function Bu(){E.fixedRowsTop=1}function rd(){E.fixedColumnsLeft=1}function nd(){E.fixedRowsTop=0,E.fixedColumnsLeft=0}const ma=$t(null),li=$t(null);function Wu(){var I;const A=(I=o.value)==null?void 0:I.hotInstance;if(!A||ma==null||ma.value==null)return;const w=ke(A);if(w){for(let Z=w.rStart;Z<=w.rEnd;Z++)A.setRowHeight(Z,ma.value);A.render()}}function ig(){var I;const A=(I=o.value)==null?void 0:I.hotInstance;if(!A||li==null||li.value==null)return;const w=ke(A);if(w){for(let Z=w.cStart;Z<=w.cEnd;Z++)A.setColWidth(Z,li.value);A.render()}}function cn(){var Z;const A=(Z=o.value)==null?void 0:Z.hotInstance;if(!A)return;const w=ke(A);if(!w)return;const I=Array.from({length:w.rEnd-w.rStart+1},(te,X)=>w.rStart+X);A.getPlugin("hiddenRows").hideRows(I),A.render()}function pa(){var Z;const A=(Z=o.value)==null?void 0:Z.hotInstance;if(!A)return;const w=ke(A);if(!w)return;const I=Array.from({length:w.cEnd-w.cStart+1},(te,X)=>w.cStart+X);A.getPlugin("hiddenColumns").hideColumns(I),A.render()}function $u(){var Z;const A=(Z=o.value)==null?void 0:Z.hotInstance;if(!A)return;const w=A.countRows(),I=A.countCols();A.getPlugin("hiddenRows").showRows([...Array(w).keys()]),A.getPlugin("hiddenColumns").showColumns([...Array(I).keys()]),A.render()}const Fo=$t(""),ga=$t(""),ss=$t(!1),Xr=Ws({left:12,top:100});let ya=null;const sd=Ri(()=>({left:Xr.left+"px",top:Xr.top+"px"}));function id(A){const w=!ss.value;if(_e(w?"search":void 0),ss.value=w,A){ya=A.currentTarget;const I=ya.getBoundingClientRect();Xr.left=Math.round(I.left),Xr.top=Math.round(I.bottom+4)}}let Ea=[],Gu=0;function Ce(){var Z;const A=(Z=o.value)==null?void 0:Z.hotInstance;if(!A||(Ea=A.getPlugin("search").query(Fo.value||"")||[],!Ea.length))return;Gu=(Gu+1)%Ea.length;const I=Ea[Gu];A.selectCell(I.row,I.col)}function L(){var te;const A=(te=o.value)==null?void 0:te.hotInstance;if(!A||!Fo.value)return;const Z=(A.getPlugin("search").query(Fo.value)||[]).map(X=>[X.row,X.col,ga.value]);A.setDataAtCell(Z)}const q=Ws({r:0,c:0}),ce=Ri(()=>`${Yu(q.c)}${q.r+1}`),Pe=$t(""),dr=$t(!1);let fr=[],Xt=null,hn=null;function rr(A,w){var X,He,yt;q.r=A,q.c=w;const I=(X=o.value)==null?void 0:X.hotInstance;if(!I)return;if(dr.value&&Pe.value.startsWith("=")){const et=ke(I);if(et){const Wn=`${Yu(et.cStart)}${et.rStart+1}${et.rEnd!==et.rStart||et.cEnd!==et.cStart?":"+Yu(et.cEnd)+(et.rEnd+1):""}`;YL(Wn),ju()}return}if(hn&&((He=hn.value)!=null&&He.startsWith("="))){const et=ke(I);if(et){const Wn=`${Yu(et.cStart)}${et.rStart+1}${et.rEnd!==et.rStart||et.cEnd!==et.cStart?":"+Yu(et.cEnd)+(et.rEnd+1):""}`;jL(hn,Wn),ui();const Ls=Pe.value;Pe.value=hn.value,ju(),Pe.value=Ls}return}const Z=I.getDataAtCell(A,w);let te;try{te=(yt=I.getSourceDataAtCell)==null?void 0:yt.call(I,A,w)}catch{}typeof te=="string"&&te.startsWith("=")?Pe.value=te:Pe.value=Z??""}function zu(){var I;const A=(I=o.value)==null?void 0:I.hotInstance;if(!A)return;const w=og(Pe.value);A.setDataAtCell(q.r,q.c,w),dr.value=!1,ui()}function od(){dr.value=!0,ju()}function GR(){dr.value=!1,ui()}function GL(){dr.value&&ju()}function zL(){i.value&&T(i.value)}function Yu(A){let w="";A=A|0;do w=String.fromCharCode(65+A%26)+w,A=Math.floor(A/26)-1;while(A>=0);return w}function zR(A){const w=A.match(/^([A-Z]+)(\d+)$/i);if(!w)return null;const I=w[1].toUpperCase(),Z=parseInt(w[2],10)-1;let te=0;for(let X=0;X<I.length;X++)te=te*26+(I.charCodeAt(X)-64);return{r:Z,c:te-1}}function YR(A){if(!A||A[0]!=="=")return[];const w=[],I=/\b([A-Z]+\d+)(?::([A-Z]+\d+))?/gi;let Z;for(;Z=I.exec(A);){const te=zR(Z[1]);if(te)if(Z[2]){const X=zR(Z[2]);if(!X)continue;w.push({r1:Math.min(te.r,X.r),c1:Math.min(te.c,X.c),r2:Math.max(te.r,X.r),c2:Math.max(te.c,X.c)})}else w.push({r1:te.r,c1:te.c,r2:te.r,c2:te.c})}return w}function YL(A){const w=a.value;if(!w)return;const I=w.selectionStart??Pe.value.length,Z=w.selectionEnd??I,te=Pe.value.slice(0,I),X=Pe.value.slice(Z);Pe.value=te+A+X,requestAnimationFrame(()=>{try{w.focus();const He=(te+A).length;w.setSelectionRange(He,He)}catch{}})}function jL(A,w){const I=A.selectionStart??A.value.length,Z=A.selectionEnd??I,te=A.value.slice(0,I),X=A.value.slice(Z);A.value=te+w+X;try{A.focus();const He=(te+w).length;A.setSelectionRange(He,He)}catch{}}function ui(){var w;(w=o.value)!=null&&w.hotInstance&&(fr.forEach(I=>I.remove()),fr=[])}function ju(){var X;const A=(X=o.value)==null?void 0:X.hotInstance;if(!A||(ui(),!Pe.value.startsWith("=")))return;const w=YR(Pe.value);if(!w.length)return;const I=["#1a73e8","#d93025","#188038","#f9ab00","#9334e6"],Z=A.rootElement,te=Z.getBoundingClientRect();w.forEach((He,yt)=>{const et=A.getCell(He.r1,He.c1),Wn=A.getCell(He.r2,He.c2);if(!et||!Wn)return;const Ls=et.getBoundingClientRect(),is=Wn.getBoundingClientRect(),os=Ls.left-te.left,ji=Ls.top-te.top,va=is.right-Ls.left,ud=is.bottom-Ls.top,ci=I[yt%I.length],$n=document.createElement("div");$n.className="ref-overlay",$n.style.position="absolute",$n.style.pointerEvents="none",$n.style.left=os+"px",$n.style.top=ji+"px",$n.style.width=Math.max(0,va)+"px",$n.style.height=Math.max(0,ud)+"px",$n.style.border=`2px dashed ${ci}`,$n.style.background=KL(ci,.06),$n.style.boxSizing="border-box",$n.style.zIndex="4500",Z.appendChild($n),fr.push($n)})}function KL(A,w){const I=A.replace("#",""),Z=parseInt(I.substring(0,2),16),te=parseInt(I.substring(2,4),16),X=parseInt(I.substring(4,6),16);return`rgba(${Z}, ${te}, ${X}, ${w})`}Nc(()=>{ui()});function XL(A,w){var Wn,Ls;const I=(Wn=o.value)==null?void 0:Wn.hotInstance;if(!I)return;if(Xt){try{Xt()}catch{}Xt=null}const Z=(Ls=I.getActiveEditor)==null?void 0:Ls.call(I),te=Z==null?void 0:Z.TEXTAREA;if(!te)return;hn=te;const X=()=>{const is=te.value||"";if(is.startsWith("=")){ui();const os=is;if(YR(os).length){const va=Pe.value;Pe.value=os,ju(),Pe.value=va}else ui()}else ui()},He=()=>{ui(),hn=null},yt=is=>{(is.key==="Enter"||is.key==="Escape")&&ui()};te.addEventListener("input",X),te.addEventListener("blur",He),te.addEventListener("keydown",yt);const et=is=>{if(is.key==="Enter")try{const os=te.value||"";if(os.startsWith("=")){const ji=og(os);ji!==os&&(te.value=ji)}}catch{}};te.addEventListener("keydown",et,!0),X(),Xt=()=>{te.removeEventListener("input",X),te.removeEventListener("blur",He),te.removeEventListener("keydown",yt),te.removeEventListener("keydown",et,!0),hn=null}}const Rl=$t(!1),Sl=Ws({left:12,top:100});let ad=null;const qL=Ri(()=>({left:Sl.left+"px",top:Sl.top+"px"}));function QL(A){const w=!Rl.value;if(_e(w?"align":void 0),Rl.value=w,A){ad=A.currentTarget;const I=ad.getBoundingClientRect();Sl.left=Math.round(I.left),Sl.top=Math.round(I.bottom+4)}}const Cl=$t(!1),Tl=Ws({left:12,top:100});let ld=null;const ZL=Ri(()=>({left:Tl.left+"px",top:Tl.top+"px"}));function JL(A){const w=!Cl.value;if(_e(w?"format":void 0),Cl.value=w,A){ld=A.currentTarget;const I=ld.getBoundingClientRect();Tl.left=Math.round(I.left),Tl.top=Math.round(I.bottom+4)}}function eP(A){if(A)for(const w of A){const I=w[3];typeof I=="string"&&I.trim().startsWith("=")&&(w[3]=og(I))}}function og(A){if(typeof A!="string"||!A.startsWith("="))return A;let w=A;const I=[];w=w.replace(/"([^"\\]|\\.|"")*"/g,X=>`__STR_PLACEHOLDER_${I.push(X)-1}__`),w=w.replace(/;/g,",");const Z={SOMA:"SUM",SOMASE:"SUMIF",SOMASES:"SUMIFS",MEDIA:"AVERAGE",MEDIASE:"AVERAGEIF",MEDIASES:"AVERAGEIFS",MIN:"MIN",MINIMO:"MIN",MAX:"MAX",MAXIMO:"MAX",SE:"IF",E:"AND",OU:"OR",NAO:"NOT",CONTSE:"COUNTIF",CONTSES:"COUNTIFS",CONTNUM:"COUNT","CONT.NM":"COUNT","CONT.NMEROS":"COUNT",CONTVALORES:"COUNTA","CONT.VALORES":"COUNTA",PROCV:"VLOOKUP",PROCH:"HLOOKUP",INDICE:"INDEX",NDICE:"INDEX",CORRESP:"MATCH",ARRED:"ROUND",ARREDONDAR:"ROUND","ARREDONDAR.PARA.BAIXO":"ROUNDDOWN","ARREDONDAR.PARA.CIMA":"ROUNDUP",TEXTO:"TEXT",CONCAT:"CONCAT",CONCATENAR:"CONCAT",HOJE:"TODAY",AGORA:"NOW",VERDADEIRO:"TRUE",FALSO:"FALSE"},te=X=>X.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"");return w=w.replace(/([A-Za-z-\.]+)\s*(?=\()/g,X=>{const He=te(X).toUpperCase().replace(/\./g,"");return Z[He]||X}),w=w.replace(/\b((?:\d{1,3}(?:\.\d{3})+)|\d+),(\d+)\b/g,(X,He,yt)=>String(He).replace(/\./g,"")+"."+yt),w=w.replace(/__STR_PLACEHOLDER_(\d+)__/g,(X,He)=>I[Number(He)]),w}return(A,w)=>(pr(),Zr("div",{class:"wrap",ref_key:"wrapEl",ref:l},[F("nav",{class:"menubar",ref_key:"menubarEl",ref:u,onMousedown:tt},[F("button",{class:"menuitem",onClick:w[0]||(w[0]=I=>Fe("arquivo",I))}," Arquivo "),F("button",{class:"menuitem",onClick:w[1]||(w[1]=I=>Fe("editar",I))}," Editar "),F("button",{class:"menuitem",onClick:w[2]||(w[2]=I=>Fe("inserir",I))}," Inserir "),F("button",{class:"menuitem",onClick:w[3]||(w[3]=I=>Fe("formatar",I))}," Formatar "),F("button",{class:"menuitem",onClick:w[4]||(w[4]=I=>Fe("dados",I))}," Dados "),F("button",{class:"menuitem",onClick:w[5]||(w[5]=I=>Fe("ajuda",I))}," Ajuda "),Q.value==="arquivo"?(pr(),Zr("div",{key:0,class:"dropdown",style:Yn(ie.value)},[F("button",{onClick:O},"Nova planilha"),F("label",null,[F("input",{type:"file",accept:".csv,text/csv",onChange:H,hidden:""},null,32),w[33]||(w[33]=Zy(" Importar CSV ",-1))]),F("button",{onClick:V},"Exportar CSV"),w[34]||(w[34]=F("hr",null,null,-1)),F("button",{class:"danger",onClick:_},"Apagar planilha")],4)):hi("",!0),Q.value==="editar"?(pr(),Zr("div",{key:1,class:"dropdown",style:Yn(ie.value)},[F("button",{onClick:R},"Desfazer"),F("button",{onClick:x},"Refazer"),F("button",{onClick:y},"Apagar contedo"),F("button",{onClick:p},"Limpar formatao")],4)):hi("",!0),Q.value==="inserir"?(pr(),Zr("div",{key:2,class:"dropdown",style:Yn(ie.value)},[F("button",{onClick:P},"Linha acima"),F("button",{onClick:U},"Linha abaixo"),F("button",{onClick:G},"Coluna  esquerda"),F("button",{onClick:j},"Coluna  direita")],4)):hi("",!0),Q.value==="formatar"?(pr(),Zr("div",{key:3,class:"dropdown",style:Yn(ie.value)},[F("button",{onClick:M},"Negrito"),F("button",{onClick:D},"Itlico"),F("button",{onClick:W},"Sublinhado"),w[35]||(w[35]=F("hr",null,null,-1)),F("button",{onClick:k},"Alinhar  esquerda"),F("button",{onClick:$},"Centralizar"),F("button",{onClick:K},"Alinhar  direita"),w[36]||(w[36]=F("hr",null,null,-1)),F("button",{onClick:ae},"Formato moeda (R$)"),F("button",{onClick:se},"Formato percentual (%)"),F("button",{onClick:ye},"0 decimais"),F("button",{onClick:Se},"1 decimal"),F("button",{onClick:xe},"2 decimais")],4)):hi("",!0),Q.value==="dados"?(pr(),Zr("div",{key:4,class:"dropdown",style:Yn(ie.value)},[F("button",{onClick:fe},"Ordenar A  Z"),F("button",{onClick:me},"Ordenar Z  A"),w[37]||(w[37]=F("hr",null,null,-1)),F("button",{onClick:ne},"Mesclar"),F("button",{onClick:b},"Desmesclar"),w[38]||(w[38]=F("hr",null,null,-1)),F("button",{onClick:cn},"Ocultar linhas"),F("button",{onClick:pa},"Ocultar colunas"),F("button",{onClick:$u},"Mostrar tudo")],4)):hi("",!0),Q.value==="ajuda"?(pr(),Zr("div",{key:5,class:"dropdown",style:Yn(ie.value)},[...w[39]||(w[39]=[F("div",{style:{padding:"6px 10px","max-width":"300px",color:"#4b5563"}}," Atalhos: Ctrl+Z/Y (Desfazer/Refazer), Ctrl+C/V (Copiar/Colar), Duplo clique na aba renomeia. ",-1)])],4)):hi("",!0)],544),F("header",{class:"toolbar",ref_key:"toolbarEl",ref:c,onMousedown:tt},[F("div",Kte,[F("div",Xte,[(pr(!0),Zr(gn,null,JR(n.value,I=>(pr(),Zr("button",{key:I.id,class:ap(["tab",{active:I.id===s.value}]),onClick:Z=>g(I.id),onDblclick:Qu(Z=>T(I),["stop"]),title:`Abrir ${I.name}`},Cf(I.name),43,qte))),128)),F("button",{class:"tab add",title:"Nova planilha",onClick:O}," + ")])]),F("div",Qte,[F("button",{class:"btn",onClick:R,title:"Desfazer"},""),F("button",{class:"btn",onClick:x,title:"Refazer"},""),w[45]||(w[45]=F("span",{class:"sep"},null,-1)),F("button",{class:"btn",onClick:M,title:"Negrito"},"B"),F("button",{class:"btn",onClick:D,title:"Itlico"},[...w[40]||(w[40]=[F("i",null,"I",-1)])]),F("button",{class:"btn",onClick:W,title:"Sublinhado"},[...w[41]||(w[41]=[F("u",null,"U",-1)])]),w[46]||(w[46]=F("span",{class:"sep"},null,-1)),F("button",{class:"btn",onClick:w[6]||(w[6]=I=>QL(I)),title:"Alinhar"},"  "),w[47]||(w[47]=F("span",{class:"sep"},null,-1)),F("button",{class:"btn",onClick:w[7]||(w[7]=I=>JL(I)),title:"Formato"}," x "),w[48]||(w[48]=F("span",{class:"sep"},null,-1)),as(F("select",{class:"btn","onUpdate:modelValue":w[8]||(w[8]=I=>Ht.value=I),onChange:Rr,title:"Tamanho da fonte"},[(pr(),Zr(gn,null,JR([10,11,12,13,14,16,18],I=>F("option",{key:I,value:I},Cf(I),9,Zte)),64))],544),[[qu,Ht.value]]),F("button",{class:"btn",onClick:It,title:"Quebra de texto"},"  "),w[49]||(w[49]=F("span",{class:"sep"},null,-1)),as(F("select",{class:"btn","onUpdate:modelValue":w[9]||(w[9]=I=>Sr.value=I),title:"Espessura borda"},[...w[42]||(w[42]=[F("option",{value:1},"1px",-1),F("option",{value:2},"2px",-1),F("option",{value:3},"3px",-1)])],512),[[qu,Sr.value]]),as(F("select",{class:"btn","onUpdate:modelValue":w[10]||(w[10]=I=>cr.value=I),title:"Estilo borda"},[...w[43]||(w[43]=[F("option",{value:"solid"},"slida",-1),F("option",{value:"dashed"},"tracejada",-1)])],512),[[qu,cr.value]]),F("button",{class:"btn",onClick:w[11]||(w[11]=I=>ng(I)),title:"Bordas"},"  "),as(F("input",{class:"btn",type:"color","onUpdate:modelValue":w[12]||(w[12]=I=>gt.value=I),title:"Cor da borda",style:{width:"40px",padding:"4px"}},null,512),[[Sa,gt.value]]),F("button",{class:"btn",onClick:hr,title:"Borda externa"},"  "),F("button",{class:"btn",onClick:sg,title:"Bordas em todas"},"  "),F("button",{class:"btn",onClick:Po,title:"Limpar bordas"},"  "),w[50]||(w[50]=F("span",{class:"sep"},null,-1)),as(F("input",{class:"btn",style:{width:"72px"},type:"number",min:"12",max:"120",step:"2","onUpdate:modelValue":w[13]||(w[13]=I=>ma.value=I),placeholder:"Altura",title:"Altura da linha"},null,512),[[Sa,ma.value,void 0,{number:!0}]]),F("button",{class:"btn",onClick:Wu,title:"Aplicar altura da(s) linha(s)"},"  "),as(F("input",{class:"btn",style:{width:"72px"},type:"number",min:"24",max:"400",step:"4","onUpdate:modelValue":w[14]||(w[14]=I=>li.value=I),placeholder:"Largura",title:"Largura da coluna"},null,512),[[Sa,li.value,void 0,{number:!0}]]),F("button",{class:"btn",onClick:ig,title:"Aplicar largura da(s) coluna(s)"},"  "),w[51]||(w[51]=F("span",{class:"sep"},null,-1)),F("button",{class:"btn",onClick:P,title:"Linha acima"},"  "),F("button",{class:"btn",onClick:U,title:"Linha abaixo"},"  "),F("button",{class:"btn",onClick:G,title:"Coluna  esquerda"},"  "),F("button",{class:"btn",onClick:j,title:"Coluna  direita"},"  "),F("button",{class:"btn",onClick:y,title:"Apagar contedo"},"  "),F("button",{class:"btn",onClick:p,title:"Limpar formatao"},"  "),w[52]||(w[52]=F("span",{class:"sep"},null,-1)),F("button",{class:"btn",onClick:fe,title:"Ordenar AZ"},"AZ"),F("button",{class:"btn",onClick:me,title:"Ordenar ZA"},"ZA"),F("button",{class:"btn",onClick:ne,title:"Mesclar"},""),F("button",{class:"btn",onClick:b,title:"Desmesclar"},""),F("button",{class:"btn",onClick:cn,title:"Ocultar linhas"}," L "),F("button",{class:"btn",onClick:pa,title:"Ocultar colunas"}," C "),F("button",{class:"btn",onClick:$u,title:"Mostrar tudo"},""),w[53]||(w[53]=F("span",{class:"sep"},null,-1)),F("button",{class:"btn",onClick:Bu,title:"Congelar 1 linha"},"  "),F("button",{class:"btn",onClick:rd,title:"Congelar 1 coluna"},"  "),F("button",{class:"btn",onClick:nd,title:"Descongelar"},""),w[54]||(w[54]=F("span",{class:"sep"},null,-1)),F("button",{class:"btn",onClick:w[15]||(w[15]=I=>id(I)),title:"Buscar/Substituir"},"  "),w[55]||(w[55]=F("span",{class:"sep"},null,-1)),F("button",{class:"btn",onClick:zL,title:"Renomear planilha"},"  "),F("button",{class:"btn ghost",onClick:V,title:"Exportar CSV"}," Exportar "),F("label",Jte,[F("input",{type:"file",accept:".csv,text/csv",onChange:H,hidden:""},null,32),w[44]||(w[44]=Zy(" Importar ",-1))]),F("button",{class:"btn danger",onClick:_,title:"Apagar planilha"}," Apagar ")])],544),F("div",{class:"formula",ref_key:"formulaEl",ref:h},[F("div",ere,Cf(ce.value),1),as(F("input",{ref_key:"formulaInput",ref:a,class:"formula-input","onUpdate:modelValue":w[16]||(w[16]=I=>Pe.value=I),onKeydown:[fd(Qu(zu,["prevent"]),["enter"]),fd(Qu(GR,["prevent"]),["esc"])],onFocus:od,onInput:GL,placeholder:"Digite = para frmulas"},null,40,tre),[[Sa,Pe.value]])],512),ss.value?(pr(),Zr("div",{key:0,class:"dropdown",style:Yn(sd.value),onMousedown:tt},[F("div",rre,[F("label",nre,[w[56]||(w[56]=F("span",{style:{"font-size":"12px",color:"#6b7280"}},"Buscar",-1)),as(F("input",{"onUpdate:modelValue":w[17]||(w[17]=I=>Fo.value=I),placeholder:"Texto a buscar",onKeydown:fd(Qu(Ce,["prevent"]),["enter"])},null,40,sre),[[Sa,Fo.value]])]),F("div",{style:{display:"flex",gap:"6px"}},[F("button",{class:"btn",onClick:Ce,title:"Prximo"}," Encontrar  ")]),F("label",ire,[w[57]||(w[57]=F("span",{style:{"font-size":"12px",color:"#6b7280"}},"Substituir por",-1)),as(F("input",{"onUpdate:modelValue":w[18]||(w[18]=I=>ga.value=I),placeholder:"Novo texto",onKeydown:fd(Qu(L,["prevent"]),["enter"])},null,40,ore),[[Sa,ga.value]])]),F("div",{style:{display:"flex",gap:"6px"}},[F("button",{class:"btn",onClick:L,title:"Substituir tudo"}," Substituir tudo ")])])],36)):hi("",!0),Rl.value?(pr(),Zr("div",{key:1,class:"dropdown",style:Yn(qL.value),onMousedown:tt},[F("div",{style:{display:"grid",gap:"6px","min-width":"220px"}},[w[58]||(w[58]=F("div",{style:{"font-size":"12px",color:"#6b7280"}},"Horizontal",-1)),F("div",{style:{display:"flex",gap:"6px"}},[F("button",{class:"btn",onClick:k},"Esquerda"),F("button",{class:"btn",onClick:$},"Centro"),F("button",{class:"btn",onClick:K},"Direita")]),w[59]||(w[59]=F("div",{style:{"font-size":"12px",color:"#6b7280"}},"Vertical",-1)),F("div",{style:{display:"flex",gap:"6px"}},[F("button",{class:"btn",onClick:Y},"Topo"),F("button",{class:"btn",onClick:z},"Meio"),F("button",{class:"btn",onClick:B},"Base")])])],36)):hi("",!0),Cl.value?(pr(),Zr("div",{key:2,class:"dropdown",style:Yn(ZL.value),onMousedown:tt},[F("div",{style:{display:"grid",gap:"6px","min-width":"240px"}},[w[60]||(w[60]=F("div",{style:{"font-size":"12px",color:"#6b7280"}},"Nmeros",-1)),F("div",{style:{display:"flex","flex-wrap":"wrap",gap:"6px"}},[F("button",{class:"btn",onClick:ae},"Moeda (R$)"),F("button",{class:"btn",onClick:se},"Percentual (%)"),F("button",{class:"btn",onClick:ye},"0 decimais"),F("button",{class:"btn",onClick:Se},"1 decimal"),F("button",{class:"btn",onClick:xe},"2 decimais")]),w[61]||(w[61]=F("div",{style:{"font-size":"12px",color:"#6b7280"}},"Tipo",-1)),F("div",{style:{display:"flex",gap:"6px"}},[F("button",{class:"btn",onClick:De},"Texto"),F("button",{class:"btn",onClick:Le},"Nmero"),F("button",{class:"btn",onClick:Kt},"Data")])])],36)):hi("",!0),rt.value?(pr(),Zr("div",{key:3,class:"dropdown",style:Yn(Lo.value),onMousedown:tt},[F("div",are,[F("button",{class:"bd-btn outline",onClick:w[19]||(w[19]=I=>Kr("outline")),title:"Contorno"}),F("button",{class:"bd-btn inner",onClick:w[20]||(w[20]=I=>Kr("inner")),title:"Internas"}),F("button",{class:"bd-btn all",onClick:w[21]||(w[21]=I=>Kr("all")),title:"Todas"}),F("button",{class:"bd-btn thick",onClick:w[22]||(w[22]=I=>Kr("thickOutline")),title:"Contorno grosso"}),F("button",{class:"bd-btn left",onClick:w[23]||(w[23]=I=>Kr("left")),title:"Esquerda"}),F("button",{class:"bd-btn right",onClick:w[24]||(w[24]=I=>Kr("right")),title:"Direita"}),F("button",{class:"bd-btn top",onClick:w[25]||(w[25]=I=>Kr("top")),title:"Superior"}),F("button",{class:"bd-btn bottom",onClick:w[26]||(w[26]=I=>Kr("bottom")),title:"Inferior"}),F("button",{class:"bd-btn innerH",onClick:w[27]||(w[27]=I=>Kr("innerHorizontal")),title:"Internas horizontais"}),F("button",{class:"bd-btn innerV",onClick:w[28]||(w[28]=I=>Kr("innerVertical")),title:"Internas verticais"}),F("button",{class:"bd-btn clear",onClick:w[29]||(w[29]=I=>Kr("clear")),title:"Limpar"})]),F("div",lre,[F("label",ure,[w[63]||(w[63]=F("span",{style:{"font-size":"12px",color:"#6b7280"}},"Largura",-1)),as(F("select",{"onUpdate:modelValue":w[30]||(w[30]=I=>Sr.value=I)},[...w[62]||(w[62]=[F("option",{value:1},"1",-1),F("option",{value:2},"2",-1),F("option",{value:3},"3",-1)])],512),[[qu,Sr.value]])]),F("label",cre,[w[65]||(w[65]=F("span",{style:{"font-size":"12px",color:"#6b7280"}},"Estilo",-1)),as(F("select",{"onUpdate:modelValue":w[31]||(w[31]=I=>cr.value=I)},[...w[64]||(w[64]=[F("option",{value:"solid"},"slida",-1),F("option",{value:"dashed"},"tracejada",-1)])],512),[[qu,cr.value]])]),F("label",hre,[w[66]||(w[66]=F("span",{style:{"font-size":"12px",color:"#6b7280"}},"Cor",-1)),as(F("input",{type:"color","onUpdate:modelValue":w[32]||(w[32]=I=>gt.value=I)},null,512),[[Sa,gt.value]])])])],36)):hi("",!0),F("main",{class:"board",ref_key:"boardEl",ref:d},[i.value?(pr(),um(cA(oR),{key:0,ref_key:"hotRef",ref:o,settings:E,data:i.value.data,class:"grid"},null,8,["settings","data"])):(pr(),Zr("div",dre,"Nenhuma planilha selecionada"))],512)],512))}}),mre=(r,e)=>{const t=r.__vccOpts||r;for(const[n,s]of e)t[n]=s;return t},pre=mre(fre,[["__scopeId","data-v-f7ce637d"]]);wD(pre).mount("#app")});export default gre();
