import{h as pe,p as UT,n as fs}from"./vendor.js";function KS(n){const e=n.length;let t=0;for(;t<e;)n[t]=[n[t]],t+=1}function sm(n,e){const t=e.length;let i=0;for(;i<t;)n.push(e[i]),i+=1}function Da(n){const e=[];if(!n||n.length===0||!n[0]||n[0].length===0)return e;const t=n.length,i=n[0].length;for(let o=0;o<t;o++)for(let s=0;s<i;s++)e[s]||(e[s]=[]),e[s][o]=n[o][s];return e}function at(n,e,t,i){let o=-1,s=n,r=t;Array.isArray(n)||(s=Array.from(n));const l=s.length;for(i&&l&&(o+=1,r=s[o]),o+=1;o<l;)r=e(r,s[o],o,s),o+=1;return r}function bo(n,e){let t=0,i=n;Array.isArray(n)||(i=Array.from(n));const o=i.length,s=[];let r=-1;for(;t<o;){const l=i[t];e(l,t,i)&&(r+=1,s[r]=l),t+=1}return s}function ae(n,e){let t=0,i=n;Array.isArray(n)||(i=Array.from(n));const o=i.length,s=[];let r=-1;for(;t<o;){const l=i[t];r+=1,s[r]=e(l,t,i),t+=1}return s}function b(n,e){let t=0,i=n;Array.isArray(n)||(i=Array.from(n));const o=i.length;for(;t<o&&e(i[t],t,i)!==!1;)t+=1;return n}function XS(n){return at(n,(e,t)=>e+t,0)}function zT(n){return at(n,(e,t)=>e>t?e:t,Array.isArray(n)?n[0]:void 0)}function GT(n){return at(n,(e,t)=>e<t?e:t,Array.isArray(n)?n[0]:void 0)}function YT(n){return n.length?XS(n)/n.length:0}function qS(n){return at(n,(e,t)=>e.concat(Array.isArray(t)?qS(t):t),[])}function Zm(n){const e=[];return b(n,t=>{e.indexOf(t)===-1&&e.push(t)}),e}function rm(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[i,...o]=[...e];let s=i;return b(o,r=>{s=s.filter(l=>!r.includes(l))}),s}function KT(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[i,...o]=[...e];let s=i;return b(o,r=>{s=s.filter(l=>r.includes(l))}),s}function XT(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[i,...o]=[...e],s=new Set(i);return b(o,r=>{b(r,l=>{s.has(l)||s.add(l)})}),Array.from(s)}function lm(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return n.split(e)}const qT=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:YT,arrayEach:b,arrayFilter:bo,arrayFlatten:qS,arrayMap:ae,arrayMax:zT,arrayMin:GT,arrayReduce:at,arraySum:XS,arrayUnique:Zm,extendArray:sm,getDifferenceOfArrays:rm,getIntersectionOfArrays:KT,getUnionOfArrays:XT,pivot:Da,stringToArray:lm,to2dArray:KS},Symbol.toStringTag,{value:"Module"}));function Re(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return at(n,(s,r,l)=>{const a=r.replace(/\r?\n\s*/g,""),h=t[l]?t[l]:"";return s+a+h},"").trim()}function Qe(n){let e;switch(typeof n){case"string":case"number":e=`${n}`;break;case"object":e=n===null?"":n.toString();break;case"undefined":e="";break;default:e=n.toString();break}return e}function F(n){return typeof n<"u"}function Ne(n){return typeof n>"u"}function Je(n){return n===null||n===""||Ne(n)}function QS(n){return Object.prototype.toString.call(n)==="[object RegExp]"}const Ha="length",La=n=>parseInt(n,16),nb=n=>parseInt(n,10),_c=(n,e,t)=>n.substr(e,t),ka=n=>n.codePointAt(0)-65,am=n=>`${n}`.replace(/\-/g,""),QT=n=>La(_c(am(n),La("12"),ka("F")))/(La(_c(am(n),ka("B"),~~![][Ha]))||9),JT=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let ib=!1;const ob={invalid:()=>Re`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return Re`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Re`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},sb={invalid:()=>Re`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return Re`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Re`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function JS(n,e){const t=!Je(n),i=typeof n=="string"&&n.toLowerCase()==="non-commercial-and-evaluation",o="14.6.2";let s,r="invalid",l="invalid";n=am(n||"");const a=ZT(n);if(t||i||a)if(a){const h=pe("10/02/2025","DD/MM/YYYY"),u=Math.floor(h.toDate().getTime()/864e5),c=QT(n);s=pe((c+1)*864e5,"x").format("MMMM DD, YYYY"),u>c?(r="expired",l="expired"):(r="valid",l="valid")}else i?(r="non_commercial",l="valid"):(r="invalid",l="invalid");else r="missing",l="missing";if(JT()&&(r="valid",l="valid"),!ib&&r!=="valid"&&(ob[r]({keyValidityDate:s,hotVersion:o})&&console[r==="non_commercial"?"info":"warn"](ob[r]({keyValidityDate:s,hotVersion:o})),ib=!0),l!=="valid"&&e.parentNode&&sb[l]({keyValidityDate:s,hotVersion:o})){const u=document.createElement("div");u.className="hot-display-license-info",u.innerHTML=sb[l]({keyValidityDate:s,hotVersion:o}),e.parentNode.insertBefore(u,e.nextSibling)}}function ZT(n){let e=[][Ha],t=e;if(n[Ha]!==ka("Z"))return!1;for(let i="",o="B<H4P+".split(""),s=ka(o.shift());s;s=ka(o.shift()||"A"))--s<""[Ha]?t=t|(nb(`${nb(La(i)+(La(_c(n,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=_c(n,s,s?o[Ha]===1?9:8:6);return t===e}const eM=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:JS,isDefined:F,isEmpty:Je,isRegExp:QS,isUndefined:Ne,stringify:Qe},Symbol.toStringTag,{value:"Module"}));function Nt(n){return n[0].toUpperCase()+n.substr(1)}function tM(){const n=[];for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];let o=t.length;for(;o;){o-=1;const s=Qe(t[o]).toLowerCase();n.indexOf(s)===-1&&n.push(s)}return n.length===1}function ep(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+n()+n()}function tp(n){return/^([0-9][0-9]?%$)|(^100%$)/.test(n)}function np(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${n}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,i)=>t.charAt(0)==="\\"?t.substr(1,t.length-1):e[i]===void 0?"":e[i])}function hm(n){return Rd(`${n}`,{ALLOWED_TAGS:[]})}function Rd(n,e){return UT.sanitize(n,e)}const nM=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:tM,isPercentValue:tp,randomString:ep,sanitize:Rd,stripTags:hm,substitute:np,toUpperCaseFirst:Nt},Symbol.toStringTag,{value:"Module"})),Rl=n=>["tabindex",n],iM=()=>["role","treegrid"],Wi=()=>["role","presentation"],oM=()=>["role","gridcell"],sM=()=>["role","rowheader"],ZS=()=>["role","rowgroup"],rM=()=>["role","columnheader"],um=()=>["role","row"],lM=()=>["role","menu"],aM=()=>["role","menuitem"],hM=()=>["role","menuitemcheckbox"],uM=()=>["role","combobox"],ey=()=>["role","listbox"],cM=()=>["role","option"],dM=()=>["role","checkbox"],fM=()=>["scope","col"],gM=()=>["scope","row"],mM=()=>["type","text"],Oc=n=>["aria-label",n],mr=()=>["aria-hidden","true"],pM=()=>["aria-disabled","true"],wM=()=>["aria-multiselectable","true"],ty=n=>["aria-haspopup",n],ny=n=>["aria-rowcount",n],Ed=n=>["aria-colcount",n],iy=n=>["aria-rowindex",n],ip=n=>["aria-colindex",n],Ln=n=>["aria-expanded",n],CM=n=>["aria-sort",n],rb=()=>["aria-readonly","true"],lb=()=>["aria-invalid","true"],oy=n=>["aria-checked",n],op=()=>["aria-selected","true"],bM=()=>["aria-autocomplete","list"],vM=n=>["aria-controls",n],SM=n=>["aria-activedescendant",n],yM=n=>["aria-live",n],RM=n=>["aria-relevant",n],EM=n=>["aria-setsize",n],TM=n=>["aria-posinset",n];function sy(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=-1,i=null,o=n;for(;o!==null;){if(t===e){i=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(t+=1,o=o.parentNode)}return i}function ry(n,e){const t=n.closest(".handsontable");return!!t&&(t.parentNode===e||t===e)}function ly(n){return Object.getPrototypeOf(n.parent)&&n.frameElement}function rr(n){return ly(n)&&n.parent}function MM(n){return!!Object.getPrototypeOf(n.parent)}function ss(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:o}=Node;let s=n;for(;s!=null&&s!==t;){const{nodeType:r,nodeName:l}=s;if(r===i&&(e.includes(l)||e.includes(s)))return s;const{host:a}=s;a&&r===o?s=a:s=s.parentNode}return null}function xa(n,e,t){const i=[];let o=n;for(;o&&(o=ss(o,e,t),!(!o||t&&!t.contains(o)));)i.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;const s=i.length;return s?i[s-1]:null}function ts(n,e){let t=n.parentNode,i=[];for(typeof e=="string"?n.defaultView?i=Array.prototype.slice.call(n.querySelectorAll(e),0):i=Array.prototype.slice.call(n.ownerDocument.querySelectorAll(e),0):i.push(e);t!==null;){if(i.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function ay(n){let e=0,t=n;if(t.previousSibling)for(;t=t.previousSibling;)e+=1;return e}function Fo(n,e,t){const i=t.parentElement.querySelector(`.ht_clone_${n}`);return i?i.contains(e):null}function hy(n){return!n||!n.length?[]:n.filter(e=>!!e)}function uy(n,e){if(!n||!n.length)return{regexFree:[],regexes:[]};const t=[],i=[];return i.push(...n.filter(o=>{const s=o instanceof RegExp;return s&&e&&t.push(o),!s})),{regexFree:i,regexes:t}}function K(n,e){return n.classList===void 0||typeof e!="string"||e===""?!1:n.classList.contains(e)}function P(n,e){typeof e=="string"&&(e=e.split(" ")),e=hy(e),e.length>0&&n.classList.add(...e)}function X(n,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:t,regexes:i}=uy(e,!0);t=hy(t),t.length>0&&n.classList.remove(...t),i.forEach(o=>{n.classList.forEach(s=>{o.test(s)&&n.classList.remove(s)})})}function Y(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,t]]),e.forEach(i=>{Array.isArray(i)&&i[0]!==""&&n.setAttribute(...i)})}function pr(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:t,regexes:i}=uy(e,!0);t.forEach(o=>{o!==""&&n.removeAttribute(o)}),i.forEach(o=>{n.getAttributeNames().forEach(s=>{o.test(s)&&n.removeAttribute(s)})})}function sp(n){if(n.nodeType===3)n.parentNode.removeChild(n);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(n.nodeName)>-1){const e=n.childNodes;for(let t=e.length-1;t>=0;t--)sp(e[t])}}function si(n){let e;for(;e=n.lastChild;)n.removeChild(e)}const cy=/(<(.*)>|&(.*);)/;function wr(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;cy.test(e)?n.innerHTML=t?Rd(e):e:rs(n,e)}function rs(n,e){const t=n.firstChild;t&&t.nodeType===3&&t.nextSibling===null?t.textContent=e:(si(n),n.appendChild(n.ownerDocument.createTextNode(e)))}function lr(n){const e=n.ownerDocument.documentElement;let t=n;for(;t!==e;){if(t===null)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(t.host){if(t.host.impl)return lr(t.host.impl);if(t.host)return lr(t.host);throw new Error("Lost in Web Components world")}else return!1;else if(Ui(t).display==="none")return!1;t=t.parentNode}return!0}function mt(n){const e=n.ownerDocument,t=e.defaultView,i=e.documentElement;let o=n,s,r,l;for(s=o.offsetLeft,r=o.offsetTop,l=o;(o=o.offsetParent)&&!(o===e.body||!("offsetLeft"in o));)s+=o.offsetLeft,r+=o.offsetTop,l=o;return l&&l.style.position==="fixed"&&(s+=t.pageXOffset||i.scrollLeft,r+=t.pageYOffset||i.scrollTop),{left:s,top:r}}function rp(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Td(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Md(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?rp(e):n.scrollTop}function lp(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?Td(e):n.scrollLeft}function sh(n){let e=n.ownerDocument,t=e?e.defaultView:void 0;e||(e=n.document?n.document:n,t=e.defaultView);const i=["auto","scroll"];let o=n.parentNode;for(;o&&o.style&&e.body!==o;){let{overflow:s,overflowX:r,overflowY:l}=o.style;if([s,r,l].includes("scroll"))return o;if({overflow:s,overflowX:r,overflowY:l}=t.getComputedStyle(o),i.includes(s)||i.includes(r)||i.includes(l)||o.clientHeight<=o.scrollHeight+1&&(i.includes(l)||i.includes(s))||o.clientWidth<=o.scrollWidth+1&&(i.includes(r)||i.includes(s)))return o;o=o.parentNode}return t}function dy(n){return n.scrollHeight-n.clientHeight}function fy(n){return n.scrollWidth-n.clientWidth}function ar(n){const e=n.ownerDocument,t=e.defaultView;let i=n.parentNode;for(;i&&i.style&&e.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;const o=Ui(i,t),s=["scroll","hidden","auto"],r=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),a=o.getPropertyValue("overflow-x");if(s.includes(r)||s.includes(l)||s.includes(a))return i;i=i.parentNode}return t}function wl(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(n){if(n===t)return e==="width"?`${t.innerWidth}px`:e==="height"?`${t.innerHeight}px`:void 0}else return;const i=n.style[e];if(i!==""&&i!==void 0)return i;const o=Ui(n,t);if(o[e]!==""&&o[e]!==void 0)return o[e]}function PM(n,e){const{selectorText:t}=e;let i=!1;return e.type===CSSRule.STYLE_RULE&&t&&(n.msMatchesSelector?i=n.msMatchesSelector(t):n.matches&&(i=n.matches(t))),i}function Ui(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n.currentStyle||e.getComputedStyle(n)}function De(n){return n.offsetWidth}function ot(n){return n.offsetHeight}function Js(n){return n.clientHeight||n.innerHeight}function ap(n){return n.clientWidth||n.innerWidth}function IM(n,e,t){n.addEventListener(e,t,!1)}function HM(n,e,t){n.removeEventListener(e,t,!1)}function hp(n){return n.selectionStart?n.selectionStart:0}function gy(n){return n.selectionEnd?n.selectionEnd:0}function xM(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=n.document;let t="";return n.getSelection?t=n.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(t=e.selection.createRange().text),t}function cm(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;n.getSelection&&(n.getSelection().empty?n.getSelection().empty():n.getSelection().removeAllRanges&&n.getSelection().removeAllRanges())}function Sh(n,e,t){if(t===void 0&&(t=e),n.setSelectionRange){n.focus();try{n.setSelectionRange(e,t)}catch{const o=n.parentNode,s=o.style.display;o.style.display="block",n.setSelectionRange(e,t),o.style.display=s}}}let cf;function AM(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=n.createElement("div");e.style.height="200px",e.style.width="100%";const t=n.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(n.body||n.documentElement).appendChild(t);const i=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return i===o&&(o=t.clientWidth),(n.body||n.documentElement).removeChild(t),i-o}function pt(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return cf===void 0&&(cf=AM(n)),cf}function my(n){return n.offsetWidth!==n.clientWidth}function py(n){return n.offsetHeight!==n.clientHeight}function Pd(n,e,t){n.style.transform=`translate3d(${e},${t},0)`}function _M(n){let e;return n.style.transform&&(e=n.style.transform)!==""?["transform",e]:-1}function yh(n){n.style.transform&&n.style.transform!==""&&(n.style.transform="")}function $a(n){return n&&(["INPUT","SELECT","TEXTAREA"].indexOf(n.nodeName)>-1||n.contentEditable==="true")}function Id(n){return $a(n)&&n.hasAttribute("data-hot-input")===!1}function OM(n){const e=n.ownerDocument.activeElement;Id(e)||n.select()}function up(n){return!n.parentNode}function wy(n,e){new IntersectionObserver((i,o)=>{i.forEach(s=>{s.isIntersecting&&n.offsetParent!==null&&(e(),o.unobserve(n))})},{root:n.ownerDocument.body}).observe(n)}function cp(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=n.ownerDocument,o=i.createRange(),s=i.defaultView.getSelection();Y(n,"contenteditable",!0),t&&Y(n,...mr()),e&&P(n,"invisibleSelection"),o.selectNodeContents(n),s.removeAllRanges(),s.addRange(o)}function dp(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const t=n.ownerDocument.defaultView.getSelection();n.hasAttribute("aria-hidden")&&n.removeAttribute("aria-hidden"),t.removeAllRanges(),e&&X(n,"invisibleSelection"),n.removeAttribute("contenteditable")}function Cy(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;cp(n,t),e(),dp(n,t)}const NM=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:cy,addClass:P,addEvent:IM,clearTextSelection:cm,closest:ss,closestDown:xa,empty:si,fastInnerHTML:wr,fastInnerText:rs,getCaretPosition:hp,getComputedStyle:Ui,getCssTransform:_M,getFrameElement:ly,getMaximumScrollLeft:fy,getMaximumScrollTop:dy,getParent:sy,getParentWindow:rr,getScrollLeft:lp,getScrollTop:Md,getScrollableElement:sh,getScrollbarWidth:pt,getSelectionEndPosition:gy,getSelectionText:xM,getStyle:wl,getTrimmingContainer:ar,getWindowScrollLeft:Td,getWindowScrollTop:rp,hasAccessToParentWindow:MM,hasClass:K,hasHorizontalScrollbar:py,hasVerticalScrollbar:my,index:ay,innerHeight:Js,innerWidth:ap,isChildOf:ts,isDetached:up,isInput:$a,isOutsideInput:Id,isThisHotChild:ry,isVisible:lr,makeElementContentEditableAndSelectItsContent:cp,matchesCSSRules:PM,observeVisibilityChangeOnce:wy,offset:mt,outerHeight:ot,outerWidth:De,overlayContainsElement:Fo,removeAttribute:pr,removeClass:X,removeContentEditableFromElementAndDeselect:dp,removeEvent:HM,removeTextNodes:sp,resetCssTransform:yh,runWithSelectedContendEditableElement:Cy,selectElementIfAllowed:OM,setAttribute:Y,setCaretPosition:Sh,setOverlayPosition:Pd},Symbol.toStringTag,{value:"Module"}));function _e(n){return typeof n=="function"}function by(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=0;const i={lastCallThrottled:!0};let o=null;function s(){for(var r=arguments.length,l=new Array(r),a=0;a<r;a++)l[a]=arguments[a];const h=Date.now();let u=!1;i.lastCallThrottled=!0,t||(t=h,u=!0);const c=e-(h-t);return u?(i.lastCallThrottled=!1,n.apply(this,l)):(o&&clearTimeout(o),o=setTimeout(()=>{i.lastCallThrottled=!1,n.apply(this,l),t=0,o=void 0},c)),i}return s}function DM(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const i=by(n,e);let o=t;function s(){o=t}function r(){for(var l=arguments.length,a=new Array(l),h=0;h<l;h++)a[h]=arguments[h];return o?(o-=1,n.apply(this,a)):i.apply(this,a)}return r.clearHits=s,r}function Hd(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=null,i;function o(){for(var s=arguments.length,r=new Array(s),l=0;l<s;l++)r[l]=arguments[l];return t&&clearTimeout(t),t=setTimeout(()=>{i=n.apply(this,r)},e),i}return o}function LM(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[i,...o]=e;return function(){for(var r=arguments.length,l=new Array(r),a=0;a<r;a++)l[a]=arguments[a];return at(o,(h,u)=>u(h),i.apply(this,l))}}function fp(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return function(){for(var s=arguments.length,r=new Array(s),l=0;l<s;l++)r[l]=arguments[l];return n.apply(this,t.concat(r))}}function vy(n){const e=n.length;function t(i){return function(){for(var s=arguments.length,r=new Array(s),l=0;l<s;l++)r[l]=arguments[l];const a=i.concat(r);let h;return a.length>=e?h=n.apply(this,a):h=t(a),h}}return t([])}function kM(n){const e=n.length;function t(i){return function(){for(var s=arguments.length,r=new Array(s),l=0;l<s;l++)r[l]=arguments[l];const a=i.concat(r.reverse());let h;return a.length>=e?h=n.apply(this,a):h=t(a),h}}return t([])}function Nc(n,e,t,i,o,s,r,l){return F(l)?n.call(e,t,i,o,s,r,l):F(r)?n.call(e,t,i,o,s,r):F(s)?n.call(e,t,i,o,s):F(o)?n.call(e,t,i,o):F(i)?n.call(e,t,i):F(t)?n.call(e,t):n.call(e)}const $M=Object.freeze(Object.defineProperty({__proto__:null,curry:vy,curryRight:kM,debounce:Hd,fastCall:Nc,isFunction:_e,partial:fp,pipe:LM,throttle:by,throttleAfterHits:DM},Symbol.toStringTag,{value:"Module"}));function Cl(n){let e;return Array.isArray(n)?e=n.length?new Array(n.length).fill(null):[]:(e={},te(n,(t,i)=>{i!=="__children"&&(t&&typeof t=="object"&&!Array.isArray(t)?e[i]=Cl(t):Array.isArray(t)?t.length&&typeof t[0]=="object"&&!Array.isArray(t[0])?e[i]=[Cl(t[0])]:e[i]=[]:e[i]=null)})),e}function li(n,e){return e.prototype.constructor=e,n.prototype=new e,n.prototype.constructor=n,n}function lt(n,e,t){const i=Array.isArray(t);return te(e,(o,s)=>{(i===!1||t.includes(s))&&(n[s]=o)}),n}function Rh(n,e){te(e,(t,i)=>{e[i]&&typeof e[i]=="object"?(n[i]||(Array.isArray(e[i])?n[i]=[]:Object.prototype.toString.call(e[i])==="[object Date]"?n[i]=e[i]:n[i]={}),Rh(n[i],e[i])):n[i]=e[i]})}function Dt(n){return typeof n=="object"?JSON.parse(JSON.stringify(n)):n}function ri(n){const e={};return te(n,(t,i)=>{e[i]=t}),e}function Ee(n){n.MIXINS||(n.MIXINS=[]);for(var e=arguments.length,t=new Array(e>1?e-1:0),i=1;i<e;i++)t[i-1]=arguments[i];return b(t,o=>{n.MIXINS.push(o.MIXIN_NAME),te(o,(s,r)=>{if(n.prototype[r]!==void 0)throw new Error(`Mixin conflict. Property '${r}' already exist and cannot be overwritten.`);if(typeof s=="function")n.prototype[r]=s;else{const l=function(u,c){const d=`_${u}`,g=p=>{let v=p;return(Array.isArray(v)||ee(v))&&(v=Dt(v)),v};return function(){return this[d]===void 0&&(this[d]=g(c)),this[d]}},a=function(u){const c=`_${u}`;return function(d){this[c]=d}};Object.defineProperty(n.prototype,r,{get:l(r,s),set:a(r),configurable:!0})}})}),n}function xd(n,e){return JSON.stringify(n)===JSON.stringify(e)}function ee(n){return Object.prototype.toString.call(n)==="[object Object]"}function zi(n,e,t,i){i.value=t,i.writable=i.writable!==!1,i.enumerable=i.enumerable!==!1,i.configurable=i.configurable!==!1,Object.defineProperty(n,e,i)}function te(n,e){for(const t in n)if((!n.hasOwnProperty||n.hasOwnProperty&&Object.prototype.hasOwnProperty.call(n,t))&&e(n[t],t,n)===!1)break;return n}function Sy(n,e){const t=e.split(".");let i=n;return te(t,o=>{if(i=i[o],i===void 0)return i=void 0,!1}),i}function gc(n,e,t){const i=e.split(".");let o=n;i.forEach((s,r)=>{r!==i.length-1?(je(o,s)||(o[s]={}),o=o[s]):o[s]=t})}function Ad(n){if(!ee(n))return 0;const e=function(t){let i=0;return ee(t)?te(t,(o,s)=>{s!=="__children"&&(i+=e(o))}):i+=1,i};return e(n)}function Dn(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const t=`_${e}`,i={_touched:!1,[t]:n,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[t]},set(o){this._touched=!0,this[t]=o},enumerable:!0,configurable:!0}),i}function je(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const VM=Object.freeze(Object.defineProperty({__proto__:null,clone:ri,createObjectPropListener:Dn,deepClone:Dt,deepExtend:Rh,deepObjectSize:Ad,defineGetter:zi,duckSchema:Cl,extend:lt,getProperty:Sy,hasOwnProperty:je,inherit:li,isObject:ee,isObjectEqual:xd,mixin:Ee,objectEach:te,setProperty:gc},Symbol.toStringTag,{value:"Module"}));function _d(n){return window.requestAnimationFrame(n)}function rh(n){window.cancelAnimationFrame(n)}function gp(){return"ontouchstart"in window}function yy(){return typeof window<"u"}let yr;function Ry(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return yr||(typeof Intl=="object"?yr=new Intl.Collator(n,e).compare:typeof String.prototype.localeCompare=="function"?yr=(t,i)=>`${t}`.localeCompare(i):yr=(t,i)=>t===i?0:t>i?-1:1,yr)}const FM=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:rh,getComparisonFunction:Ry,isCSR:yy,isTouchSupported:gp,requestAnimationFrame:_d},Symbol.toStringTag,{value:"Module"})),In=n=>{const e={value:!1};return e.test=(t,i)=>{e.value=n(t,i)},e},yo={chrome:In((n,e)=>/Chrome/.test(n)&&/Google/.test(e)),chromeWebKit:In(n=>/CriOS/.test(n)),edge:In(n=>/Edge/.test(n)),edgeWebKit:In(n=>/EdgiOS/.test(n)),firefox:In(n=>/Firefox/.test(n)),firefoxWebKit:In(n=>/FxiOS/.test(n)),mobile:In(n=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(n)),safari:In((n,e)=>/Safari/.test(n)&&/Apple Computer/.test(e))},El={mac:In(n=>/^Mac/.test(n)),win:In(n=>/^Win/.test(n)),linux:In(n=>/^Linux/.test(n)),ios:In(n=>/iPhone|iPad|iPod/i.test(n))};function Ey(){let{userAgent:n=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};te(yo,t=>{let{test:i}=t;return void i(n,e)})}function Ty(){let{platform:n=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};te(El,e=>{let{test:t}=e;return void t(n)})}yy()&&(Ey(),Ty());function mp(){return yo.chrome.value}function My(){return yo.chromeWebKit.value}function mc(){return yo.firefox.value}function Py(){return yo.firefoxWebKit.value}function pp(){return yo.safari.value}function Iy(){return yo.edge.value}function WM(){return yo.edgeWebKit.value}function go(){return yo.mobile.value}function wp(){return El.ios.value}function Cp(){let{maxTouchPoints:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return n>2&&El.mac.value}function dm(){return El.win.value}function lh(){return El.mac.value}function BM(){return El.linux.value}const jM=Object.freeze(Object.defineProperty({__proto__:null,isChrome:mp,isChromeWebKit:My,isEdge:Iy,isEdgeWebKit:WM,isFirefox:mc,isFirefoxWebKit:Py,isIOS:wp,isIpadOS:Cp,isLinuxOS:BM,isMacOS:lh,isMobileBrowser:go,isSafari:pp,isWindowsOS:dm,setBrowserMeta:Ey,setPlatformMeta:Ty},Symbol.toStringTag,{value:"Module"})),B={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:mc()?182:174,AUDIO_MUTE:mc()?181:173,AUDIO_UP:mc()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},UM=[B.ALT,B.ARROW_DOWN,B.ARROW_LEFT,B.ARROW_RIGHT,B.ARROW_UP,B.AUDIO_DOWN,B.AUDIO_MUTE,B.AUDIO_UP,B.BACKSPACE,B.CAPS_LOCK,B.DELETE,B.END,B.ENTER,B.ESCAPE,B.F1,B.F2,B.F3,B.F4,B.F5,B.F6,B.F7,B.F8,B.F9,B.F10,B.F11,B.F12,B.F13,B.F14,B.F15,B.F16,B.F17,B.F18,B.F19,B.HOME,B.INSERT,B.MEDIA_NEXT,B.MEDIA_PLAY_PAUSE,B.MEDIA_PREV,B.MEDIA_STOP,B.NULL,B.NUM_LOCK,B.PAGE_DOWN,B.PAGE_UP,B.PAUSE,B.SCROLL_LOCK,B.SHIFT,B.TAB];function Hy(n){return n===32||n>=48&&n<=57||n>=96&&n<=111||n>=186&&n<=192||n>=219&&n<=222||n>=226||n>=65&&n<=90}function bp(n){return UM.includes(n)}function zM(n){const e=[];return lh()?e.push(B.COMMAND_LEFT,B.COMMAND_RIGHT,B.COMMAND_FIREFOX):e.push(B.CONTROL),e.includes(n)}function xy(n){return[B.CONTROL,B.COMMAND_LEFT,B.COMMAND_RIGHT,B.COMMAND_FIREFOX].includes(n)}function Tl(n,e){const t=e.split("|");let i=!1;return b(t,o=>{if(n===B[o])return i=!0,!1}),i}const GM=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:B,isCtrlKey:zM,isCtrlMetaKey:xy,isFunctionKey:bp,isKey:Tl,isPrintableChar:Hy},Symbol.toStringTag,{value:"Module"}));function $n(n){n.isImmediatePropagationEnabled=!1,n.cancelBubble=!0}function Yo(n){return n.isImmediatePropagationEnabled===!1}function ls(n){return n.button===2}function Od(n){return n.button===0}function Ay(n){return n instanceof TouchEvent}function _y(n,e){const t={x:n.offsetX,y:n.offsetY};let i=n.target;if(!(e instanceof HTMLElement)||i!==e&&i.contains(e))return t;for(;i!==e;)t.x+=i.offsetLeft,t.y+=i.offsetTop,i=i.offsetParent;return t}const YM=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Yo,isLeftClick:Od,isRightClick:ls,isTouchEvent:Ay,offsetRelativeTo:_y,stopImmediatePropagation:$n},Symbol.toStringTag,{value:"Module"}));function ye(){F(console)&&console.warn(...arguments)}function vp(){F(console)&&console.error(...arguments)}function KM(n,e,t){return(e=XM(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function XM(n){var e=qM(n,"string");return typeof e=="symbol"?e:e+""}function qM(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Rr=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],QM=Re`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,df=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),ff=new Map([[]]),Vh=new WeakMap;class V{static getSingleton(){return ZM()}constructor(){KM(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return b(Rr,t=>{e[t]=[],this.initOrderMap(e,t)}),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=arguments.length>3?arguments[3]:void 0;if(Array.isArray(t))b(t,s=>this.add(e,s,i));else{df.has(e)&&ye(np(QM,{hookName:e,removedInVersion:df.get(e)})),ff.has(e)&&ye(ff.get(e));const s=this.getBucket(i);if(typeof s[e]>"u"&&(this.register(e),s[e]=[],this.initOrderMap(s,e)),t.skip=!1,s[e].indexOf(t)===-1){let r=!1;t.initialHook&&b(s[e],(l,a)=>{if(l.initialHook)return s[e][a]=t,r=!0,!1}),r||s[e].push(t)}this.setCallbackOrderIndex(s,e,t,o),this.orderBucketByOrderIndex(s,e)}return this}once(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=arguments.length>3?arguments[3]:void 0;Array.isArray(t)?b(t,s=>this.once(e,s,i)):(t.runOnce=!0,this.add(e,t,i,o))}remove(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const o=this.getBucket(i);return typeof o[e]<"u"&&o[e].indexOf(t)>=0?(t.skip=!0,!0):!1}has(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const i=this.getBucket(t);return!!(i[e]!==void 0&&i[e].length)}run(e,t,i,o,s,r,l,a){{const h=this.globalBucket[t],u=h?h.length:0;let c=0;if(u)for(;c<u;){if(!h[c]||h[c].skip){c+=1;continue}const d=Nc(h[c],e,i,o,s,r,l,a);d!==void 0&&(i=d),h[c]&&h[c].runOnce&&this.remove(t,h[c]),c+=1}}{const h=this.getBucket(e)[t],u=h?h.length:0;let c=0;if(u)for(;c<u;){if(!h[c]||h[c].skip){c+=1;continue}const d=Nc(h[c],e,i,o,s,r,l,a);d!==void 0&&(i=d),h[c]&&h[c].runOnce&&this.remove(t,h[c],e),c+=1}}return i}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;te(this.getBucket(e),(t,i,o)=>o[i].length=0)}register(e){this.isRegistered(e)||Rr.push(e)}deregister(e){this.isRegistered(e)&&Rr.splice(Rr.indexOf(e),1)}isDeprecated(e){return ff.has(e)||df.has(e)}isRegistered(e){return Rr.indexOf(e)>=0}getRegistered(){return Rr}setCallbackOrderIndex(e,t,i,o){const s=Number.isInteger(o)?o:0,r=this.getCallbackOrderMap(e,t);r.set(s,[...r.get(s)||[],i])}orderBucketByOrderIndex(e,t){const i=this.getCallbackOrderMap(e,t);i===void 0||i.size===0||i.size===1&&i.has(0)||(e[t]=[...i].sort((o,s)=>o[0]-s[0]).flatMap(o=>{let[,s]=o;return s}))}initOrderMap(e,t){Vh.has(e)||Vh.set(e,[]),Vh.get(e)[t]=new Map}getCallbackOrderMap(e,t){return Vh.get(e)[t]}}const JM=new V;function ZM(){return JM}const gf=new Map;function ai(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";gf.has(n)||gf.set(n,new Map);const e=gf.get(n);function t(l,a){e.set(l,a)}function i(l){return e.get(l)}function o(l){return e.has(l)}function s(){return[...e.keys()]}function r(){return[...e.values()]}return{register:t,getItem:i,hasItem:o,getNames:s,getValues:r}}const fm=new WeakMap,{register:e0,getItem:Oy,hasItem:Ny,getNames:t0,getValues:MG}=ai("editors");function n0(n){const e={},t=n;this.getConstructor=function(){return n},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new t(i)),e[i.guid]},V.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function Dy(n,e){let t;if(typeof n=="function")fm.get(n)||tn(null,n),t=fm.get(n);else if(typeof n=="string")t=Oy(n);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!t)throw Error(`No editor registered under name "${n}"`);return t.getInstance(e)}function Dc(n){if(typeof n=="function")return n;if(!Ny(n))throw Error(`No registered editor found under "${n}" name`);return Oy(n).getConstructor()}function tn(n,e){n&&typeof n!="string"&&(e=n,n=e.EDITOR_TYPE);const t=new n0(e);typeof n=="string"&&e0(n,t),fm.set(e,t)}function i0(n,e,t){return(e=o0(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function o0(n){var e=s0(n,"string");return typeof e=="symbol"?e:e+""}function s0(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}let pc=0;class kn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;i0(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,i){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(r){i.call(this,r0(r))}return this.context.eventListeners.push({element:e,event:t,callback:i,callbackProxy:s,options:o,eventManager:this}),e.addEventListener(t,s,o),pc+=1,()=>{this.removeEventListener(e,t,i)}}removeEventListener(e,t,i){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,r;for(;s;)if(s-=1,r=this.context.eventListeners[s],r.event===t&&r.element===e){if(i&&i!==r.callback||o&&r.eventManager!==this)continue;this.context.eventListeners.splice(s,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),pc-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const i=this.context.eventListeners[t];e&&i.eventManager!==this||(this.context.eventListeners.splice(t,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),pc-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let i=e.document,o=e;i||(i=e.ownerDocument?e.ownerDocument:e,o=i.defaultView);const s={bubbles:!0,cancelable:t!=="mousemove",view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let r;i.createEvent?(r=i.createEvent("MouseEvents"),r.initMouseEvent(t,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,i.body.parentNode)):r=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(r):e.fireEvent(`on${t}`,r)}}function r0(n){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=function(){e.apply(this),$n(this)},n}function l0(){return pc}function a0(n,e){h0(n,e),e.add(n)}function h0(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gs(n,e,t){return(e=u0(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function u0(n){var e=c0(n,"string");return typeof e=="symbol"?e:e+""}function c0(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ab(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var mf=new WeakSet;class gm{constructor(e,t,i){a0(this,mf),gs(this,"hot",void 0),gs(this,"tableMeta",void 0),gs(this,"selection",void 0),gs(this,"eventManager",void 0),gs(this,"destroyed",!1),gs(this,"activeEditor",void 0),gs(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=i,this.eventManager=new kn(e),this.hot.addHook("afterDocumentKeyDown",o=>ab(mf,this,d0).call(this,o)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",o=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",o)}),this.hot.view._wt.update("onCellDblClick",(o,s,r)=>ab(mf,this,f0).call(this,o,s,r))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,h=>{h&&this.prepareEditor()});return}const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||t.isHeader())return;const{row:i,col:o}=t,s=this.hot.runHooks("modifyGetCellCoords",i,o);let r=i,l=o;if(Array.isArray(s)&&([r,l]=s),this.cellProperties=this.hot.getCellMeta(r,l),!this.isCellEditable()){this.clearActiveEditor();return}const a=this.hot.getCell(i,o,!0);if(a){const h=this.hot.getCellEditor(this.cellProperties),u=this.hot.colToProp(l),c=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(r),l);this.activeEditor=Dy(h,this.hot),this.activeEditor.prepare(i,o,u,a,c,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const o=this.hot.getSelectedRangeLast();let s=this.hot.runHooks("beforeBeginEditing",o.highlight.row,o.highlight.col,e,t,i);if(t instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&o.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,i){this.activeEditor?this.activeEditor.finishEditing(e,t,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:i,col:o}=e.highlight,{rowIndexMapper:s,columnIndexMapper:r}=this.hot,l=s.isHidden(this.hot.toPhysicalRow(i))||r.isHidden(this.hot.toPhysicalColumn(o));return!(this.cellProperties.readOnly||!t||l)}moveSelectionAfterEnter(e){const t={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function d0(n){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Yo(n))return;const{keyCode:t}=n,i=(n.ctrlKey||n.metaKey)&&!n.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!bp(t)&&!xy(t)&&!i&&!this.isEditorOpened()&&this.openEditor("",n)}function f0(n,e){e.isCell()&&this.openEditor(null,n,!0)}const hb=new WeakMap;gm.getInstance=function(n,e,t){let i=hb.get(n);return i||(i=new gm(n,e,t),hb.set(n,i)),i};function g0(n,e){Ly(n,e),e.add(n)}function _l(n,e,t){Ly(n,e),e.set(n,t)}function Ly(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Be(n,e){return n.get(fo(n,e))}function Ol(n,e,t){return n.set(fo(n,e),t),t}function fo(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const dl=Object.freeze({CELL:"cell",MIXED:"mixed"});var St=new WeakMap,Fh=new WeakMap,Wh=new WeakMap,Bh=new WeakMap,jh=new WeakMap,Bo=new WeakSet;class m0{constructor(e){var t=this;g0(this,Bo),_l(this,St,void 0),_l(this,Fh,void 0),_l(this,Wh,1),_l(this,Bh,null),_l(this,jh,new Map);const i=e.getSettings();Ol(St,this,e),Ol(Fh,this,i.imeFastEdit?dl.MIXED:dl.CELL),Be(St,this).addHook("afterUpdateSettings",function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return fo(Bo,t,w0).call(t,...s)}),Be(St,this).addHook("afterSelection",function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return fo(Bo,t,ub).call(t,...s)}),Be(St,this).addHook("afterSelectionFocusSet",function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return fo(Bo,t,ub).call(t,...s)}),Be(St,this).addHook("afterSelectionEnd",function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return fo(Bo,t,p0).call(t,...s)})}getFocusMode(){return Be(Fh,this)}setFocusMode(e){Object.values(dl).includes(e)?Ol(Fh,this,e):ye(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Be(Wh,this)}setRefocusDelay(e){Ol(Wh,this,e)}setRefocusElementGetter(e){Ol(Bh,this,e)}getRefocusElement(){if(typeof Be(Bh,this)=="function")return Be(Bh,this).call(this);var e;return(e=Be(St,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=i=>{var o,s;const r=(o=Be(St,this).getSelectedRangeLast())===null||o===void 0?void 0:o.highlight;if(!r)return;let l=Be(St,this).runHooks("modifyFocusedElement",r.row,r.col,i);l instanceof HTMLElement||(l=i),l&&!((s=Be(St,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&l.focus({preventScroll:!0})};e?t(e):fo(Bo,this,Sp).call(this,i=>t(i))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Be(Wh,this);const i=this.getRefocusElement();Be(St,this).getSettings().imeFastEdit&&!((e=Be(St,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&i&&(Be(jh,this).has(t)||Be(jh,this).set(t,Hd(()=>{i.select()},t)),Be(jh,this).get(t)())}}function Sp(n){var e;const t=(e=Be(St,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||!Be(St,this).selection.isCellVisible(t)){n(null);return}const i=Be(St,this).getCell(t.row,t.col,!0);i===null?Be(St,this).addHookOnce("afterScroll",()=>{n(Be(St,this).getCell(t.row,t.col,!0))}):n(i)}function ub(){fo(Bo,this,Sp).call(this,n=>{const{activeElement:e}=Be(St,this).rootDocument;e&&Id(e)&&e.blur(),this.focusOnHighlightedCell(n)})}function p0(){fo(Bo,this,Sp).call(this,n=>{this.getFocusMode()===dl.MIXED&&n.nodeName==="TD"&&this.refocusToEditorTextarea()})}function w0(n){typeof n.imeFastEdit=="boolean"&&this.setFocusMode(n.imeFastEdit?dl.MIXED:dl.CELL)}const ky={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},C0=new RegExp(Object.keys(ky).map(n=>`(${n})`).join("|"),"gi");function b0(n){return(n&&n.nodeName||"")==="TABLE"}function mm(n){const e=n.hasColHeaders(),t=n.hasRowHeaders(),i=[e?-1:0,t?-1:0,n.countRows()-1,n.countCols()-1],o=n.getData(...i),s=o.length,r=s>0?o[0].length:0,l=["<table>","</table>"],a=e?["<thead>","</thead>"]:[],h=["<tbody>","</tbody>"],u=t?1:0,c=e?1:0;for(let d=0;d<s;d+=1){const g=e&&d===0,p=[];for(let C=0;C<r;C+=1){const S=!g&&t&&C===0;let R="";if(g)R=`<th>${n.getColHeader(C-u)}</th>`;else if(S)R=`<th>${n.getRowHeader(d-c)}</th>`;else{const M=o[d][C],{hidden:I,rowspan:H,colspan:O}=n.getCellMeta(d-c,C-u);if(!I){const k=[];if(H&&k.push(`rowspan="${H}"`),O&&k.push(`colspan="${O}"`),Je(M))R=`<td ${k.join(" ")}></td>`;else{const N=M.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");R=`<td ${k.join(" ")}>${N}</td>`}}}p.push(R)}const v=["<tr>",...p,"</tr>"].join("");g?a.splice(1,0,v):h.splice(-1,0,v)}return l.splice(1,0,a.join(""),h.join("")),l.join("")}function pm(n){const e=n.length,t=["<table>"];for(let i=0;i<e;i+=1){const o=n[i],s=o.length,r=[];i===0&&t.push("<tbody>");for(let l=0;l<s;l+=1){const a=o[l],h=Je(a)?"":a.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,u=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(u.length-1)} </span>`).replace(/\t/gi,"&#9;");r.push(`<td>${h}</td>`)}t.push("<tr>",...r,"</tr>"),i+1===e&&t.push("</tbody>")}return t.push("</table>"),t.join("")}function $y(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const t={},i=e.createDocumentFragment(),o=e.createElement("div");i.appendChild(o);let s=n;if(typeof s=="string"){const M=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,I=>{const H=I.match(/<td\b[^>]*?>/g)[0],O=/<p.*?>/g,k=I.substring(H.length,I.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(O,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${H}${k}</td>`});o.insertAdjacentHTML("afterbegin",`${M}`),s=o.querySelector("table")}if(!s||!b0(s))return;const r=o.querySelector('meta[name$="enerator"]'),l=s.querySelector("tbody th")!==null,a=s.querySelector("tr"),h=a?Array.from(a.cells).reduce((M,I)=>M+I.colSpan,0)-(l?1:0):0,u=s.tFoot&&Array.from(s.tFoot.rows)||[],c=[];let d=!1,g=0,p=0;if(s.tHead){const M=Array.from(s.tHead.rows).filter(I=>{const H=I.querySelector("td")!==null;return H&&c.push(I),!H});g=M.length,d=g>0,g>1?t.nestedHeaders=Array.from(M).reduce((I,H)=>{const O=Array.from(H.cells).reduce((k,N,Ce)=>{if(l&&Ce===0)return k;const{colSpan:ie,innerHTML:Ie}=N,oe=ie>1?{label:Ie,colspan:ie}:Ie;return k.push(oe),k},[]);return I.push(O),I},[]):d&&(t.colHeaders=Array.from(M[0].children).reduce((I,H,O)=>(l&&O===0||I.push(H.innerHTML),I),[]))}c.length&&(t.fixedRowsTop=c.length),u.length&&(t.fixedRowsBottom=u.length);const v=[...c,...Array.from(s.tBodies).reduce((M,I)=>(M.push(...Array.from(I.rows)),M),[]),...u];p=v.length;const C=new Array(p);for(let M=0;M<p;M++)C[M]=new Array(h);const S=[],R=[];for(let M=0;M<p;M++){const I=v[M],H=Array.from(I.cells),O=H.length;for(let k=0;k<O;k++){const N=H[k],{nodeName:Ce,innerHTML:ie,rowSpan:Ie,colSpan:oe}=N,Fe=C[M].findIndex(We=>We===void 0);if(Ce==="TD"){if(Ie>1||oe>1){for(let wt=M;wt<M+Ie;wt++)if(wt<p)for(let re=Fe;re<Fe+oe;re++)C[wt][re]=null;const Rt=N.getAttribute("style");Rt&&Rt.includes("mso-ignore:colspan")||S.push({col:Fe,row:M,rowspan:Ie,colspan:oe})}let We="";r&&/excel/gi.test(r.content)?We=ie.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):We=ie.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[M][Fe]=We.replace(C0,Rt=>ky[Rt])}else R.push(ie)}}return S.length&&(t.mergeCells=S),R.length&&(t.rowHeaders=R),C.length&&(t.data=C),t}const v0=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:pm,htmlToGridSettings:$y,instanceToHTML:mm},Symbol.toStringTag,{value:"Module"}));function _t(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=typeof n;if(t==="number")return!isNaN(n)&&isFinite(n);if(t==="string"){if(n.length===0)return!1;if(n.length===1)return/\d/.test(n);const i=Array.from(new Set([".",...e])).map(o=>`\\${o}`).join("|");return new RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(n.trim())}else if(t==="object")return!!n&&typeof n.valueOf()=="number"&&!(n instanceof Date);return!1}function Vy(n){return _t(n,[","])}function j(n,e,t){let i=-1;for(typeof e=="function"?(t=e,e=n):i=n-1;++i<=e&&t(i)!==!1;);}function wm(n,e,t){let i=n+1;for(typeof e=="function"&&(t=e,e=0);--i>=e&&t(i)!==!1;);}function yp(n,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(n*e/100,10)}function Se(n,e,t){return Math.min(n,e)===n?e:Math.max(n,t)===n?t:n}const S0=Object.freeze(Object.defineProperty({__proto__:null,clamp:Se,isNumeric:_t,isNumericLike:Vy,rangeEach:j,rangeEachReverse:wm,valueAccordingPercent:yp},Symbol.toStringTag,{value:"Module"})),Cm="asc",y0="desc",cb=new Map([[Cm,[-1,1]],[y0,[1,-1]]]),R0=n=>`The priority '${n}' is already declared in a map.`,E0=n=>`The priority '${n}' is not a number.`;function T0(){let{errorPriorityExists:n,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=new Map;n=_e(n)?n:R0,e=_e(e)?e:E0;function i(s,r){if(!_t(s))throw new Error(e(s));if(t.has(s))throw new Error(n(s));t.set(s,r)}function o(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Cm;const[r,l]=cb.get(s)||cb.get(Cm);return[...t].sort((a,h)=>a[0]<h[0]?r:l).map(a=>a[1])}return{addItem:i,getItems:o}}const M0=n=>`The id '${n}' is already declared in a map.`;function Nd(){let{errorIdExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;n=_e(n)?n:M0;function t(h,u){if(a(h))throw new Error(n(h));e.set(h,u)}function i(h){return e.delete(h)}function o(){e.clear()}function s(h){const[u]=l().find(c=>{let[d,g]=c;return h===g?d:!1})||[null];return u}function r(h){return e.get(h)}function l(){return[...e]}function a(h){return e.has(h)}return{addItem:t,clear:o,getId:s,getItem:r,getItems:l,hasItem:a,removeItem:i}}const P0=n=>`'${n}' value is already declared in a unique set.`;function I0(){let{errorItemExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;n=_e(n)?n:P0;function t(s){if(e.has(s))throw new Error(n(s));e.add(s)}function i(){return[...e]}function o(){e.clear()}return{addItem:t,clear:o,getItems:i}}const Rp=n=>`There is already registered "${n}" plugin.`,H0=n=>`There is already registered plugin on priority "${n}".`,x0=n=>`The priority "${n}" is not a number.`,Fy=T0({errorPriorityExists:H0,errorPriorityNaN:x0}),Wy=I0({errorItemExists:Rp}),bm=Nd({errorIdExists:Rp});function Ep(){return[...Fy.getItems(),...Wy.getItems()]}function Eh(n){const e=Nt(n);return bm.getItem(e)}function A0(n){return!!Eh(n)}function ce(n,e,t){[n,e,t]=O0(n,e,t),Eh(n)===void 0&&_0(n,e,t)}function _0(n,e,t){const i=Nt(n);if(bm.hasItem(i))throw new Error(Rp(i));t===void 0?Wy.addItem(i):Fy.addItem(t,i),bm.addItem(i,e)}function O0(n,e,t){return typeof n=="function"&&(e=n,n=e.PLUGIN_KEY,t=e.PLUGIN_PRIORITY),[n,e,t]}const{register:N0,getItem:D0,hasItem:By,getNames:L0,getValues:PG}=ai("renderers");function Lc(n){if(typeof n=="function")return n;if(!By(n))throw Error(`No registered renderer found under "${n}" name`);return D0(n)}function cn(n,e){typeof n!="string"&&(e=n,n=e.RENDERER_TYPE),N0(n,e)}const{register:k0,getItem:$0,hasItem:jy,getNames:V0,getValues:IG}=ai("validators");function Tp(n){if(typeof n=="function")return n;if(!jy(n))throw Error(`No registered validator found under "${n}" name`);return $0(n)}function Qs(n,e){typeof n!="string"&&(e=n,n=e.VALIDATOR_TYPE),k0(n,e)}function Nl(n,e,t){return(e=F0(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function F0(n){var e=W0(n,"string");return typeof e=="symbol"?e:e+""}function W0(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class B0{constructor(){Nl(this,"count",0),Nl(this,"startColumn",null),Nl(this,"endColumn",null),Nl(this,"startPosition",null),Nl(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:i,zeroBasedScrollOffset:o,viewportWidth:s,columnWidth:r}=t,l=o>0?s+1:s;i>=o&&i+r<=o+l&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var t;const{scrollOffset:i,viewportWidth:o,inlineStartOffset:s,zeroBasedScrollOffset:r,totalColumns:l,needReverse:a,startPositions:h,columnWidth:u}=e;if(this.endColumn===l-1&&a)for(this.startColumn=this.endColumn;this.startColumn>0;){const p=h[this.endColumn]+u-h[this.startColumn-1];if(p<=o&&(this.startColumn-=1),p>=o)break}this.startPosition=(t=h[this.startColumn])!==null&&t!==void 0?t:null;const c=r>0?o+1:o,d=i+o-c,g=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*s||i>h.at(-1)||-1*i-o>-1*g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,l<this.endColumn&&(this.endColumn=l-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Dl(n,e,t){return(e=j0(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function j0(n){var e=U0(n,"string");return typeof e=="symbol"?e:e+""}function U0(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class z0{constructor(){Dl(this,"count",0),Dl(this,"startRow",null),Dl(this,"endRow",null),Dl(this,"startPosition",null),Dl(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:i,zeroBasedScrollOffset:o,innerViewportHeight:s,rowHeight:r}=t;i>=o&&i+r<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var t;const{scrollOffset:i,viewportHeight:o,horizontalScrollbarHeight:s,totalRows:r,needReverse:l,startPositions:a,rowHeight:h}=e;if(this.endRow===r-1&&l)for(this.startRow=this.endRow;this.startRow>0;){const d=a[this.endRow]+h-a[this.startRow-1];if(d<=o-s&&(this.startRow-=1),d>=o-s)break}this.startPosition=(t=a[this.startRow])!==null&&t!==void 0?t:null;const u=i+o-s,c=this.startRow===null?0:e.getRowHeight(this.startRow);u<c||i>a.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,r<this.endRow&&(this.endRow=r-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Ll(n,e,t){return(e=G0(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function G0(n){var e=Y0(n,"string");return typeof e=="symbol"?e:e+""}function Y0(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Uy{constructor(){Ll(this,"count",0),Ll(this,"startColumn",null),Ll(this,"endColumn",null),Ll(this,"startPosition",null),Ll(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:i,zeroBasedScrollOffset:o,viewportWidth:s}=t;i<=o&&(this.startColumn=e);const r=o>0?s+1:s;i>=o&&i<=o+r&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var t;const{scrollOffset:i,viewportWidth:o,inlineStartOffset:s,zeroBasedScrollOffset:r,totalColumns:l,needReverse:a,startPositions:h,columnWidth:u}=e;if(this.endColumn===l-1&&a)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=h[this.endColumn]+u-h[this.startColumn-1];if(this.startColumn-=1,g>o)break}this.startPosition=(t=h[this.startColumn])!==null&&t!==void 0?t:null;const c=r>0?o+1:o;i+o-c<-1*s||i>h.at(-1)+u||-1*i-o>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,l<this.endColumn&&(this.endColumn=l-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function kl(n,e,t){return(e=K0(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function K0(n){var e=X0(n,"string");return typeof e=="symbol"?e:e+""}function X0(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class zy{constructor(){kl(this,"count",0),kl(this,"startRow",null),kl(this,"endRow",null),kl(this,"startPosition",null),kl(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:i,zeroBasedScrollOffset:o,innerViewportHeight:s}=t;i<=o&&(this.startRow=e),i>=o&&i<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var t;const{scrollOffset:i,viewportHeight:o,horizontalScrollbarHeight:s,totalRows:r,needReverse:l,startPositions:a,rowHeight:h}=e;if(this.endRow===r-1&&l)for(this.startRow=this.endRow;this.startRow>0;){const c=a[this.endRow]+h-a[this.startRow-1];if(this.startRow-=1,c>=o-s)break}this.startPosition=(t=a[this.startRow])!==null&&t!==void 0?t:null,i+o-s<0||i>a.at(-1)+h?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,r<this.endRow&&(this.endRow=r-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function $l(n,e,t){return(e=q0(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function q0(n){var e=Q0(n,"string");return typeof e=="symbol"?e:e+""}function Q0(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class J0{constructor(){$l(this,"count",0),$l(this,"startColumn",0),$l(this,"endColumn",0),$l(this,"startPosition",0),$l(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}}function Vl(n,e,t){return(e=Z0(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Z0(n){var e=eP(n,"string");return typeof e=="symbol"?e:e+""}function eP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class tP{constructor(){Vl(this,"count",0),Vl(this,"startRow",0),Vl(this,"endRow",0),Vl(this,"startPosition",0),Vl(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}}class nP extends Uy{finalize(e){var t;super.finalize(e);const{overrideFn:i,totalColumns:o,startPositions:s}=e;this.startColumn!==null&&typeof i=="function"&&i(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=(t=s[this.startColumn])!==null&&t!==void 0?t:null,o<this.endColumn&&(this.endColumn=o-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}class iP extends zy{finalize(e){var t;super.finalize(e);const{overrideFn:i,totalRows:o,startPositions:s}=e;this.startRow!==null&&typeof i=="function"&&i(this),this.startRow<0&&(this.startRow=0),this.startPosition=(t=s[this.startRow])!==null&&t!==void 0?t:null,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function db(n,e,t){return(e=oP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function oP(n){var e=sP(n,"string");return typeof e=="symbol"?e:e+""}function sP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Gy{constructor(e){db(this,"calculationTypes",[]),db(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(t=>{let[i,o]=t;this.calculationResults.set(i,o),o.initialize(e)})}_process(e,t){this.calculationTypes.forEach(i=>{let[,o]=i;return o.process(e,t)})}_finalize(e){this.calculationTypes.forEach(t=>{let[,i]=t;return i.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Bn(n,e,t){return(e=rP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rP(n){var e=lP(n,"string");return typeof e=="symbol"?e:e+""}function lP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Dd=50;class aP extends Gy{constructor(e){let{calculationTypes:t,viewportWidth:i,scrollOffset:o,totalColumns:s,columnWidthFn:r,overrideFn:l,inlineStartOffset:a}=e;super(t),Bn(this,"viewportWidth",0),Bn(this,"scrollOffset",0),Bn(this,"zeroBasedScrollOffset",0),Bn(this,"totalColumns",0),Bn(this,"columnWidthFn",null),Bn(this,"columnWidth",0),Bn(this,"overrideFn",null),Bn(this,"inlineStartOffset",0),Bn(this,"totalCalculatedWidth",0),Bn(this,"startPositions",[]),Bn(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=o,this.zeroBasedScrollOffset=Math.max(o,0),this.totalColumns=s,this.columnWidthFn=r,this.overrideFn=l,this.inlineStartOffset=a,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const t=this.columnWidthFn(e);return isNaN(t)?Dd:t}}function vn(n,e,t){return(e=hP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hP(n){var e=uP(n,"string");return typeof e=="symbol"?e:e+""}function uP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Yy=23;class cP extends Gy{constructor(e){let{calculationTypes:t,viewportHeight:i,scrollOffset:o,totalRows:s,rowHeightFn:r,overrideFn:l,horizontalScrollbarHeight:a}=e;super(t),vn(this,"viewportHeight",0),vn(this,"scrollOffset",0),vn(this,"zeroBasedScrollOffset",0),vn(this,"totalRows",0),vn(this,"rowHeightFn",null),vn(this,"rowHeight",0),vn(this,"overrideFn",null),vn(this,"horizontalScrollbarHeight",0),vn(this,"innerViewportHeight",0),vn(this,"totalCalculatedHeight",0),vn(this,"startPositions",[]),vn(this,"needReverse",!0),this.viewportHeight=i,this.scrollOffset=o,this.zeroBasedScrollOffset=Math.max(o,0),this.totalRows=s,this.rowHeightFn=r,this.overrideFn=l,this.horizontalScrollbarHeight=a??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const t=this.rowHeightFn(e);return isNaN(t)?Yy:t}}function dP(n,e,t){fP(n,e),e.set(n,t)}function fP(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fb(n,e,t){return(e=gP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gP(n){var e=mP(n,"string");return typeof e=="symbol"?e:e+""}function mP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Er(n,e){return n.get(Ky(n,e))}function gb(n,e,t){return n.set(Ky(n,e),t),t}function Ky(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Yi=new WeakMap;class hr{constructor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;fb(this,"row",null),fb(this,"col",null),dP(this,Yi,!1),gb(Yi,this,i),typeof e<"u"&&typeof t<"u"&&(this.row=e,this.col=t)}isValid(e){const{countRows:t,countCols:i,countRowHeaders:o,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-o||this.row>=t||this.col>=i)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Er(Yi,this)}isSouthEastOf(e){return this.row>=e.row&&(Er(Yi,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Er(Yi,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Er(Yi,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Er(Yi,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof hr&&gb(Yi,this,e.isRtl()),this}clone(){return new hr(this.row,this.col,Er(Yi,this))}toObject(){return{row:this.row,col:this.col}}}function pP(n,e,t){wP(n,e),e.set(n,t)}function wP(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pf(n,e,t){return(e=CP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function CP(n){var e=bP(n,"string");return typeof e=="symbol"?e:e+""}function bP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Sn(n,e){return n.get(Xy(n,e))}function vP(n,e,t){return n.set(Xy(n,e),t),t}function Xy(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Kt=new WeakMap;class Th{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;pf(this,"highlight",null),pf(this,"from",null),pf(this,"to",null),pP(this,Kt,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=i.clone(),vP(Kt,this,o)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:i}=e,o=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return o.row<=t&&s.row>=t&&o.col<=i&&s.col>=i}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return e.row<t.row||e.col<t.col||e.row>i.row||e.col>i.col?(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0):!1}expandByRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),s=this.getDirection(),r=e.getOuterTopStartCorner(),l=e.getOuterBottomEndCorner(),a=Math.min(i.row,r.row),h=Math.min(i.col,r.col),u=Math.max(o.row,l.row),c=Math.max(o.col,l.col),d=this._createCellCoords(a,h),g=this._createCellCoords(u,c);return this.from=d,this.to=g,this.setDirection(s),t&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Sn(Kt,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Sn(Kt,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Sn(Kt,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Sn(Kt,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Sn(Kt,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Sn(Kt,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Sn(Kt,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Sn(Kt,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof hr))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},o=[];return t.top===i.top&&o.push("top"),t.right===i.right&&o.push(Sn(Kt,this)?"left":"right"),t.bottom===i.bottom&&o.push("bottom"),t.left===i.left&&o.push(Sn(Kt,this)?"right":"left"),o}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),i=[];for(let o=e.row;o<=t.row;o++)for(let s=e.col;s<=t.col;s++)!(this.from.row===o&&this.from.col===s)&&!(this.to.row===o&&this.to.col===s)&&i.push(this._createCellCoords(o,s));return i}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),i=[];for(let o=e.row;o<=t.row;o++)for(let s=e.col;s<=t.col;s++)e.row===o&&e.col===s?i.push(e):t.row===o&&t.col===s?i.push(t):i.push(this._createCellCoords(o,s));return i}forAll(e){const t=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let o=t.row;o<=i.row;o++)for(let s=t.col;s<=i.col;s++)if(e(o,s)===!1)return}clone(){return new Th(this.highlight,this.from,this.to,Sn(Kt,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new hr(e,t,Sn(Kt,this))}}function fi(n,e,t){SP(n,e),e.set(n,t)}function SP(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function U(n,e){return n.get(qy(n,e))}function Mo(n,e,t){return n.set(qy(n,e),t),t}function qy(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var yn=new WeakMap,wf=new WeakMap,Ct=new WeakMap,Tr=new WeakMap,Uh=new WeakMap,jn=new WeakMap,Cf=new WeakMap,Fl=new WeakMap,ms=new WeakMap,gi=new WeakMap;let Qy=class{constructor(e,t,i,o,s,r){let l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;fi(this,yn,void 0),fi(this,wf,void 0),fi(this,Ct,void 0),fi(this,Tr,void 0),fi(this,Uh,void 0),fi(this,jn,void 0),fi(this,Cf,void 0),fi(this,Fl,void 0),fi(this,ms,[null,null]),fi(this,gi,[null,null]),Mo(yn,this,i),Mo(wf,this,t),Mo(Ct,this,s),Mo(Tr,this,r),Mo(Uh,this,l),Mo(jn,this,o),Mo(Cf,this,e),this.registerEvents()}registerEvents(){U(jn,this).addEventListener(U(Ct,this).holder,"contextmenu",i=>this.onContextMenu(i)),U(jn,this).addEventListener(U(Ct,this).TABLE,"mouseover",i=>this.onMouseOver(i)),U(jn,this).addEventListener(U(Ct,this).TABLE,"mouseout",i=>this.onMouseOut(i));const e=()=>{U(jn,this).addEventListener(U(Ct,this).holder,"touchstart",i=>this.onTouchStart(i)),U(jn,this).addEventListener(U(Ct,this).holder,"touchend",i=>this.onTouchEnd(i)),this.momentumScrolling||(this.momentumScrolling={}),U(jn,this).addEventListener(U(Ct,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||U(yn,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,U(yn,this).getSetting("onAfterMomentumScroll"))},200)})},t=()=>{U(jn,this).addEventListener(U(Ct,this).holder,"mouseup",i=>this.onMouseUp(i)),U(jn,this).addEventListener(U(Ct,this).holder,"mousedown",i=>this.onMouseDown(i))};go()?e():(gp()&&e(),t())}selectedCellWasTouched(e){const i=this.parentCell(e).coords;if(U(Fl,this)&&i){const[o,s]=[i.row,U(Fl,this).from.row],[r,l]=[i.col,U(Fl,this).from.col];return o===s&&r===l}return!1}parentCell(e){const t={},i=U(Ct,this).TABLE,o=xa(e,["TD","TH"],i);return o?(t.coords=U(Ct,this).getCoords(o),t.TD=o):K(e,"wtBorder")&&K(e,"current")?(t.coords=U(Tr,this).getFocusSelection().cellRange.highlight,t.TD=U(Ct,this).getCell(t.coords)):K(e,"wtBorder")&&K(e,"area")&&U(Tr,this).getAreaSelection().cellRange&&(t.coords=U(Tr,this).getAreaSelection().cellRange.to,t.TD=U(Ct,this).getCell(t.coords)),t}onMouseDown(e){const t=U(wf,this).rootDocument.activeElement,i=fp(sy,e.target),o=e.target;if(!["TD","TH"].includes(t.nodeName)&&(o===t||i(0)===t||i(1)===t))return;const s=this.parentCell(o);K(o,"corner")?U(yn,this).getSetting("onCellCornerMouseDown",e,o):s.TD&&U(yn,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(U(gi,this)[0]=s.TD,clearTimeout(U(ms,this)[0]),U(ms,this)[0]=setTimeout(()=>{U(gi,this)[0]=null},1e3))}onContextMenu(e){if(U(yn,this).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!U(yn,this).has("onCellMouseOver"))return;const t=U(Ct,this).TABLE,i=xa(e.target,["TD","TH"],t),o=U(Uh,this)||this;i&&i!==o.lastMouseOver&&ts(i,t)&&(o.lastMouseOver=i,this.callListener("onCellMouseOver",e,U(Ct,this).getCoords(i),i))}onMouseOut(e){if(!U(yn,this).has("onCellMouseOut"))return;const t=U(Ct,this).TABLE,i=xa(e.target,["TD","TH"],t),o=xa(e.relatedTarget,["TD","TH"],t),s=U(Uh,this)||this;i&&i!==o&&ts(i,t)&&(this.callListener("onCellMouseOut",e,U(Ct,this).getCoords(i),i),o===null&&(s.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&U(yn,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),!(e.button!==0&&!this.touchApplied)&&(t.TD===U(gi,this)[0]&&t.TD===U(gi,this)[1]?(K(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),U(gi,this)[0]=null,U(gi,this)[1]=null):t.TD===U(gi,this)[0]&&(U(gi,this)[1]=t.TD,clearTimeout(U(ms,this)[1]),U(ms,this)[1]=setTimeout(()=>{U(gi,this)[1]=null},500)))}onTouchStart(e){Mo(Fl,this,U(Tr,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const i=e.target,o=(t=this.parentCell(i))===null||t===void 0?void 0:t.coords,s=F(o)&&o.row>=0&&o.col>=0;if(e.cancelable&&s&&U(yn,this).getSetting("isDataViewInstance")){const l=["A","BUTTON","INPUT"];wp()&&(My()||Py())&&this.selectedCellWasTouched(i)&&!l.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,i,o){const s=U(yn,this).getSettingPure(e);s&&s(t,i,o,U(Cf,this).call(this))}destroy(){clearTimeout(U(ms,this)[0]),clearTimeout(U(ms,this)[1]),U(jn,this).destroy()}};function bf(n,e,t){return(e=yP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yP(n){var e=RP(n,"string");return typeof e=="symbol"?e:e+""}function RP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class EP{constructor(e,t,i){bf(this,"offset",void 0),bf(this,"total",void 0),bf(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function vf(n,e,t){return(e=TP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function TP(n){var e=MP(n,"string");return typeof e=="symbol"?e:e+""}function MP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class PP{constructor(e,t,i){vf(this,"offset",void 0),vf(this,"total",void 0),vf(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const IP=0,kc=1,$c=2;function zh(n,e,t){return(e=HP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function HP(n){var e=xP(n,"string");return typeof e=="symbol"?e:e+""}function xP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class mb{constructor(){zh(this,"currentSize",0),zh(this,"nextSize",0),zh(this,"currentOffset",0),zh(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function Sf(n,e,t){return(e=AP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function AP(n){var e=_P(n,"string");return typeof e=="symbol"?e:e+""}function _P(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class OP{constructor(){Sf(this,"size",new mb),Sf(this,"workingSpace",IP),Sf(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof mb}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=kc,e.workingSpace=$c,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=$c,e.workingSpace=kc,this.sharedSize=e.getViewSize()}}function Mr(n,e,t){return(e=NP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function NP(n){var e=DP(n,"string");return typeof e=="symbol"?e:e+""}function DP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Jy{constructor(e,t,i){Mr(this,"rootNode",void 0),Mr(this,"nodesPool",void 0),Mr(this,"sizeSet",new OP),Mr(this,"childNodeType",void 0),Mr(this,"visualIndex",0),Mr(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=t,this.childNodeType=i.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let i=0;if(this.isSharedViewSet()){let o=e.firstElementChild;for(;o;){if(o.tagName===this.childNodeType)i+=1;else if(t.isPlaceOn(kc))break;o=o.nextElementSibling}}else i=e.childElementCount;return i}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,i=this.isSharedViewSet(),{nextSize:o}=t.getViewSize();let s=this.getRenderedChildCount();for(;s<o;){const l=this.nodesPool();!i||i&&t.isPlaceOn($c)?e.appendChild(l):e.insertBefore(l,e.firstChild),s+=1}const r=i&&t.isPlaceOn(kc);for(;s>o;)e.removeChild(r?e.firstChild:e.lastChild),s-=1}render(){const{rootNode:e,sizeSet:t}=this;let i=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn($c)&&(i+=t.sharedSize.nextSize);let o=e.childNodes[i];if(o.tagName!==this.childNodeType){const s=this.nodesPool();e.replaceChild(s,o),o=s}this.collectedNodes.push(o),this.visualIndex+=1}end(){}}class Zy extends Jy{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function LP(n,e,t){return(e=kP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kP(n){var e=$P(n,"string");return typeof e=="symbol"?e:e+""}function $P(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class VP{constructor(e){LP(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function Wl(n,e,t){return(e=FP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function FP(n){var e=WP(n,"string");return typeof e=="symbol"?e:e+""}function WP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Mh{constructor(e,t){Wl(this,"nodesPool",null),Wl(this,"nodeType",void 0),Wl(this,"rootNode",void 0),Wl(this,"table",null),Wl(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new VP(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function pb(n,e,t){return(e=BP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function BP(n){var e=jP(n,"string");return typeof e=="symbol"?e:e+""}function jP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class UP extends Mh{constructor(){super("TH"),pb(this,"orderViews",new WeakMap),pb(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new Zy(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:i,rows:o,cells:s}=this.table;for(let r=0;r<e;r++){const l=this.table.renderedRowToSource(r),a=o.getRenderedNode(r);this.sourceRowIndex=l;const h=this.obtainOrderView(a),u=s.obtainOrderView(a);h.appendView(u).setSize(i).setOffset(this.table.renderedColumnToSource(0)).start();for(let c=0;c<i;c++){h.render();const d=h.getCurrentNode();d.className="",d.removeAttribute("style"),pr(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Y(d,[sM(),gM(),ip(c+1),Rl(-1)]),t[c](l,d,c)}h.end()}}}class zP extends Mh{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let i=this.rootNode.firstChild;if(e){const{columnsToRender:o}=this.table,s=o+t;for(let l=0,a=e;l<a;l++){for(i=this.rootNode.childNodes[l],i||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<s;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)i.removeChild(i.lastChild),this.renderedNodes-=1}const r=this.rootNode.childNodes.length;if(r>e)for(let l=e;l<r;l++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&si(i)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Y(this.rootNode,[ZS()]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:i,columnsToRender:o,rowHeadersCount:s}=this.table,r=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&Y(r,[um(),iy(t+1)]);for(let l=-1*s;l<o;l+=1){const a=this.table.renderedColumnToSource(l),h=r.childNodes[l+s];h.className="",h.removeAttribute("style"),pr(h,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Y(h,[ip(l+1+this.table.rowHeadersCount),Rl(-1),rM(),...l>=0?[fM()]:[um()]]),i[t](a,h,t)}}}}let wb=!1;class GP extends Mh{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,i=e+t;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!wb&&e>1e3&&(wb=!0,ye(Re`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let o=0;o<t;o++){const s=this.table.renderedColumnToSource(o),r=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[o].style.width=`${r}px`}for(let o=0;o<e;o++){const s=this.table.renderedColumnToSource(o),r=this.table.columnUtils.getStretchedColumnWidth(s);this.rootNode.childNodes[o+t].style.width=`${r}px`}const i=this.rootNode.firstChild;i&&P(i,"rowHeader")}}function YP(n,e,t){return(e=KP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function KP(n){var e=XP(n,"string");return typeof e=="symbol"?e:e+""}function XP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Gh={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let Cb=!1;class qP extends Mh{constructor(e){super("TR",e),YP(this,"orderView",void 0),this.orderView=new Jy(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!Cb&&e>1e3&&(Cb=!0,ye(Re`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Y(this.rootNode,[ZS()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let o=0;o<e;o++){this.orderView.render();const s=this.orderView.getCurrentNode(),r=this.table.renderedRowToSource(o);if(this.table.isAriaEnabled()){var t,i;Y(s,[um(),iy(r+((t=(i=this.table.rowUtils)===null||i===void 0||(i=i.dataAccessObject)===null||i===void 0?void 0:i.columnHeaders.length)!==null&&t!==void 0?t:0)+1)])}X(s,[Gh.rowEven,Gh.rowOdd]),(r+1)%2===0?P(s,Gh.rowEven):P(s,Gh.rowOdd)}this.orderView.end()}}function bb(n,e,t){return(e=QP(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function QP(n){var e=JP(n,"string");return typeof e=="symbol"?e:e+""}function JP(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class ZP extends Mh{constructor(){super("TD"),bb(this,"orderViews",new WeakMap),bb(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new Zy(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:i,rowHeaders:o}=this.table;for(let l=0;l<e;l++){const a=this.table.renderedRowToSource(l),h=i.getRenderedNode(l);this.sourceRowIndex=a;const u=this.obtainOrderView(h),c=o.obtainOrderView(h);u.prependView(c).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<t;d++){u.render();const g=u.getCurrentNode(),p=this.table.renderedColumnToSource(d);if(K(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),pr(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(a,p,g),this.table.isAriaEnabled()){var s,r;Y(g,[...g.hasAttribute("role")?[]:[oM()],Rl(-1),ip(p+((s=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}u.end()}}}function ct(n,e,t){return(e=eI(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function eI(n){var e=tI(n,"string");return typeof e=="symbol"?e:e+""}function tI(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class nI{constructor(e){let{cellRenderer:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ct(this,"rootNode",void 0),ct(this,"rootDocument",void 0),ct(this,"rowHeaders",null),ct(this,"columnHeaders",null),ct(this,"colGroup",null),ct(this,"rows",null),ct(this,"cells",null),ct(this,"rowFilter",null),ct(this,"columnFilter",null),ct(this,"rowUtils",null),ct(this,"columnUtils",null),ct(this,"rowsToRender",0),ct(this,"columnsToRender",0),ct(this,"rowHeaderFunctions",[]),ct(this,"rowHeadersCount",0),ct(this,"columnHeaderFunctions",[]),ct(this,"columnHeadersCount",0),ct(this,"cellRenderer",void 0),ct(this,"activeOverlayName",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:i,rows:o,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),i.setTable(this),o.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=i,this.rows=o,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let i=0;i<e;i++){const o=t.getRenderedNode(i);if(o.firstChild){const s=this.renderedRowToSource(i),r=this.rowUtils.getHeightByOverlayName(s,this.activeOverlayName);r?o.firstChild.style.height=`${r-1}px`:o.firstChild.style.height=""}}}}class iI{constructor(){let{TABLE:e,THEAD:t,COLGROUP:i,TBODY:o,rowUtils:s,columnUtils:r,cellRenderer:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new nI(e,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new UP,columnHeaders:new zP(t),colGroup:new GP(i),rows:new qP(o),cells:new ZP}),this.renderer.setAxisUtils(s,r)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Bl(n,e,t){oI(n,e),e.set(n,t)}function oI(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yh(n,e,t){return(e=sI(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sI(n){var e=rI(n,"string");return typeof e=="symbol"?e:e+""}function rI(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Pt(n,e){return n.get(eR(n,e))}function jl(n,e,t){return n.set(eR(n,e),t),t}function eR(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Kh=new WeakMap,Pr=new WeakMap,Ul=new WeakMap,Xh=new WeakMap,ps=new WeakMap;class lI{constructor(e){let{totalColumns:t,stretchMode:i,stretchingColumnWidthFn:o,columnWidthFn:s}=e;Yh(this,"stretchAllRatio",0),Yh(this,"stretchLastWidth",0),Yh(this,"stretchAllColumnsWidth",[]),Bl(this,Kh,0),Yh(this,"needVerifyLastColumnWidth",!0),Bl(this,Pr,()=>0),Bl(this,Ul,r=>r),Bl(this,Xh,r=>r),Bl(this,ps,()=>"none"),jl(Pr,this,t),jl(ps,this,i),jl(Ul,this,o??Pt(Ul,this)),jl(Xh,this,s??Pt(Xh,this))}refreshStretching(e){if(Pt(ps,this).call(this)==="none")return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,jl(Kh,this,e);let t=0;for(let o=0;o<Pt(Pr,this).call(this);o++){const s=this._getColumnWidth(o),r=Pt(Ul,this).call(this,void 0,o);typeof r=="number"?e-=r:t+=s}const i=e-t;if(Pt(ps,this).call(this)==="all"&&i>0)this.stretchAllRatio=e/t,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(Pt(ps,this).call(this)==="last"&&e!==1/0){const o=this._getColumnWidth(Pt(Pr,this).call(this)-1),s=i+o;this.stretchLastWidth=s>=0?s:o}}getStretchedColumnWidth(e,t){let i=null;return Pt(ps,this).call(this)==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(e,t):Pt(ps,this).call(this)==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(e)),i}_getStretchedAllColumnWidth(e,t){let i=0;if(!this.stretchAllColumnsWidth[e]){const o=Math.round(t*this.stretchAllRatio),s=Pt(Ul,this).call(this,o,e);s===void 0?this.stretchAllColumnsWidth[e]=o:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===Pt(Pr,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let o=0;o<this.stretchAllColumnsWidth.length;o++)i+=this.stretchAllColumnsWidth[o];i!==Pt(Kh,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=Pt(Kh,this)-i)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===Pt(Pr,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=Pt(Xh,this).call(this,e);return isNaN(t)&&(t=Dd),t}}function qh(n,e,t){return(e=aI(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function aI(n){var e=hI(n,"string");return typeof e=="symbol"?e:e+""}function hI(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class uI{constructor(e,t){qh(this,"dataAccessObject",void 0),qh(this,"wtSettings",void 0),qh(this,"headerWidths",new Map),qh(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=t,this.stretching=new lI({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(i,o)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",i,o),columnWidthFn:i=>this.dataAccessObject.wtTable.getColumnWidth(i)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let t=this.getWidth(e);const i=this.stretching.getStretchedColumnWidth(e,t);return i&&(t=i),t}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");const i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(t=t?Math.max(t,i):i),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:t,cloneSource:i}=this.dataAccessObject,o=i?i.wtTable.holder:e.holder,s=o.offsetHeight<o.scrollHeight?pt():0;this.stretching.refreshStretching(t.getViewportWidth()-s)}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),t=e.getSetting("onModifyRowHeaderWidth",t),t!=null){const i=e.getSetting("rowHeaders").length,o=e.getSetting("defaultColumnWidth");for(let s=0;s<i;s++){let r=Array.isArray(t)?t[s]:t;r=r??o,this.headerWidths.set(s,r)}}}}function vb(n,e,t){return(e=cI(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cI(n){var e=dI(n,"string");return typeof e=="symbol"?e:e+""}function dI(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class fI{constructor(e,t){vb(this,"dataAccessObject",void 0),vb(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(t=t===void 0?i:Math.max(t,i)),t}getHeightByOverlayName(e,t){let i=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);const o=this.dataAccessObject.wtViewport.oversizedRows[e];return o!==void 0&&(i=i===void 0?o:Math.max(i,o)),i}}function mi(n,e,t){return(e=gI(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gI(n){var e=mI(n,"string");return typeof e=="symbol"?e:e+""}function mI(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Ml{constructor(e,t,i,o,s){mi(this,"wtSettings",null),mi(this,"domBindings",void 0),mi(this,"TBODY",null),mi(this,"THEAD",null),mi(this,"COLGROUP",null),mi(this,"hasTableHeight",!0),mi(this,"hasTableWidth",!0),mi(this,"isTableVisible",!1),mi(this,"tableOffset",0),mi(this,"holderOffset",0),this.domBindings=i,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,sp(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const r=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(r)),this.rowUtils=new fI(this.dataAccessObject,this.wtSettings),this.columnUtils=new uI(this.dataAccessObject,this.wtSettings),this.tableRenderer=new iI({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let i;return(!t||t.nodeType!==Node.ELEMENT_NODE||!K(t,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",t&&t.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Y(i,[Wi()]),i}createHider(e){const t=e.parentNode;let i;return(!t||t.nodeType!==Node.ELEMENT_NODE||!K(t,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",t&&t.insertBefore(i,e),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Y(i,[Wi()]),i}createHolder(e){const t=e.parentNode;let i;return(!t||t.nodeType!==Node.ELEMENT_NODE||!K(t,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",t&&t.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Y(i.parentNode,[Wi()])),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Y(i,[Wi()]),i}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,{wtOverlays:i,wtViewport:o}=this.dataAccessObject,s=t.getSetting("totalRows"),r=t.getSetting("totalColumns"),l=t.getSetting("rowHeaders"),a=l.length,h=t.getSetting("columnHeaders"),u=h.length;let c=e;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=mt(this.holder),c=o.createCalculators(c),a&&!t.getSetting("fixedColumnsStart"))){const g=i.inlineStartOverlay.getScrollPosition(),p=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,p!==this.correctHeaderWidth&&(c=!1)}if(c)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=mt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const g=s>0?this.getFirstRenderedRow():0,p=r>0?this.getFirstRenderedColumn():0;this.rowFilter=new PP(g,s,u),this.columnFilter=new EP(p,r,a);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const C={};this.wtSettings.getSetting("beforeDraw",!0,C),v=C.skipRender!==!0}if(v){this.tableRenderer.setHeaderContentRenderers(l,h),(this.is($i)||this.is(ns))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let C;if(this.isMaster&&(C=this.dataAccessObject.workspaceWidth,o.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is($i))&&this.markOversizedRows(),this.isMaster){this.wtSettings.getSetting("externalRowCalculator")||o.createVisibleCalculators(),i.refresh(!1),i.applyToDOM();const S=De(this.hider),R=De(this.TABLE);S!==0&&R!==S&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),C!==o.getWorkspaceWidth()&&(o.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is($i)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let d=!1;return this.isMaster&&(d=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(d=i.bottomOverlay.resetFixedPosition()||d),d=i.inlineStartOverlay.resetFixedPosition()||d,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(c),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let i=this.wtSettings.getSetting("columnHeaders").length;const o=this.wtSettings.getSetting("defaultRowHeight");let s,r,l;const a=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;i;)i-=1,s=this.getColumnHeaderHeight(i),r=this.getColumnHeader(t,i),r&&(l=Js(r),(!s&&o<l||s<l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),Array.isArray(a)?a[i]!==null&&a[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=a[i]):isNaN(a)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=a),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(a[i]||a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=a[i]||a))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,o=e.getSetting("columnHeaders");for(let s=0,r=o.length;s<r;s++)if(i[s]){if(!t[s]||t[s].childNodes.length===0)return;t[s].childNodes[0].style.height=`${i[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is($i))&&!e.getSetting("externalRowCalculator")){const i=this.getRenderedRowsCount();for(let o=0;o<i;o++){const s=this.rowFilter.renderedToSource(o);t.oversizedRows&&t.oversizedRows[s]&&(t.oversizedRows[s]=void 0)}}}getCell(e){let t=e.row,i=e.col;const o=this.wtSettings.getSetting("onModifyGetCellCoords",t,i);if(o&&Array.isArray(o)&&([t,i]=o),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;const s=this.getRow(t);if(!s&&t>=0)throw new Error("TR was expected to be rendered but is not");const r=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!r&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return r}getRow(e){let t=null,i=null;if(e<0){var o;t=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceRowToVisibleColHeadedRow(e),i=this.THEAD}else{var s;t=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),i=this.TBODY}return t!==void 0&&i!==void 0?i.childNodes.length<t+1?!1:i.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.THEAD.childNodes[t];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(o=>{const s=o.childNodes[i];s&&t.push(s)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.wtSettings.getSetting("rowHeaders").length;if(t>=i)return;const o=this.rowFilter.sourceToRendered(e),s=o<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):o,l=(o<0?this.THEAD:this.TBODY).childNodes[s];return l==null?void 0:l.childNodes[t]}getRowHeaders(e){const t=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let o=0;o<i;o++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],r=s==null?void 0:s.childNodes[o];r&&t.push(r)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=ss(t,["TD","TH"])),t===null)return null;const i=t.parentNode,o=i.parentNode;let s=ay(i),r=t.cellIndex;return Fo(dr,t,this.wtRootElement)||Fo(ur,t,this.wtRootElement)?o.nodeName==="THEAD"&&(s-=o.childNodes.length):Fo(ns,t,this.wtRootElement)||Fo($i,t,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-o.childNodes.length+s:o===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):s=this.rowFilter.renderedToSource(s),Fo(dr,t,this.wtRootElement)||Fo(cr,t,this.wtRootElement)||Fo(ns,t,this.wtRootElement)?r=this.columnFilter.offsettedTH(r):r=this.columnFilter.visibleRowHeadedColumnToSourceColumn(r),this.wot.createCellCoords(s,r)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.wtSettings.getSetting("defaultRowHeight"),i=Js(this.TBODY)-1;let o,s,r,l,a;if(!(t===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,r=this.rowFilter.renderedToSource(e),o=this.getRowHeight(r),l=this.getTrForRow(r),a=l.querySelector("th"),a?s=Js(a):s=Js(l)-1,(!o&&this.wtSettings.getSetting("defaultRowHeight")<s||o<s)&&(s+=1,this.dataAccessObject.wtViewport.oversizedRows[r]=s)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=i}isRowHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=i}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return De(this.TABLE)}getHeight(){return ot(this.TABLE)}getTotalWidth(){const e=De(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=ot(this.hider);return e!==0?e:this.getHeight()}isVisible(){return lr(this.TABLE)}_modifyRowHeaderWidth(e){let t=_e(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}const pI="stickyRowsBottom",Mp={getFirstRenderedRow(){const n=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),t=n-e;return n===0||e===0?-1:t<0?0:t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};zi(Mp,"MIXIN_NAME",pI,{writable:!1,enumerable:!1});const wI="stickyColumnsStart",Ld={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const n=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),n)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};zi(Ld,"MIXIN_NAME",wI,{writable:!1,enumerable:!1});class Pp extends Ml{constructor(e,t,i,o){super(e,t,i,o,ns)}}Ee(Pp,Mp);Ee(Pp,Ld);const ur="top",$i="bottom",cr="inline_start",dr="top_inline_start_corner",ns="bottom_inline_start_corner",tR=[ur,$i,cr,dr,ns],CI=new Map([[ur,`ht_clone_${ur}`],[$i,`ht_clone_${$i}`],[cr,`ht_clone_${cr} ht_clone_left`],[dr,`ht_clone_${dr} ht_clone_top_left_corner`],[ns,`ht_clone_${ns} ht_clone_bottom_left_corner`]]);function bI(n,e){vI(n,e),e.add(n)}function vI(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function SI(n,e,t){return(e=yI(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yI(n){var e=RI(n,"string");return typeof e=="symbol"?e:e+""}function RI(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Qh(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var zl=new WeakSet;class EI{constructor(e){bI(this,zl),SI(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,i,o,s){const r=this.scrollViewportHorizontally(e.col,i,s),l=this.scrollViewportVertically(e.row,t,o);return r||l}scrollViewportHorizontally(e,t,i){const{drawn:o,totalColumns:s}=this.dataAccessObject;if(!o||!Number.isInteger(e)||e<0||e>s)return!1;const r=t===void 0&&i===void 0,{fixedColumnsStart:l,inlineStartOverlay:a}=this.dataAccessObject;if(r&&e<l||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),!Number.isInteger(e)||e<0||e>s))return!1;const h=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn();let c=!1;return(r&&(e<h||e>u)||!r)&&(c=a.scrollTo(e,r?e>=this.getLastPartiallyVisibleColumn():t)),c}scrollViewportVertically(e,t,i){const{drawn:o,totalRows:s}=this.dataAccessObject;if(!o||!Number.isInteger(e)||e<0||e>s)return!1;const r=t===void 0&&i===void 0,{fixedRowsBottom:l,fixedRowsTop:a,topOverlay:h}=this.dataAccessObject;if(r&&(e<a||e>s-l-1)||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),!Number.isInteger(e)||e<0||e>s))return!1;const u=this.getFirstVisibleRow(),c=this.getLastVisibleRow();let d=!1;return(r&&(e<u||e>c)||!r)&&(d=h.scrollTo(e,r?e>=this.getLastPartiallyVisibleRow():i)),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Qh(zl,this,yb).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Qh(zl,this,yb).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Qh(zl,this,Sb).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Qh(zl,this,Sb).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function Sb(n){const{wtSettings:e,inlineStartOverlay:t,wtTable:i,wtViewport:o,totalColumns:s,rootWindow:r}=this.dataAccessObject;if(t.mainTableScrollableElement===r){const l=e.getSetting("rtlMode");let a=null;if(l){const u=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;a=Math.abs(u.right-d)}else a=mt(i.wtRootElement).left;const h=Math.abs(lp(r,r));if(a>h){const u=ap(r);let c=o.getRowHeaderWidth();for(let d=1;d<=s;d++)if(c+=t.sumCellSizes(d-1,d),a+c-h>=u){n=d-2;break}}}return n}function yb(n){const{topOverlay:e,wtTable:t,wtViewport:i,totalRows:o,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const r=mt(t.wtRootElement),l=Md(s,s);if(r.top>l){const a=Js(s);let h=i.getColumnHeaderHeight();for(let u=1;u<=o;u++)if(h+=e.sumCellSizes(u-1,u),r.top+h-l>=a){n=u-2;break}}}return n}function Un(n,e,t){return(e=TI(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function TI(n){var e=MI(n,"string");return typeof e=="symbol"?e:e+""}function MI(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Ip{get eventManager(){return new kn(this)}constructor(e,t){Un(this,"wtTable",void 0),Un(this,"wtScroll",void 0),Un(this,"wtViewport",void 0),Un(this,"wtOverlays",void 0),Un(this,"selectionManager",void 0),Un(this,"wtEvent",void 0),Un(this,"guid",`wt_${ep()}`),Un(this,"drawInterrupted",!1),Un(this,"drawn",!1),Un(this,"domBindings",void 0),Un(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new EI(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;t<i;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,i){rs(i,e[t])}])}}createCellCoords(e,t){return new hr(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,i){return new Th(e,t,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const i=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),r=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<o&&e.col<r)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<r&&e.row>=i-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<r)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,i,o,s){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,t,i,o,s)}scrollViewportHorizontally(e,t,i){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,t,i)}scrollViewportVertically(e,t,i){return e<0?!1:this.wtScroll.scrollViewportVertically(e,t,i)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function Rb(n,e,t){return(e=PI(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function PI(n){var e=II(n,"string");return typeof e=="symbol"?e:e+""}function II(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class HI extends Ip{constructor(e,t,i){super(e,t),Rb(this,"cloneSource",void 0),Rb(this,"cloneOverlay",void 0);const o=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new Qy(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}function xI(n,e,t){return(e=AI(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function AI(n){var e=_I(n,"string");return typeof e=="symbol"?e:e+""}function _I(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Ph{constructor(e,t,i,o,s){xI(this,"wtSettings",null),zi(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=t,this.wtSettings=o;const{TABLE:r,hider:l,spreader:a,holder:h,wtRootElement:u}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=r,this.hider=l,this.spreader=a,this.holder=h,this.wtRootElement=u,this.trimmingContainer=ar(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=ar(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=sh(e.TABLE)}getRelativeCellPosition(e,t,i){if(this.clone.wtTable.holder.contains(e)===!1){ye(`The provided element is not a child of the ${this.type} overlay`);return}const o=this.mainTableScrollableElement===this.domBindings.rootWindow,s=i<this.wtSettings.getSetting("fixedColumnsStart"),r=t<this.wtSettings.getSetting("fixedRowsTop"),l=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),a=this.clone.wtTable.spreader,h={start:this.getRelativeStartPosition(a),top:a.offsetTop},u={start:this.getRelativeStartPosition(e),top:e.offsetTop};let c=null;return o?c=this.getRelativeCellPositionWithinWindow(r,s,u,h):c=this.getRelativeCellPositionWithinHolder(r,l,s,u,h),c}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,i,o){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let r=0,l=0;if(!t)r=o.start;else{let a=s.left;this.isRtl()&&(a=this.domBindings.rootWindow.innerWidth-(s.left+s.width+pt())),r=a<=0?-1*a:0}return e?l=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:l=o.top,{start:i.start+r,top:i.top+l}}getRelativeCellPositionWithinHolder(e,t,i,o,s){const r={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let l=0,a=0;if(i||(l=r.horizontal-s.start),t){const h=this.wot.wtTable.wtRootElement.getBoundingClientRect();a=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+h.top}else e||(a=r.vertical-s.top);return{start:o.start-l,top:o.top-a}}makeClone(){if(tR.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:i,rootWindow:o}=this.domBindings,s=i.createElement("div"),r=i.createElement("table"),l=e.wtRootElement.parentNode;s.className=`${CI.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,t.getSetting("ariaTags")&&Y(s,[Wi()]),r.className=e.TABLE.className,e.TABLE.getAttribute("role")&&r.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(r),l.appendChild(s);const h=this.wtSettings.getSetting("preventOverflow");return h===!0||h==="horizontal"&&this.type===ur||h==="vertical"&&this.type===cr?this.mainTableScrollableElement=o:o.getComputedStyle(l).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=sh(e.TABLE),new HI(r,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.needFullRender&&this.clone.draw(e)}reset(){const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,i=e.style,o=t.style,s=e.parentNode.style;[i,o,s].forEach(r=>{r.width="",r.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class OI extends Ph{constructor(e,t,i,o,s,r){super(e,t,ns,i,o),this.bottomOverlay=s,this.inlineStartOverlay=r}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new Pp(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),r=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${s}px`,t.style.bottom=`${r}px`}else yh(t),this.repositionOverlay();let i=ot(this.clone.wtTable.TABLE);const o=De(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),t.style.height=`${i}px`,t.style.width=`${o}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let s=0;t.hasVerticalScroll()||(s+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(s+=pt(i)),o.style.bottom=`${s}px`}}const NI="calculatedColumns",kd={getFirstRenderedColumn(){const n=this.dataAccessObject.startColumnRendered;return n===null?-1:n},getFirstVisibleColumn(){const n=this.dataAccessObject.startColumnVisible;return n===null?-1:n},getFirstPartiallyVisibleColumn(){const n=this.dataAccessObject.startColumnPartiallyVisible;return n===null?-1:n},getLastRenderedColumn(){const n=this.dataAccessObject.endColumnRendered;return n===null?-1:n},getLastVisibleColumn(){const n=this.dataAccessObject.endColumnVisible;return n===null?-1:n},getLastPartiallyVisibleColumn(){const n=this.dataAccessObject.endColumnPartiallyVisible;return n===null?-1:n},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};zi(kd,"MIXIN_NAME",NI,{writable:!1,enumerable:!1});class Hp extends Ml{constructor(e,t,i,o){super(e,t,i,o,$i)}}Ee(Hp,Mp);Ee(Hp,kd);function DI(n,e,t){return(e=LI(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function LI(n){var e=kI(n,"string");return typeof e=="symbol"?e:e+""}function kI(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class $I extends Ph{constructor(e,t,i,o){super(e,t,$i,i,o),DI(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new Hp(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let i=0;const o=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!o||o!=="vertical")?(i=this.getOverlayOffset(),t.style.bottom=`${i}px`):(i=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let s=0;t.hasVerticalScroll()||(s+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(s+=pt(i)),o.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let i=!1;return this.mainTableScrollableElement===t?(t.scrollTo(Td(t),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:i,wtSettings:o}=this.wot,s=o.getSetting("defaultRowHeight");let r=e,l=0;for(;r<t;){const a=i.getRowHeight(r);l+=a===void 0?s:a,r+=1}return l}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:i,rootWindow:o}=this.domBindings,s=pt(i),l=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||a==="horizontal"){let u=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=s),u=Math.min(u,e.wtRootElement.scrollWidth),l.width=`${u}px`}else l.width="";this.clone.wtTable.holder.style.width=l.width;let h=ot(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(h=0),l.height=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let i=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let r=0;t&&s.offsetHeight!==s.clientHeight&&(r=pt(this.domBindings.rootDocument)),t?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=r,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Md(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const o=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),r=o-s,l=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-l+o,0),i>r&&(i=0)}return i}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==t,o=this.wtSettings.getSetting("columnHeaders");let s=!1;if((i||t===0)&&o.length>0){const r=this.wot.wtTable.holder.parentNode,l=K(r,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(P(r,"innerBorderBottom"),s=!l):(X(r,"innerBorderBottom"),s=l)}return s}}const VI="calculatedRows",xp={getFirstRenderedRow(){const n=this.dataAccessObject.startRowRendered;return n===null?-1:n},getFirstVisibleRow(){const n=this.dataAccessObject.startRowVisible;return n===null?-1:n},getFirstPartiallyVisibleRow(){const n=this.dataAccessObject.startRowPartiallyVisible;return n===null?-1:n},getLastRenderedRow(){const n=this.dataAccessObject.endRowRendered;return n===null?-1:n},getLastVisibleRow(){const n=this.dataAccessObject.endRowVisible;return n===null?-1:n},getLastPartiallyVisibleRow(){const n=this.dataAccessObject.endRowPartiallyVisible;return n===null?-1:n},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};zi(xp,"MIXIN_NAME",VI,{writable:!1,enumerable:!1});class Ap extends Ml{constructor(e,t,i,o){super(e,t,i,o,cr)}}Ee(Ap,xp);Ee(Ap,Ld);const FI="localHooks",Et={_localHooks:Object.create(null),addLocalHook(n,e){return this._localHooks[n]||(this._localHooks[n]=[]),this._localHooks[n].push(e),this},runLocalHooks(n,e,t,i,o,s,r){if(this._localHooks[n]){const l=this._localHooks[n].length;for(let a=0;a<l;a++)Nc(this._localHooks[n][a],this,e,t,i,o,s,r)}},clearLocalHooks(){return this._localHooks={},this}};zi(Et,"MIXIN_NAME",FI,{writable:!1,enumerable:!1});let nR=class{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}};Ee(nR,Et);const iR="active-header",_p="header",Op="area",Np="focus",WI="fill",BI="row",jI="column",UI="custom-selection",Dp=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});function zI(n,e){oR(n,e),e.add(n)}function Eb(n,e,t){oR(n,e),e.set(n,t)}function oR(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function st(n,e){return n.get(Va(n,e))}function Tb(n,e,t){return n.set(Va(n,e),t),t}function Va(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var zn=new WeakMap,Zt=new WeakMap,Jh=new WeakSet;class GI{constructor(){zI(this,Jh),Eb(this,zn,void 0),Eb(this,Zt,void 0)}setActiveOverlay(e){return Tb(Zt,this,e),this}setActiveSelection(e){return Tb(zn,this,e),this}scan(){const e=st(zn,this).settings.selectionType,t=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(i=>t.add(i)),this.scanRowsInHeadersRange(i=>t.add(i))):e==="area"?this.scanCellsRange(i=>t.add(i)):e==="focus"?(this.scanColumnsInHeadersRange(i=>t.add(i)),this.scanRowsInHeadersRange(i=>t.add(i)),this.scanCellsRange(i=>t.add(i))):e==="fill"?this.scanCellsRange(i=>t.add(i)):e==="header"?(this.scanColumnsInHeadersRange(i=>t.add(i)),this.scanRowsInHeadersRange(i=>t.add(i))):e==="row"?(this.scanRowsInHeadersRange(i=>t.add(i)),this.scanRowsInCellsRange(i=>t.add(i))):e==="column"&&(this.scanColumnsInHeadersRange(i=>t.add(i)),this.scanColumnsInCellsRange(i=>t.add(i))),t}scanColumnsInHeadersRange(e){const[t,i,o,s]=st(zn,this).getCorners(),{wtTable:r}=st(Zt,this),l=r.getRenderedColumnsCount(),a=r.getColumnHeadersCount();let h=0;for(let u=-r.getRowHeadersCount();u<l;u++){const c=r.columnFilter.renderedToSource(u);if(!(c<i||c>s)){for(let d=-a;d<0;d++){if(d<t||d>o)continue;const g=d+a;let p=r.getColumnHeader(c,g);const v=st(Zt,this).getSetting("onBeforeHighlightingColumnHeader",c,g,{selectionType:st(zn,this).settings.selectionType,columnCursor:h,selectionWidth:s-i+1});v!==null&&(v!==c&&(p=r.getColumnHeader(v,g)),e(p))}h+=1}}}scanRowsInHeadersRange(e){const[t,i,o,s]=st(zn,this).getCorners(),{wtTable:r}=st(Zt,this),l=r.getRenderedRowsCount(),a=r.getRowHeadersCount();let h=0;for(let u=-r.getColumnHeadersCount();u<l;u++){const c=r.rowFilter.renderedToSource(u);if(!(c<t||c>o)){for(let d=-a;d<0;d++){if(d<i||d>s)continue;const g=d+a;let p=r.getRowHeader(c,g);const v=st(Zt,this).getSetting("onBeforeHighlightingRowHeader",c,g,{selectionType:st(zn,this).settings.selectionType,rowCursor:h,selectionHeight:o-t+1});v!==null&&(v!==c&&(p=r.getRowHeader(v,g)),e(p))}h+=1}}}scanCellsRange(e){const[t,i,o,s]=st(zn,this).getCorners(),{wtTable:r}=st(Zt,this);Va(Jh,this,yf).call(this,(l,a)=>{if(l>=t&&l<=o&&a>=i&&a<=s){const h=r.getCell(st(Zt,this).createCellCoords(l,a)),u=st(Zt,this).getSetting("onAfterDrawSelection",l,a,st(zn,this).settings.layerLevel);typeof u=="string"&&P(h,u),e(h)}})}scanRowsInCellsRange(e){const[t,,i]=st(zn,this).getCorners(),{wtTable:o}=st(Zt,this);Va(Jh,this,yf).call(this,(s,r)=>{if(s>=t&&s<=i){const l=o.getCell(st(Zt,this).createCellCoords(s,r));e(l)}})}scanColumnsInCellsRange(e){const[,t,,i]=st(zn,this).getCorners(),{wtTable:o}=st(Zt,this);Va(Jh,this,yf).call(this,(s,r)=>{if(r>=t&&r<=i){const l=o.getCell(st(Zt,this).createCellCoords(s,r));e(l)}})}}function yf(n){const{wtTable:e}=st(Zt,this),t=e.getRenderedRowsCount(),i=e.getRenderedColumnsCount();for(let o=0;o<t;o+=1){const s=e.rowFilter.renderedToSource(o);for(let r=0;r<i;r+=1)n(s,e.columnFilter.renderedToSource(r))}}class Mb{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Dp,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,i=this.main.childNodes.length;t<i;t++){const o=this.main.childNodes[t];this.eventManager.addEventListener(o,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),$n(e);const i=this,o=this.wot.rootDocument.body,s=t.getBoundingClientRect();t.style.display="none";function r(a){if(a.clientY<Math.floor(s.top)||a.clientY>Math.ceil(s.top+s.height)||a.clientX<Math.floor(s.left)||a.clientX>Math.ceil(s.left+s.width))return!0}function l(a){r(a)&&(i.eventManager.removeEventListener(o,"mousemove",l),t.style.display="block")}this.eventManager.addEventListener(o,"mousemove",l)}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const i=["top","start","bottom","end","corner"];let o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(let l=0;l<5;l++){const a=i[l],h=t.createElement("div");h.className=`wtBorder ${this.settings.className||""}`,this.settings[a]&&this.settings[a].hide&&(h.className+=" hidden"),o=h.style,o.backgroundColor=this.settings[a]&&this.settings[a].color?this.settings[a].color:e.border.color,o.height=this.settings[a]&&this.settings[a].width?`${this.settings[a].width}px`:`${e.border.width}px`,o.width=this.settings[a]&&this.settings[a].width?`${this.settings[a].width}px`:`${e.border.width}px`,this.main.appendChild(h)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),go()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let r=s.bordersHolder;r||(r=t.createElement("div"),r.className="htBorders",s.bordersHolder=r,s.spreader.appendChild(r)),r.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const t=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const o={position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${parseInt(i/1.5,10)}px`};te(o,(r,l)=>{this.selectionHandles.styles.bottomHitArea[l]=r,this.selectionHandles.styles.topHitArea[l]=r});const s={position:"absolute",height:`${t}px`,width:`${t}px`,"border-radius":`${parseInt(t/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};te(s,(r,l)=>{this.selectionHandles.styles.bottom[l]=r,this.selectionHandles.styles.top[l]=r}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const i=this.wot.selectionManager.getAreaSelection();return!!(i.cellRange&&(e!==i.cellRange.to.row||t!==i.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,i,o,s,r){const a=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:h,topHitArea:u,bottom:c,bottomHitArea:d}=this.selectionHandles.styles,g=parseInt(h.borderWidth,10),p=parseInt(h.width,10),v=parseInt(u.width,10),C=this.wot.wtTable.getWidth(),S=this.wot.wtTable.getHeight();h.top=`${parseInt(i-p-1,10)}px`,h[a]=`${parseInt(o-p-1,10)}px`,u.top=`${parseInt(i-v/4*3,10)}px`,u[a]=`${parseInt(o-v/4*3,10)}px`;const R=Math.min(parseInt(o+s,10),C-p-g*2),M=Math.min(parseInt(o+s-v/4,10),C-v-g*2);c[a]=`${R}px`,d[a]=`${M}px`;const I=Math.min(parseInt(i+r,10),S-p-g*2),H=Math.min(parseInt(i+r-v/4,10),S-v-g*2);c.top=`${I}px`,d.top=`${H}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(h.display="block",u.display="block",this.isPartRange(e,t)?(c.display="none",d.display="none"):(c.display="block",d.display="block")):(h.display="none",c.display="none",u.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(h.zIndex="9999",u.zIndex="9999"):(h.zIndex="",u.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:t,rootDocument:i,rootWindow:o}=this.wot;let s,r,l,a,h,u;const c=t.getRenderedRowsCount();for(let re=0;re<c;re+=1){const fe=t.rowFilter.renderedToSource(re);if(fe>=e[0]&&fe<=e[2]){s=fe,h=e[0];break}}for(let re=c-1;re>=0;re-=1){const fe=t.rowFilter.renderedToSource(re);if(fe>=e[0]&&fe<=e[2]){r=fe;break}}const d=t.getRenderedColumnsCount();for(let re=0;re<d;re+=1){const fe=t.columnFilter.renderedToSource(re);if(fe>=e[1]&&fe<=e[3]){l=fe,u=e[1];break}}for(let re=d-1;re>=0;re-=1){const fe=t.columnFilter.renderedToSource(re);if(fe>=e[1]&&fe<=e[3]){a=fe;break}}if(s===void 0||l===void 0){this.disappear();return}let g=t.getCell(this.wot.createCellCoords(s,l));const p=s!==r||l!==a,v=p?t.getCell(this.wot.createCellCoords(r,a)):g,C=mt(g),S=p?mt(v):C,R=mt(t.TABLE),M=De(t.TABLE),I=C.top,H=C.left,O=this.wot.wtSettings.getSetting("rtlMode");let k=0,N=0;if(O){const re=De(g),fe=o.innerWidth-R.left-M;N=H+re-S.left,k=o.innerWidth-H-re-fe-1}else N=S.left+De(v)-H,k=H-R.left-1;if(this.isEntireColumnSelected(s,r)){const re=this.getDimensionsFromHeader("columns",l,a,h,R);let fe=null;re&&([fe,k,N]=re),fe&&(g=fe)}let Ce=I-R.top-1,ie=S.top+ot(v)-I;if(this.isEntireRowSelected(l,a)){const re=this.getDimensionsFromHeader("rows",s,r,u,R);let fe=null;re&&([fe,Ce,ie]=re),fe&&(g=fe)}const Ie=Ui(g,o);parseInt(Ie.borderTopWidth,10)>0&&(Ce+=1,ie=ie>0?ie-1:0),parseInt(Ie[O?"borderRightWidth":"borderLeftWidth"],10)>0&&(k+=1,N=N>0?N-1:0);const oe=O?"right":"left";this.topStyle.top=`${Ce}px`,this.topStyle[oe]=`${k}px`,this.topStyle.width=`${N}px`,this.topStyle.display="block",this.startStyle.top=`${Ce}px`,this.startStyle[oe]=`${k}px`,this.startStyle.height=`${ie}px`,this.startStyle.display="block";const Fe=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${Ce+ie-Fe}px`,this.bottomStyle[oe]=`${k}px`,this.bottomStyle.width=`${N}px`,this.bottomStyle.display="block",this.endStyle.top=`${Ce}px`,this.endStyle[oe]=`${k+N-Fe}px`,this.endStyle.height=`${ie+1}px`,this.endStyle.display="block";let We=this.settings.border.cornerVisible;We=typeof We=="function"?We(this.settings.layerLevel):We;const Rt=this.wot.getSetting("onModifyGetCellCoords",r,a);let[Vn,wt]=[r,a];if(Rt&&Array.isArray(Rt)&&([,,Vn,wt]=Rt),go()||!We||this.isPartRange(Vn,wt))this.cornerStyle.display="none";else{this.cornerStyle.top=`${Ce+ie+this.cornerCenterPointOffset-1}px`,this.cornerStyle[oe]=`${k+N+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let re=ar(t.TABLE);const fe=re===o;fe&&(re=i.documentElement);const To=parseInt(this.cornerDefaultStyle.width,10)/2,f=parseInt(this.cornerDefaultStyle.height,10)/2;if(a===this.wot.getSetting("totalColumns")-1){const m=fe?v.getBoundingClientRect().left:v.offsetLeft;let w=!1,y=0;O?(y=m-parseInt(this.cornerDefaultStyle.width,10)/2,w=y<0):(y=m+De(v)+parseInt(this.cornerDefaultStyle.width,10)/2,w=y>=ap(re)),w&&(this.cornerStyle[oe]=`${Math.floor(k+N+this.cornerCenterPointOffset-To)}px`,this.cornerStyle[O?"borderLeftWidth":"borderRightWidth"]=0)}r===this.wot.getSetting("totalRows")-1&&(fe?v.getBoundingClientRect().top:v.offsetTop)+ot(v)+parseInt(this.cornerDefaultStyle.height,10)/2>=Js(re)&&(this.cornerStyle.top=`${Math.floor(Ce+ie+this.cornerCenterPointOffset-f)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}go()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(r,a,Ce,k,N,ie)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,i,o,s){const{wtTable:r}=this.wot,l=r.wtRootElement.parentNode;let a=null,h=null,u=null,c=null,d=null,g=null,p=null,v=null;switch(e){case"rows":a=function(){return r.getRowHeader(...arguments)},h=function(){return ot(...arguments)},u="ht__selection--rows",g="top";break;case"columns":a=function(){return r.getColumnHeader(...arguments)},h=function(){return De(...arguments)},u="ht__selection--columns",g="left";break}if(l.classList.contains(u)){const C=this.wot.getSetting("columnHeaders").length;if(p=a(t,C-o),v=a(i,C-o),!p||!v)return!1;const S=mt(p),R=mt(v);return p&&v&&(c=S[g]-s[g]-1,d=R[g]+h(v)-S[g]),[p,c,d]}return!1}changeBorderStyle(e,t){const i=this[e].style,o=t[e];!o||o.hide?P(this[e],"hidden"):(K(this[e],"hidden")&&X(this[e],"hidden"),i.backgroundColor=o.color,(e==="top"||e==="bottom")&&(i.height=`${o.width}px`),(e==="start"||e==="end")&&(i.width=`${o.width}px`))}changeBorderToDefaultStyle(e){const t={width:1,color:"#000"},i=this[e].style;i.backgroundColor=t.color,i.width=`${t.width}px`,i.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?P(this[e],"hidden"):X(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",go()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function YI(n,e){sR(n,e),e.add(n)}function Ir(n,e,t){sR(n,e),e.set(n,t)}function sR(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function se(n,e){return n.get(Lp(n,e))}function Pb(n,e,t){return n.set(Lp(n,e),t),t}function Lp(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var At=new WeakMap,nn=new WeakMap,Rf=new WeakMap,Aa=new WeakMap,Ef=new WeakMap,ws=new WeakMap,Ib=new WeakSet;class KI{constructor(e){YI(this,Ib),Ir(this,At,void 0),Ir(this,nn,void 0),Ir(this,Rf,new GI),Ir(this,Aa,new WeakMap),Ir(this,Ef,new WeakSet),Ir(this,ws,new Map),Pb(nn,this,e)}setActiveOverlay(e){return Pb(At,this,e),se(Rf,this).setActiveOverlay(se(At,this)),se(Aa,this).has(se(At,this))||se(Aa,this).set(se(At,this),new Set),this}getFocusSelection(){return se(nn,this)!==null?se(nn,this).getFocus():null}getAreaSelection(){return se(nn,this)!==null?se(nn,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(se(ws,this).has(e)){const i=se(ws,this).get(e);if(i.has(se(At,this)))return i.get(se(At,this));const o=new Mb(se(At,this),e.settings);return i.set(se(At,this),o),o}const t=new Mb(se(At,this),e.settings);return se(ws,this).set(e,new Map([[se(At,this),t]])),t}getBorderInstances(e){var t,i;return Array.from((t=(i=se(ws,this).get(e))===null||i===void 0?void 0:i.values())!==null&&t!==void 0?t:[])}destroyBorders(e){se(ws,this).get(e).forEach(t=>t.destroy()),se(ws,this).delete(e)}render(e){if(se(nn,this)===null)return;e&&Lp(Ib,this,XI).call(this);const t=Array.from(se(nn,this)),i=new Map,o=new Map;for(let s=0;s<t.length;s++){const r=t[s],{className:l,headerAttributes:a,createLayers:h,selectionType:u}=r.settings;se(Ef,this).has(r)||(se(Ef,this).add(r),r.addLocalHook("destroy",()=>this.destroyBorders(r)));const c=this.getBorderInstance(r);if(r.isEmpty()){c==null||c.disappear();continue}l&&se(Rf,this).setActiveSelection(r).scan().forEach(p=>{if(i.has(p)){const v=i.get(p);v.has(l)&&h===!0?v.set(l,v.get(l)+1):v.set(l,1)}else i.set(p,new Map([[l,1]]));a&&(o.has(p)||o.set(p,[]),p.nodeName==="TH"&&o.get(p).push(...a))});const d=r.getCorners();se(At,this).getSetting("onBeforeDrawBorders",d,u),c==null||c.appear(d)}i.forEach((s,r)=>{var l;const a=Array.from(s).map(h=>{let[u,c]=h;return c===1?u:[u,...Array.from({length:c-1},(d,g)=>`${u}-${g+1}`)]}).flat();a.forEach(h=>se(Aa,this).get(se(At,this)).add(h)),P(r,a),r.nodeName==="TD"&&Array.isArray((l=se(nn,this).options)===null||l===void 0?void 0:l.cellAttributes)&&Y(r,se(nn,this).options.cellAttributes)}),Array.from(o.keys()).forEach(s=>{Y(s,[...o.get(s)])})}}function XI(){const n=se(Aa,this).get(se(At,this)),e=se(At,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let t=0;t<e.length;t++)n.add(e[t]);n.forEach(t=>{var i,o;const s=se(At,this).wtTable.TABLE.querySelectorAll(`.${t}`);let r=[];Array.isArray((i=se(nn,this).options)===null||i===void 0?void 0:i.cellAttributes)&&(r=se(nn,this).options.cellAttributes.map(l=>l[0])),Array.isArray((o=se(nn,this).options)===null||o===void 0?void 0:o.headerAttributes)&&(r=[...r,...se(nn,this).options.headerAttributes.map(l=>l[0])]);for(let l=0,a=s.length;l<a;l++)X(s[l],t),pr(s[l],r)}),n.clear()}class qI extends Ph{constructor(e,t,i,o){super(e,t,cr,i,o)}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new Ap(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,i=this.clone.wtTable.holder.parentNode,o=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===t&&(!o||o!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),Pd(i,`${s}px`,"0px")):(s=this.getScrollPosition(),yh(i));const r=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),r}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let i=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,rp(t)),i=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const i=this.wtSettings.getSetting("defaultColumnWidth");let o=e,s=0;for(;o<t;)s+=this.wot.wtTable.getStretchedColumnWidth(o)||i,o+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:i}=this.domBindings,o=pt(t),r=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="vertical"){let h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=o),h=Math.min(h,e.wtRootElement.scrollHeight),r.height=`${h}px`}else r.height="";this.clone.wtTable.holder.style.height=r.height;const a=De(this.clone.wtTable.TABLE);r.width=`${a}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(Dp.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){const{wtSettings:i}=this,o=i.getSetting("rowHeaders"),s=i.getSetting("fixedColumnsStart"),l=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,a=s===0&&o.length>0&&!K(l.parentNode,"innerBorderInlineStart")?1:0;let h=this.getTableParentOffset(),u=0;if(t){const c=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();c>d&&(t=!1)}return t&&l.offsetWidth!==l.clientWidth&&(u=pt(this.domBindings.rootDocument)),t?(h+=this.sumCellSizes(0,e+1),h-=this.wot.wtViewport.getViewportWidth(),h+=a):h+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),h+=u,fy(this.mainTableScrollableElement)===h-a&&a>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(a),this.setScrollPosition(h)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(lp(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const o=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),r=o-s;i>r&&(i=0)}return i}adjustHeaderBordersPosition(e){const{wtSettings:t}=this,i=this.wot.wtTable.holder.parentNode,o=t.getSetting("rowHeaders"),s=t.getSetting("fixedColumnsStart"),r=t.getSetting("totalRows"),l=t.getSetting("preventOverflow")==="vertical";r?X(i,"emptyRows"):P(i,"emptyRows");let a=!1;if(!l){if(s&&!o.length)P(i,"innerBorderLeft innerBorderInlineStart");else if(!s&&o.length){const h=K(i,"innerBorderInlineStart");e?(P(i,"innerBorderLeft innerBorderInlineStart"),a=!h):(X(i,"innerBorderLeft innerBorderInlineStart"),a=h)}}return a}}const QI="stickyRowsTop",kp={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};zi(kp,"MIXIN_NAME",QI,{writable:!1,enumerable:!1});class $p extends Ml{constructor(e,t,i,o){super(e,t,i,o,dr)}}Ee($p,kp);Ee($p,Ld);function Hb(n,e,t){return(e=JI(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function JI(n){var e=ZI(n,"string");return typeof e=="symbol"?e:e+""}function ZI(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class eH extends Ph{constructor(e,t,i,o,s,r){super(e,t,dr,i,o),Hb(this,"topOverlay",void 0),Hb(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=r}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new $p(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();Pd(e,`${o}px`,`${s}px`)}else yh(e);let t=ot(this.clone.wtTable.TABLE);const i=De(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${i}px`,!1}}class Vp extends Ml{constructor(e,t,i,o){super(e,t,i,o,ur)}}Ee(Vp,kp);Ee(Vp,kd);function tH(n,e,t){return(e=nH(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function nH(n){var e=iH(n,"string");return typeof e=="symbol"?e:e+""}function iH(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class oH extends Ph{constructor(e,t,i,o){super(e,t,ur,i,o),tH(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new Vp(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow");let o=0,s=!1;if(this.trimmingContainer===t&&(!i||i!=="vertical")){const{wtTable:l}=this.wot,a=l.hider.getBoundingClientRect(),h=Math.ceil(a.bottom),u=e.offsetHeight;s=h===u,o=this.getOverlayOffset(),Pd(e,"0px",`${o}px`)}else o=this.getScrollPosition(),yh(e);const r=this.adjustHeaderBordersPosition(o,s);return this.adjustElementsSize(),r}setScrollPosition(e){const t=this.domBindings.rootWindow;let i=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(Td(t),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const i=this.wtSettings.getSetting("defaultRowHeight");let o=e,s=0;for(;o<t;){const r=this.wot.wtTable.getRowHeight(o);s+=r===void 0?i:r,o+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:i}=this.domBindings,o=pt(t),r=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=o),h=Math.min(h,e.wtRootElement.scrollWidth),r.width=`${h}px`}else r.width="";this.clone.wtTable.holder.style.width=r.width;let a=ot(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(a=0),r.height=`${a}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(Dp.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:i,wtSettings:o}=this,r=(i.cloneSource?i.cloneSource:i).wtTable.holder,l=o.getSetting("columnHeaders"),h=o.getSetting("fixedRowsTop")===0&&l.length>0&&!K(r.parentNode,"innerBorderTop")?1:0;let u=this.getTableParentOffset(),c=0;if(t){const d=this.wot.wtTable.getRowHeight(e),g=this.wot.wtViewport.getViewportHeight();d>g&&(t=!1)}if(t&&r.offsetHeight!==r.clientHeight&&(c=pt(this.domBindings.rootDocument)),t){const d=o.getSetting("fixedRowsBottom"),g=o.getSetting("totalRows");u+=this.sumCellSizes(0,e+1),u-=i.wtViewport.getViewportHeight()-this.sumCellSizes(g-d,g),u+=1,u+=h}else u+=this.sumCellSizes(o.getSetting("fixedRowsTop"),e);return u+=c,dy(this.mainTableScrollableElement)===u-h&&h>0&&this.wot.wtOverlays.expandHiderVerticallyBy(h),this.setScrollPosition(u)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Md(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const o=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),r=o-s;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>r&&(i=0)}return i}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:i}=this,o=this.wot.wtTable.holder.parentNode,s=i.getSetting("totalColumns"),r=i.getSetting("preventOverflow")==="horizontal";s?X(o,"emptyColumns"):P(o,"emptyColumns");let l=!1;if(!t&&!r){const a=i.getSetting("fixedRowsTop"),h=this.cachedFixedRowsTop!==a,u=i.getSetting("columnHeaders");if((h||a===0)&&u.length>0){const c=K(o,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),e||i.getSetting("totalRows")===0?(P(o,"innerBorderTop"),l=!c):(X(o,"innerBorderTop"),l=c)}}return l}}function Zh(n,e,t){sH(n,e),e.set(n,t)}function sH(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ki(n,e,t){return(e=rH(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rH(n){var e=lH(n,"string");return typeof e=="symbol"?e:e+""}function lH(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Cs(n,e,t){return n.set(rR(n,e),t),t}function Xi(n,e){return n.get(rR(n,e))}function rR(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Hr=new WeakMap,eu=new WeakMap,xr=new WeakMap,tu=new WeakMap;class aH{constructor(e,t,i,o,s,r){Ki(this,"wot",null),Zh(this,Hr,[]),Ki(this,"topOverlay",null),Ki(this,"bottomOverlay",null),Ki(this,"inlineStartOverlay",null),Ki(this,"topInlineStartCornerOverlay",null),Ki(this,"bottomInlineStartCornerOverlay",null),Ki(this,"browserLineHeight",void 0),Ki(this,"wtSettings",null),Zh(this,eu,!1),Zh(this,xr,0),Zh(this,tu,null),Ki(this,"resizeObserver",new ResizeObserver(u=>{_d(()=>{!Array.isArray(u)||!u.length||(Cs(xr,this,Xi(xr,this)+1),Xi(xr,this)===100&&(ye("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Xi(tu,this)!==null&&clearTimeout(Xi(tu,this)),Cs(tu,this,setTimeout(()=>{Cs(xr,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=o,this.domBindings=i,this.facadeGetter=t,this.wtTable=r;const{rootDocument:l,rootWindow:a}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=pt(l);const h=a.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=h?r.holder:sh(r.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=a.scrollX,this.lastScrollY=a.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=[...Xi(Hr,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,i=e.getComputedStyle(t.body),o=parseInt(i.lineHeight,10),s=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=o||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new oH(...e),this.bottomOverlay=new $I(...e),this.inlineStartOverlay=new qI(...e),this.topInlineStartCornerOverlay=new eH(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new OI(...e,this.bottomOverlay,this.inlineStartOverlay),Cs(Hr,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Cs(eu,this,Xi(Hr,this).reduce((e,t)=>t.hasRenderingStateChanged()||e,!1)),Xi(Hr,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Xi(Hr,this).forEach(e=>{const t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:o}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",c=>this.onKeyDown(c)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",c=>this.onTableScroll(c),{passive:!0}),i!==o&&this.eventManager.addEventListener(o,"scroll",c=>this.onTableScroll(c),{passive:!0});const s=t.devicePixelRatio&&t.devicePixelRatio>1,r=this.scrollableElement===t,l=this.wtSettings.getSetting("preventWheel"),a={passive:r};(l||s||!mp())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",c=>this.onCloneWheel(c,l),a),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(c=>{if(c&&c.needFullRender){const{holder:d}=c.clone.wtTable;this.eventManager.addEventListener(d,"wheel",g=>this.onCloneWheel(g,l),a)}});let u;this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(u),u=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize"),Cs(xr,this,0)},200)}),r||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(o!==t&&s!==t&&!e.target.contains(o)||i!==t&&s!==t&&!e.target.contains(i))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:i}=this.domBindings,o=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,r=e.target,l=s!==i&&r!==i&&!r.contains(s),a=o!==i&&r!==i&&!r.contains(o);if(this.keyPressed&&(l||a)||this.scrollableElement===i)return;const h=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==i&&h)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Tl(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(i+=i*this.browserLineHeight,t+=t*this.browserLineHeight);const o=this.scrollVertically(t),s=this.scrollHorizontally(i);return o||s}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,[o,s]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==o||this.lastScrollX!==e.scrollX,this.verticalScrolling=i.scrollTop!==s||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=o;const r=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;r&&(r.scrollLeft=o)}this.verticalScrolling&&(i.scrollTop=s),this.refreshAll()}syncScrollWithMaster(){if(!Xi(eu,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:i}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i),Cs(eu,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=sh(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,i=e.clientHeight,o=t!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=i),o}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:i}=this.domBindings,o=this.scrollableElement===i,s=this.wtSettings.getSetting("totalColumns"),r=this.wtSettings.getSetting("totalRows"),l=e.getRowHeaderWidth(),h=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,r)+1,u=l+this.inlineStartOverlay.sumCellSizes(0,s),d=t.hider.style,g=()=>o?!1:this.scrollableElement.scrollTop>Math.max(0,h-t.holder.clientHeight),p=()=>o?!1:this.scrollableElement.scrollLeft>Math.max(0,u-t.holder.clientWidth),v=g()?1:0,C=p()?1:0;if(d.width=`${u+C}px`,d.height=`${h+v}px`,this.scrollbarSize>0){const{scrollHeight:S,scrollWidth:R}=t.wtRootElement,{scrollHeight:M,scrollWidth:I}=t.holder;this.hasScrollbarRight=S<M,this.hasScrollbarBottom=R<I,this.hasScrollbarRight&&t.hider.scrollWidth+this.scrollbarSize>R?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&t.hider.scrollHeight+this.scrollbarSize>S&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let i=null;return b(t,o=>{o&&o.clone&&o.clone.wtTable.TABLE.contains(e)&&(i=o.clone)}),i}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];b(t,i=>{i&&(i.clone.wtTable.TABLE.className=e.className)})}}function xb(n,e,t){return(e=hH(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hH(n){var e=uH(n,"string");return typeof e=="symbol"?e:e+""}function uH(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class cH{constructor(e){xb(this,"settings",{}),xb(this,"defaults",Object.freeze(this.getDefaults())),te(this.defaults,(t,i)=>{if(e[i]!==void 0)this.settings[i]=e[i];else{if(t===void 0)throw new Error(`A required setting "${i}" was not provided`);this.settings[i]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,i)=>{const o=this.getSetting("data",e,t);rs(i,o??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return t===void 0?te(e,(i,o)=>{this.settings[o]=i}):this.settings[e]=t,this}getSetting(e,t,i,o,s){return typeof this.settings[e]=="function"?this.settings[e](t,i,o,s):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Fp extends Ml{constructor(e,t,i,o){super(e,t,i,o,"master")}alignOverlaysWithTrimmingContainer(){const e=ar(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const i=e.parentElement,o=wl(e,"height",t),s=wl(e,"overflow",t),r=this.holder.style,{scrollWidth:l,scrollHeight:a}=e;let h=e.offsetWidth,u=e.offsetHeight;if(i&&["auto","hidden","scroll"].includes(s)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?i.insertBefore(d,e.nextElementSibling):i.appendChild(d);const g=parseInt(Ui(d,t).height,10);i.removeChild(d),g===0&&(u=0)}u=Math.min(u,a),r.height=o==="auto"?"auto":`${u}px`,h=Math.min(h,l),r.width=`${h}px`,r.overflow="",this.hasTableHeight=r.height==="auto"?!0:u>0,this.hasTableWidth=h>0}this.isTableVisible=lr(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,i="master",s=e.getSetting("columnHeaders").length;if(s&&!t.hasOversizedColumnHeadersMarked[i]){const l=e.getSetting("rowHeaders").length,a=this.getRenderedColumnsCount();for(let h=0;h<s;h++)for(let u=-1*l;u<a;u++)this.markIfOversizedColumnHeader(u);t.hasOversizedColumnHeadersMarked[i]=!0}}}Ee(Fp,xp);Ee(Fp,kd);class dH{constructor(e,t,i,o,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=i,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new tP:new iP],["fullyVisible",()=>new z0],["partiallyVisible",()=>new zy]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new J0:new nP],["fullyVisible",()=>new B0],["partiallyVisible",()=>new Uy]]),this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let i=0;return t===this.domBindings.rootWindow?i=e.documentElement.clientHeight:i=ot(t)>0&&t.clientHeight>0?t.clientHeight:1/0,i}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:t,rootWindow:i}=this.domBindings,o=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=t.documentElement.offsetWidth,r=e.getSetting("totalColumns"),l=e.getSetting("preventOverflow"),a=e.getSetting("rtlMode"),h=this.wtTable.TABLE.getBoundingClientRect(),u=a?h.right-s:h.left,c=s-u;let d,g;if(l)return De(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?d=Math.min(c,s):d=Math.min(this.getContainerFillWidth(),c,s),o===i&&r>0&&this.sumColumnWidths(0,r-1)>d)return t.documentElement.clientWidth;if(o!==i&&(g=wl(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",i),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(d,o.clientWidth);const p=e.getSetting("stretchH");return p==="none"||!p?Math.max(d,De(this.wtTable.TABLE)):d}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let i=0,o=e;for(;o<t;)i+=this.wtTable.getColumnWidth(o),o+=1;return i}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);const i=t.offsetWidth;return this.containerWidth=i,e.removeChild(t),i}getWorkspaceOffset(){return mt(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=ot(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,o=t.length;i<o;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let o=0,s=t.length;o<s;o++)i?(this.rowHeaderWidth+=De(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:i}=this;let o=this.getViewportHeight(),s,r;this.rowHeaderWidth=NaN;let l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const a=t.getSetting("fixedRowsTop"),h=t.getSetting("fixedRowsBottom"),u=t.getSetting("totalRows");return a&&l>=0&&(r=this.dataAccessObject.topOverlay.sumCellSizes(0,a),l+=r,o-=r),h&&this.dataAccessObject.bottomOverlay.clone&&(r=this.dataAccessObject.bottomOverlay.sumCellSizes(u-h,u),o-=r),i.holder.clientHeight===i.holder.offsetHeight?s=0:s=pt(this.domBindings.rootDocument),new cP({calculationTypes:e.map(c=>[c,this.rowsCalculatorTypes.get(c)()]),viewportHeight:o,scrollOffset:l,totalRows:t.getSetting("totalRows"),rowHeightFn:c=>i.getRowHeight(c),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:i}=this;let o=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const r=t.getSetting("fixedColumnsStart");if(r&&s>=0){const l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,r);s+=l,o-=l}return i.holder.clientWidth!==i.holder.offsetWidth&&(o-=pt(this.domBindings.rootDocument)),new aP({calculationTypes:e.map(l=>[l,this.columnsCalculatorTypes.get(l)()]),viewportWidth:o,scrollOffset:s,totalColumns:t.getSetting("totalColumns"),columnWidthFn:l=>i.getColumnWidth(l),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,i=this.createRowsCalculator(),o=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){const s=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s)}if(e&&!t.getSetting("renderAllColumns")){const s=o.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s)}return e||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=o.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=o.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=o.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:i}=e;if(t===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,i=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:o,endRow:s}=this.rowsRenderCalculator;return t<o||t===o&&t>0?!1:!(i>s||i===s&&i<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:i}=e;if(t===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,i=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:o,endColumn:s}=this.columnsRenderCalculator;return t<o||t===o&&t>0?!1:!(i>s||i===s&&i<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){te(this.hasOversizedColumnHeadersMarked,(e,t,i)=>{i[t]=void 0})}}class fH extends Ip{constructor(e,t){super(e,new cH(t));const i=this.wtSettings.getSetting("facade",this);this.wtTable=new Fp(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new dH(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new KI(this.wtSettings.getSetting("selections")),this.wtEvent=new Qy(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new aH(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],i=[];te(e,(o,s)=>{this.wtSettings.getSetting(s).length&&i.push(o),t.push(o)}),X(this.wtTable.wtRootElement.parentNode,t),P(this.wtTable.wtRootElement.parentNode,i)}getOverlayByName(e){var t;if(!tR.includes(e))return null;const i=e.replace(/_([a-z])/g,o=>o[1].toUpperCase());return(t=this.wtOverlays[`${i}Overlay`])!==null&&t!==void 0?t:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class Wp{constructor(e){e instanceof Ip?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=t=>{const i=new Wp(t);return()=>i},this._wot=new fH(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,i){return this._wot.createCellRange(e,t,i)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,t)}scrollViewport(e,t,i,o,s){return this._wot.scrollViewport(e,t,i,o,s)}scrollViewportHorizontally(e,t,i){return this._wot.scrollViewportHorizontally(e,t,i)}scrollViewportVertically(e,t,i){return this._wot.scrollViewportVertically(e,t,i)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,i,o,s){return this._wot.wtSettings.getSetting(e,t,i,o,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function Ab(n){let{isShiftKey:e,isLeftClick:t,isRightClick:i,coords:o,selection:s,controller:r,cellCoordsFactory:l}=n;const a=s.isSelected()?s.getSelectedRange().current():null,h=s.isSelectedByCorner(),u=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&a)o.row>=0&&o.col>=0&&!r.cell?s.setRangeEnd(o):(h||u)&&o.row>=0&&o.col>=0&&!r.cell?s.setRangeEnd(l(o.row,o.col)):h&&o.row<0&&!r.column?s.setRangeEnd(l(a.to.row,o.col)):u&&o.col<0&&!r.row?s.setRangeEnd(l(o.row,a.to.col)):(!h&&!u&&o.col<0||h&&o.col<0)&&!r.row?s.selectRows(Math.max(a.from.row,0),o.row,o.col):(!h&&!u&&o.row<0||u&&o.row<0)&&!r.column&&s.selectColumns(Math.max(a.from.col,0),o.col,o.row);else{const c=!s.inInSelection(o),d=t||i&&c;o.row<0&&o.col>=0&&!r.column?d&&s.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!r.row?d&&s.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!r.cell?d&&s.setRangeStart(o):o.col<0&&o.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function gH(n){let{isLeftClick:e,coords:t,selection:i,controller:o,cellCoordsFactory:s}=n;if(!e)return;const r=i.isSelectedByRowHeader(),l=i.isSelectedByColumnHeader(),a=i.tableProps.countCols(),h=i.tableProps.countRows();i.markSource("mouse"),l&&!o.column?i.setRangeEnd(s(h-1,t.col)):r&&!o.row?i.setRangeEnd(s(t.row,a-1)):o.cell||i.setRangeEnd(t),i.markEndSource()}const mH=new Map([["mousedown",Ab],["mouseover",gH],["touchstart",Ab]]);function _b(n,e){let{coords:t,selection:i,controller:o,cellCoordsFactory:s}=e;mH.get(n.type)({coords:t,selection:i,controller:o,cellCoordsFactory:s,isShiftKey:n.shiftKey,isLeftClick:Od(n)||n.type==="touchstart",isRightClick:ls(n)})}const lR=new WeakMap,Bp=Symbol("rootInstance");function pH(n){lR.set(n,!0)}function wH(n){return n===Bp}function wc(n){return lR.has(n)}function CH(n,e){aR(n,e),e.add(n)}function bs(n,e,t){aR(n,e),e.set(n,t)}function aR(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Po(n,e,t){return(e=bH(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function bH(n){var e=vH(n,"string");return typeof e=="symbol"?e:e+""}function vH(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function bt(n,e){return n.get(ah(n,e))}function Rn(n,e,t){return n.set(ah(n,e),t),t}function ah(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Tf=new WeakMap,nu=new WeakMap,iu=new WeakMap,qi=new WeakMap,Gn=new WeakMap,Mf=new WeakMap,Pf=new WeakMap,Cc=new WeakSet;class SH{constructor(e){CH(this,Cc),Po(this,"hot",void 0),Po(this,"eventManager",void 0),Po(this,"settings",void 0),Po(this,"THEAD",void 0),Po(this,"TBODY",void 0),Po(this,"_wt",void 0),Po(this,"activeWt",void 0),bs(this,Tf,0),bs(this,nu,0),Po(this,"postponedAdjustElementsSize",!1),bs(this,iu,!1),bs(this,qi,void 0),bs(this,Gn,void 0),bs(this,Mf,0),bs(this,Pf,0),this.hot=e,this.eventManager=new kn(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){const i=this._wt.getCell(e,t);return i<0?null:i}scrollViewport(e,t,i,o,s){return this._wt.scrollViewport(e,t,i,o,s)}scrollViewportHorizontally(e,t,i){return this._wt.scrollViewportHorizontally(e,t,i)}scrollViewportVertically(e,t,i){return this._wt.scrollViewportVertically(e,t,i)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,i=e.getAttribute("style");i&&e.setAttribute("data-originalstyle",i),P(e,"handsontable"),Rn(Gn,this,t.createElement("TABLE")),P(bt(Gn,this),"htCore"),this.hot.getSettings().tableClassName&&P(bt(Gn,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Y(bt(Gn,this),[Wi()]),Y(e,[iM(),ny(-1),Ed(this.hot.countCols()),wM()])),this.THEAD=t.createElement("THEAD"),bt(Gn,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),bt(Gn,this).appendChild(this.TBODY),this.hot.table=bt(Gn,this),this.hot.container.insertBefore(bt(Gn,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:t,selection:i,rootWindow:o}=this.hot,s=t.documentElement;this.eventManager.addEventListener(e,"mousedown",l=>{Rn(iu,this,!0),this.isTextSelectionAllowed(l.target)||(cm(o),l.preventDefault(),o.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{Rn(iu,this,!1)}),this.eventManager.addEventListener(e,"mousemove",l=>{bt(iu,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&cm(o),l.preventDefault())}),this.eventManager.addEventListener(s,"keyup",l=>{i.isInProgress()&&!l.shiftKey&&i.finish()}),this.eventManager.addEventListener(s,"mouseup",l=>{i.isInProgress()&&Od(l)&&i.finish(),Rn(qi,this,!1);const a=Id(t.activeElement);$a(t.activeElement)&&!a||(a||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!e.contains(l.target)&&!ls(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",l=>{i.isInProgress()&&ls(l)&&(i.finish(),Rn(qi,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{i.isInProgress()&&i.finish(),Rn(qi,this,!1)}),this.eventManager.addEventListener(s,"mousedown",l=>{const a=l.target,h=l.x||l.clientX,u=l.y||l.clientY;let c=l.target;if(bt(qi,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(c===d){const p=pt(t);if(t.elementFromPoint(h+p,u)!==d||t.elementFromPoint(h,u+p)!==d)return}else for(;c!==s;){if(c===null){if(l.isTargetWebComponent)break;return}if(c===e)return;c=c.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(a):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let r=rr(o);for(;r!==null;)this.eventManager.addEventListener(r.document.documentElement,"click",()=>{this.hot.unlisten()}),r=rr(r);this.eventManager.addEventListener(bt(Gn,this),"selectstart",l=>{this.settings.fragmentSelection||$a(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:i}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,i))}translateFromRenderableToVisualIndex(e,t){let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,o=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return i===null&&(i=e),o===null&&(o=t),[i,o]}countRenderableIndexes(e,t){const i=Math.min(e.getNotTrimmedIndexesLength(),t),o=e.getNearestNotHiddenIndex(i-1,-1);return o===null?0:e.getRenderableFromVisualIndex(o)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,i,o){if(isNaN(e)||e<0)return 0;const s=i.getNearestNotHiddenIndex(e,t),r=i.getRenderableFromVisualIndex(s);if(!Number.isInteger(r))return 0;let l=0;return t<0?l=r+1:t>0&&(l=o-r),l}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let i=0;for(let o=e;o<=t;o++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(o)!==null&&(i+=1);return i}countRenderableRowsInRange(e,t){let i=0;for(let o=e;o<=t;o++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(o)!==null&&(i+=1);return i}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:bt(Gn,this),isDataViewInstance:()=>wc(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(s,r)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,r)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((r,l)=>{const a=r>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(r):r;this.appendRowHeader(a,l)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),Rn(nu,this,s.length),this.hot.getSettings().ariaTags&&ah(Cc,this,hR).call(this)===this.hot.countCols()&&ah(Cc,this,yH).call(this,bt(nu,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((r,l)=>{const a=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;this.appendColHeader(a,l)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),Rn(Tf,this,s.length),s},columnWidth:s=>{const r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(r===null?s:r)},rowHeight:s=>{const r=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(r===null?s:r)},rowHeightByOverlayName:(s,r)=>{const l=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),a=l===null?s:l;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(a),a,r)},cellRenderer:(s,r,l)=>{const[a,h]=this.translateFromRenderableToVisualIndex(s,r),u=this.hot.runHooks("modifyGetCellCoords",a,h);let c=a,d=h;Array.isArray(u)&&([c,d]=u);const g=this.hot.getCellMeta(c,d),p=this.hot.colToProp(d);let v=this.hot.getDataAtRowProp(c,p);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,g)),this.hot.runHooks("beforeRenderer",l,a,h,p,v,g),this.hot.getCellRenderer(g)(this.hot,l,a,h,p,v,g),this.hot.runHooks("afterRenderer",l,a,h,p,v,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&lr(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,r,l,a)=>{const h=this.translateFromRenderableToVisualCoords(r),u={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=a,Rn(qi,this,!0),this.hot.runHooks("beforeOnCellMouseDown",s,h,l,u),!Yo(s)&&(_b(s,{coords:h,selection:this.hot.selection,controller:u,cellCoordsFactory:(c,d)=>this.hot._createCellCoords(c,d)}),this.hot.runHooks("afterOnCellMouseDown",s,h,l),this.activeWt=this._wt)},onCellContextMenu:(s,r,l,a)=>{const h=this.translateFromRenderableToVisualCoords(r);this.activeWt=a,Rn(qi,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,h,l),!Yo(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,h,l),this.activeWt=this._wt)},onCellMouseOut:(s,r,l,a)=>{const h=this.translateFromRenderableToVisualCoords(r);this.activeWt=a,this.hot.runHooks("beforeOnCellMouseOut",s,h,l),!Yo(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,h,l),this.activeWt=this._wt)},onCellMouseOver:(s,r,l,a)=>{const h=this.translateFromRenderableToVisualCoords(r),u={row:!1,column:!1,cell:!1};this.activeWt=a,this.hot.runHooks("beforeOnCellMouseOver",s,h,l,u),!Yo(s)&&(bt(qi,this)&&_b(s,{coords:h,selection:this.hot.selection,controller:u,cellCoordsFactory:(c,d)=>this.hot._createCellCoords(c,d)}),this.hot.runHooks("afterOnCellMouseOver",s,h,l),this.activeWt=this._wt)},onCellMouseUp:(s,r,l,a)=>{const h=this.translateFromRenderableToVisualCoords(r);this.activeWt=a,this.hot.runHooks("beforeOnCellMouseUp",s,h,l),!(Yo(s)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",s,h,l),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,r)=>this.beforeRender(s,r),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:s=>{const r=this.hot.rowIndexMapper,l=s<0;let a=s;return!l&&(a=r.getVisualFromRenderableIndex(s),a===null)?s:(a=this.hot.runHooks("beforeViewportScrollVertically",a),this.hot.runHooks("beforeViewportScroll"),l?a:r.getRenderableFromVisualIndex(a))},onBeforeViewportScrollHorizontally:s=>{const r=this.hot.columnIndexMapper,l=s<0;let a=s;return!l&&(a=r.getVisualFromRenderableIndex(s),a===null)?s:(a=this.hot.runHooks("beforeViewportScrollHorizontally",a),this.hot.runHooks("beforeViewportScroll"),l?a:r.getRenderableFromVisualIndex(a))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,r,l)=>{const a=this.hot.rowIndexMapper,h=s<0;let u=s;h||(u=a.getVisualFromRenderableIndex(s));const c=this.hot.runHooks("beforeHighlightingRowHeader",u,r,l);return h?c:a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(c,1))},onBeforeHighlightingColumnHeader:(s,r,l)=>{const a=this.hot.columnIndexMapper,h=s<0;let u=s;h||(u=a.getVisualFromRenderableIndex(s));const c=this.hot.runHooks("beforeHighlightingColumnHeader",u,r,l);return h?c:a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(c,1))},onAfterDrawSelection:(s,r,l)=>{let a;const[h,u]=this.translateFromRenderableToVisualIndex(s,r),c=this.hot.selection.getSelectedRange();if(c.size()>0){const g=c.peekByIndex(l??0);a=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",h,u,a,l)},onBeforeDrawBorders:(s,r)=>{const[l,a,h,u]=s,c=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(l),this.hot.columnIndexMapper.getVisualFromRenderableIndex(a),this.hot.rowIndexMapper.getVisualFromRenderableIndex(h),this.hot.columnIndexMapper.getVisualFromRenderableIndex(u)];return this.hot.runHooks("beforeDrawBorders",c,r)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(s,r)=>{const l=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r);return this.hot.runHooks("beforeStretchingColumnWidth",s,l)},onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,r,l)=>{const a=this.hot.rowIndexMapper,h=this.hot.columnIndexMapper,u=r>=0?h.getVisualFromRenderableIndex(r):r,c=s>=0?a.getVisualFromRenderableIndex(s):s,d=this.hot.runHooks("modifyGetCellCoords",c,u,l);if(Array.isArray(d)){const[g,p,v,C]=d;return[g>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(g,1)):g,p>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(p,1)):p,v>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(v,-1)):v,C>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(C,-1)):C]}},viewportRowCalculatorOverride:s=>{let r=this.settings.viewportRowRenderingOffset;if(r==="auto"&&this.settings.fixedRowsTop&&(r=10),r>0||r==="auto"){const l=this.countRenderableRows(),a=s.startRow,h=s.endRow;if(typeof r=="number")s.startRow=Math.max(a-r,0),s.endRow=Math.min(h+r,l-1);else if(r==="auto"){const u=Math.ceil(h/l*12);s.startRow=Math.max(a-u,0),s.endRow=Math.min(h+u,l-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let r=this.settings.viewportColumnRenderingOffset;if(r==="auto"&&this.settings.fixedColumnsStart&&(r=10),r>0||r==="auto"){const l=this.countRenderableColumns(),a=s.startColumn,h=s.endColumn;if(typeof r=="number"&&(s.startColumn=Math.max(a-r,0),s.endColumn=Math.min(h+r,l-1)),r==="auto"){const u=Math.ceil(h/l*6);s.startColumn=Math.max(a-u,0),s.endColumn=Math.min(h+u,l-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new Wp(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:i,height:o}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,o),this.eventManager.addEventListener(t,"mousedown",s=>{s.target===t&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",s=>{s.target===t&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if($a(e))return!0;const t=ts(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&t||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return bt(qi,this)}isSelectedOnlyCell(){var e,t;return(e=(t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const i=t.firstChild;if(!K(i,"relative")){si(t),this.appendRowHeader(e,t);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:i,getRowHeader:o}=this.hot,s=i.createElement("div"),r=i.createElement("span");s.className="relative",r.className="rowHeader",this.updateCellHeader(r,e,o),s.appendChild(r),t.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const r=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return r?r.split(" "):[]};if(t.firstChild){const r=t.firstChild;K(r,"relative")?(this.updateCellHeader(r.querySelector(".colHeader"),e,i,o),r.className="",P(r,["relative",...s()])):(si(t),this.appendColHeader(e,t,i,o))}else{const{rootDocument:r}=this.hot,l=r.createElement("div"),a=r.createElement("span"),h=s();l.classList.add("relative",...h),a.className="colHeader",this.settings.ariaTags&&(Y(l,...Wi()),Y(a,...Wi())),this.updateCellHeader(a,e,i,o),l.appendChild(a),t.appendChild(l)}this.hot.runHooks("afterGetColHeader",e,t,o)}updateCellHeader(e,t,i){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=t;const r=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(K(e,"colHeader")?s=r.wtTable.columnFilter.sourceToRendered(t):K(e,"rowHeader")&&(s=r.wtTable.rowFilter.sourceToRendered(t))),s>-1?wr(e,i(t,o)):(rs(e," "),P(e,"cornerHeader"))}maximumVisibleElementWidth(e){const i=this._wt.wtViewport.getWorkspaceWidth()-e;return i>0?i:0}maximumVisibleElementHeight(e){const i=this._wt.wtViewport.getWorkspaceHeight()-e;return i>0?i:0}setLastSize(e,t){Rn(Mf,this,e),Rn(Pf,this,t)}getLastSize(){return{width:bt(Mf,this),height:bt(Pf,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return bt(Tf,this)}getRowHeadersCount(){return bt(nu,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return((t=this._wt.wtOverlays.getParentOverlay(e))!==null&&t!==void 0?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function hR(){return parseInt(this.hot.rootElement.getAttribute(Ed()[0]),10)}function yH(n){const e=ah(Cc,this,hR).call(this)+n;Y(this.hot.rootElement,...Ed(e))}const uR="ABCDEFGHIJKLMNOPQRSTUVWXYZ",vm=uR.length;function $d(n){let e=n+1,t="",i;for(;e>0;)i=(e-1)%vm,t=String.fromCharCode(65+i)+t,e=parseInt((e-i)/vm,10);return t}function RH(n){let e=0;if(n)for(let t=0,i=n.length-1;t<n.length;t+=1,i-=1)e+=vm**i*(uR.indexOf(n[t])+1);return e-=1,e}function EH(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const t=[];let i,o;for(i=0;i<n;i++){const s=[];for(o=0;o<e;o++)s.push($d(o)+(i+1));t.push(s)}return t}function TH(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const t=[];let i,o;for(i=0;i<n;i++){const s={};for(o=0;o<e;o++)s[`prop${o}`]=$d(o)+(i+1);t.push(s)}return t}function MH(n,e){const t=[];let i;for(let o=0;o<n;o++){i=[];for(let s=0;s<e;s++)i.push("");t.push(i)}return t}function jp(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=n;const i=[];return(!Array.isArray(n)||!Array.isArray(n[0]))&&(t=[n]),t.forEach((o,s)=>{Array.isArray(o)?o.forEach((r,l)=>{i.push([s+e,l,r])}):Object.keys(o).forEach(r=>{i.push([s+e,r,o[r]])})}),i}function Up(n){let e=0;return Array.isArray(n)&&(n[0]&&Array.isArray(n[0])?e=n[0].length:n[0]&&ee(n[0])&&(e=Ad(n[0]))),e}function cR(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>Array.isArray(e)))}function dR(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const PH=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:Up,createEmptySpreadsheetData:MH,createSpreadsheetData:EH,createSpreadsheetObjectData:TH,dataRowToChangesArray:jp,isArrayOfArrays:cR,isArrayOfObjects:dR,spreadsheetColumnIndex:RH,spreadsheetColumnLabel:$d},Symbol.toStringTag,{value:"Module"}));function Gl(n,e,t){return(e=IH(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function IH(n){var e=HH(n,"string");return typeof e=="symbol"?e:e+""}function HH(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class xH{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Gl(this,"hot",void 0),Gl(this,"data",void 0),Gl(this,"dataType","array"),Gl(this,"colToProp",()=>{}),Gl(this,"propToCol",()=>{}),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const t=[];return b(this.data,(i,o)=>{const s=this.getAtCell(o,e);t.push(s)}),t}getAtRow(e,t,i){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=t===void 0&&i===void 0,{dataDotNotation:r}=this.hot.getSettings();let l=null,a=null;if(l=this.modifyRowData(e),Array.isArray(l))a=[],s?l.forEach((h,u)=>{a[u]=this.getAtPhysicalCell(e,u,l)}):j(t,i,h=>{a[h-t]=this.getAtPhysicalCell(e,h,l)});else if(ee(l)||_e(l))if(o?a=[]:a={},!s||o){const u=this.countFirstRowKeys()-1;j(0,u,c=>{const d=this.colToProp(c);if(c>=(t||0)&&c<=(i||u)&&!Number.isInteger(d)){const g=this.getAtPhysicalCell(e,d,l);o?a.push(g):r?gc(a,d,g):a[d]=g}})}else te(l,(h,u)=>{const c=this.getAtPhysicalCell(e,u,l);r?gc(a,u,c):a[u]=c});return a}setAtCell(e,t,i){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const o=Dn(i);this.hot.runHooks("modifySourceData",e,t,o,"set"),o.isTouched()&&(i=o.value)}Number.isInteger(t)?this.data[e][t]=i:gc(this.data[e],t,i)}}getAtPhysicalCell(e,t,i){let o=null;if(i)if(typeof t=="string"){const{dataDotNotation:s}=this.hot.getSettings();o=s?Sy(i,t):i[t]}else typeof t=="function"?o=t(i):o=i[t];if(this.hot.hasHook("modifySourceData")){const s=Dn(o);this.hot.runHooks("modifySourceData",e,t,s,"get"),s.isTouched()&&(o=s.value)}return o}getAtCell(e,t){const i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),i)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=null,r=null,l=null,a=null;e===null||t===null?(o=!0,s=0,l=this.countRows()-1):(s=Math.min(e.row,t.row),r=Math.min(e.col,t.col),l=Math.max(e.row,t.row),a=Math.max(e.col,t.col));const h=[];return j(s,l,u=>{h.push(o?this.getAtRow(u,void 0,void 0,i):this.getAtRow(u,r,a,i))}),h}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return Up(this.data)}destroy(){this.data=null,this.hot=null}}function Ob(n,e,t){return(e=AH(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function AH(n){var e=_H(n,"string");return typeof e=="symbol"?e:e+""}function _H(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Cr{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ob(this,"indexedValues",[]),Ob(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length?(this.indexedValues[e]=t,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,_e(this.initValueOrFn)?j(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):j(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Ee(Cr,Et);function zp(n,e,t,i){const o=t.length?t[0]:void 0;return[...n.slice(0,o),...t.map((s,r)=>_e(i)?i(s,r):i),...o===void 0?[]:n.slice(o)]}function Gp(n,e){return bo(n,(t,i)=>e.includes(i)===!1)}class us extends Cr{insert(e,t){this.indexedValues=zp(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=Gp(this.indexedValues,e),super.remove(e)}}class Vd extends us{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return at(this.getValues(),(e,t,i)=>(t&&e.push(i),e),[])}}function Yp(n,e,t){return[...n.slice(0,e),...t,...n.slice(e)]}function hh(n,e){return bo(n,t=>e.includes(t)===!1)}function Kp(n,e){return ae(n,t=>t-e.filter(i=>i<t).length)}function Xp(n,e){const t=e[0],i=e.length;return ae(n,o=>o>=t?o+i:o)}function OH(n,e,t){return(e=NH(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function NH(n){var e=DH(n,"string");return typeof e=="symbol"?e:e+""}function DH(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Fd extends Cr{constructor(){super(...arguments),OH(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=t,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=hh(this.orderOfIndexes,[e]),_e(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=zp(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=Xp(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=Gp(this.indexedValues,e),this.orderOfIndexes=hh(this.orderOfIndexes,e),this.orderOfIndexes=Kp(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Ih extends us{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return at(this.getValues(),(e,t,i)=>(t&&e.push(i),e),[])}}const Nb=new Map([["indexesSequence",{getListWithInsertedItems:Yp,getListWithRemovedItems:hh}],["physicallyIndexed",{getListWithInsertedItems:zp,getListWithRemovedItems:Gp}]]),fR=n=>{if(Nb.has(n)===!1)throw new Error(`Alter strategy with ID '${n}' does not exist.`);return Nb.get(n)};class gR extends Cr{constructor(){super(e=>e)}insert(e,t){const i=Xp(this.indexedValues,t);this.indexedValues=Yp(i,e,t),super.insert(e,t)}remove(e){const t=hh(this.indexedValues,e);this.indexedValues=Kp(t,e),super.remove(e)}}const Db=new Map([["hiding",Vd],["index",Cr],["linkedPhysicalIndexToValue",Fd],["physicalIndexToValue",us],["trimming",Ih]]);function LH(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!Db.has(n))throw new Error(`The provided map type ("${n}") does not exist.`);return new(Db.get(n))(e)}function kH(n,e,t){return(e=$H(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $H(n){var e=VH(n,"string");return typeof e=="symbol"?e:e+""}function VH(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}let Sm=0;class qp{constructor(){kH(this,"collection",new Map)}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)),Sm+=1)}unregister(e){const t=this.collection.get(e);F(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),Sm-=1)}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return Ne(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(i=>{i.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}Ee(qp,Et);function FH(){return Sm}function If(n,e,t){return(e=WH(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function WH(n){var e=BH(n,"string");return typeof e=="symbol"?e:e+""}function BH(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Lb extends qp{constructor(e,t){super(),If(this,"mergedValuesCache",[]),If(this,"aggregationFunction",void 0),If(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const t=ae(this.get(),s=>s.getValues()),i=[],o=F(t[0])&&t[0].length||0;for(let s=0;s<o;s+=1){const r=[];for(let l=0;l<this.getLength();l+=1)r.push(t[l][s]);i.push(r)}return ae(i,this.aggregationFunction)}getMergedValueAtIndex(e,t){const i=this.getMergedValues(t)[e];return F(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function jH(n,e,t){UH(n,e),e.set(n,t)}function UH(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zH(n,e,t){return n.set(mR(n,e),t),t}function GH(n,e){return n.get(mR(n,e))}function mR(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Hf=new WeakMap;class pR{constructor(){jH(this,Hf,[])}subscribe(e){return this.addLocalHook("change",e),this._write(GH(Hf,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){zH(Hf,this,e)}}Ee(pR,Et);function kb(n,e){const t=[];let i=0,o=0;for(;i<n.length&&o<e.length;i++,o++)n[i]!==e[o]&&t.push({op:"replace",index:o,oldValue:n[i],newValue:e[o]});for(;i<e.length;i++)t.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;o<n.length;o++)t.push({op:"remove",index:o,oldValue:n[o],newValue:void 0});return t}function Yl(n,e,t){YH(n,e),e.set(n,t)}function YH(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function En(n,e){return n.get(wR(n,e))}function ou(n,e,t){return n.set(wR(n,e),t),t}function wR(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var su=new WeakMap,Kl=new WeakMap,ru=new WeakMap,lu=new WeakMap,au=new WeakMap;class KH{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Yl(this,su,new Set),Yl(this,Kl,[]),Yl(this,ru,[]),Yl(this,lu,!1),Yl(this,au,!1),ou(au,this,e??!1)}createObserver(){const e=new pR;return En(su,this).add(e),e.addLocalHook("unsubscribe",()=>{En(su,this).delete(e)}),e._writeInitialChanges(kb(En(Kl,this),En(ru,this))),e}emit(e){let t=En(ru,this);(!En(lu,this)||En(Kl,this).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(En(au,this)):ou(Kl,this,new Array(e.length).fill(En(au,this))),En(lu,this)||(ou(lu,this,!0),t=En(Kl,this)));const i=kb(t,e);En(su,this).forEach(o=>o._write(i)),ou(ru,this,e)}}function Vt(n,e,t){return(e=XH(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function XH(n){var e=qH(n,"string");return typeof e=="symbol"?e:e+""}function qH(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class ym{constructor(){Vt(this,"indexesSequence",new gR),Vt(this,"trimmingMapsCollection",new Lb(e=>e.some(t=>t===!0),!1)),Vt(this,"hidingMapsCollection",new Lb(e=>e.some(t=>t===!0),!1)),Vt(this,"variousMapsCollection",new qp),Vt(this,"hidingChangesObservable",new KH({initialIndexValue:!1})),Vt(this,"notTrimmedIndexesCache",[]),Vt(this,"notHiddenIndexesCache",[]),Vt(this,"isBatched",!1),Vt(this,"indexesSequenceChanged",!1),Vt(this,"indexesChangeSource",void 0),Vt(this,"trimmedIndexesChanged",!1),Vt(this,"hiddenIndexesChanged",!1),Vt(this,"renderablePhysicalIndexesCache",[]),Vt(this,"fromPhysicalToVisualIndexesCache",new Map),Vt(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,i){return this.registerMap(e,LH(t,i))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof Ih?this.trimmingMapsCollection.register(e,t):t instanceof Vd?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const i=this.getNumberOfIndexes();return i>0&&t.init(i),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return F(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return F(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return F(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return F(t)?t:null}getNearestNotHiddenIndex(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let r=-1;return t>0?r=s.findIndex(l=>l>e):r=s.reverse().findIndex(l=>l<e),r===-1?i?this.getNearestNotHiddenIndex(e,-t,!1):null:s[r]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const i=[...Array(this.getNumberOfIndexes()-e).keys()].map(o=>o+e);this.removeIndexes(i)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(i=>this.isTrimmed(i)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(i=>this.isHidden(i)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(i=>this.isHidden(i)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);const i=ae(e,h=>this.getPhysicalFromVisualIndex(h)),o=this.getNotTrimmedIndexesLength(),s=e.length,r=hh(this.getIndexesSequence(),i),l=r.filter(h=>this.isTrimmed(h)===!1);let a=r.indexOf(l[l.length-1])+1;if(t+s<o){const h=l[t];a=r.indexOf(h)}this.indexesChangeSource="move",this.setIndexesSequence(Yp(r,a,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const i=this.getNotTrimmedIndexes()[e],o=F(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),r=ae(new Array(t).fill(o),(l,a)=>l+a);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(s,r),this.hidingMapsCollection.insertToEvery(s,r),this.variousMapsCollection.insertToEvery(s,r),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const i=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(i,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const i=this.getPhysicalFromRenderableIndex(t),o=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(o,t)}}}Ee(ym,Et);function QH(n,e){return te(e,(t,i)=>{Ne(n[i])&&(n[i]=t)}),n}function CR(n){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(n);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:n}function bR(n){F(n)&&vp(Re`Language with code "${n}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function JH(n,e){return Array.isArray(n)&&Number.isInteger(e)?n[e]:n}const{register:ZH,getValues:ex}=ai("phraseFormatters");function tx(n,e){ZH(n,e)}function nx(){return ex()}tx("pluralize",JH);const vR="ContextMenu:items",J=vR,Qp=`${J}.noItems`,Jp=`${J}.insertRowAbove`,Zp=`${J}.insertRowBelow`,ew=`${J}.insertColumnOnTheLeft`,tw=`${J}.insertColumnOnTheRight`,nw=`${J}.removeRow`,iw=`${J}.removeColumn`,ow=`${J}.undo`,sw=`${J}.redo`,Vc=`${J}.readOnly`,rw=`${J}.clearColumn`,lw=`${J}.copy`,aw=`${J}.copyWithHeaders`,hw=`${J}.copyWithGroupHeaders`,uw=`${J}.copyHeadersOnly`,cw=`${J}.cut`,dw=`${J}.freezeColumn`,fw=`${J}.unfreezeColumn`,gw=`${J}.mergeCells`,mw=`${J}.unmergeCells`,pw=`${J}.addComment`,ww=`${J}.editComment`,Cw=`${J}.removeComment`,bw=`${J}.readOnlyComment`,vw=`${J}.align`,Fc=`${J}.align.left`,Wc=`${J}.align.center`,Bc=`${J}.align.right`,jc=`${J}.align.justify`,Uc=`${J}.align.top`,zc=`${J}.align.middle`,Gc=`${J}.align.bottom`,Sw=`${J}.borders`,yw=`${J}.borders.top`,Rw=`${J}.borders.right`,Ew=`${J}.borders.bottom`,Tw=`${J}.borders.left`,Mw=`${J}.borders.remove`,Pw=`${J}.nestedHeaders.insertChildRow`,Iw=`${J}.nestedHeaders.detachFromParent`,Hw=`${J}.hideColumn`,xw=`${J}.showColumn`,Aw=`${J}.hideRow`,_w=`${J}.showRow`,Yt="Filters:",Ze=`${Yt}conditions`,Wd=`${Ze}.none`,Ow=`${Ze}.isEmpty`,Nw=`${Ze}.isNotEmpty`,Dw=`${Ze}.isEqualTo`,Lw=`${Ze}.isNotEqualTo`,kw=`${Ze}.beginsWith`,$w=`${Ze}.endsWith`,Vw=`${Ze}.contains`,Fw=`${Ze}.doesNotContain`,ix=`${Ze}.byValue`,Ww=`${Ze}.greaterThan`,Bw=`${Ze}.greaterThanOrEqualTo`,jw=`${Ze}.lessThan`,Uw=`${Ze}.lessThanOrEqualTo`,zw=`${Ze}.isBetween`,Gw=`${Ze}.isNotBetween`,Yw=`${Ze}.after`,Kw=`${Ze}.before`,Xw=`${Ze}.today`,qw=`${Ze}.tomorrow`,Qw=`${Ze}.yesterday`,Jw=`${Yt}labels.filterByCondition`,Zw=`${Yt}labels.filterByValue`,eC=`${Yt}labels.conjunction`,Bd=`${Yt}labels.disjunction`,Yc=`${Yt}values.blankCells`,tC=`${Yt}buttons.selectAll`,nC=`${Yt}buttons.clear`,iC=`${Yt}buttons.ok`,oC=`${Yt}buttons.cancel`,sC=`${Yt}buttons.placeholder.search`,rC=`${Yt}buttons.placeholder.value`,lC=`${Yt}buttons.placeholder.secondValue`,aC="CheckboxRenderer:",hC=`${aC}checked`,uC=`${aC}unchecked`,ox=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:hC,CHECKBOX_RENDERER_NAMESPACE:aC,CHECKBOX_UNCHECKED:uC,CONTEXTMENU_ITEMS_ADD_COMMENT:pw,CONTEXTMENU_ITEMS_ALIGNMENT:vw,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Gc,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:Wc,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:jc,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:Fc,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:zc,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:Bc,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:Uc,CONTEXTMENU_ITEMS_BORDERS:Sw,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:Ew,CONTEXTMENU_ITEMS_BORDERS_LEFT:Tw,CONTEXTMENU_ITEMS_BORDERS_RIGHT:Rw,CONTEXTMENU_ITEMS_BORDERS_TOP:yw,CONTEXTMENU_ITEMS_CLEAR_COLUMN:rw,CONTEXTMENU_ITEMS_COPY:lw,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:uw,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:hw,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:aw,CONTEXTMENU_ITEMS_CUT:cw,CONTEXTMENU_ITEMS_EDIT_COMMENT:ww,CONTEXTMENU_ITEMS_FREEZE_COLUMN:dw,CONTEXTMENU_ITEMS_HIDE_COLUMN:Hw,CONTEXTMENU_ITEMS_HIDE_ROW:Aw,CONTEXTMENU_ITEMS_INSERT_LEFT:ew,CONTEXTMENU_ITEMS_INSERT_RIGHT:tw,CONTEXTMENU_ITEMS_MERGE_CELLS:gw,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:Iw,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:Pw,CONTEXTMENU_ITEMS_NO_ITEMS:Qp,CONTEXTMENU_ITEMS_READ_ONLY:Vc,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:bw,CONTEXTMENU_ITEMS_REDO:sw,CONTEXTMENU_ITEMS_REMOVE_BORDERS:Mw,CONTEXTMENU_ITEMS_REMOVE_COLUMN:iw,CONTEXTMENU_ITEMS_REMOVE_COMMENT:Cw,CONTEXTMENU_ITEMS_REMOVE_ROW:nw,CONTEXTMENU_ITEMS_ROW_ABOVE:Jp,CONTEXTMENU_ITEMS_ROW_BELOW:Zp,CONTEXTMENU_ITEMS_SHOW_COLUMN:xw,CONTEXTMENU_ITEMS_SHOW_ROW:_w,CONTEXTMENU_ITEMS_UNDO:ow,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:fw,CONTEXTMENU_ITEMS_UNMERGE_CELLS:mw,CONTEXT_MENU_ITEMS_NAMESPACE:vR,FILTERS_BUTTONS_CANCEL:oC,FILTERS_BUTTONS_CLEAR:nC,FILTERS_BUTTONS_OK:iC,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:sC,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:lC,FILTERS_BUTTONS_PLACEHOLDER_VALUE:rC,FILTERS_BUTTONS_SELECT_ALL:tC,FILTERS_CONDITIONS_AFTER:Yw,FILTERS_CONDITIONS_BEFORE:Kw,FILTERS_CONDITIONS_BEGINS_WITH:kw,FILTERS_CONDITIONS_BETWEEN:zw,FILTERS_CONDITIONS_BY_VALUE:ix,FILTERS_CONDITIONS_CONTAINS:Vw,FILTERS_CONDITIONS_EMPTY:Ow,FILTERS_CONDITIONS_ENDS_WITH:$w,FILTERS_CONDITIONS_EQUAL:Dw,FILTERS_CONDITIONS_GREATER_THAN:Ww,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:Bw,FILTERS_CONDITIONS_LESS_THAN:jw,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:Uw,FILTERS_CONDITIONS_NAMESPACE:Ze,FILTERS_CONDITIONS_NONE:Wd,FILTERS_CONDITIONS_NOT_BETWEEN:Gw,FILTERS_CONDITIONS_NOT_CONTAIN:Fw,FILTERS_CONDITIONS_NOT_EMPTY:Nw,FILTERS_CONDITIONS_NOT_EQUAL:Lw,FILTERS_CONDITIONS_TODAY:Xw,FILTERS_CONDITIONS_TOMORROW:qw,FILTERS_CONDITIONS_YESTERDAY:Qw,FILTERS_DIVS_FILTER_BY_CONDITION:Jw,FILTERS_DIVS_FILTER_BY_VALUE:Zw,FILTERS_LABELS_CONJUNCTION:eC,FILTERS_LABELS_DISJUNCTION:Bd,FILTERS_NAMESPACE:Yt,FILTERS_VALUES_BLANK_CELLS:Yc},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const SR={languageCode:"en-US",[Qp]:"No available options",[Jp]:"Insert row above",[Zp]:"Insert row below",[ew]:"Insert column left",[tw]:"Insert column right",[nw]:["Remove row","Remove rows"],[iw]:["Remove column","Remove columns"],[ow]:"Undo",[sw]:"Redo",[Vc]:"Read only",[rw]:"Clear column",[vw]:"Alignment",[Fc]:"Left",[Wc]:"Center",[Bc]:"Right",[jc]:"Justify",[Uc]:"Top",[zc]:"Middle",[Gc]:"Bottom",[dw]:"Freeze column",[fw]:"Unfreeze column",[Sw]:"Borders",[yw]:"Top",[Rw]:"Right",[Ew]:"Bottom",[Tw]:"Left",[Mw]:"Remove border(s)",[pw]:"Add comment",[ww]:"Edit comment",[Cw]:"Delete comment",[bw]:"Read-only comment",[gw]:"Merge cells",[mw]:"Unmerge cells",[lw]:"Copy",[aw]:["Copy with header","Copy with headers"],[hw]:["Copy with group header","Copy with group headers"],[uw]:["Copy header only","Copy headers only"],[cw]:"Cut",[Pw]:"Insert child row",[Iw]:"Detach from parent",[Hw]:["Hide column","Hide columns"],[xw]:["Show column","Show columns"],[Aw]:["Hide row","Hide rows"],[_w]:["Show row","Show rows"],[Wd]:"None",[Ow]:"Is empty",[Nw]:"Is not empty",[Dw]:"Is equal to",[Lw]:"Is not equal to",[kw]:"Begins with",[$w]:"Ends with",[Vw]:"Contains",[Fw]:"Does not contain",[Ww]:"Greater than",[Bw]:"Greater than or equal to",[jw]:"Less than",[Uw]:"Less than or equal to",[zw]:"Is between",[Gw]:"Is not between",[Yw]:"After",[Kw]:"Before",[Xw]:"Today",[qw]:"Tomorrow",[Qw]:"Yesterday",[Yc]:"Blank cells",[Jw]:"Filter by condition",[Zw]:"Filter by value",[eC]:"And",[Bd]:"Or",[tC]:"Select all",[nC]:"Clear",[iC]:"OK",[oC]:"Cancel",[sC]:"Search",[rC]:"Value",[lC]:"Second value",[hC]:"Checked",[uC]:"Unchecked"},sx=ox,Rm=SR.languageCode,{register:rx,getItem:yR,hasItem:lx,getValues:ax}=ai("languagesDictionaries");RR(SR);function RR(n,e){let t=n,i=e;return ee(n)&&(i=n,t=i.languageCode),hx(t,i),rx(t,Dt(i)),Dt(i)}function hx(n,e){n!==Rm&&QH(e,yR(Rm))}function ER(n){return cC(n)?Dt(yR(n)):null}function cC(n){return lx(n)}function ux(){return ax()}function TR(n,e,t){const i=ER(n);if(i===null)return null;const o=i[e];if(Ne(o))return null;const s=cx(o,t);return Array.isArray(s)?s[0]:s}function cx(n,e){let t=n;return b(nx(),i=>{t=i(n,e)}),t}function dx(n){let e=CR(n);return cC(e)||(e=Rm,bR(n)),e}function fx(n,e,t){return(e=gx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gx(n){var e=mx(n,"string");return typeof e=="symbol"?e:e+""}function mx(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Ro extends nR{constructor(e,t){super(e,null),fx(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:i}=e,o=this.getNearestNotHiddenCoords(t,1),s=this.getNearestNotHiddenCoords(i,-1);return o===null||s===null?null:((o.row>s.row||o.col>s.col)&&(o=t,s=i),this.settings.createCellRange(o,o,s))}getNearestNotHiddenCoords(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const o=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(o===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,i);return s===null?null:this.settings.createCellCoords(o,s)}getNearestNotHiddenIndex(e,t,i){return t<0?t:e.getNearestNotHiddenIndex(t,i)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),i=e.getVerticalDirection()==="N-S"?1:-1,o=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let r=null;if((s===null||s.col===null||s.row===null)&&(r=this.getNearestNotHiddenCoords(t,i,o)),r!==null&&e.overlaps(r)){const l=e.highlight.clone();if(l.row>=0&&(l.row=r.row),l.col>=0&&(l.col=r.col),this.cellRange===null){const a=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(a)}e.setHighlight(l)}return this.settings.selectionType==="focus"&&s!==null&&r===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const i=this.settings.visualToRenderableCoords(e),o=this.settings.visualToRenderableCoords(t);return i.row===null||i.col===null||o.row===null||o.col===null?null:this.settings.createCellRange(i,i,o)}}function xf(n){let{activeHeaderClassName:e,...t}=n;return new Ro({className:e,...t,selectionType:iR})}function px(n){let{areaCornerVisible:e,...t}=n;return new Ro({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...t,selectionType:Op})}function wx(n){let{...e}=n;return new Ro({className:"highlight",...e,selectionType:Op})}function Cx(n){let{columnClassName:e,...t}=n;return new Ro({className:e,...t,selectionType:jI})}function bx(n){let{cellCornerVisible:e,...t}=n;return new Ro({className:"current",headerAttributes:[op()],border:{width:2,color:"#4b89ff",cornerVisible:e},...t,selectionType:Np})}function vx(n){let{border:e,visualCellRange:t,...i}=n;return new Ro({...e,...i,selectionType:UI},t)}function Sx(n){let{...e}=n;return new Ro({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:WI})}function $b(n){let{headerClassName:e,...t}=n;return new Ro({className:e,...t,selectionType:_p})}function yx(n){let{rowClassName:e,...t}=n;return new Ro({className:e,...t,selectionType:BI})}function Rx(n,e){Ex(n,e),e.add(n)}function Ex(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xt(n,e,t){return(e=Tx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Tx(n){var e=Mx(n,"string");return typeof e=="symbol"?e:e+""}function Mx(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Qi(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var pi=new WeakSet;class Px{constructor(e){Rx(this,pi),Xt(this,"options",void 0),Xt(this,"layerLevel",0),Xt(this,"focus",void 0),Xt(this,"fill",void 0),Xt(this,"layeredAreas",new Map),Xt(this,"areas",new Map),Xt(this,"rowHeaders",new Map),Xt(this,"columnHeaders",new Map),Xt(this,"activeRowHeaders",new Map),Xt(this,"activeColumnHeaders",new Map),Xt(this,"activeCornerHeaders",new Map),Xt(this,"rowHighlights",new Map),Xt(this,"columnHighlights",new Map),Xt(this,"customSelections",[]),this.options=e,this.focus=bx(e),this.fill=Sx(e)}isEnabledFor(e,t){let i=e;e===Np&&(i="current");let o=this.options.disabledCellSelection(t.row,t.col);return typeof o=="string"&&(o=[o]),o===!1||Array.isArray(o)&&!o.includes(i)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Qi(pi,this,Ji).call(this,this.layeredAreas,px)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Qi(pi,this,Ji).call(this,this.areas,wx)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Qi(pi,this,Ji).call(this,this.rowHeaders,$b)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Qi(pi,this,Ji).call(this,this.columnHeaders,$b)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Qi(pi,this,Ji).call(this,this.activeRowHeaders,xf)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Qi(pi,this,Ji).call(this,this.activeColumnHeaders,xf)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Qi(pi,this,Ji).call(this,this.activeCornerHeaders,xf)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Qi(pi,this,Ji).call(this,this.rowHighlights,yx)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Qi(pi,this,Ji).call(this,this.columnHighlights,Cx)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(vx({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),b(this.areas.values(),e=>void e.clear()),b(this.layeredAreas.values(),e=>void e.clear()),b(this.rowHeaders.values(),e=>void e.clear()),b(this.columnHeaders.values(),e=>void e.clear()),b(this.activeRowHeaders.values(),e=>void e.clear()),b(this.activeColumnHeaders.values(),e=>void e.clear()),b(this.activeCornerHeaders.values(),e=>void e.clear()),b(this.rowHighlights.values(),e=>void e.clear()),b(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Ji(n,e){const t=this.layerLevel;if(n.has(t))return n.get(t);const i=e({layerLevel:t,...this.options});return n.set(t,i),i}function Vb(n,e,t){return(e=Ix(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ix(n){var e=Hx(n,"string");return typeof e=="symbol"?e:e+""}function Hx(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class xx{constructor(e){Vb(this,"ranges",[]),Vb(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function Ax(n,e){MR(n,e),e.add(n)}function Af(n,e,t){MR(n,e),e.set(n,t)}function MR(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function de(n,e){return n.get(ut(n,e))}function hu(n,e,t){return n.set(ut(n,e),t),t}function ut(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var uu=new WeakMap,ke=new WeakMap,ii=new WeakMap,ft=new WeakSet;class Em{constructor(e,t){Ax(this,ft),Af(this,uu,void 0),Af(this,ke,void 0),Af(this,ii,{x:0,y:0}),hu(uu,this,e),hu(ke,this,t)}transformStart(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=de(ke,this).createCellCoords(e,t);let s=de(uu,this).current().highlight;const r=de(ke,this).visualToRenderableCoords(s);let l=0,a=0;if(this.runLocalHooks("beforeTransformStart",o),r.row!==null&&r.col!==null){const{width:h,height:u}=ut(ft,this,PR).call(this),{row:c,col:d}=ut(ft,this,Wb).call(this,s),g=de(ke,this).fixedRowsBottom(),p=de(ke,this).minSpareRows(),v=de(ke,this).minSpareCols(),C=de(ke,this).autoWrapRow(),S=de(ke,this).autoWrapCol(),R=de(ke,this).createCellCoords(c+o.row,d+o.col);if(R.row>=u){const H=Dn(i&&p>0&&g===0),O=R.col+1,k=de(ke,this).createCellCoords(R.row-u,O>=h?O-h:O);this.runLocalHooks("beforeColumnWrap",H,ut(ft,this,Ar).call(this,k),O>=h),H.value?this.runLocalHooks("insertRowRequire",de(ke,this).countRenderableRows()):S&&R.assign(k)}else if(R.row<0){const H=Dn(S),O=R.col-1,k=de(ke,this).createCellCoords(u+R.row,O<0?h+O:O);this.runLocalHooks("beforeColumnWrap",H,ut(ft,this,Ar).call(this,k),O<0),S&&R.assign(k)}if(R.col>=h){const H=Dn(i&&v>0),O=R.row+1,k=de(ke,this).createCellCoords(O>=u?O-u:O,R.col-h);this.runLocalHooks("beforeRowWrap",H,ut(ft,this,Ar).call(this,k),O>=u),H.value?this.runLocalHooks("insertColRequire",de(ke,this).countRenderableColumns()):C&&R.assign(k)}else if(R.col<0){const H=Dn(C),O=R.row-1,k=de(ke,this).createCellCoords(O<0?u+O:O,h+R.col);this.runLocalHooks("beforeRowWrap",H,ut(ft,this,Ar).call(this,k),O<0),C&&R.assign(k)}const{rowDir:M,colDir:I}=ut(ft,this,Fb).call(this,R);l=M,a=I,s=ut(ft,this,Ar).call(this,R)}return this.runLocalHooks("afterTransformStart",s,l,a),s}transformEnd(e,t){const i=de(ke,this).createCellCoords(e,t),o=de(uu,this).current(),s=de(ke,this).visualToRenderableCoords(o.highlight),r=ut(ft,this,_f).call(this,o.to.row,o.from.row),l=ut(ft,this,Of).call(this,o.to.col,o.from.col),a=o.to.clone();let h=0,u=0;if(this.runLocalHooks("beforeTransformEnd",i),s.row!==null&&s.col!==null&&r!==null&&l!==null){const{row:c,col:d}=ut(ft,this,Wb).call(this,o.highlight),g=de(ke,this).createCellCoords(r+i.row,l+i.col),p=o.getTopStartCorner(),v=o.getTopEndCorner(),C=o.getBottomEndCorner();if(i.col<0&&l>=d&&g.col<d){const I=g.col-d;g.col=ut(ft,this,Of).call(this,p.col,v.col)+I}else if(i.col>0&&l<=d&&g.col>d){const I=ut(ft,this,Of).call(this,v.col,p.col),H=Math.max(g.col-I,1);g.col=I+H}if(i.row<0&&r>=c&&g.row<c){const I=g.row-c;g.row=ut(ft,this,_f).call(this,p.row,C.row)+I}else if(i.row>0&&r<=c&&g.row>c){const I=ut(ft,this,_f).call(this,C.row,p.row),H=Math.max(g.row-I,1);g.row=I+H}const{rowDir:S,colDir:R}=ut(ft,this,Fb).call(this,g);h=S,u=R;const M=ut(ft,this,Ar).call(this,g);i.row===0&&i.col!==0?a.col=M.col:i.row!==0&&i.col===0?a.row=M.row:(a.row=M.row,a.col=M.col)}return this.runLocalHooks("afterTransformEnd",a,h,u),a}setOffsetSize(e){let{x:t,y:i}=e;hu(ii,this,{x:t,y:i})}resetOffsetSize(){hu(ii,this,{x:0,y:0})}}function Fb(n){const{width:e,height:t}=ut(ft,this,PR).call(this);let i=0,o=0;return n.row<0?(i=-1,n.row=0):n.row>0&&n.row>=t&&(i=1,n.row=t-1),n.col<0?(o=-1,n.col=0):n.col>0&&n.col>=e&&(o=1,n.col=e-1),{rowDir:i,colDir:o}}function PR(){return{width:de(ii,this).x+de(ke,this).countRenderableColumns(),height:de(ii,this).y+de(ke,this).countRenderableRows()}}function _f(n,e){const t=de(ke,this).findFirstNonHiddenRenderableRow(n,e);return t===null?null:de(ii,this).y+t}function Of(n,e){const t=de(ke,this).findFirstNonHiddenRenderableColumn(n,e);return t===null?null:de(ii,this).x+t}function Wb(n){const{row:e,col:t}=de(ke,this).visualToRenderableCoords(n);if(e===null||t===null)throw new Error("Renderable coords are not visible.");return de(ke,this).createCellCoords(de(ii,this).y+e,de(ii,this).x+t)}function Ar(n){const e=n.clone();return e.col=n.col-de(ii,this).x,e.row=n.row-de(ii,this).y,de(ke,this).renderableToVisualCoords(e)}Ee(Em,Et);const jd=0,Ud=1,IR=2,dC=3,_x=[dC,IR],Ox=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Nf=Symbol("root"),Bb=Symbol("child");function bl(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Nf;if(e!==Nf&&e!==Bb)throw new Error("The second argument is used internally only and cannot be overwritten.");const t=Array.isArray(n),i=e===Nf;let o=jd;if(t){const s=n[0];n.length===0?o=Ud:i&&s instanceof Th?o=dC:i&&Array.isArray(s)?o=bl(s,Bb):n.length>=2&&n.length<=4&&!n.some((l,a)=>!Ox[a].includes(typeof l))&&(o=IR)}return o}function uh(n){let{createCellCoords:e,createCellRange:t,keepDirection:i=!1,propToCol:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!_x.includes(n))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const r=n===dC;let l=r?s.from.row:s[0],a=r?s.from.col:s[1],h=r?s.to.row:s[2],u=r?s.to.col:s[3];if(typeof o=="function"&&(typeof a=="string"&&(a=o(a)),typeof u=="string"&&(u=o(u))),Ne(h)&&(h=l),Ne(u)&&(u=a),!i){const g=l,p=a,v=h,C=u;l=Math.min(g,v),a=Math.min(p,C),h=Math.max(g,v),u=Math.max(p,C)}const c=e(l,a),d=e(h,u);return t(c,c,d)}}function Nx(n){const e=bl(n.getSelected());if(e===jd||e===Ud)return[];const t=uh(e,{createCellCoords:n._createCellCoords.bind(n),createCellRange:n._createCellRange.bind(n)}),i=new Set;b(n.getSelected(),r=>{const{from:l,to:a}=t(r),h=Math.max(l.col,0),u=a.col-h+1;b(Array.from(new Array(u),(c,d)=>h+d),c=>{i.has(c)||i.add(c)})});const o=Array.from(i).sort((r,l)=>r-l);return at(o,(r,l,a,h)=>(a!==0&&l===h[a-1]+1?r[r.length-1][1]+=1:r.push([l,1]),r),[])}function Dx(n){const e=bl(n.getSelected());if(e===jd||e===Ud)return[];const t=uh(e,{createCellCoords:n._createCellCoords.bind(n),createCellRange:n._createCellRange.bind(n)}),i=new Set;b(n.getSelected(),r=>{const{from:l,to:a}=t(r),h=Math.max(l.row,0),u=a.row-h+1;b(Array.from(new Array(u),(c,d)=>h+d),c=>{i.has(c)||i.add(c)})});const o=Array.from(i).sort((r,l)=>r-l);return at(o,(r,l,a,h)=>(a!==0&&l===h[a-1]+1?r[r.length-1][1]+=1:r.push([l,1]),r),[])}function _r(n,e,t){Lx(n,e),e.set(n,t)}function Lx(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vs(n,e,t){return(e=kx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kx(n){var e=$x(n,"string");return typeof e=="symbol"?e:e+""}function $x(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function $e(n,e){return n.get(HR(n,e))}function wi(n,e,t){return n.set(HR(n,e),t),t}function HR(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var It=new WeakMap,Ss=new WeakMap,cu=new WeakMap,Xl=new WeakMap,du=new WeakMap,ql=new WeakMap;class xR{constructor(e,t){var i=this;vs(this,"settings",void 0),vs(this,"tableProps",void 0),vs(this,"inProgress",!1),vs(this,"selectedRange",new xx((o,s,r)=>this.tableProps.createCellRange(o,s,r))),vs(this,"highlight",void 0),_r(this,It,void 0),_r(this,Ss,void 0),vs(this,"selectedByRowHeader",new Set),vs(this,"selectedByColumnHeader",new Set),_r(this,cu,!1),_r(this,Xl,!1),_r(this,du,"unknown"),_r(this,ql,-1),this.settings=e,this.tableProps=t,this.highlight=new Px({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[op()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(o,s)=>this.tableProps.isDisabledCellSelection(o,s),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:o=>this.tableProps.visualToRenderableCoords(o),renderableToVisualCoords:o=>this.tableProps.renderableToVisualCoords(o),createCellCoords:(o,s)=>this.tableProps.createCellCoords(o,s),createCellRange:(o,s,r)=>this.tableProps.createCellRange(o,s,r)}),wi(It,this,new Em(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:o=>this.tableProps.visualToRenderableCoords(o),renderableToVisualCoords:o=>this.tableProps.renderableToVisualCoords(o),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(o,s)=>this.tableProps.createCellCoords(o,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),wi(Ss,this,new Em(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const o=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,o.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const o=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,o.getOuterBottomEndCorner().col)},visualToRenderableCoords:o=>this.tableProps.visualToRenderableCoords(o),renderableToVisualCoords:o=>this.tableProps.renderableToVisualCoords(o),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(o,s)=>this.tableProps.createCellCoords(o,s),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),$e(It,this).addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return i.runLocalHooks("beforeModifyTransformStart",...s)}),$e(It,this).addLocalHook("afterTransformStart",function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return i.runLocalHooks("afterModifyTransformStart",...s)}),$e(It,this).addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return i.runLocalHooks("beforeModifyTransformEnd",...s)}),$e(It,this).addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return i.runLocalHooks("afterModifyTransformEnd",...s)}),$e(It,this).addLocalHook("insertRowRequire",function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return i.runLocalHooks("insertRowRequire",...s)}),$e(It,this).addLocalHook("insertColRequire",function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return i.runLocalHooks("insertColRequire",...s)}),$e(It,this).addLocalHook("beforeRowWrap",function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return i.runLocalHooks("beforeRowWrap",...s)}),$e(It,this).addLocalHook("beforeColumnWrap",function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return i.runLocalHooks("beforeColumnWrap",...s)}),$e(Ss,this).addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return i.runLocalHooks("beforeModifyTransformFocus",...s)}),$e(Ss,this).addLocalHook("afterTransformStart",function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return i.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}markSource(e){wi(du,this,e)}markEndSource(){wi(du,this,"unknown")}getSelectionSource(){return $e(du,this)}setExpectedLayers(e){wi(ql,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,wi(ql,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",r=Ne(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,l=e.clone();wi(cu,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,l),(!s||s&&!r&&Ne(t))&&this.selectedRange.clear(),this.selectedRange.add(l).current().setHighlight(o.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(e)}setRangeStartOnly(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,t,!0,i)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((i>0||o>0)&&(i===0&&t.col<0&&!s||o===0&&t.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const r=this.selectedRange.current();if(this.settings.navigableHeaders||r.highlight.normalize(),this.settings.selectionMode==="single")r.setFrom(r.highlight),r.setTo(r.highlight);else{const a=r.getHorizontalDirection(),h=r.getVerticalDirection(),u=this.isMultiple();r.setTo(t),u&&(a!==r.getHorizontalDirection()||r.getWidth()===1&&!r.includes(r.highlight))&&r.from.assign({col:r.highlight.col}),u&&(h!==r.getVerticalDirection()||r.getHeight()===1&&!r.includes(r.highlight))&&r.from.assign({row:r.highlight.row})}i>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!r.isSingleHeader())&&r.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const l=$e(ql,this)===-1||this.selectedRange.size()===$e(ql,this);this.runLocalHooks("afterSetRangeEnd",e,l)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const i=this.tableProps.countRows(),o=this.tableProps.countCols();t<this.highlight.layerLevel&&(b(this.highlight.getAreas(),p=>void p.clear()),b(this.highlight.getLayeredAreas(),p=>void p.clear()),b(this.highlight.getRowHeaders(),p=>void p.clear()),b(this.highlight.getColumnHeaders(),p=>void p.clear()),b(this.highlight.getActiveRowHeaders(),p=>void p.clear()),b(this.highlight.getActiveColumnHeaders(),p=>void p.clear()),b(this.highlight.getActiveCornerHeaders(),p=>void p.clear()),b(this.highlight.getRowHighlights(),p=>void p.clear()),b(this.highlight.getColumnHighlights(),p=>void p.clear())),this.highlight.useLayerLevel(t);const s=this.highlight.createArea(),r=this.highlight.createLayeredArea(),l=this.highlight.createRowHeader(),a=this.highlight.createColumnHeader(),h=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),c=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(s.clear(),r.clear(),l.clear(),a.clear(),h.clear(),u.clear(),c.clear(),d.clear(),g.clear(),this.highlight.isEnabledFor(Op,e.highlight)&&(this.isMultiple()||t>=1)&&(s.add(e.from).add(e.to).commit(),r.add(e.from).add(e.to).commit(),t===1)){const p=this.selectedRange.previous();this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(p.from).commit().syncWith(p),this.highlight.createLayeredArea().add(p.from).commit().syncWith(p),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(_p,e.highlight)){if(!e.isSingleHeader()){const C=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),S=this.tableProps.createCellCoords(e.to.row,-1),R=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),M=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(l.add(C).commit(),a.add(R).commit(),d.add(C).commit(),g.add(R).commit()):(l.add(C).add(S).commit(),a.add(R).add(M).commit(),d.add(C).add(S).commit(),g.add(R).add(M).commit())}const p=!$e(Xl,this)&&this.isEntireRowSelected()&&(o>0&&o===e.getWidth()||o===0&&this.isSelectedByRowHeader()),v=!$e(Xl,this)&&this.isEntireColumnSelected()&&(i>0&&i===e.getHeight()||i===0&&this.isSelectedByColumnHeader());p&&h.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&u.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),p&&v&&c.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const t=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Np,t.highlight)&&i.add(t.highlight).commit().syncWith(t),this.inProgress||(wi(cu,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?$e(It,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):$e(It,this).resetOffsetSize(),this.setRangeStart($e(It,this).transformStart(e,t,i))}transformEnd(e,t){this.settings.navigableHeaders?$e(It,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):$e(It,this).resetOffsetSize(),this.setRangeEnd($e(It,this).transformEnd(e,t))}transformFocus(e,t){const i=this.selectedRange.current(),{row:o,col:s}=i.getOuterTopStartCorner(),r=this.tableProps.countRenderableColumnsInRange(0,s-1),l=this.tableProps.countRenderableRowsInRange(0,o-1);i.highlight.isHeader()?$e(Ss,this).setOffsetSize({x:s<0?Math.abs(s):-r,y:o<0?Math.abs(o):-l}):$e(Ss,this).setOffsetSize({x:s<0?0:-r,y:o<0?0:-l});const a=$e(Ss,this).transformStart(e,t);this.setRangeFocus(a.normalize())}shiftRows(e,t){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=e){const{from:o,to:s,highlight:r}=i,l=this.tableProps.countRows(),a=this.isSelectedByRowHeader(),h=this.isSelectedByColumnHeader(),u=h?-1:0,c=h?0:t;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Se(o.row+c,u,l-1),o.col),g=this.tableProps.createCellCoords(Se(s.row+t,u,l-1),s.col);this.markSource("shift"),r.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Se(r.row+t,0,l-1),r.col)):this.setRangeStartOnly(d,!0),a&&this.selectedByRowHeader.add(this.getLayerLevel()),h&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=e){const{from:o,to:s,highlight:r}=i,l=this.tableProps.countCols(),a=this.isSelectedByRowHeader(),h=this.isSelectedByColumnHeader(),u=a?-1:0,c=a?0:t;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(o.row,Se(o.col+c,u,l-1)),g=this.tableProps.createCellCoords(s.row,Se(s.col+t,u,l-1));this.markSource("shift"),r.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(r.row,Se(r.col+t,0,l-1))):this.setRangeStartOnly(d,!0),a&&this.selectedByRowHeader.add(this.getLayerLevel()),h&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Dn(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&$e(cu,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=o=>{const{col:s}=o.getOuterTopStartCorner(),r=this.tableProps.countRowHeaders(),l=this.tableProps.countCols();return(r>0&&s<0||r===0)&&o.getWidth()===l};if(e===-1)return Array.from(this.selectedRange).some(o=>t(o));const i=this.selectedRange.peekByIndex(e);return i?t(i):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=o=>{const{row:s}=o.getOuterTopStartCorner(),r=this.tableProps.countColHeaders(),l=this.tableProps.countRows();return(r>0&&s<0||r===0)&&o.getHeight()===l};if(e===-1)return Array.from(this.selectedRange).some(o=>t(o));const i=this.selectedRange.peekByIndex(e);return i?t(i):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return t.row!==null&&t.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),r=this.tableProps.countCols(),l=this.tableProps.countRowHeaders(),a=this.tableProps.countColHeaders(),h=i?-a:0,u=t?-l:0;if(h===0&&u===0&&(s===0||r===0))return;let c=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:g}=o;wi(Xl,this,g),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(c=this.tableProps.createCellCoords(Se(d.row,h,s-1),Se(d.col,u,r-1)));const p=this.tableProps.createCellCoords(h,u),v=this.tableProps.createCellCoords(s-1,r-1);this.clear(),this.setRangeStartOnly(p,void 0,c),u<0&&this.selectedByRowHeader.add(this.getLayerLevel()),h<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.finish(),wi(Xl,this,!1)}selectCells(e){var t=this;const i=bl(e);if(i===Ud)return!1;if(i===jd)throw new Error(Re`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const o=uh(i,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:a=>this.tableProps.propToCol(a),keepDirection:!0}),s=this.settings.navigableHeaders,r={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},l=!e.some(a=>{const h=o(a),u=h.isValid(r);return!(u&&!h.containsHeaders()||u&&h.containsHeaders()&&h.isSingleHeader())});return l&&(this.clear(),this.setExpectedLayers(e.length),b(e,a=>{const{from:h,to:u}=o(a);this.setRangeStartOnly(h.clone(),!1),this.setRangeEnd(u.clone())}),this.finish()),l}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const o=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof t=="string"?this.tableProps.propToCol(t):t,r=this.tableProps.countRows(),l=this.tableProps.countCols(),a=this.tableProps.countColHeaders(),h=a===0?0:-a,u=this.tableProps.createCellCoords(h,o),c=this.tableProps.createCellCoords(r-1,s),d=this.tableProps.createCellRange(u,u,c).isValid({countRows:r,countCols:l,countRowHeaders:0,countColHeaders:a});if(d){let g=0,p=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(g=Se(i.row,h,r-1),p=Se(i.col,Math.min(o,s),Math.max(o,s))):(g=Se(i,h,r-1),p=o);const v=this.tableProps.createCellCoords(g,p),C=a===0?0:Se(v.row,h,-1),S=r-1,R=this.tableProps.createCellCoords(C,o),M=this.tableProps.createCellCoords(S,s);this.runLocalHooks("beforeSelectColumns",R,M,v),R.row=C,M.row=S,this.setRangeStartOnly(R,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(M),this.runLocalHooks("afterSelectColumns",R,M,v),this.finish()}return d}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const o=this.tableProps.countRows(),s=this.tableProps.countCols(),r=this.tableProps.countRowHeaders(),l=r===0?0:-r,a=this.tableProps.createCellCoords(e,l),h=this.tableProps.createCellCoords(t,s-1),u=this.tableProps.createCellRange(a,a,h).isValid({countRows:o,countCols:s,countRowHeaders:r,countColHeaders:0});if(u){let c=0,d=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(c=Se(i.row,Math.min(e,t),Math.max(e,t)),d=Se(i.col,l,s-1)):(c=e,d=Se(i,l,s-1));const g=this.tableProps.createCellCoords(c,d),p=r===0?0:Se(g.col,l,-1),v=s-1,C=this.tableProps.createCellCoords(e,p),S=this.tableProps.createCellCoords(t,v);this.runLocalHooks("beforeSelectRows",C,S,g),C.col=p,S.col=v,this.setRangeStartOnly(C,void 0,g),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(S),this.runLocalHooks("afterSelectRows",C,S,g),this.finish()}return u}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),t=this.tableProps.countCols();if(e===0||t===0){this.deselect();return}const i=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:o,to:s,highlight:r}=i;this.clear(),r.assign({row:Se(r.row,-1/0,e-1),col:Se(r.col,-1/0,t-1)}),o.assign({row:Se(o.row,-1/0,e-1),col:Se(o.col,-1/0,t-1)}),s.assign({row:Se(s.row,0,e-1),col:Se(s.col,0,t-1)}),this.selectedRange.ranges.push(i),this.highlight.getFocus().add(r).commit().syncWith(i),this.applyAndCommit(i)}commit(){if(this.highlight.getCustomSelections().forEach(o=>{o.commit()}),!this.isSelected())return;const t=this.highlight.getFocus(),i=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let o=0;o<this.selectedRange.size();o+=1){this.highlight.useLayerLevel(o);const s=this.highlight.createArea(),r=this.highlight.createLayeredArea(),l=this.highlight.createRowHeader(),a=this.highlight.createColumnHeader(),h=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),c=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();s.commit(),r.commit(),l.commit(),a.commit(),h.commit(),u.commit(),c.commit(),d.commit(),g.commit()}this.highlight.useLayerLevel(i)}}Ee(xR,Et);const jb=/^(\r\n|\n\r|\r|\n)/,Vx=/^[^\t\r\n]+/,Ub=/^\t/;function Fx(n){const e=[[""]];if(n.length===0)return e;let t=0,i=0,o;for(;n.length>0&&o!==n.length;)if(o=n.length,n.match(Ub))n=n.replace(Ub,""),t+=1,e[i][t]="";else if(n.match(jb))n=n.replace(jb,""),t=0,i+=1,e[i]=[""];else{let s="";if(n.startsWith('"')){let r=0,l=!0;for(;l;){const a=n.slice(0,1);a==='"'&&(r+=1),s+=a,n=n.slice(1),(n.length===0||n.match(/^[\t\r\n]/)&&r%2===0)&&(l=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,a=>new Array(Math.floor(a.length/2)).fill('"').join(""))}else{const r=n.match(Vx);s=r?r[0]:"",n=n.slice(s.length)}e[i][t]=s}return e}function Fa(n){let e,t,i,o,s="",r;for(e=0,t=n.length;e<t;e+=1){for(o=n[e].length,i=0;i<o;i+=1)i>0&&(s+="	"),r=n[e][i],typeof r=="string"?r.indexOf(`
`)>-1?s+=`"${r.replace(/"/g,'""')}"`:s+=r:r==null?s+="":s+=r;e!==t-1&&(s+=`
`)}return s}function ys(n,e,t){return(e=Wx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Wx(n){var e=Bx(n,"string");return typeof e=="symbol"?e:e+""}function Bx(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class al{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,i){ys(this,"hot",void 0),ys(this,"metaManager",void 0),ys(this,"tableMeta",void 0),ys(this,"dataSource",void 0),ys(this,"duckSchema",void 0),ys(this,"colToPropCache",void 0),ys(this,"propToColCache",void 0),this.hot=e,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let i;if(this.colToPropCache=[],this.propToColCache=new Map,t){let o=0,s=0,r=!1;if(typeof t=="function"){const l=Ad(e);o=l>0?l:this.countFirstRowKeys(),r=!0}else{const l=this.tableMeta.maxCols;o=Math.min(l,t.length)}for(i=0;i<o;i++){const l=r?t(i):t[i];if(ee(l)){if(typeof l.data<"u"){const a=r?s:i;this.colToPropCache[a]=l.data,this.propToColCache.set(l.data,a)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return Up(this.dataSource)}recursiveDuckColumns(e,t,i){let o=t,s=i,r;return typeof o>"u"&&(o=0,s=""),typeof e=="object"&&!Array.isArray(e)&&te(e,(l,a)=>{l===null?(r=s+a,this.colToPropCache.push(r),this.propToColCache.set(r,o),o+=1):o=this.recursiveDuckColumns(l,o,`${a}.`)}),o}colToProp(e){if(Number.isInteger(e)===!1)return e;const t=this.hot.toPhysicalColumn(e);return t===null?e:this.colToPropCache&&F(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(F(t))return this.hot.toVisualColumn(t);const i=this.hot.toVisualColumn(e);return i===null?e:i}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Cl(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:o="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let r=s,l=0,a=e;if((typeof a!="number"||a>=s)&&(a=s),a<this.hot.countRows()&&(r=this.hot.toPhysicalRow(a)),this.hot.runHooks("beforeCreateRow",a,t,i)===!1||r===null)return{delta:0};const u=this.tableMeta.maxRows,c=this.getSchema().length,d=[];for(;l<t&&s+l<u;){let p=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?p=Dt(this.getSchema()):(p=[],j(c-1,()=>p.push(null))):this.hot.dataType==="function"?p=this.tableMeta.dataSchema(a+l):(p={},Rh(p,this.getSchema())),d.push(p),l+=1}this.hot.rowIndexMapper.insertIndexes(a,l),o==="below"&&(r=Math.min(r+1,s)),this.spliceData(r,0,d);const g=this.hot.toVisualRow(r);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),l>0&&(e==null?this.metaManager.createRow(null,l):i!=="auto"&&this.metaManager.createRow(r,t)),this.hot.runHooks("afterCreateRow",g,l,i),this.hot.forceFullRender=!0,{delta:l,startPhysicalIndex:r}}createCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:o="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,r=this.tableMeta.maxCols,l=this.hot.countSourceCols();let a=e;if((typeof a!="number"||a>=l)&&(a=l),this.hot.runHooks("beforeCreateCol",a,t,i)===!1)return{delta:0};let u=l;a<this.hot.countCols()&&(u=this.hot.toPhysicalColumn(a));const c=this.hot.countSourceRows();let d=this.hot.countCols(),g=0,p=u;o==="end"&&(p=Math.min(p+1,l));const v=p;for(;g<t&&d<r;){if(typeof a!="number"||a>=d)if(c>0)for(let S=0;S<c;S+=1)typeof s[S]>"u"&&(s[S]=[]),s[S].push(null);else s.push([null]);else for(let S=0;S<c;S++)s[S].splice(p,0,null);g+=1,p+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(a,g),g>0&&(e==null?this.metaManager.createColumn(null,g):i!=="auto"&&this.metaManager.createColumn(v,t));const C=this.hot.toVisualColumn(v);return this.hot.runHooks("afterCreateCol",C,g,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:g,startPhysicalIndex:v}}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(e)?e:-t;const s=this.visualRowsToPhysical(o,t),r=this.hot.countSourceRows();if(o=(r+o)%r,this.hot.runHooks("beforeRemoveRow",o,s.length,s,i)===!1)return!1;const a=s.length;if(this.filterData(o,a,s),o<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const u=F(this.tableMeta.columns)||F(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&u===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((u,c)=>c-u).forEach(u=>{this.metaManager.removeRow(u,1)}),this.hot.runHooks("afterRemoveRow",o,a,s,i),this.hot.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let o=typeof e!="number"?-t:e;o=(this.hot.countCols()+o)%this.hot.countCols();const s=this.visualColumnsToPhysical(o,t),r=s.slice(0).sort((c,d)=>d-c);if(this.hot.runHooks("beforeRemoveCol",o,t,s,i)===!1)return!1;let a=!0;const h=r.length,u=this.dataSource;for(let c=0;c<h;c++)a&&s[0]!==s[c]-c&&(a=!1);if(a)for(let c=0,d=this.hot.countSourceRows();c<d;c++)u[c].splice(s[0],t),c===0&&this.metaManager.removeColumn(s[0],t);else for(let c=0,d=this.hot.countSourceRows();c<d;c++)for(let g=0;g<h;g++)u[c].splice(r[g],1),c===0&&this.metaManager.removeColumn(r[g],1);return o<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",o,t,s,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,i){const o=this.hot.getDataAtCol(e),s=o.slice(t,t+i),r=o.slice(t+i);for(var l=arguments.length,a=new Array(l>3?l-3:0),h=3;h<l;h++)a[h-3]=arguments[h];sm(a,r);let u=0;for(;u<i;)a.push(null),u+=1;return KS(a),this.hot.populateFromArray(t,e,a,null,null,"spliceCol"),s}spliceRow(e,t,i){const o=this.hot.getSourceDataAtRow(e),s=o.slice(t,t+i),r=o.slice(t+i);for(var l=arguments.length,a=new Array(l>3?l-3:0),h=3;h<l;h++)a[h-3]=arguments[h];sm(a,r);let u=0;for(;u<i;)a.push(null),u+=1;return this.hot.populateFromArray(e,t,[a],null,null,"spliceRow"),s}spliceData(e,t,i){if(this.hot.runHooks("beforeDataSplice",e,t,i)!==!1){const s=[...this.dataSource.slice(0,e),...i,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(r=>this.dataSource.push(r))}}filterData(e,t,i){let o=this.hot.runHooks("filterData",e,t,i);Array.isArray(o)===!1&&(o=this.dataSource.filter((s,r)=>i.indexOf(r)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}get(e,t){const i=this.hot.toPhysicalRow(e);let o=this.dataSource[i];const s=this.hot.runHooks("modifyRowData",i);o=isNaN(s)?s:o;const{dataDotNotation:r}=this.hot.getSettings();let l=null;if(o&&o.hasOwnProperty&&je(o,t))l=o[t];else if(r&&typeof t=="string"&&t.indexOf(".")>-1){let a=o;if(!a)return null;const h=t.split(".");for(let u=0,c=h.length;u<c;u++)if(a=a[h[u]],typeof a>"u")return null;l=a}else typeof t=="function"&&(l=t(this.dataSource.slice(i,i+1)[0]));if(this.hot.hasHook("modifyData")){const a=Dn(l);this.hot.runHooks("modifyData",i,this.propToCol(t),a,"get"),a.isTouched()&&(l=a.value)}return l}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,i){const o=this.hot.toPhysicalRow(e);let s=i,r=this.dataSource[o];const l=this.hot.runHooks("modifyRowData",o);if(r=isNaN(l)?l:r,this.hot.hasHook("modifyData")){const h=Dn(s);this.hot.runHooks("modifyData",o,this.propToCol(t),h,"set"),h.isTouched()&&(s=h.value)}const{dataDotNotation:a}=this.hot.getSettings();if(r&&r.hasOwnProperty&&je(r,t))r[t]=s;else if(a&&typeof t=="string"&&t.indexOf(".")>-1){let h=r,u=0,c;const d=t.split(".");for(u=0,c=d.length-1;u<c;u++)typeof h[d[u]]>"u"&&(h[d[u]]={}),h=h[d[u]];h[d[u]]=s}else typeof t=="function"?t(this.dataSource.slice(o,o+1)[0],s):r[t]=s}visualRowsToPhysical(e,t){const i=this.hot.countSourceRows(),o=[];let s=(i+e)%i,r=t,l;for(;s<i&&r;)l=this.hot.toPhysicalRow(s),o.push(l),r-=1,s+=1;return o}visualColumnsToPhysical(e,t){const i=this.hot.countCols(),o=[];let s=(i+e)%i,r=t;for(;s<i&&r;){const l=this.hot.toPhysicalColumn(s);o.push(l),r-=1,s+=1}return o}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;e<0||e===0?t=0:t=e||1/0;const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,t,al.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,i){const o=[];let s,r,l;const a=this.tableMeta.maxRows,h=this.tableMeta.maxCols;if(a===0||h===0)return[];const u=i===al.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,c=Math.min(Math.max(a-1,0),Math.max(e.row,t.row)),d=Math.min(Math.max(h-1,0),Math.max(e.col,t.col));for(s=Math.min(e.row,t.row);s<=c;s++){l=[];const g=s>=0?this.hot.toPhysicalRow(s):s;for(r=Math.min(e.col,t.col);r<=d&&g!==null;r++)l.push(u.call(this,s,this.colToProp(r)));g!==null&&o.push(l)}return o}getText(e,t){return Fa(this.getRange(e,t,al.DESTINATION_RENDERER))}getCopyableText(e,t){return Fa(this.getRange(e,t,al.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:jx,getItem:Ux,hasItem:AR,getNames:zx,getValues:AG}=ai("cellTypes");function fC(n){if(!AR(n))throw Error(`You declared cell type "${n}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Ux(n)}function Mn(n,e){typeof n!="string"&&(e=n,n=e.CELL_TYPE);const{editor:t,renderer:i,validator:o}=e;t&&tn(n,t),i&&cn(n,i),o&&Qs(n,o),jx(n,e)}function Gx(n,e){var t;return n==="CELL_TYPE"?!1:((t=e._automaticallyAssignedMetaProps)===null||t===void 0?void 0:t.has(n))||!je(e,n)}function zd(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=typeof e.type=="string"?fC(e.type):e.type;if(n._automaticallyAssignedMetaProps&&te(e,(s,r)=>void n._automaticallyAssignedMetaProps.delete(r)),!ee(i))return;t===n&&!n._automaticallyAssignedMetaProps&&(n._automaticallyAssignedMetaProps=new Set);const o={};te(i,(s,r)=>{if(Gx(r,t)){var l;o[r]=s,(l=n._automaticallyAssignedMetaProps)===null||l===void 0||l.add(r)}}),lt(n,o)}function Yx(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function t(){}li(t,n);for(let i=0;i<e.length;i++)t.prototype[e[i]]=void 0;return t}function bc(n){return Number.isInteger(n)&&n>=0}function vc(n,e){if(!n())throw new Error(`Assertion failed: ${e}`)}function fu(n){return n==null}const _R=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(n){let e,t,i;for(e=0,t=this.countRows();e<t;e++)if(i=this.getDataAtCell(e,n),Je(i)===!1)return!1;return!0},isEmptyRow(n){let e,t,i,o;for(e=0,t=this.countCols();e<t;e++)if(i=this.getDataAtCell(n,e),Je(i)===!1)return typeof i=="object"?(o=this.getCellMeta(n,e),xd(this.getSchema()[o.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function zb(n,e,t){return(e=Kx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Kx(n){var e=Xx(n,"string");return typeof e=="symbol"?e:e+""}function Xx(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function qx(){return class{}}class Qx{constructor(e){zb(this,"metaCtor",qx()),zb(this,"meta",void 0),this.meta=this.metaCtor.prototype,lt(this.meta,_R()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;lt(this.meta,e),zd(this.meta,{...e,type:(t=e.type)!==null&&t!==void 0?t:this.meta.type},e)}}function Jx(n,e,t){return(e=Zx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Zx(n){var e=eA(n,"string");return typeof e=="symbol"?e:e+""}function eA(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class tA{constructor(e){Jx(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){lt(this.meta,e),zd(this.meta,e,e)}}function gu(n,e,t){return(e=nA(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function nA(n){var e=iA(n,"string");return typeof e=="symbol"?e:e+""}function iA(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Kc{constructor(e){gu(this,"valueFactory",void 0),gu(this,"data",[]),gu(this,"index",[]),gu(this,"holes",new Set),this.valueFactory=e}obtain(e){vc(()=>bc(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let i;if(t>=0)i=this.data[t],i===void 0&&(i=this.valueFactory(e),this.data[t]=i);else if(i=this.valueFactory(e),this.holes.size>0){const o=this.holes.values().next().value;this.holes.delete(o),this.data[o]=i,this.index[e]=o}else this.data.push(i),this.index[e]=this.data.length-1;return i}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;vc(()=>bc(e)||fu(e),"Expecting an unsigned number or null/undefined argument.");const i=[],o=this.data.length;for(let r=0;r<t;r++)i.push(o+r),this.data.push(void 0);const s=fu(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...i,...this.index.slice(s)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;vc(()=>bc(e)||fu(e),"Expecting an unsigned number or null/undefined argument.");const i=this.index.splice(fu(e)?this.index.length-t:e,t);for(let o=0;o<i.length;o++){const s=i[o];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return bo(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let i=0;i<this.data.length;i++){const o=this._getKeyByStorageIndex(i);o!==-1&&e.push([o,this.data[i]])}let t=0;return{next:()=>{if(t<e.length){const i=e[t];return t+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function Gb(n,e,t){return(e=oA(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function oA(n){var e=sA(n,"string");return typeof e=="symbol"?e:e+""}function sA(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const rA=["data","width"];class lA{constructor(e){Gb(this,"globalMeta",void 0),Gb(this,"metas",new Kc(()=>this._createMeta())),this.globalMeta=e,this.metas=new Kc(()=>this._createMeta())}updateMeta(e,t){const i=this.getMeta(e);lt(i,t),zd(i,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return Yx(this.globalMeta.getMetaConstructor(),rA).prototype}}function Yb(n,e,t){return(e=aA(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function aA(n){var e=hA(n,"string");return typeof e=="symbol"?e:e+""}function hA(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class uA{constructor(e){Yb(this,"columnMeta",void 0),Yb(this,"metas",new Kc(()=>this._createRow())),this.columnMeta=e}updateMeta(e,t,i){const o=this.getMeta(e,t);lt(o,i),zd(o,i)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,t)}getMeta(e,t,i){const o=this.metas.obtain(e).obtain(t);return i===void 0?o:o[i]}setMeta(e,t,i,o){var s;const r=this.metas.obtain(e).obtain(t);(s=r._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(i),r[i]=o}removeMeta(e,t,i){const o=this.metas.obtain(e).obtain(t);delete o[i]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let i=0;i<t.length;i++)F(t[i])&&e.push(...t[i].values());return e}getMetasAtRow(e){vc(()=>bc(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Kc(e=>this._createMeta(e))}_createMeta(e){const t=this.columnMeta.getMetaConstructor(e);return new t}}class OR{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new Qx(e),this.tableMeta=new tA(this.globalMeta),this.columnMeta=new lA(this.globalMeta),this.cellMeta=new uA(this.columnMeta),i.forEach(o=>new o(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,i){let{visualRow:o,visualColumn:s}=i;const r=this.cellMeta.getMeta(e,t);return r.visualRow=o,r.visualCol=s,r.row=e,r.col=t,this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(e,t,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,i)}setCellMeta(e,t,i,o){this.cellMeta.setMeta(e,t,i,o)}updateCellMeta(e,t,i){this.cellMeta.updateMeta(e,t,i)}removeCellMeta(e,t,i){this.cellMeta.removeMeta(e,t,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Ee(OR,Et);function Kb(n,e,t,i){const{hotInstance:o,dataMap:s,dataSource:r,internalSource:l,source:a,metaManager:h,firstRun:u}=i,c=Nt(l),d=o.getSettings();Array.isArray(d.dataSchema)?o.dataType="array":_e(d.dataSchema)?o.dataType="function":o.dataType="object",s&&s.destroy(),n=o.runHooks(`before${c}`,n,u,a);const g=new al(o,n,h);if(e(g),typeof n=="object"&&n!==null)n.push&&n.splice||(n=[n]);else if(n===null){const p=g.getSchema();n=[];let v,C=0,S=0;for(C=0,S=d.startRows;C<S;C++)if((o.dataType==="object"||o.dataType==="function")&&d.dataSchema)v=Dt(p),n.push(v);else if(o.dataType==="array")v=Dt(p[0]),n.push(v);else{v=[];for(let R=0,M=d.startCols;R<M;R++)v.push(null);n.push(v)}}else throw new Error(`${l} only accepts array of objects or array of arrays (${typeof n} given)`);Array.isArray(n[0])&&(o.dataType="array"),d.data=n,g.dataSource=n,r.data=n,r.dataType=o.dataType,r.colToProp=g.colToProp.bind(g),r.propToCol=g.propToCol.bind(g),r.countCachedColumns=g.countCachedColumns.bind(g),t(g),o.runHooks(`after${c}`,n,u,a),u||(o.runHooks("afterChange",null,l),o.render()),o.getSettings().ariaTags&&Y(o.rootElement,[ny(-1),Ed(o.countCols()+(o.view?o.countRowHeaders():0))])}function Xb(n,e,t){return(e=cA(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cA(n){var e=dA(n,"string");return typeof e=="symbol"?e:e+""}function dA(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class fA{constructor(e){Xb(this,"metaManager",void 0),Xb(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),V.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:i,col:o}=e;if((t=this.metaSyncMemo.get(i))!==null&&t!==void 0&&t.has(o))return;const{visualRow:s,visualCol:r}=e,l=this.metaManager.hot,a=l.colToProp(r);e.prop=a,l.runHooks("beforeGetCellMeta",s,r,e);const h=je(e,"type")?e.type:null;let u=_e(e.cells)?e.cells(i,o,a):null;if(h)if(u){var c;u.type=(c=u.type)!==null&&c!==void 0?c:h}else u={type:h};u&&this.metaManager.updateCellMeta(i,o,u),l.runHooks("afterGetCellMeta",s,r,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(o)}}function gA(n,e,t){mA(n,e),e.set(n,t)}function mA(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Df(n,e,t){return(e=pA(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pA(n){var e=wA(n,"string");return typeof e=="symbol"?e:e+""}function wA(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function CA(n,e){return n.get(bA(n,e))}function bA(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var qb=new WeakMap;class vA{constructor(e){Df(this,"metaManager",void 0),Df(this,"usageTracker",new Set),Df(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),gA(this,qb,(t,i,o)=>{if(!o)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{initOnly:i,target:o,onChange:s}=e,r=typeof o=="string",l=r?o:t,a=`_${l}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[l],s?(this.installPropWatcher(t,a,s),r&&this.installPropWatcher(o,a,s)):i&&(this.installPropWatcher(t,a,CA(qb,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))})}installPropWatcher(e,t,i){const o=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(s){const r=!o.usageTracker.has(e);o.usageTracker.add(e),i.call(o,e,s,r),this[t]=s},enumerable:!0,configurable:!0})}}const NR="gridDefault",cs="editorManager.handlingEditor",SA={name:"editorCloseAndSave",callback(n){n._getEditorManager().closeEditorAndSaveChanges()}},yA="hooksRefRegisterer",DR={_hooksStorage:Object.create(null),addHook(n,e){return this._hooksStorage[n]||(this._hooksStorage[n]=[]),this.hot.addHook(n,e),this._hooksStorage[n].push(e),this},removeHooksByKey(n){b(this._hooksStorage[n]||[],e=>{this.hot.removeHook(n,e)})},clearHooks(){te(this._hooksStorage,(n,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};zi(DR,"MIXIN_NAME",yA,{writable:!1,enumerable:!1});function Yn(n,e,t){return(e=RA(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function RA(n){var e=EA(n,"string");return typeof e=="symbol"?e:e+""}function EA(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const TA="base",nt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Pl{static get EDITOR_TYPE(){return TA}constructor(e){Yn(this,"hot",void 0),Yn(this,"state",nt.VIRGIN),Yn(this,"_opened",!1),Yn(this,"_fullEditMode",!1),Yn(this,"_closeCallback",null),Yn(this,"TD",null),Yn(this,"row",null),Yn(this,"col",null),Yn(this,"prop",null),Yn(this,"originalValue",null),Yn(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,i,o,s,r){this.TD=o,this.row=e,this.col=t,this.prop=i,this.originalValue=s,this.cellProperties=r,this.state=this.isOpened()?this.state:nt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let i,o,s,r;if(t){const a=this.hot.getSelectedLast();i=Math.max(Math.min(a[0],a[2]),0),o=Math.max(Math.min(a[1],a[3]),0),s=Math.max(a[0],a[2]),r=Math.max(a[1],a[3])}else[i,o,s,r]=[this.row,this.col,null,null];const l=this.hot.runHooks("modifyGetCellCoords",i,o);Array.isArray(l)&&([i,o]=l),this.hot.populateFromArray(i,o,e,s,r,"edit")}beginEditing(e,t){if(this.state!==nt.VIRGIN)return;const i=this.hot,o=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(o,s)),this.state=nt.EDITING,this.isInFullEditMode()){const r=typeof e=="string"?e:Qe(this.originalValue);this.setValue(r)}this.open(t),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,t,i){let o;if(i){const s=this._closeCallback;this._closeCallback=r=>{s&&s(r),i(r),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===nt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===nt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?o=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:o=[[s]],this.state=nt.WAITING,this.saveValue(o,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",r=>{this.state=nt.FINISHED,this.discardEditor(r)}):(this.state=nt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=nt.FINISHED,this.discardEditor()}discardEditor(e){this.state===nt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=nt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=nt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===nt.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:i,wtViewport:o}=this.hot.view._wt,s=this.hot.rootWindow,r=mt(t),l=De(t),a=mt(this.hot.rootElement),h=De(this.hot.rootElement),u=i.topOverlay.holder,c=i.inlineStartOverlay.holder,d=u!==s?u.scrollTop:0,g=c!==s?c.scrollLeft:0,p=s.innerWidth-a.left-h,{wtTable:v}=(e=i.getParentOverlay(t))!==null&&e!==void 0?e:this.hot.view._wt,C=v.name,S=["master","inline_start"].includes(C)?d:0,R=["master","top","bottom"].includes(C)?g:0,M=r.top===a.top?0:1;let I=r.top-a.top-M-S,H=0;this.hot.isRtl()?H=s.innerWidth-r.left-l-p-1+R:H=r.left-a.left-1-R,["top","top_inline_start_corner"].includes(C)&&(I+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(H+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));const O=this.hot.hasColHeaders(),k=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),N=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),ie=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(O&&k<=0||k===ie)&&(I+=1),N<=0&&(H+=1);const Ie=o.rowsRenderCalculator.startPosition,oe=o.columnsRenderCalculator.startPosition,Fe=Math.abs(i.inlineStartOverlay.getScrollPosition()),We=i.topOverlay.getScrollPosition(),Rt=pt(this.hot.rootDocument);let Vn=t.offsetTop;if(["inline_start","master"].includes(C)&&(Vn+=Ie-We),["bottom","bottom_inline_start_corner"].includes(C)){const{wtViewport:A,wtTable:z}=i.bottomOverlay.clone;Vn+=A.getWorkspaceHeight()-z.getHeight()-Rt}let wt=t.offsetLeft;this.hot.isRtl()?(wt>=0?wt=v.getWidth()-t.offsetLeft:wt=Math.abs(wt),wt+=oe-Fe-l):["top","master","bottom"].includes(C)&&(wt+=oe-Fe);const re=Ui(this.TD,this.hot.rootWindow),fe=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",To=parseInt(re[fe],10)>0?0:1,f=parseInt(re.borderTopWidth,10)>0?0:1,m=De(t)+To,w=ot(t)+f,y=my(u)?Rt:0,E=py(c)?Rt:0,T=this.hot.view.maximumVisibleElementWidth(wt)-y+To,x=Math.max(this.hot.view.maximumVisibleElementHeight(Vn)-E+f,23);return{top:I,start:H,height:w,maxHeight:x,width:m,maxWidth:T}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?t="top-inline-start-corner":t="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?t="bottom-inline-start-corner":t="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}Ee(Pl,DR);const MA={name:"editorCloseAndSaveByArrowKeys",callback(n,e,t){const i=n._getEditorManager(),o=i.getActiveEditor();o.isInFullEditMode()&&o.state===nt.EDITING||(i.closeEditorAndSaveChanges(),n.getSelected()&&(t.includes("arrowdown")?n.selection.transformStart(1,0):t.includes("arrowup")?n.selection.transformStart(-1,0):t.includes("arrowleft")?n.selection.transformStart(0,-1*n.getDirectionFactor()):t.includes("arrowright")&&n.selection.transformStart(0,n.getDirectionFactor())),e.preventDefault())}},PA={name:"editorCloseAndSaveByEnter",callback(n,e){const t=n._getEditorManager();t.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),t.moveSelectionAfterEnter(e)}},IA={name:"editorCloseWithoutSaving",callback(n){const e=n._getEditorManager();e.closeEditorAndRestoreOriginalValue(n.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},HA={name:"editorFastOpen",callback(n,e){const{highlight:t}=n.getSelectedRangeLast();t.isHeader()||n._getEditorManager().openEditor(null,e,!0)}},xA={name:"editorOpen",callback(n,e,t){const i=n._getEditorManager(),o=n.getSelectedRangeLast(),{highlight:s}=o;if(n.selection.isMultiple()&&!o.isHeader()&&n.countRenderedCols()>0&&n.countRenderedRows()>0){const r=n.getSettings(),l=typeof r.enterMoves=="function"?r.enterMoves(e):r.enterMoves;t.includes("shift")?n.selection.transformFocus(-l.row,-l.col):n.selection.transformFocus(l.row,l.col);return}s.isHeader()||(n.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),$n(e))}};function AA(){return[SA,MA,PA,IA,HA,xA]}const _A={name:"extendCellsSelectionDown",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByColumnHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByRowHeader())&&n.selection.transformEnd(1,0)}},OA={name:"extendCellsSelectionDownByViewportHeight",callback(n){const{to:e}=n.getSelectedRangeLast(),t=Math.min(e.row+n.countVisibleRows(),n.countRows()-1),i=n.rowIndexMapper.getNearestNotHiddenIndex(t,-1);if(i!==null){const o=n._createCellCoords(i,e.col),s=e.row-n.view.getFirstFullyVisibleRow(),r=Math.min(o.row-s,n.countRows()-1);n.selection.setRangeEnd(o),n.scrollViewportTo({row:r,verticalSnap:"top",horizontalSnap:"start"})}}},NA={name:"extendCellsSelectionLeft",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByColumnHeader())&&n.selection.transformEnd(0,-1*n.getDirectionFactor())}},DA={name:"extendCellsSelectionRight",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByColumnHeader())&&n.selection.transformEnd(0,n.getDirectionFactor())}},LA={name:"extendCellsSelectionToColumns",callback(n){const{highlight:e,from:t,to:i}=n.getSelectedRangeLast();n.selection.isSelectedByRowHeader()?n.selection.selectAll(!0,!0):n.selectColumns(t.col,i.col,e)}},kA={name:"extendCellsSelectionToMostBottom",callback(n){const{selection:e,rowIndexMapper:t}=n,{highlight:i,from:o,to:s}=n.getSelectedRangeLast(),r=i.isHeader()&&n.selection.isSelectedByRowHeader();if(i.isCell()||r){const l=t.getNearestNotHiddenIndex(n.countRows()-1,-1),a=o.clone();a.row=i.row,e.setRangeStart(a,void 0,!1,i.clone()),r&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(l,s.col))}}},$A={name:"extendCellsSelectionToMostInlineEnd",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:i,from:o,to:s}=n.getSelectedRangeLast();if(!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&i.isCell()){const r=t.getNearestNotHiddenIndex(n.countCols()-1,-1),l=o.clone();l.col=i.col,e.setRangeStart(l,void 0,!1,i.clone()),e.setRangeEnd(n._createCellCoords(s.row,r))}}},VA={name:"extendCellsSelectionToMostInlineStart",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:i,from:o,to:s}=n.getSelectedRangeLast();if(!n.selection.isSelectedByRowHeader()&&!n.selection.isSelectedByCorner()&&i.isCell()){const r=parseInt(n.getSettings().fixedColumnsStart,10),l=t.getNearestNotHiddenIndex(r,1),a=o.clone();a.col=i.col,e.setRangeStart(a,void 0,!1,i.clone()),e.setRangeEnd(n._createCellCoords(s.row,l))}}},FA={name:"extendCellsSelectionToMostLeft",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:i,from:o,to:s}=n.getSelectedRangeLast(),r=i.isHeader()&&n.selection.isSelectedByColumnHeader();if(i.isCell()||r){const l=t.getNearestNotHiddenIndex(...n.isRtl()?[n.countCols()-1,-1]:[0,1]),a=o.clone();a.col=i.col,e.setRangeStart(a,void 0,!1,i.clone()),r&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(s.row,l))}}},WA={name:"extendCellsSelectionToMostRight",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:i,from:o,to:s}=n.getSelectedRangeLast(),r=i.isHeader()&&n.selection.isSelectedByColumnHeader();if(i.isCell()||r){const l=t.getNearestNotHiddenIndex(...n.isRtl()?[0,1]:[n.countCols()-1,-1]),a=o.clone();a.col=i.col,e.setRangeStart(a,void 0,!1,i.clone()),r&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(s.row,l))}}},BA={name:"extendCellsSelectionToMostTop",callback(n){const{selection:e,rowIndexMapper:t}=n,{highlight:i,from:o,to:s}=n.getSelectedRangeLast(),r=i.isHeader()&&n.selection.isSelectedByRowHeader();if(i.isCell()||r){const l=t.getNearestNotHiddenIndex(0,1),a=o.clone();a.row=i.row,e.setRangeStart(a,void 0,!1,i.clone()),r&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(l,s.col))}}},jA={name:"extendCellsSelectionToRows",callback(n){const{highlight:e,from:t,to:i}=n.getSelectedRangeLast();n.selection.isSelectedByColumnHeader()?n.selection.selectAll(!0,!0):n.selectRows(t.row,i.row,e)}},UA={name:"extendCellsSelectionUp",callback(n){const{highlight:e}=n.getSelectedRangeLast();!n.selection.isSelectedByColumnHeader()&&!n.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&n.selection.isSelectedByRowHeader())&&n.selection.transformEnd(-1,0)}},zA={name:"extendCellsSelectionUpByViewportHeight",callback(n){const{to:e}=n.getSelectedRangeLast(),t=Math.max(e.row-n.countVisibleRows(),0),i=n.rowIndexMapper.getNearestNotHiddenIndex(t,1);if(i!==null){const o=n._createCellCoords(i,e.col),s=e.row-n.view.getFirstFullyVisibleRow(),r=Math.max(o.row-s,0);n.selection.setRangeEnd(o),n.scrollViewportTo({row:r,verticalSnap:"top",horizontalSnap:"start"})}}};function GA(){return[_A,OA,NA,DA,LA,kA,$A,VA,FA,WA,BA,jA,UA,zA]}const YA={name:"moveCellSelectionDown",callback(n){let{selection:e}=n;e.transformStart(1,0)}},KA={name:"moveCellSelectionDownByViewportHeight",callback(n){const{navigableHeaders:e}=n.getSettings(),t=e?n.countColHeaders():0,{row:i}=n.getSelectedRangeLast().highlight;let o=n.countVisibleRows()+t;i===n.countRows()-1?o=1:i+o>n.countRows()&&(o=n.countRows()-i-1),n.selection.transformStart(o,0),n.getSelectedRangeLast().highlight.row<0&&n.scrollViewportTo({row:0})}},XA={name:"moveCellSelectionInlineEnd",callback(n,e){const t=n.getSettings(),i=n.getSelectedRangeLast(),o=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;n.selection.isMultiple()&&!i.isHeader()&&n.countRenderedCols()>0&&n.countRenderedRows()>0?n.selection.transformFocus(-o.row,-o.col):n.selection.transformStart(-o.row,-o.col)}},qA={name:"moveCellSelectionInlineStart",callback(n,e){const t=n.getSettings(),i=n.getSelectedRangeLast(),o=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;n.selection.isMultiple()&&!i.isHeader()&&n.countRenderedCols()>0&&n.countRenderedRows()>0?n.selection.transformFocus(o.row,o.col):n.selection.transformStart(o.row,o.col)}},QA={name:"moveCellSelectionLeft",callback(n){n.selection.transformStart(0,-1*n.getDirectionFactor())}},JA={name:"moveCellSelectionRight",callback(n){n.selection.transformStart(0,n.getDirectionFactor())}},ZA={name:"moveCellSelectionToMostBottom",callback(n){const{col:e}=n.getSelectedRangeLast().highlight;let t=n.rowIndexMapper.getNearestNotHiddenIndex(n.countRows()-1,-1);t===null&&(t=-1),n.selection.setRangeStart(n._createCellCoords(t,e))}},e_={name:"moveCellSelectionToMostBottomInlineEnd",callback(n){const{selection:e,rowIndexMapper:t,columnIndexMapper:i}=n,o=parseInt(n.getSettings().fixedRowsBottom,10),s=t.getNearestNotHiddenIndex(n.countRows()-o-1,-1),r=i.getNearestNotHiddenIndex(n.countCols()-1,-1);e.setRangeStart(n._createCellCoords(s,r))}},t_={name:"moveCellSelectionToMostInlineEnd",callback(n){const{selection:e,columnIndexMapper:t}=n;e.setRangeStart(n._createCellCoords(n.getSelectedRangeLast().highlight.row,t.getNearestNotHiddenIndex(n.countCols()-1,-1)))}},n_={name:"moveCellSelectionToMostInlineStart",callback(n){const{selection:e,columnIndexMapper:t}=n,i=parseInt(n.getSettings().fixedColumnsStart,10),o=n.getSelectedRangeLast().highlight.row,s=t.getNearestNotHiddenIndex(i,1);e.setRangeStart(n._createCellCoords(o,s))}},i_={name:"moveCellSelectionToMostLeft",callback(n){const{selection:e,columnIndexMapper:t}=n,i=n.getSelectedRangeLast().highlight.row;let o=t.getNearestNotHiddenIndex(...n.isRtl()?[n.countCols()-1,-1]:[0,1]);o===null&&(o=n.isRtl()?-1:-n.countRowHeaders()),e.setRangeStart(n._createCellCoords(i,o))}},o_={name:"moveCellSelectionToMostRight",callback(n){const{selection:e,columnIndexMapper:t}=n,{row:i}=n.getSelectedRangeLast().highlight;let o=t.getNearestNotHiddenIndex(...n.isRtl()?[0,1]:[n.countCols()-1,-1]);o===null&&(o=n.isRtl()?-n.countRowHeaders():-1),e.setRangeStart(n._createCellCoords(i,o))}},s_={name:"moveCellSelectionToMostTop",callback(n){const{col:e}=n.getSelectedRangeLast().highlight;let t=n.rowIndexMapper.getNearestNotHiddenIndex(0,1);t===null&&(t=-n.countColHeaders()),n.selection.setRangeStart(n._createCellCoords(t,e))}},r_={name:"moveCellSelectionToMostTopInlineStart",callback(n){const{selection:e,rowIndexMapper:t,columnIndexMapper:i}=n,o=parseInt(n.getSettings().fixedRowsTop,10),s=parseInt(n.getSettings().fixedColumnsStart,10),r=t.getNearestNotHiddenIndex(o,1),l=i.getNearestNotHiddenIndex(s,1);e.setRangeStart(n._createCellCoords(r,l))}},l_={name:"moveCellSelectionUp",callback(n){let{selection:e}=n;e.transformStart(-1,0)}},a_={name:"moveCellSelectionUpByViewportHight",callback(n){const{navigableHeaders:e}=n.getSettings(),t=e?n.countColHeaders():0,{row:i}=n.getSelectedRangeLast().highlight;let o=-(n.countVisibleRows()+t);i===-t?o=-1:i+o<t&&(o=-(i+t)),n.selection.transformStart(o,0),n.getSelectedRangeLast().highlight.row<0&&n.scrollViewportTo({row:0})}};function h_(){return[YA,KA,XA,qA,QA,JA,ZA,e_,t_,n_,i_,o_,s_,r_,l_,a_]}const u_={name:"emptySelectedCells",callback(n){n.emptySelectedCells(),n._getEditorManager().prepareEditor()}},c_={name:"scrollToFocusedCell",callback(n){const{highlight:e}=n.getSelectedRangeLast(),t=n.view.getFirstFullyVisibleRow()-1,i=n.view.getFirstFullyVisibleColumn()-1,o=n.view.getLastFullyVisibleRow()+1,s=n.view.getLastFullyVisibleColumn()+1,r=n._createCellCoords(t,i),l=n._createCellCoords(o,s);if(!n._createCellRange(r,r,l).includes(e)&&(e.row>=0||e.col>=0)){const h={};if(e.col>=0){const u=Math.floor(n.countVisibleCols()/2);h.col=Math.max(e.col-u,0)}if(e.row>=0){const u=Math.floor(n.countVisibleRows()/2);h.row=Math.max(e.row-u,0)}n.scrollViewportTo({...h,verticalSnap:"top",horizontalSnap:"start"})}}},d_={name:"selectAllCells",callback(n){n.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},f_={name:"selectAllCellsAndHeaders",callback(n){n.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},g_={name:"populateSelectedCellsData",callback(n){const e=n.getSelectedRange(),{row:t,col:i}=e[e.length-1].highlight.normalize(),o=n.getDataAtCell(t,i),s=new Map;for(let r=0;r<e.length;r++)e[r].forAll((l,a)=>{if(l>=0&&a>=0&&(l!==t||a!==i)){const{readOnly:h}=n.getCellMeta(l,a);h||s.set(`${l}x${a}`,[l,a,o])}});n.setDataAtCell(Array.from(s.values()))}},m_=[...AA(),...GA(),...h_(),u_,c_,d_,f_,g_];function LR(n){const e={};return m_.forEach(t=>{let{name:i,callback:o}=t;e[i]=function(){for(var s=arguments.length,r=new Array(s),l=0;l<s;l++)r[l]=arguments[l];return o(n,...r)}}),e}function p_(n){const e=n.getShortcutManager().addContext("editor"),t=LR(n),i={group:cs};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(o,s)=>t.editorCloseAndSaveByEnter(o,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(o,s)=>t.editorCloseAndSaveByEnter(o,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:n.getShortcutManager().getContext("grid"),callback:(o,s)=>t.editorCloseAndSave(o,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(o,s)=>t.editorCloseAndSaveByArrowKeys(o,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>t.editorCloseWithoutSaving()}],i)}function w_(n){const e=n.getShortcutManager().addContext("grid"),t=LR(n),i={runOnlyIf:()=>{const{navigableHeaders:o}=n.getSettings();return F(n.getSelected())&&(o||!o&&n.countRenderedRows()>0&&n.countRenderedCols()>0)},group:NR};e.addShortcuts([{keys:[["F2"]],callback:o=>t.editorFastOpen(o)},{keys:[["Enter"],["Enter","Shift"]],callback:(o,s)=>t.editorOpen(o,s)},{keys:[["Backspace"],["Delete"]],callback:()=>t.emptySelectedCells()}],{group:cs,runOnlyIf:()=>F(n.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>t.selectAllCells(),runOnlyIf:()=>{var o;return!((o=n.getSelectedRangeLast())!==null&&o!==void 0&&o.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var o;return(o=n.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>t.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>t.populateSelectedCellsData(),runOnlyIf:()=>{var o,s;return!((o=n.getSelectedRangeLast())!==null&&o!==void 0&&o.highlight.isHeader())&&((s=n.getSelectedRangeLast())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>t.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>t.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>t.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>t.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>t.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>t.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>t.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>t.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>t.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>t.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>t.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>t.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>t.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:o=>t.moveCellSelectionInlineStart(o)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:o=>t.moveCellSelectionInlineEnd(o)},{keys:[["Control/Meta","Backspace"]],callback:()=>t.scrollToFocusedCell()}],i)}function C_(n){[w_,p_].forEach(e=>e(n))}function b_(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=n.rootElement,i=Qb(n),o=Qb(n);return i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),o.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),t.firstChild.before(i),t.lastChild.after(o),{activate(){n._registerTimeout(()=>{i.tabIndex=0,o.tabIndex=0},10)},deactivate(){n._registerTimeout(()=>{i.tabIndex=-1,o.tabIndex=-1},10)}}}function Qb(n){const t=n.rootDocument.createElement("input");return t.type="text",t.classList.add("htFocusCatcher"),n.getSettings().ariaTags&&Y(t,[Wi(),mr()]),t}function v_(n){const e=S_(n);let t;const{activate:i,deactivate:o}=b_(n,{onFocusFromTop(){var c;const d=(c=e(t))!==null&&c!==void 0?c:Tm(n);d&&(n.runHooks("modifyFocusOnTabNavigation","from_above",d),n.selectCell(d.row,d.col)),n.listen()},onFocusFromBottom(){var c;const d=(c=e(t))!==null&&c!==void 0?c:Mm(n);d&&(n.runHooks("modifyFocusOnTabNavigation","from_below",d),n.selectCell(d.row,d.col)),n.listen()}}),s={wrapped:!1,flipped:!1};let r=!0,l=!1,a=!1;n.addHook("afterListen",()=>o()),n.addHook("afterUnlisten",()=>i()),n.addHook("afterSelection",(c,d,g,p,v)=>{if(l&&(s.wrapped&&s.flipped||a)&&(a=!1,v.value=!0),r){var C;t=(C=n.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight}}),n.addHook("beforeRowWrap",(c,d,g)=>{s.wrapped=!0,s.flipped=g});function h(){s.wrapped=!1,s.flipped=!1,n.deselectCell(),n.unlisten()}const u={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:NR,group:"focusCatcher"};n.getShortcutManager().getContext("grid").addShortcuts([{...u,callback:()=>{const{tabNavigation:c}=n.getSettings();l=!0,n.getSelectedRangeLast()&&!c&&(r=!1),c||(a=!0)},position:"before"},{...u,callback:c=>{const{tabNavigation:d,autoWrapRow:g}=n.getSettings();if(l=!1,r=!0,!d||!n.selection.isSelected()||g&&s.wrapped&&s.flipped||!g&&s.wrapped)return g&&s.wrapped&&s.flipped&&(t=c.shiftKey?Tm(n):Mm(n)),h(),!1;c.preventDefault()},position:"after"}])}function Tm(n){const{rowIndexMapper:e,columnIndexMapper:t}=n,{navigableHeaders:i}=n.getSettings();let o=i&&n.countColHeaders()>0?-n.countColHeaders():0,s=i&&n.countRowHeaders()>0?-n.countRowHeaders():0;return o===0&&(o=e.getVisualFromRenderableIndex(o)),s===0&&(s=t.getVisualFromRenderableIndex(s)),o===null||s===null?null:n._createCellCoords(o,s)}function Mm(n){var e,t;const{rowIndexMapper:i,columnIndexMapper:o}=n,{navigableHeaders:s}=n.getSettings();let r=i.getRenderableIndexesLength()-1,l=o.getRenderableIndexesLength()-1;if(r<0){if(!s||n.countColHeaders()===0)return null;r=-1}if(l<0){if(!s||n.countColHeaders()===0)return null;l=-1}return n._createCellCoords((e=i.getVisualFromRenderableIndex(r))!==null&&e!==void 0?e:r,(t=o.getVisualFromRenderableIndex(l))!==null&&t!==void 0?t:l)}function S_(n){return e=>{if(!e)return null;const t=Tm(n),i=Mm(n);return e.col<t.col&&(e.col=t.col),e.col>i.col&&(e.col=i.col),e.row<t.row&&(e.row=t.row),e.row>i.row&&(e.row=i.row),e}}function y_(n){return e=>{let{col:t}=e;n.scrollViewportTo({col:t})}}function R_(){return()=>{}}function E_(n){return e=>{n.scrollViewportTo(e.toObject())}}function T_(n){return e=>{n.scrollViewportTo(e.toObject())}}function M_(n){return e=>{n.scrollViewportTo(e.toObject())}}function P_(n){return e=>{let{row:t}=e;n.scrollViewportTo({row:t})}}function I_(n){return e=>{const t=n.selection.getSelectionSource(),{row:i,col:o}=e;if(i<0&&o>=0)n.scrollViewportTo({col:o});else if(o<0&&i>=0)n.scrollViewportTo({row:i});else{if(t==="mouse"&&(o===n.view.getLastPartiallyVisibleColumn()||i===n.view.getLastPartiallyVisibleRow()))return;n.scrollViewportTo({row:i,col:o})}}}function H_(n){const{selection:e}=n;let t=!1,i=!1;return{resume(){i=!1},suspend(){i=!0},skipNextScrollCycle(){t=!0},scrollTo(o){var s;if(t||i){t=!1;return}let r;e.isFocusSelectionChanged()?r=E_(n):e.isSelectedByCorner()?r=R_():e.isSelectedByRowHeader()?r=P_(n):e.isSelectedByColumnHeader()?r=y_(n):e.getSelectedRange().size()===1&&e.isMultiple()?r=T_(n):e.getSelectedRange().size()===1&&!e.isMultiple()?r=I_(n):e.getSelectedRange().size()>1&&(r=M_(n)),(s=r)===null||s===void 0||s(o)}}}const Jb=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),mu=n=>n.map(e=>{const t=e.toLowerCase();return Jb.has(t)?Jb.get(t):t}).sort().join("+"),x_=n=>n.split("+"),Zb=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Lf=n=>{let{which:e,key:t}=n;if(Zb.has(e))return Zb.get(e);const i=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(i)?i:t.toLowerCase()},kR=Symbol("shortcut-context");function $R(n){return ee(n)&&n.__kindOf===kR}const A_=n=>{const e=Nd({errorIdExists:a=>`The "${a}" shortcut is already registered in the "${n}" context.`}),t=function(){let{keys:a,callback:h,group:u,runOnlyIf:c=()=>!0,captureCtrl:d=!1,preventDefault:g=!0,stopPropagation:p=!1,relativeToGroup:v,position:C,forwardToContext:S}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Ne(u))throw new Error("You need to define the shortcut's group.");if(_e(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(a)===!1)throw new Error(Re`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const R={callback:h,group:u,runOnlyIf:c,captureCtrl:d,preventDefault:g,stopPropagation:p};F(v)&&(R.relativeToGroup=v,R.position=C),$R(S)&&(R.forwardToContext=S),a.forEach(M=>{const I=mu(M);if(e.hasItem(I)){const O=e.getItem(I);let k=O.findIndex(N=>N.group===v);k!==-1?C==="before"?k-=1:k+=1:k=O.length,O.splice(k,0,R)}else e.addItem(I,[R])})},i=function(a){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};a.forEach(u=>{te(h,(c,d)=>{Object.prototype.hasOwnProperty.call(u,d)===!1&&(u[d]=h[d])}),t(u)})},o=a=>{const h=mu(a);e.removeItem(h)};return{__kindOf:kR,addShortcut:t,addShortcuts:i,getShortcuts:a=>{const h=mu(a),u=e.getItem(h);return F(u)?u.slice():[]},hasShortcut:a=>{const h=mu(a);return e.hasItem(h)},removeShortcutsByKeys:o,removeShortcutsByGroup:a=>{e.getItems().forEach(u=>{let[c,d]=u;const g=d.filter(p=>p.group!==a);g.length===0?o(x_(c)):(d.length=0,d.push(...g))})}}};function __(){const n=new Set;return{press(e){n.add(e)},release(e){n.delete(e)},releaseAll(){n.clear()},isPressed(e){return n.has(e)}}}const O_=["meta","alt","shift","control"],Ql=__(),Jl=[];let pu=0;function N_(n,e,t,i,o){const s=g=>O_.includes(g),r=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return g.altKey&&v.push("alt"),p&&(g.ctrlKey||g.metaKey)?v.push("control/meta"):(g.ctrlKey&&v.push("control"),g.metaKey&&v.push("meta")),g.shiftKey&&v.push("shift"),v},l=g=>{if(e(g)===!1)return;const p=t(g);if(g.keyCode===229||p===!1||Yo(g))return;const v=Lf(g);let C=[];s(v)||(C=r(g));const S=[v].concat(C);!o(g,S)&&(lh()&&C.includes("meta")||!lh()&&C.includes("control"))&&o(g,[v].concat(r(g,!0))),i(g)},a=g=>{if(g.key){const p=Lf(g);s(p)&&Ql.press(p)}},h=g=>{if(g.key){const p=Lf(g);s(p)&&Ql.release(p)}},u=()=>{Ql.releaseAll()};return{mount:()=>{let g=n;for(pu+=1;g;)pu===1&&(g.document.documentElement.addEventListener("keydown",a),Jl.push({event:"keydown",listener:a}),g.document.documentElement.addEventListener("keyup",h),Jl.push({event:"keyup",listener:h})),g.document.documentElement.addEventListener("keydown",l),g.document.documentElement.addEventListener("blur",u),g=rr(g)},unmount:()=>{let g=n;for(pu-=1;g;){if(pu===0){for(let p=0;p<Jl.length;p++){const{event:v,listener:C}=Jl[p];g.document.documentElement.removeEventListener(v,C)}Jl.length=0}g.document.documentElement.removeEventListener("keydown",l),g.document.documentElement.removeEventListener("blur",u),g=rr(g)}},isPressed:g=>Ql.isPressed(g),releasePressedKeys:()=>Ql.releaseAll()}}const D_=n=>{let{ownerWindow:e,handleEvent:t,beforeKeyDown:i,afterKeyDown:o}=n;const s=Nd({errorIdExists:p=>`The "${p}" context name is already registered.`});let r="grid";const l=p=>{const v=A_(p);return s.addItem(p,v),v},a=()=>r,h=p=>s.getItem(p),u=p=>{if(!s.hasItem(p))throw new Error(Re`You've tried to activate the "${p}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);r=p};let c=!1;const d=function(p,v){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:a();const S=$R(C)?C:h(C);let R=!1;if(!S.hasShortcut(v))return R;const M=S.getShortcuts(v);for(let I=0;I<M.length;I++){const{callback:H,runOnlyIf:O,preventDefault:k,stopPropagation:N,captureCtrl:Ce,forwardToContext:ie}=M[I];if(O(p)===!0){if(c=Ce,R=H(p,v)===!1,c=!1,k&&p.preventDefault(),N&&($n(p),p.stopPropagation()),R)break;ie&&d(p,v,ie)}}return R},g=N_(e,t,i,o,d);return g.mount(),{addContext:l,getActiveContextName:a,getContext:h,setActiveContextName:u,isCtrlPressed:()=>!c&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}};let kf=null;const $f=new Map;function VR(n,e){var t,i=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const r=new kn(s);let l,a,h,u,c,d,g=!0;wH(o)&&pH(this),this.rootElement=n,this.rootDocument=n.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const p=(t=e==null?void 0:e.layoutDirection)!==null&&t!==void 0?t:"inherit",v=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=dx(e.language);const C=new OR(s,e,[fA,vA]),S=C.getTableMeta(),R=C.getGlobalMeta(),M=Nd();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,n.insertBefore(this.container,n.firstChild),wc(this)&&JS(e.licenseKey,n),this.guid=`ht_${ep()}`,$f.set(this.guid,this),this.columnIndexMapper=new ym,this.rowIndexMapper=new ym,this.columnIndexMapper.addLocalHook("indexesSequenceChange",f=>{s.runHooks("afterColumnSequenceChange",f)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",f=>{s.runHooks("afterRowSequenceChange",f)}),a=new xH(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const I=f=>{const{row:m,col:w}=f;return s._createCellCoords(m>=0?s.rowIndexMapper.getRenderableFromVisualIndex(m):m,w>=0?s.columnIndexMapper.getRenderableFromVisualIndex(w):w)},H=f=>{const{row:m,col:w}=f;return s._createCellCoords(m>=0?s.rowIndexMapper.getVisualFromRenderableIndex(m):m,w>=0?s.columnIndexMapper.getVisualFromRenderableIndex(w):w)},O=(f,m)=>{const w=m>f?1:-1,y=Math.min(f,m),E=Math.max(f,m),T=s.rowIndexMapper.getNearestNotHiddenIndex(f,w);return T===null||w===1&&T>E||w===-1&&T<y?null:T>=0?s.rowIndexMapper.getRenderableFromVisualIndex(T):T},k=(f,m)=>{const w=m>f?1:-1,y=Math.min(f,m),E=Math.max(f,m),T=s.columnIndexMapper.getNearestNotHiddenIndex(f,w);return T===null||w===1&&T>E||w===-1&&T<y?null:T>=0?s.columnIndexMapper.getRenderableFromVisualIndex(T):T};let N=new xR(S,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:f=>l.propToCol(f),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(f,m)=>s._createCellCoords(f,m),createCellRange:(f,m,w)=>s._createCellRange(f,m,w),visualToRenderableCoords:I,renderableToVisualCoords:H,findFirstNonHiddenRenderableRow:O,findFirstNonHiddenRenderableColumn:k,isDisabledCellSelection:(f,m)=>f<0||m<0?s.getSettings().disableVisualSelection:s.getCellMeta(f,m).disableVisualSelection});this.selection=N;const Ce=f=>{let{hiddenIndexesChanged:m}=f;m&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",Ce),this.rowIndexMapper.addLocalHook("cacheUpdated",Ce),this.selection.addLocalHook("afterSetRangeEnd",(f,m)=>{const w=Dn(!1),y=this.selection.getSelectedRange(),{from:E,to:T}=y.current(),x=y.size()-1;this.runHooks("afterSelection",E.row,E.col,T.row,T.col,w,x),this.runHooks("afterSelectionByProp",E.row,s.colToProp(E.col),T.row,s.colToProp(T.col),w,x),m&&(!w.isTouched()||w.isTouched()&&!w.value)&&d.scrollTo(f);const A=N.isSelectedByRowHeader(),z=N.isSelectedByColumnHeader();A&&z?P(this.rootElement,["ht__selection--rows","ht__selection--columns"]):A?(X(this.rootElement,"ht__selection--columns"),P(this.rootElement,"ht__selection--rows")):z?(X(this.rootElement,"ht__selection--rows"),P(this.rootElement,"ht__selection--columns")):X(this.rootElement,["ht__selection--rows","ht__selection--columns"]),N.getSelectionSource()!=="shift"&&u.closeEditor(null),s.view.render(),u.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",f=>{this.runHooks("beforeSelectionFocusSet",f.row,f.col)}),this.selection.addLocalHook("afterSetFocus",f=>{const m=Dn(!1);this.runHooks("afterSelectionFocusSet",f.row,f.col,m),(!m.isTouched()||m.isTouched()&&!m.value)&&d.scrollTo(f),u.closeEditor(),s.view.render(),u.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",f=>{const m=f.length-1,{from:w,to:y}=f[m];this.runHooks("afterSelectionEnd",w.row,w.col,y.row,y.col,m),this.runHooks("afterSelectionEndByProp",w.row,s.colToProp(w.col),y.row,s.colToProp(y.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",f=>{const m=this.runHooks("afterIsMultipleSelection",f.value);f.value&&(f.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{u.closeEditor(),s.view.render(),X(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("afterSelectRows",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("modifyTransformFocus",...m)}).addLocalHook("afterModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("afterModifyTransformFocus",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",f=>this.alter("insert_row_above",f,1,"auto")).addLocalHook("insertColRequire",f=>this.alter("insert_col_start",f,1,"auto")),h={alter(f,m){var w,y;let E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,T=arguments.length>3?arguments[3]:void 0,x=arguments.length>4?arguments[4]:void 0;const A=z=>{if(z.length===0)return[];const G=[...z];return G.sort((ge,Le)=>{let[me]=ge,[et]=Le;return me===et?0:me>et?1:-1}),at(G,(ge,Le)=>{let[me,et]=Le;const Lt=ge[ge.length-1],[kt,$t]=Lt,Tt=kt+$t;if(me<=Tt){const Fn=Math.max(et-(Tt-me),0);Lt[1]+=Fn}else ge.push([me,et]);return ge},[G[0]])};switch(f){case"insert_row_below":case"insert_row_above":const z=s.countSourceRows();if(S.maxRows===z)return;const G=f==="insert_row_below"?"below":"above";m=(w=m)!==null&&w!==void 0?w:G==="below"?z:0;const{delta:D,startPhysicalIndex:ge}=l.createRow(m,E,{source:T,mode:G});N.shiftRows(s.toVisualRow(ge),D);break;case"insert_col_start":case"insert_col_end":const Le=f==="insert_col_end"?"end":"start";m=(y=m)!==null&&y!==void 0?y:Le==="end"?s.countSourceCols():0;const{delta:me,startPhysicalIndex:et}=l.createCol(m,E,{source:T,mode:Le});if(me){if(Array.isArray(S.colHeaders)){const $t=[s.toVisualColumn(et),0];$t.length+=me,Array.prototype.splice.apply(S.colHeaders,$t)}N.shiftColumns(s.toVisualColumn(et),me)}break;case"remove_row":const Lt=$t=>{let Tt=0;b($t,Fn=>{let[Ue,Mt]=Fn;const hi=Je(Ue)?s.countRows()-1:Math.max(Ue-Tt,0);if(Number.isInteger(Ue)&&(Ue=Math.max(Ue-Tt,0)),!l.removeRow(Ue,Mt,T))return;if(N.isSelected()){const{row:Wn}=s.getSelectedRangeLast().highlight;Wn>=Ue&&Wn<=Ue+Mt-1&&u.closeEditor(!0)}const vr=s.countRows();vr===0?N.deselect():T==="ContextMenu.removeRow"?N.refresh():N.shiftRows(Ue,-Mt);const ds=S.fixedRowsTop;ds>=hi+1&&(S.fixedRowsTop-=Math.min(Mt,ds-hi));const bn=S.fixedRowsBottom;bn&&hi>=vr-bn&&(S.fixedRowsBottom-=Math.min(Mt,bn)),Tt+=Mt})};Array.isArray(m)?Lt(A(m)):Lt([[m,E]]);break;case"remove_col":const kt=$t=>{let Tt=0;b($t,Fn=>{let[Ue,Mt]=Fn;const hi=Je(Ue)?s.countCols()-1:Math.max(Ue-Tt,0);let ui=s.toPhysicalColumn(hi);if(Number.isInteger(Ue)&&(Ue=Math.max(Ue-Tt,0)),!l.removeCol(Ue,Mt,T))return;if(N.isSelected()){const{col:Wn}=s.getSelectedRangeLast().highlight;Wn>=Ue&&Wn<=Ue+Mt-1&&u.closeEditor(!0)}s.countCols()===0?N.deselect():T==="ContextMenu.removeColumn"?N.refresh():N.shiftColumns(Ue,-Mt);const bn=S.fixedColumnsStart;bn>=hi+1&&(S.fixedColumnsStart-=Math.min(Mt,bn-hi)),Array.isArray(S.colHeaders)&&(typeof ui>"u"&&(ui=-1),S.colHeaders.splice(ui,Mt)),Tt+=Mt})};Array.isArray(m)?kt(A(m)):kt([[m,E]]);break;default:throw new Error(`There is no such action "${f}"`)}s.view.render(),x||h.adjustRowsAndCols()},adjustRowsAndCols(){const f=S.minRows,m=S.minSpareRows,w=S.minCols,y=S.minSpareCols;if(f){const E=s.countRows();E<f&&l.createRow(E,f-E,{source:"auto"})}if(m){const E=s.countEmptyRows(!0);if(E<m){const T=m-E,x=Math.min(T,S.maxRows-s.countSourceRows());l.createRow(s.countRows(),x,{source:"auto"})}}{let E;(w||y)&&(E=s.countEmptyCols(!0));let T=s.countCols();if(w&&!S.columns&&T<w){const x=w-T;E+=x,l.createCol(T,x,{source:"auto"})}if(y&&!S.columns&&s.dataType==="array"&&E<y){T=s.countCols();const x=y-E,A=Math.min(x,S.maxCols-T);l.createCol(T,A,{source:"auto"})}}s.view&&s.view.adjustElementsSize()},populateFromArray(f,m,w,y,E){let T,x,A,z;const G=[],D={},ge=[],Le=f.row,me=f.col;if(x=m.length,x===0)return!1;let et=0,Lt=0;switch(ee(w)&&(et=w.col-me+1,Lt=w.row-Le+1),E){case"shift_down":const kt=Da(m),$t=kt.length,Tt=Math.max($t,et),Fn=s.getData().slice(Le),Ue=Da(Fn).slice(me,me+Tt);for(A=0;A<Tt;A+=1)if(A<$t){for(T=0,x=kt[A].length;T<Lt-x;T+=1)kt[A].push(kt[A][T%x]);A<Ue.length?ge.push(kt[A].concat(Ue[A])):ge.push(kt[A].concat(new Array(Fn.length).fill(null)))}else ge.push(kt[A%$t].concat(Ue[A]));s.populateFromArray(Le,me,Da(ge));break;case"shift_right":const Mt=m.length,hi=Math.max(Mt,Lt),ui=s.getData().slice(Le).map(Gi=>Gi.slice(me));for(T=0;T<hi;T+=1)if(T<Mt){for(A=0,z=m[T].length;A<et-z;A+=1)m[T].push(m[T][A%z]);if(T<ui.length)for(let Gi=0;Gi<ui[T].length;Gi+=1)m[T].push(ui[T][Gi]);else m[T].push(...new Array(ui[0].length).fill(null))}else m.push(m[T%x].slice(0,hi).concat(ui[T]));s.populateFromArray(Le,me,m);break;case"overwrite":default:D.row=f.row,D.col=f.col;let vr=0,ds=0,bn=!0,Wn;const JC=function($h){let Sr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Al=m[$h%m.length];return Sr!==null?Al[Sr%Al.length]:Al},ZC=m.length,uf=w?w.row-f.row+1:0;for(w?x=uf:x=Math.max(ZC,uf),T=0;T<x&&!(w&&D.row>w.row&&uf>ZC||!S.allowInsertRow&&D.row>s.countRows()-1||D.row>=S.maxRows);T++){const Gi=T-vr,$h=JC(Gi).length,Sr=w?w.col-f.col+1:0;if(w?z=Sr:z=Math.max($h,Sr),D.col=f.col,Wn=s.getCellMeta(D.row,D.col),(y==="CopyPaste.paste"||y==="Autofill.fill")&&Wn.skipRowOnPaste){vr+=1,D.row+=1,x+=1;continue}for(ds=0,A=0;A<z&&!(w&&D.col>w.col&&Sr>$h||!S.allowInsertColumn&&D.col>s.countCols()-1||D.col>=S.maxCols);A++){if(Wn=s.getCellMeta(D.row,D.col),(y==="CopyPaste.paste"||y==="Autofill.fill")&&Wn.skipColumnOnPaste){ds+=1,D.col+=1,z+=1;continue}if(Wn.readOnly&&y!=="UndoRedo.undo"){D.col+=1;continue}const Al=A-ds;let ci=JC(Gi,Al),di=s.getDataAtCell(D.row,D.col);if(ci!==null&&typeof ci=="object")if(Array.isArray(ci)&&di===null&&(di=[]),di===null||typeof di!="object")bn=!1;else{const eb=Cl(Array.isArray(di)?di:di[0]||di),tb=Cl(Array.isArray(ci)?ci:ci[0]||ci);xd(eb,tb)||Array.isArray(eb)&&Array.isArray(tb)?ci=Dt(ci):bn=!1}else di!==null&&typeof di=="object"&&(bn=!1);bn&&G.push([D.row,D.col,ci]),bn=!0,D.col+=1}D.row+=1}s.setDataAtCell(G,null,null,y||"populateFromArray");break}}};function ie(f){const m=CR(f);cC(m)?(s.runHooks("beforeLanguageChange",m),R.language=m,s.runHooks("afterLanguageChange",m)):bR(f)}function Ie(f,m){const w=f==="className"?s.rootElement:s.table;if(g)P(w,m);else{let y=[],E=[];R[f]&&(y=Array.isArray(R[f])?R[f]:lm(R[f])),m&&(E=Array.isArray(m)?m:lm(m));const T=rm(y,E),x=rm(E,y);T.length&&X(w,T),x.length&&P(w,x)}R[f]=m}this.init=function(){a.setData(S.data),s.runHooks("beforeInit"),(go()||Cp())&&P(s.rootElement,"mobile"),this.updateSettings(S,!0),this.view=new SH(this),u=gm.getInstance(s,S,N),d=H_(s),c=new m0(s),wc(this)&&v_(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&s.rootElement.offsetParent===null&&wy(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof g=="object"&&(s.runHooks("afterChange",g[0],g[1]),g=!1),s.runHooks("afterInit")};function oe(){let f=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,f=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&f===!1&&(f=!0,this.onQueueEmpty(this.valid))}}}function Fe(f){const m=f.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):f}function We(f,m,w){if(!f.length){w();return}const y=s.getActiveEditor(),E=new oe;let T=!0;E.onQueueEmpty=()=>{y&&T&&y.cancelChanges(),w()};for(let x=f.length-1;x>=0;x--){const[A,z,,G]=f[x],D=l.propToCol(z);let ge;Number.isInteger(D)?ge=s.getCellMeta(A,D):ge={...Object.getPrototypeOf(S),...S},ge.type==="numeric"&&typeof G=="string"&&Vy(G)&&(f[x][3]=Fe(G)),s.getCellValidator(ge)&&(E.addValidatorToQueue(),s.validateCell(f[x][3],ge,function(Le,me){return function(et){if(typeof et!="boolean")throw new Error("Validation error: result is not boolean");et===!1&&me.allowInvalid===!1&&(T=!1,f.splice(Le,1),me.valid=!0),E.removeValidatorFormQueue()}}(x,ge),m))}E.checkIfQueueIsEmpty()}function Rt(f,m){for(let y=f.length-1;y>=0;y--){let E=!1;if(f[y]===null){f.splice(y,1);continue}if(!((f[y][2]===null||f[y][2]===void 0)&&(f[y][3]===null||f[y][3]===void 0))){if(S.allowInsertRow)for(;f[y][0]>s.countRows()-1;){const{delta:T}=l.createRow(void 0,void 0,{source:m});if(T===0){E=!0;break}}if(s.dataType==="array"&&(!S.columns||S.columns.length===0)&&S.allowInsertColumn)for(;l.propToCol(f[y][1])>s.countCols()-1;){const{delta:T}=l.createCol(void 0,void 0,{source:m});if(T===0){E=!0;break}}E||l.set(f[y][0],f[y][1],f[y][3])}}const w=f.length>0;if(s.forceFullRender=!0,w){h.adjustRowsAndCols(),s.runHooks("beforeChangeRender",f,m),u.closeEditor(),s.view.render(),u.prepareEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",f,m||"edit");const y=s.getActiveEditor();y&&F(y.refreshValue)&&y.refreshValue()}else s.view.render()}this._createCellCoords=function(f,m){return s.view._wt.createCellCoords(f,m)},this._createCellRange=function(f,m,w){return s.view._wt.createCellRange(f,m,w)},this.validateCell=function(f,m,w,y){let E=s.getCellValidator(m);function T(x){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){w(x);return}const z=m.visualCol,G=m.visualRow,D=s.getCell(G,z,!0);if(D&&D.nodeName!=="TH"){const ge=s.rowIndexMapper.getRenderableFromVisualIndex(G),Le=s.columnIndexMapper.getRenderableFromVisualIndex(z);s.view._wt.getSetting("cellRenderer",ge,Le,D)}w(x)}QS(E)&&(E=function(x){return function(A,z){z(x.test(A))}}(E)),_e(E)?(f=s.runHooks("beforeValidate",f,m.visualRow,m.prop,y),s._registerImmediate(()=>{E.call(m,f,x=>{s&&(x=s.runHooks("afterValidate",x,f,m.visualRow,m.prop,y),m.valid=x,T(x),s.runHooks("postAfterValidate",x,f,m.visualRow,m.prop,y))})})):s._registerImmediate(()=>{m.valid=!0,T(m.valid,!1)})};function Vn(f,m,w){return Array.isArray(f)?f:[[f,m,w]]}function wt(f,m){const w=s.getActiveEditor(),y=s.runHooks("beforeChange",f,m||"edit"),E=f.filter(T=>T!==null);return y===!1||E.length===0?(w&&w.cancelChanges(),[]):E}this.setDataAtCell=function(f,m,w,y){const E=Vn(f,m,w),T=[];let x=y,A,z,G;for(A=0,z=E.length;A<z;A++){if(typeof E[A]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof E[A][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");E[A][1]>=this.countCols()?G=E[A][1]:G=l.colToProp(E[A][1]),T.push([E[A][0],G,a.getAtCell(this.toPhysicalRow(E[A][0]),E[A][1]),E[A][2]])}!x&&typeof f=="object"&&(x=m);const D=wt(T,y);s.runHooks("afterSetDataAtCell",D,x),We(D,x,()=>{Rt(D,x)})},this.setDataAtRowProp=function(f,m,w,y){const E=Vn(f,m,w),T=[];let x=y,A,z;for(A=0,z=E.length;A<z;A++)T.push([E[A][0],E[A][1],a.getAtCell(this.toPhysicalRow(E[A][0]),E[A][1]),E[A][2]]);!x&&typeof f=="object"&&(x=m);const G=wt(T,y);s.runHooks("afterSetDataAtRowProp",G,x),We(G,x,()=>{Rt(G,x)})},this.listen=function(){s&&!s.isListening()&&($f.forEach(f=>{s!==f&&f.unlisten()}),kf=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(kf=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return kf===s.guid},this.destroyEditor=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;u.closeEditor(f),s.view.render(),m&&N.isSelected()&&u.prepareEditor()},this.populateFromArray=function(f,m,w,y,E,T,x){if(!(typeof w=="object"&&typeof w[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const A=typeof y=="number"?s._createCellCoords(y,E):null;return h.populateFromArray(s._createCellCoords(f,m),w,A,T,x)},this.spliceCol=function(f,m,w){for(var y=arguments.length,E=new Array(y>3?y-3:0),T=3;T<y;T++)E[T-3]=arguments[T];return l.spliceCol(f,m,w,...E)},this.spliceRow=function(f,m,w){for(var y=arguments.length,E=new Array(y>3?y-3:0),T=3;T<y;T++)E[T-3]=arguments[T];return l.spliceRow(f,m,w,...E)},this.getSelected=function(){if(N.isSelected())return ae(N.getSelectedRange(),f=>{let{from:m,to:w}=f;return[m.row,m.col,w.row,w.col]})},this.getSelectedLast=function(){const f=this.getSelected();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.getSelectedRange=function(){if(N.isSelected())return Array.from(N.getSelectedRange())},this.getSelectedRangeLast=function(){const f=this.getSelectedRange();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.emptySelectedCells=function(f){if(!N.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];b(N.getSelectedRange(),w=>{if(w.isSingleHeader())return;const y=w.getTopStartCorner(),E=w.getBottomEndCorner();j(y.row,E.row,T=>{j(y.col,E.col,x=>{this.getCellMeta(T,x).readOnly||m.push([T,x,null])})})}),m.length>0&&this.setDataAtCell(m,f)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const f=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(f,0),!this.isRenderSuspended()&&f===this.renderSuspendedCounter&&(this.renderCall?this.render():s.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(f){this.suspendRender();const m=f();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||f)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const w=f();return this.resumeExecution(m),w},this.batch=function(f){this.suspendRender(),this.suspendExecution();const m=f();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!s.view)return;const{width:f,height:m}=s.view.getLastSize(),{width:w,height:y}=s.rootElement.getBoundingClientRect(),E=w!==f||y!==m;s.runHooks("beforeRefreshDimensions",{width:f,height:m},{width:w,height:y},E)!==!1&&((E||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(w,y),s.render()),s.runHooks("afterRefreshDimensions",{width:f,height:m},{width:w,height:y},E))},this.updateData=function(f,m){Kb(f,w=>{l=w},w=>{l=w,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),h.adjustRowsAndCols(),N.refresh()},{hotInstance:s,dataMap:l,dataSource:a,internalSource:"updateData",source:m,metaManager:C,firstRun:g})},this.loadData=function(f,m){Kb(f,w=>{l=w},()=>{C.clearCellsCache(),s.initIndexMappers(),h.adjustRowsAndCols(),N.refresh(),g&&(g=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:a,internalSource:"loadData",source:m,metaManager:C,firstRun:g})},this.getInitialColumnCount=function(){const f=S.columns;let m=0;if(Array.isArray(f))m=f.length;else if(_e(f))if(s.dataType==="array"){const w=this.countSourceCols();for(let y=0;y<w;y+=1)f(y)&&(m+=1)}else(s.dataType==="object"||s.dataType==="function")&&(m=l.colToPropCache.length);else if(F(S.dataSchema)){const w=l.getSchema();m=Array.isArray(w)?w.length:Ad(w)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(f,m,w,y){return Ne(f)?l.getAll():l.getRange(s._createCellCoords(f,m),s._createCellCoords(w,y),l.DESTINATION_RENDERER)},this.getCopyableText=function(f,m,w,y){return l.getCopyableText(s._createCellCoords(f,m),s._createCellCoords(w,y))},this.getCopyableData=function(f,m){return l.getCopyable(f,l.colToProp(m))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=(g?s.loadData:s.updateData).bind(this);let y=!1,E,T;if(F(f.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(F(f.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(F(f.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(E in f)E==="data"||(E==="language"?ie(f.language):E==="className"?Ie("className",f.className):E==="tableClassName"&&s.table?(Ie("tableClassName",f.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):V.getSingleton().isRegistered(E)||V.getSingleton().isDeprecated(E)?(_e(f[E])||Array.isArray(f[E]))&&(f[E].initialHook=!0,s.addHook(E,f[E])):!m&&je(f,E)&&(R[E]=f[E]));f.data===void 0&&S.data===void 0?w(null,"updateSettings"):f.data!==void 0?w(f.data,"updateSettings"):f.columns!==void 0&&(l.createMap(),s.initIndexMappers());const x=s.countCols(),A=S.columns;if(A&&_e(A)&&(y=!0),(f.cell!==void 0||f.cells!==void 0||f.columns!==void 0)&&C.clearCache(),x>0)for(E=0,T=0;E<x;E++){if(A){const D=y?A(E):A[T];D&&C.updateColumnMeta(T,D)}T+=1}F(f.cell)&&te(f.cell,D=>{s.setCellMetaObject(D.row,D.col,D)}),s.runHooks("afterCellMetaReset");let z=s.rootElement.style.height;z!==""&&(z=parseInt(s.rootElement.style.height,10));let G=f.height;if(_e(G)&&(G=G()),m&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),G===null){const D=s.rootElement.getAttribute("data-initialstyle");D&&(D.indexOf("height")>-1||D.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",D):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else G!==void 0&&(s.rootElement.style.height=isNaN(G)?`${G}`:`${G}px`,s.rootElement.style.overflow="hidden");if(typeof f.width<"u"){let D=f.width;_e(D)&&(D=D()),s.rootElement.style.width=isNaN(D)?`${D}`:`${D}px`}m||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",f)),h.adjustRowsAndCols(),s.view&&!g&&(s.forceFullRender=!0,s.view.render(),s.view._wt.wtOverlays.adjustElementsSize()),!m&&s.view&&(z===""||G===""||G===void 0)&&z!==G&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const f=s.getSelectedLast();if(S.getValue){if(_e(S.getValue))return S.getValue.call(s);if(f)return s.getData()[f[0][0]][S.getValue]}else if(f)return s.getDataAtCell(f[0],f[1])},this.getSettings=function(){return S},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(f,m,w,y,E){h.alter(f,m,w,y,E)},this.getCell=function(f,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,y=m,E=f;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;y=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(f>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(f)))return null;E=this.rowIndexMapper.getRenderableFromVisualIndex(f)}return E===null||y===null||E===void 0||y===void 0?null:s.view.getCellAtCoords(s._createCellCoords(E,y),w)},this.getCoords=function(f){const m=this.view._wt.wtTable.getCoords(f);if(m===null)return null;const{row:w,col:y}=m;let E=w,T=y;return w>=0&&(E=this.rowIndexMapper.getVisualFromRenderableIndex(w)),y>=0&&(T=this.columnIndexMapper.getVisualFromRenderableIndex(y)),s._createCellCoords(E,T)},this.colToProp=function(f){return l.colToProp(f)},this.propToCol=function(f){return l.propToCol(f)},this.toVisualRow=f=>this.rowIndexMapper.getVisualFromPhysicalIndex(f),this.toVisualColumn=f=>this.columnIndexMapper.getVisualFromPhysicalIndex(f),this.toPhysicalRow=f=>this.rowIndexMapper.getPhysicalFromVisualIndex(f),this.toPhysicalColumn=f=>this.columnIndexMapper.getPhysicalFromVisualIndex(f),this.getDataAtCell=function(f,m){return l.get(f,l.colToProp(m))},this.getDataAtRowProp=function(f,m){return l.get(f,m)},this.getDataAtCol=function(f){const m=[],w=l.getRange(s._createCellCoords(0,f),s._createCellCoords(S.data.length-1,f),l.DESTINATION_RENDERER);for(let y=0;y<w.length;y+=1)for(let E=0;E<w[y].length;E+=1)m.push(w[y][E]);return m},this.getDataAtProp=function(f){const m=[],w=l.getRange(s._createCellCoords(0,l.propToCol(f)),s._createCellCoords(S.data.length-1,l.propToCol(f)),l.DESTINATION_RENDERER);for(let y=0;y<w.length;y+=1)for(let E=0;E<w[y].length;E+=1)m.push(w[y][E]);return m},this.getSourceData=function(f,m,w,y){let E;return f===void 0?E=a.getData():E=a.getByRange(s._createCellCoords(f,m),s._createCellCoords(w,y)),E},this.getSourceDataArray=function(f,m,w,y){let E;return f===void 0?E=a.getData(!0):E=a.getByRange(s._createCellCoords(f,m),s._createCellCoords(w,y),!0),E},this.getSourceDataAtCol=function(f){return a.getAtColumn(f)},this.setSourceDataAtCell=function(f,m,w,y){const E=Vn(f,m,w),T=this.hasHook("afterSetSourceDataAtCell"),x=[];T&&b(E,z=>{let[G,D,ge]=z;x.push([G,D,a.getAtCell(G,D),ge])}),b(E,z=>{let[G,D,ge]=z;a.setAtCell(G,D,ge)}),T&&this.runHooks("afterSetSourceDataAtCell",x,y),this.render();const A=s.getActiveEditor();A&&F(A.refreshValue)&&A.refreshValue()},this.getSourceDataAtRow=function(f){return a.getAtRow(f)},this.getSourceDataAtCell=function(f,m){return a.getAtCell(f,m)},this.getDataAtRow=function(f){return l.getRange(s._createCellCoords(f,0),s._createCellCoords(f,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(f,m,w,y){const E=f===void 0?[0,0,this.countRows(),this.countCols()]:[f,m,w,y],[T,x]=E;let[,,A,z]=E,G=null,D=null;A===void 0&&(A=T),z===void 0&&(z=x);let ge="mixed";return j(Math.max(Math.min(T,A),0),Math.max(T,A),Le=>{let me=!0;return j(Math.max(Math.min(x,z),0),Math.max(x,z),et=>(D=this.getCellMeta(Le,et).type,G?me=G===D:G=D,me)),ge=me?D:"mixed",me}),ge},this.removeCellMeta=function(f,m,w){const[y,E]=[this.toPhysicalRow(f),this.toPhysicalColumn(m)];let T=C.getCellMetaKeyValue(y,E,w);s.runHooks("beforeRemoveCellMeta",f,m,w,T)!==!1&&(C.removeCellMeta(y,E,w),s.runHooks("afterRemoveCellMeta",f,m,w,T)),T=null},this.spliceCellsMeta=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var w=arguments.length,y=new Array(w>2?w-2:0),E=2;E<w;E++)y[E-2]=arguments[E];if(y.length>0&&!Array.isArray(y[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&C.removeRow(this.toPhysicalRow(f),m),y.length>0&&b(y.reverse(),T=>{C.createRow(this.toPhysicalRow(f)),b(T,(x,A)=>this.setCellMetaObject(f,A,x))}),s.render()},this.setCellMetaObject=function(f,m,w){typeof w=="object"&&te(w,(y,E)=>{this.setCellMeta(f,m,E,y)})},this.setCellMeta=function(f,m,w,y){if(s.runHooks("beforeSetCellMeta",f,m,w,y)===!1)return;let T=f,x=m;f<this.countRows()&&(T=this.toPhysicalRow(f)),m<this.countCols()&&(x=this.toPhysicalColumn(m)),C.setCellMeta(T,x,w,y),s.runHooks("afterSetCellMeta",f,m,w,y)},this.getCellsMeta=function(){return C.getCellsMeta()},this.getCellMeta=function(f,m){let w=this.toPhysicalRow(f),y=this.toPhysicalColumn(m);return w===null&&(w=f),y===null&&(y=m),C.getCellMeta(w,y,{visualRow:f,visualColumn:m})},this.getColumnMeta=function(f){return C.getColumnMeta(this.toPhysicalColumn(f))},this.getCellMetaAtRow=function(f){return C.getCellsMetaAtRow(f)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||S.columns)},this.getCellRenderer=function(f,m){const w=typeof f=="number"?s.getCellMeta(f,m).renderer:f.renderer;return typeof w=="string"?Lc(w):Ne(w)?Lc("text"):w},this.getCellEditor=function(f,m){const w=typeof f=="number"?s.getCellMeta(f,m).editor:f.editor;return typeof w=="string"?Dc(w):Ne(w)?Dc("text"):w},this.getCellValidator=function(f,m){const w=typeof f=="number"?s.getCellMeta(f,m).validator:f.validator;return typeof w=="string"?Tp(w):w},this.validateCells=function(f){this._validateCells(f)},this.validateRows=function(f,m){if(!Array.isArray(f))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,f)},this.validateColumns=function(f,m){if(!Array.isArray(f))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,f)},this._validateCells=function(f,m,w){const y=new oe;f&&(y.onQueueEmpty=f);let E=s.countRows()-1;for(;E>=0;){if(m!==void 0&&m.indexOf(E)===-1){E-=1;continue}let T=s.countCols()-1;for(;T>=0;){if(w!==void 0&&w.indexOf(T)===-1){T-=1;continue}y.addValidatorToQueue(),s.validateCell(s.getDataAtCell(E,T),s.getCellMeta(E,T),x=>{if(typeof x!="boolean")throw new Error("Validation error: result is not boolean");x===!1&&(y.valid=!1),y.removeValidatorFormQueue()},"validateCells"),T-=1}E-=1}y.checkIfQueueIsEmpty()},this.getRowHeader=function(f){let m=S.rowHeaders,w=f;return w!==void 0&&(w=s.runHooks("modifyRowHeader",w)),w===void 0?(m=[],j(s.countRows()-1,y=>{m.push(s.getRowHeader(y))})):Array.isArray(m)&&m[w]!==void 0?m=m[w]:_e(m)?m=m(w):m&&typeof m!="string"&&typeof m!="number"&&(m=w+1),m},this.hasRowHeaders=function(){return!!S.rowHeaders},this.hasColHeaders=function(){if(S.colHeaders!==void 0&&S.colHeaders!==null)return!!S.colHeaders;for(let f=0,m=s.countCols();f<m;f++)if(s.getColHeader(f))return!0;return!1},this.getColHeader=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const w=s.runHooks("modifyColHeader",f);if(w===void 0){const A=[],z=s.countCols();for(let G=0;G<z;G++)A.push(s.getColHeader(G));return A}let y=S.colHeaders;const E=function(A){const z=[],G=s.countCols();let D=0;for(;D<G;D++)_e(S.columns)&&S.columns(D)&&z.push(D);return z[A]},T=s.toPhysicalColumn(w),x=E(T);return S.colHeaders===!1?y=null:S.columns&&_e(S.columns)&&S.columns(x)&&S.columns(x).title?y=S.columns(x).title:S.columns&&S.columns[T]&&S.columns[T].title?y=S.columns[T].title:Array.isArray(S.colHeaders)&&S.colHeaders[T]!==void 0?y=S.colHeaders[T]:_e(S.colHeaders)?y=S.colHeaders(T):S.colHeaders&&typeof S.colHeaders!="string"&&typeof S.colHeaders!="number"&&(y=$d(w)),y=s.runHooks("modifyColumnHeaderValue",y,f,m),y},this._getColWidthFromSettings=function(f){let m;if(f>=0&&(m=s.getCellMeta(0,f).width),(m===void 0||m===S.width)&&(m=S.colWidths),m!=null){switch(typeof m){case"object":m=m[f];break;case"function":m=m(f);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(f){let m=s._getColWidthFromSettings(f);return m=s.runHooks("modifyColWidth",m,f),m===void 0&&(m=Dd),m},this._getRowHeightFromSettings=function(f){let m=S.rowHeights;if(m!=null){switch(typeof m){case"object":m=m[f];break;case"function":m=m(f);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(f){let m=s._getRowHeightFromSettings(f);return m=s.runHooks("modifyRowHeight",m,f),m},this.countSourceRows=function(){return a.countRows()},this.countSourceCols=function(){return a.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const f=S.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(f,m)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return wm(s.countRows()-1,w=>{if(s.isEmptyRow(w))m+=1;else if(f===!0)return!1}),m},this.countEmptyCols=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return wm(s.countCols()-1,w=>{if(s.isEmptyCol(w))m+=1;else if(f===!0)return!1}),m},this.isEmptyRow=function(f){return S.isEmptyRow.call(s,f)},this.isEmptyCol=function(f){return S.isEmptyCol.call(s,f)},this.selectCell=function(f,m,w,y){let E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,T=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Ne(f)||Ne(m)?!1:this.selectCells([[f,m,w,y]],E,T)},this.selectCells=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&d.suspend();const y=N.selectCells(f);return y&&w&&s.listen(),d.resume(),y},this.selectColumns=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;return N.selectColumns(f,m,w)},this.selectRows=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;return N.selectRows(f,m,w)},this.deselectCell=function(){N.deselect()},this.selectAll=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),N.selectAll(f,m,w)};const re=(f,m)=>f.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(f){var m;if(typeof f=="number"){var w;f={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(w=arguments[4])!==null&&w!==void 0?w:!0}}const{row:y,col:E,verticalSnap:T,horizontalSnap:x,considerHiddenIndexes:A}=(m=f)!==null&&m!==void 0?m:{};let z,G,D,ge;T!==void 0&&(z=T==="top",G=!z),x!==void 0&&(D=x==="start",ge=!D);let Le=y,me=E;if(A===void 0||A){const kt=Number.isInteger(y)&&y>=0,$t=Number.isInteger(E)&&E>=0,Tt=kt?re(this.rowIndexMapper,y):void 0,Fn=$t?re(this.columnIndexMapper,E):void 0;if(Tt===null||Fn===null)return!1;Le=kt?s.rowIndexMapper.getRenderableFromVisualIndex(Tt):y,me=$t?s.columnIndexMapper.getRenderableFromVisualIndex(Fn):E}const et=Number.isInteger(Le),Lt=Number.isInteger(me);return et&&Le>=0&&Lt&&me>=0?s.view.scrollViewport(s._createCellCoords(Le,me),z,ge,G,D):et&&Le>=0&&(Lt&&me<0||!Lt)?s.view.scrollViewportVertically(Le,z,G):Lt&&me>=0&&(et&&Le<0||!et)?s.view.scrollViewportHorizontally(me,ge,D):!1},this.scrollToFocusedCell=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",f);const{highlight:m}=this.getSelectedRangeLast();this.scrollViewportTo(m.toObject())?this.view.render():(this.removeHook("afterScroll",f),this._registerImmediate(()=>f()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),a&&a.destroy(),a=null,this.getShortcutManager().destroy(),C.clearCache(),$f.delete(this.guid),wc(s)){const f=this.rootDocument.querySelector(".hot-display-license-info");f&&f.parentNode.removeChild(f)}si(s.rootElement),r.destroy(),u&&u.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),M.getItems().forEach(f=>{let[,m]=f;m.destroy()}),M.clear(),s.runHooks("afterDestroy")},!0),V.getSingleton().destroy(s),te(s,(f,m,w)=>{_e(f)?w[m]=fe(m):m!=="guid"&&(w[m]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,h=null,N=null,u=null,s=null};function fe(f){return()=>{throw new Error(`The "${f}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return u.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(f){const m=Nt(f);return m==="UndoRedo"?this.undoRedo:M.getItem(m)},this.getPluginName=function(f){return f===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:M.getId(f)},this.getInstance=function(){return s},this.addHook=function(f,m,w){V.getSingleton().add(f,m,s,w)},this.hasHook=function(f){return V.getSingleton().has(f,s)||V.getSingleton().has(f)},this.addHookOnce=function(f,m,w){V.getSingleton().once(f,m,s,w)},this.removeHook=function(f,m){V.getSingleton().remove(f,m,s)},this.runHooks=function(f,m,w,y,E,T,x){return V.getSingleton().run(s,f,m,w,y,E,T,x)},this.getTranslatedPhrase=function(f,m){return TR(S.language,f,m)},this.toHTML=()=>mm(this),this.toTableElement=()=>{const f=this.rootDocument.createElement("div");return f.insertAdjacentHTML("afterbegin",mm(this)),f.firstElementChild},this.timeouts=[],this._registerTimeout=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=f;typeof w=="function"&&(w=setTimeout(w,m)),this.timeouts.push(w)},this._clearTimeouts=function(){b(this.timeouts,f=>{clearTimeout(f)})},this.immediates=[],this._registerImmediate=function(f){this.immediates.push(setImmediate(f))},this._clearImmediates=function(){b(this.immediates,f=>{clearImmediate(f)})},this._getEditorManager=function(){return u},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const To=D_({handleEvent(){return s.isListening()},beforeKeyDown:f=>this.runHooks("beforeKeyDown",f),afterKeyDown:f=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",f)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",f=>{f.ctrlKey===!1&&f.metaKey===!1&&To.releasePressedKeys()}),this.getShortcutManager=function(){return To},this.getFocusManager=function(){return c},Ep().forEach(f=>{const m=Eh(f);M.addItem(f,new m(this))}),C_(s),To.setActiveContextName("grid"),V.getSingleton().run(s,"construct")}function ev(n,e,t){n.addEventListener(e,t,!1)}function tv(n,e,t){n.removeEventListener(e,t,!1)}function nv(n){return n.ownerDocument.defaultView.getComputedStyle(n)}function L_(n){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},t=n.body,i=n.createTextNode(""),o=n.createElement("span");let s;function r(){i.textContent=s.value,o.style.position="absolute",o.style.fontSize=nv(s).fontSize,o.style.fontFamily=nv(s).fontFamily,o.style.whiteSpace="pre",t.appendChild(o);const u=o.clientWidth+2;t.removeChild(o);const c=s.style;c.height=`${e.minHeight}px`,e.minWidth>u?c.width=`${e.minWidth}px`:u>e.maxWidth?c.width=`${e.maxWidth}px`:c.width=`${u}px`;const d=s.scrollHeight?s.scrollHeight-1:0;e.minHeight>d?c.height=`${e.minHeight}px`:e.maxHeight<d?(c.height=`${e.maxHeight}px`,c.overflowY="visible"):c.height=`${d}px`}function l(){n.defaultView.setTimeout(r,0)}function a(u){if(u&&u.minHeight)if(u.minHeight==="inherit")e.minHeight=s.clientHeight;else{const c=parseInt(u.minHeight,10);isNaN(c)||(e.minHeight=c)}if(u&&u.maxHeight)if(u.maxHeight==="inherit")e.maxHeight=s.clientHeight;else{const c=parseInt(u.maxHeight,10);isNaN(c)||(e.maxHeight=c)}if(u&&u.minWidth)if(u.minWidth==="inherit")e.minWidth=s.clientWidth;else{const c=parseInt(u.minWidth,10);isNaN(c)||(e.minWidth=c)}if(u&&u.maxWidth)if(u.maxWidth==="inherit")e.maxWidth=s.clientWidth;else{const c=parseInt(u.maxWidth,10);isNaN(c)||(e.maxWidth=c)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function h(u,c){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=u,a(c),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${e.minHeight}px`,s.style.minWidth=`${e.minWidth}px`,s.style.maxWidth=`${e.maxWidth}px`,s.style.overflowY="hidden"),d&&(ev(s,"input",r),ev(s,"keydown",l)),r()}return{init:h,resize:r,unObserve(){tv(s,"input",r),tv(s,"keydown",l)}}}function iv(n,e){const t=hp(e),i=e.value.split(`
`);let o=t,s=0;for(let r=0;r<i.length;r++){const l=i[r];r!==0&&(s+=i[r-1].length+1);const a=s+l.length;if(n==="home"?o=s:n==="end"&&(o=a),t<=a)break}Sh(e,o)}function Rs(n,e,t){return(e=k_(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function k_(n){var e=$_(n,"string");return typeof e=="symbol"?e:e+""}function $_(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const V_="ht_editor_visible",wu="ht_editor_hidden",ov="textEditor",F_="text";class br extends Pl{static get EDITOR_TYPE(){return F_}constructor(e){super(e),Rs(this,"eventManager",new kn(this)),Rs(this,"autoResize",L_(this.hot.rootDocument)),Rs(this,"TEXTAREA",void 0),Rs(this,"textareaStyle",void 0),Rs(this,"TEXTAREA_PARENT",void 0),Rs(this,"textareaParentStyle",void 0),Rs(this,"layerClass",void 0),this.eventManager=new kn(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),ry(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,i,o,s,r){const l=this.state;if(super.prepare(e,t,i,o,s,r),!r.readOnly){this.refreshDimensions(!0);const{allowInvalid:a}=r;a&&!this.isOpened()&&(this.TEXTAREA.value=""),l!==nt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,t){this.state===nt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),Sh(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Y(this.TEXTAREA,[["data-hot-input",""],Rl(-1)]),P(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),P(this.TEXTAREA_PARENT,"handsontableInputHolder"),K(this.TEXTAREA_PARENT,this.layerClass)&&X(this.TEXTAREA_PARENT,this.layerClass),P(this.TEXTAREA_PARENT,wu),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Iy()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",X(this.TEXTAREA_PARENT,this.layerClass),P(this.TEXTAREA_PARENT,wu)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;j(e.length-1,i=>{const o=e[i];if(K(o,"handsontableEditor"))return t=!0,!1}),K(this.TEXTAREA_PARENT,wu)&&X(this.TEXTAREA_PARENT,wu),t?(this.layerClass=V_,P(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),P(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==nt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:t,start:i,width:o,maxWidth:s,height:r,maxHeight:l}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();const a=Ui(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=a.fontSize,this.TEXTAREA.style.fontFamily=a.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const h=Ui(this.TEXTAREA),u=parseInt(h.paddingLeft,10)+parseInt(h.paddingRight,10),c=parseInt(h.paddingTop,10)+parseInt(h.paddingBottom,10),d=o-u,g=r-c,p=s-u,v=l-c;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(d,p),minHeight:Math.min(g,v),maxWidth:p,maxHeight:v},!0)}bindEvents(){wp()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===nt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===nt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>F(this.hot.getSelected()),group:ov},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};t.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(o(),!1)},{keys:[["Home"]],callback:(s,r)=>{let[l]=r;iv(l,this.TEXTAREA)}},{keys:[["End"]],callback:(s,r)=>{let[l]=r;iv(l,this.TEXTAREA)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(ov)}}const W_="base";function Hh(n,e,t,i,o,s,r){const l=r.ariaTags,a=[],h=[],u=[],c=[];r.className&&P(e,r.className),r.readOnly?(a.push(r.readOnlyCellClassName),l&&c.push(rb())):l&&u.push(rb()[0]),r.valid===!1&&r.invalidCellClassName?(a.push(r.invalidCellClassName),l&&c.push(lb())):(h.push(r.invalidCellClassName),l&&u.push(lb()[0])),r.wordWrap===!1&&r.noWordWrapClassName&&a.push(r.noWordWrapClassName),!s&&r.placeholder&&a.push(r.placeholderCellClassName),X(e,h),P(e,a),pr(e,u),Y(e,c)}Hh.RENDERER_TYPE=W_;const B_="text";function Eo(n,e,t,i,o,s,r){Hh.apply(this,[n,e,t,i,o,s,r]);let l=s;if(!l&&r.placeholder&&(l=r.placeholder),l=Qe(l),r.trimWhitespace&&(l=l.trim()),r.rendererTemplate){si(e);const a=n.rootDocument.createElement("TEMPLATE");a.setAttribute("bind","{{}}"),a.innerHTML=r.rendererTemplate,HTMLTemplateElement.decorate(a),a.model=n.getSourceDataAtRow(t),e.appendChild(a)}else rs(e,l)}Eo.RENDERER_TYPE=B_;const j_="text",FR={CELL_TYPE:j_,editor:br,renderer:Eo};Mn(FR);q.editors={BaseEditor:Pl};function q(n,e){const t=new VR(n,e||{},Bp);return t.init(),t}q.Core=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new VR(n,e,Bp)};q.DefaultSettings=_R();q.hooks=V.getSingleton();q.CellCoords=hr;q.CellRange=Th;q.packageName="handsontable";q.buildDate="07/02/2025 16:13:23";q.version="14.6.2";q.languages={dictionaryKeys:sx,getLanguageDictionary:ER,getLanguagesDictionaries:ux,registerLanguageDictionary:RR,getTranslatedPhrase:TR};const sv="handsontableEditor",U_="handsontable";class gC extends br{static get EDITOR_TYPE(){return U_}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Sh(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,i,o,s,r){super.prepare(e,t,i,o,s,r);const l=this,a={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(h,u){const c=this.getSourceData(u.row,u.col);c!==void 0&&l.setValue(c),l.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&lt(a,r.handsontable),this.htOptions=a}beginEditing(e,t){const i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const o=this.htEditor.getValue();o!==void 0&&this.setValue(o)}super.finishEditing(e,t,i)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i={group:sv,relativeToGroup:cs,position:"before"},o=(s,r)=>{const l=this.htEditor;if(s!==void 0&&(s<0||l.flipped&&s>l.countRows()-1?l.deselectCell():l.selectCell(s,0),l.getData().length))return r.preventDefault(),$n(r),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const r=this.htEditor;let l,a;return!r.getSelectedLast()&&r.flipped?l=r.countRows()-1:r.getSelectedLast()&&(r.flipped?(a=r.getSelectedLast()[0],l=Math.max(0,a-1)):(a=r.getSelectedLast()[0],l=a-1)),o(l,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const r=this.htEditor;let l,a;if(!r.getSelectedLast()&&!r.flipped)l=0;else if(r.getSelectedLast()){if(r.flipped)l=r.getSelectedLast()[0]+1;else if(!r.flipped){const h=r.countRows()-1;a=r.getSelectedLast()[0],l=Math.min(h,a+1)}}return o(l,s)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(sv)}}function z_(n,e,t){G_(n,e),e.set(n,t)}function G_(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cu(n,e,t){return(e=Y_(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Y_(n){var e=K_(n,"string");return typeof e=="symbol"?e:e+""}function K_(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function rv(n,e){return n.get(X_(n,e))}function X_(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const q_="autocomplete";var Vf=new WeakMap;class mC extends gC{constructor(){super(...arguments),Cu(this,"query",null),Cu(this,"strippedChoices",[]),Cu(this,"rawChoices",[]),z_(this,Vf,this.hot.guid.slice(0,9)),Cu(this,"sortByRelevance",function(e,t,i){const o=[],s=[],r=e.length;let l=t.length,a,h,u,c;if(r===0){for(u=0;u<l;u++)s.push(u);return s}for(u=0;u<l;u++){if(h=hm(Qe(t[u])),i)c=h.indexOf(e);else{const d=this.cellProperties.locale;c=h.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}c!==-1&&(a=h.length-c-r,o.push({baseIndex:u,index:c,charsLeft:a,value:h}))}for(o.sort((d,g)=>{if(g.index===-1)return-1;if(d.index===-1)return 1;if(d.index<g.index)return-1;if(g.index<d.index)return 1;if(d.index===g.index){if(d.charsLeft<g.charsLeft)return-1;if(d.charsLeft>g.charsLeft)return 1}return 0}),u=0,l=o.length;u<l;u++)s.push(o[u].baseIndex);return s})}static get EDITOR_TYPE(){return q_}getValue(){const e=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return F(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),P(this.htContainer,"autocompleteEditor"),P(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Y(this.TEXTAREA,[mM(),uM(),ty("listbox"),bM()])}prepare(e,t,i,o,s,r){super.prepare(e,t,i,o,s,r),this.hot.getSettings().ariaTags&&Y(this.TEXTAREA,[Ln("false"),vM(`${rv(Vf,this)}-listbox-${e}-${t}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,o=i==null?void 0:i.length,{row:s,col:r}=this;this.showEditableElement(),this.focus();let l=pt();l===0&&lh()&&(l+=15),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.updateSettings({colWidths:e?[De(this.TEXTAREA)-2]:void 0,width:e?De(this.TEXTAREA)+l:void 0,autoColumnSize:!0,renderer:(a,h,u,c,d,g,p)=>{Eo(a,h,u,c,d,g,p);const{filteringCaseSensitive:v,allowHtml:C,locale:S}=this.cellProperties,R=this.query;let M=Qe(g),I,H;M&&!C&&(I=v===!0?M.indexOf(R):M.toLocaleLowerCase(S).indexOf(R.toLocaleLowerCase(S)),I!==-1&&(H=M.substr(I,R.length),M=M.replace(H,`<strong>${H}</strong>`))),t&&Y(h,[cM(),...i?[EM(o)]:[],...i?[TM(i.indexOf(g)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),h.innerHTML=M},afterSelectionEnd:(a,h)=>{if(t){const u=this.htEditor.getCell(a,h,!0);Y(u,[op()]),Y(this.TEXTAREA,...SM(u.id))}}}),t&&(Y(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Wi()),Y(this.htEditor.rootElement,[ey(),yM("polite"),RM("text"),["id",`${rv(Vf,this)}-listbox-${s}-${r}`]]),Y(this.TEXTAREA,...Ln("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Y(this.TEXTAREA,[Ln("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,typeof t=="function"?t.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=hp(this.TEXTAREA),i=gy(this.TEXTAREA),o=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let r=null,l=null,a=e;o&&(r=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),a,this.cellProperties.filteringCaseSensitive));const h=Array.isArray(r)?r.length:0;if(s===!1)h&&(l=r[0]);else{const u=[];for(let c=0,d=a.length;c<d&&!(o&&h<=c);c++)h?u.push(a[r[c]]):u.push(a[c]);l=0,a=u}this.strippedChoices=a,a.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Da([a])),a.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(l)),this.hot.listen(),Sh(this.TEXTAREA,t,t===i?void 0:i)}flipDropdownIfNeeded(){const e=ar(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,i=this.cellProperties.preventOverflow;if(t||!t&&(i||i==="horizontal"))return!1;const o=mt(this.TEXTAREA),s=ot(this.TEXTAREA),r=this.getDropdownHeight(),l=e.scrollTop,a=ot(this.hot.view._wt.wtTable.THEAD),h=mt(e),u=o.top-h.top-a+l,c=e.scrollHeight-u-a-s,d=r>c&&u>c;return d?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(d?u:c,r),d}limitDropdownIfNeeded(e,t){if(t>e){let i=0,o=0,s=0,r=null;do s=this.htEditor.getRowHeight(o)||this.htEditor.view._wt.getSetting("defaultRowHeight"),i+=s,o+=1;while(i<e);r=i-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-r}px`),this.setDropdownHeight(i-s)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){const e=this.htEditor.getColWidth(0)+pt(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,i=ae(e,s=>Qe(s));return ae(i,s=>t?s:hm(s))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),i={row:t?t.from.row:-1};let o=!1;return e===B.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(o=!0),e===B.ARROW_UP&&i.row>-1&&(o=!0),o}onBeforeKeyDown(e){if(Hy(e.keyCode)||e.keyCode===B.BACKSPACE||e.keyCode===B.DELETE||e.keyCode===B.INSERT){let t=10;if(e.keyCode===B.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},t)}}}const Q_="checkbox";class WR extends Pl{static get EDITOR_TYPE(){return Q_}beginEditing(e,t){if(t&&t.type==="mouseup"&&t.target.nodeName==="TD"){const i=this.TD.querySelector('input[type="checkbox"]');K(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Qo=()=>window,An=()=>window.document,Pm=(n,e)=>window.setTimeout(n,e),xi=function(n,e,t,i){n.addEventListener(e,t,!!i)},Zi=function(n,e,t,i){n.removeEventListener(e,t,!!i)},J_=function(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")},un=function(n,e){return(" "+n.className+" ").indexOf(" "+e+" ")!==-1},Ff=function(n,e){un(n,e)||(n.className=n.className===""?e:n.className+" "+e)},Wf=function(n,e){n.className=J_((" "+n.className+" ").replace(" "+e+" "," "))},pC=function(n){return/Array/.test(Object.prototype.toString.call(n))},gn=function(n){return/Date/.test(Object.prototype.toString.call(n))&&!isNaN(n.getTime())},Z_=function(n){let e=n.getDay();return e===0||e===6},eO=function(n){return n%4===0&&n%100!==0||n%400===0},lv=function(n,e){return[31,eO(n)?29:28,31,30,31,30,31,31,30,31,30,31][e]},bu=function(n){gn(n)&&n.setHours(0,0,0,0)},vu=function(n,e){return n.getTime()===e.getTime()},Xc=function(n,e,t){let i,o;for(i in e)o=n[i]!==void 0,o&&typeof e[i]=="object"&&e[i]!==null&&e[i].nodeName===void 0?gn(e[i])?t&&(n[i]=new Date(e[i].getTime())):pC(e[i])?t&&(n[i]=e[i].slice(0)):n[i]=Xc({},e[i],t):(t||!o)&&(n[i]=e[i]);return n},av=function(n,e,t){let i=An().createEvent("HTMLEvents");i.initEvent(e,!0,!1),i=Xc(i,t),n.dispatchEvent(i)},hv=function(n){return n.month<0&&(n.year-=Math.ceil(Math.abs(n.month)/12),n.month+=12),n.month>11&&(n.year+=Math.floor(Math.abs(n.month)/12),n.month-=12),n},Ci={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},uv=function(n,e,t){for(e+=n.firstDay;e>=7;)e-=7;return t?n.i18n.weekdaysShort[e]:n.i18n.weekdays[e]},tO=function(n){let e=[],t="false";if(n.isEmpty)if(n.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),n.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return n.isDisabled&&e.push("is-disabled"),n.isToday&&e.push("is-today"),n.isSelected&&(e.push("is-selected"),t="true"),n.hasEvent&&e.push("has-event"),n.isInRange&&e.push("is-inrange"),n.isStartRange&&e.push("is-startrange"),n.isEndRange&&e.push("is-endrange"),'<td data-day="'+n.day+'" class="'+e.join(" ")+'" aria-selected="'+t+'"><button class="pika-button pika-day" type="button" data-pika-year="'+n.year+'" data-pika-month="'+n.month+'" data-pika-day="'+n.day+'">'+n.day+"</button></td>"},nO=function(n,e){n.setHours(0,0,0,0);let t=n.getDate(),i=n.getDay(),o=e,s=o-1,r=7,l=function(d){return(d+r-1)%r};n.setDate(t+s-l(i));let a=new Date(n.getFullYear(),0,o),h=24*60*60*1e3,u=(n.getTime()-a.getTime())/h;return 1+Math.round((u-s+l(a.getDay()))/r)},iO=function(n,e,t,i,o){let s=new Date(i,t,e);return'<td class="pika-week">'+(n.hasMoment?n.moment(s).isoWeek():nO(s,o))+"</td>"},oO=function(n,e,t,i){return'<tr class="pika-row'+(t?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(e?n.reverse():n).join("")+"</tr>"},sO=function(n){return"<tbody>"+n.join("")+"</tbody>"},rO=function(n){let e,t=[];for(n.showWeekNumber&&t.push("<th></th>"),e=0;e<7;e++)t.push('<th scope="col"><abbr title="'+uv(n,e)+'">'+uv(n,e,!0)+"</abbr></th>");return"<thead><tr>"+(n.isRTL?t.reverse():t).join("")+"</tr></thead>"},lO=function(n,e,t,i,o,s){let r,l,a,h=n._o,u=t===h.minYear,c=t===h.maxYear,d='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',g,p,v=!0,C=!0;for(a=[],r=0;r<12;r++)a.push('<option value="'+(t===o?r-e:12+r-e)+'"'+(r===i?' selected="selected"':"")+(u&&r<h.minMonth||c&&r>h.maxMonth?' disabled="disabled"':"")+">"+h.i18n.months[r]+"</option>");for(g='<div class="pika-label">'+h.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+a.join("")+"</select></div>",pC(h.yearRange)?(r=h.yearRange[0],l=h.yearRange[1]+1):(r=t-h.yearRange,l=1+t+h.yearRange),a=[];r<l&&r<=h.maxYear;r++)r>=h.minYear&&a.push('<option value="'+r+'"'+(r===t?' selected="selected"':"")+">"+r+"</option>");return p='<div class="pika-label">'+t+h.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+a.join("")+"</select></div>",h.showMonthAfterYear?d+=p+g:d+=g+p,u&&(i===0||h.minMonth>=i)&&(v=!1),c&&(i===11||h.maxMonth<=i)&&(C=!1),e===0&&(d+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+h.i18n.previousMonth+"</button>"),e===n._o.numberOfMonths-1&&(d+='<button class="pika-next'+(C?"":" is-disabled")+'" type="button">'+h.i18n.nextMonth+"</button>"),d+="</div>"},aO=function(n,e,t){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+t+'">'+rO(n)+sO(e)+"</table>"};function Im(n){let e=this,t=e.config(n);e._onMouseDown=function(o){if(!e._v)return;o=o||Qo().event;let s=o.target||o.srcElement;if(s)if(un(s,"is-disabled")||(un(s,"pika-button")&&!un(s,"is-empty")&&!un(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),t.bound&&Pm(function(){e.hide(),t.blurFieldOnSelect&&t.field&&t.field.blur()},100)):un(s,"pika-prev")?e.prevMonth():un(s,"pika-next")&&e.nextMonth()),un(s,"pika-select"))e._c=!0;else if(o.preventDefault)o.preventDefault();else return o.returnValue=!1,!1},e._onChange=function(o){o=o||Qo().event;let s=o.target||o.srcElement;s&&(un(s,"pika-select-month")?e.gotoMonth(s.value):un(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(o){if(o=o||Qo().event,e.isVisible())switch(o.keyCode){case 13:case 27:t.field&&t.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(t.parse)return t.parse(t.field.value,t.format);if(this.hasMoment){let o=this.moment(t.field.value,t.format,t.formatStrict);return o&&o.isValid()?o.toDate():null}else return new Date(Date.parse(t.field.value))},e._onInputChange=function(o){let s;o.firedBy!==e&&(s=e._parseFieldValue(),gn(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let o=An().activeElement;do if(un(o,"pika-single"))return;while(o=o.parentNode);e._c||(e._b=Pm(function(){e.hide()},50)),e._c=!1},e._onClick=function(o){o=o||Qo().event;let s=o.target||o.srcElement,r=s;if(s){!hasEventListeners&&un(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),xi(s,"change",e._onChange)));do if(un(r,"pika-single")||r===t.trigger)return;while(r=r.parentNode);e._v&&s!==t.trigger&&r!==t.trigger&&e.hide()}},e.el=An().createElement("div"),e.el.className="pika-single"+(t.isRTL?" is-rtl":"")+(t.theme?" "+t.theme:""),xi(e.el,"mousedown",e._onMouseDown,!0),xi(e.el,"touchend",e._onMouseDown,!0),xi(e.el,"change",e._onChange),t.keyboardInput&&xi(An(),"keydown",e._onKeyChange),t.field&&(t.container?t.container.appendChild(e.el):t.bound?An().body.appendChild(e.el):t.field.parentNode.insertBefore(e.el,t.field.nextSibling),xi(t.field,"change",e._onInputChange),t.defaultDate||(t.defaultDate=e._parseFieldValue(),t.setDefaultDate=!0));let i=t.defaultDate;gn(i)?t.setDefaultDate?e.setDate(i,!0):e.gotoDate(i):e.gotoDate(new Date),t.bound?(this.hide(),e.el.className+=" is-bound",xi(t.trigger,"click",e._onInputClick),xi(t.trigger,"focus",e._onInputFocus),xi(t.trigger,"blur",e._onInputBlur)):this.show()}Im.prototype={config:function(n){this._o||(this._o=Xc({},Ci,!0));let e=Xc(this._o,n,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let t=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=t>4?4:t,gn(e.minDate)||(e.minDate=!1),gn(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),pC(e.yearRange)){let i=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Ci.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(n){return n=n||this._o.format,gn(this._d)?this._o.toString?this._o.toString(this._d,n):this.hasMoment?this.moment(this._d).format(n):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(n,e){this.hasMoment&&this.moment.isMoment(n)&&this.setDate(n.toDate(),e)},useMoment:function(n){this.hasMoment=!0,this.moment=n},getDate:function(){return gn(this._d)?new Date(this._d.getTime()):null},setDate:function(n,e){if(!n)return this._d=null,this._o.field&&(this._o.field.value="",av(this._o.field,"change",{firedBy:this})),this.draw();if(typeof n=="string"&&(n=new Date(Date.parse(n))),!gn(n))return;let t=this._o.minDate,i=this._o.maxDate;gn(t)&&n<t?n=t:gn(i)&&n>i&&(n=i),this._d=new Date(n.getTime()),bu(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),av(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(n){let e=!0;if(gn(n)){if(this.calendars){let t=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),o=n.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=o<t.getTime()||i.getTime()<o}e&&(this.calendars=[{month:n.getMonth(),year:n.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(n,e){let t=this.getDate()||new Date,i=parseInt(e)*24*60*60*1e3,o;n==="add"?o=new Date(t.valueOf()+i):n==="subtract"&&(o=new Date(t.valueOf()-i)),this.setDate(o)},adjustCalendars:function(){this.calendars[0]=hv(this.calendars[0]);for(let n=1;n<this._o.numberOfMonths;n++)this.calendars[n]=hv({month:this.calendars[0].month+n,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(n){isNaN(n)||(this.calendars[0].month=parseInt(n,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(n){isNaN(n)||(this.calendars[0].year=parseInt(n,10),this.adjustCalendars())},setMinDate:function(n){n instanceof Date?(bu(n),this._o.minDate=n,this._o.minYear=n.getFullYear(),this._o.minMonth=n.getMonth()):(this._o.minDate=Ci.minDate,this._o.minYear=Ci.minYear,this._o.minMonth=Ci.minMonth,this._o.startRange=Ci.startRange),this.draw()},setMaxDate:function(n){n instanceof Date?(bu(n),this._o.maxDate=n,this._o.maxYear=n.getFullYear(),this._o.maxMonth=n.getMonth()):(this._o.maxDate=Ci.maxDate,this._o.maxYear=Ci.maxYear,this._o.maxMonth=Ci.maxMonth,this._o.endRange=Ci.endRange),this.draw()},setStartRange:function(n){this._o.startRange=n},setEndRange:function(n){this._o.endRange=n},draw:function(n){if(!this._v&&!n)return;let e=this._o,t=e.minYear,i=e.maxYear,o=e.minMonth,s=e.maxMonth,r="",l;this._y<=t&&(this._y=t,!isNaN(o)&&this._m<o&&(this._m=o)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s));for(let a=0;a<e.numberOfMonths;a++)l="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),r+='<div class="pika-lendar">'+lO(this,a,this.calendars[a].year,this.calendars[a].month,this.calendars[0].year,l)+this.render(this.calendars[a].year,this.calendars[a].month,l)+"</div>";this.el.innerHTML=r,e.bound&&e.field.type!=="hidden"&&Pm(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let n,e,t,i,o,s,r,l,a,h,u;this._o.container||(this.el.style.position="absolute",n=this._o.trigger,e=this.el.offsetWidth,t=this.el.offsetHeight,i=Qo().innerWidth||An().documentElement.clientWidth,o=Qo().innerHeight||An().documentElement.clientHeight,s=An().body.scrollTop||An().documentElement.scrollTop,h=!0,u=!0,a=n.getBoundingClientRect(),r=a.left+Qo().pageXOffset,l=a.bottom+Qo().pageYOffset,(this._o.reposition&&r+e>i||this._o.position.indexOf("right")>-1&&r-e+n.offsetWidth>0)&&(r=r-e+n.offsetWidth,h=!1),(this._o.reposition&&l+t>o+s||this._o.position.indexOf("top")>-1&&l-t-n.offsetHeight>0)&&(l=l-t-n.offsetHeight,u=!1),r<0&&(r=0),l<0&&(l=0),this.el.style.left=r+"px",this.el.style.top=l+"px",Ff(this.el,h?"left-aligned":"right-aligned"),Ff(this.el,u?"bottom-aligned":"top-aligned"),Wf(this.el,h?"right-aligned":"left-aligned"),Wf(this.el,u?"top-aligned":"bottom-aligned"))},render:function(n,e,t){let i=this._o,o=new Date,s=lv(n,e),r=new Date(n,e,1).getDay(),l=[],a=[];bu(o),i.firstDay>0&&(r-=i.firstDay,r<0&&(r+=7));let h=e===0?11:e-1,u=e===11?0:e+1,c=e===0?n-1:n,d=e===11?n+1:n,g=lv(c,h),p=s+r,v=p;for(;v>7;)v-=7;p+=7-v;let C=!1;for(let S=0,R=0;S<p;S++){let M=new Date(n,e,1+(S-r)),I=gn(this._d)?vu(M,this._d):!1,H=vu(M,o),O=i.events.indexOf(M.toDateString())!==-1,k=S<r||S>=s+r,N=1+(S-r),Ce=e,ie=n,Ie=i.startRange&&vu(i.startRange,M),oe=i.endRange&&vu(i.endRange,M),Fe=i.startRange&&i.endRange&&i.startRange<M&&M<i.endRange,We=i.minDate&&M<i.minDate||i.maxDate&&M>i.maxDate||i.disableWeekends&&Z_(M)||i.disableDayFn&&i.disableDayFn(M);k&&(S<r?(N=g+N,Ce=h,ie=c):(N=N-s,Ce=u,ie=d));let Rt={day:N,month:Ce,year:ie,hasEvent:O,isSelected:I,isToday:H,isDisabled:We,isEmpty:k,isStartRange:Ie,isEndRange:oe,isInRange:Fe,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&I&&(C=!0),a.push(tO(Rt)),++R===7&&(i.showWeekNumber&&a.unshift(iO(this,S-r,e,n,i.firstWeekOfYearMinDays)),l.push(oO(a,i.isRTL,i.pickWholeWeek,C)),a=[],R=0,C=!1)}return aO(i,l,t)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),Wf(this.el,"is-hidden"),this._o.bound&&(xi(An(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let n=this._v;n!==!1&&(this._o.bound&&Zi(An(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),Ff(this.el,"is-hidden"),this._v=!1,n!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let n=this._o;this.hide(),Zi(this.el,"mousedown",this._onMouseDown,!0),Zi(this.el,"touchend",this._onMouseDown,!0),Zi(this.el,"change",this._onChange),n.keyboardInput&&Zi(An(),"keydown",this._onKeyChange),n.field&&(Zi(n.field,"change",this._onInputChange),n.bound&&(Zi(n.trigger,"click",this._onInputClick),Zi(n.trigger,"focus",this._onInputFocus),Zi(n.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function Bf(n,e,t){return(e=hO(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hO(n){var e=uO(n,"string");return typeof e=="symbol"?e:e+""}function uO(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const BR="date",cv="dateEditor";class jR extends br{constructor(){super(...arguments),Bf(this,"defaultDateFormat","DD/MM/YYYY"),Bf(this,"parentDestroyed",!1),Bf(this,"$datePicker",null)}static get EDITOR_TYPE(){return BR}init(){if(typeof pe!="function")throw new Error("You need to include moment.js to your project.");if(typeof Im!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),P(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{K(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,i,o,s,r){super.prepare(e,t,i,o,s,r)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:cv})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const o=this.hot._getEditorManager();o.closeEditor(),this.hot.view.render(),o.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(cv),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,t)}showDatepicker(e){const t=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),o=e?bp(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new Im(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(pe),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,pe(s,t,!0).isValid()&&this.$datePicker.setMoment(pe(s,t),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!o&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,pe(s,t,!0).isValid()&&this.$datePicker.setMoment(pe(s,t),!0),!o&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&Rh(t,this.cellProperties.datePickerConfig);const i=t.onSelect,o=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.keyboardInput=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=s=>{let r=s;isNaN(r.getTime())||(r=pe(r).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(r),i&&i()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},t}refreshDimensions(e){var t;if(super.refreshDimensions(e),this.state!==nt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:r}=(t=s.getParentOverlay(this.TD))!==null&&t!==void 0?t:this.hot.view._wt,l=i.getVisualFromRenderableIndex(r.getFirstPartiallyVisibleRow()),a=i.getVisualFromRenderableIndex(r.getLastPartiallyVisibleRow()),h=o.getVisualFromRenderableIndex(r.getFirstPartiallyVisibleColumn()),u=o.getVisualFromRenderableIndex(r.getLastPartiallyVisibleColumn());if(this.row>=l&&this.row<=a&&this.col>=h&&this.col<=u){const c=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+c.top+ot(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=c.right-De(this.datePicker):d+=c.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}const cO="dropdown";class wC extends mC{static get EDITOR_TYPE(){return cO}prepare(e,t,i,o,s,r){super.prepare(e,t,i,o,s,r),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}V.getSingleton().add("beforeValidate",function(n,e,t){const i=this.propToCol(t);if(Number.isInteger(i)){const o=this.getCellMeta(e,i);o.editor===wC&&o.strict===void 0&&(o.filter=!1,o.strict=!0)}});const dO="numeric";class UR extends br{static get EDITOR_TYPE(){return dO}}const fO="password";class zR extends br{static get EDITOR_TYPE(){return fO}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,si(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const jf="ht_editor_visible",dv="selectEditor",gO="select";class GR extends Pl{static get EDITOR_TYPE(){return gO}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",P(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",K(this.select,jf)&&X(this.select,jf),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,i,o,s,r){super.prepare(e,t,i,o,s,r);const l=this.cellProperties.selectOptions;let a;typeof l=="function"?a=this.prepareOptions(l(this.row,this.col,this.prop)):a=this.prepareOptions(l),si(this.select),te(a,(h,u)=>{const c=this.hot.rootDocument.createElement("OPTION");c.value=u,wr(c,h),this.select.appendChild(c)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let i=0,o=e.length;i<o;i++)t[e[i]]=e[i];else typeof e=="object"&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==nt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:t,width:i,height:o}=this.getEditedCellRect(),s=this.select.style;s.height=`${o}px`,s.width=`${i}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${t}px`,s.margin="0px",P(this.select,jf)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),i={group:dv};this.isInFullEditMode()&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const o=this.select.selectedIndex-1;o>=0&&(this.select[o].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const o=this.select.selectedIndex+1;o<=this.select.length-1&&(this.select[o].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(dv)}}const mO="time";class YR extends br{static get EDITOR_TYPE(){return mO}prepare(e,t,i,o,s,r){super.prepare(e,t,i,o,s,r),this.TEXTAREA.dir="ltr"}}function pO(){tn(Pl),tn(mC),tn(WR),tn(jR),tn(wC),tn(gC),tn(UR),tn(zR),tn(GR),tn(br),tn(YR)}const wO="html";function CC(n,e,t,i,o,s,r){Hh.apply(this,[n,e,t,i,o,s,r]),wr(e,s??"",!1)}CC.RENDERER_TYPE=wO;const CO="autocomplete";function Il(n,e,t,i,o,s,r){const{rootDocument:l}=n,a=r.allowHtml?CC:Eo,h=l.createElement("DIV"),u=n.getSettings().ariaTags;if(h.className="htAutocompleteArrow",u&&h.setAttribute(...mr()),h.appendChild(l.createTextNode("▼")),a.apply(this,[n,e,t,i,o,s,r]),e.firstChild||e.appendChild(l.createTextNode(" ")),e.insertBefore(h,e.firstChild),P(e,"htAutocomplete"),!n.acArrowListener){const c=new kn(n);n.acArrowListener=function(d){K(d.target,"htAutocompleteArrow")&&n.view._wt.getSetting("onCellDblClick",null,n._createCellCoords(t,i),e)},c.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",()=>{c.destroy()})}}Il.RENDERER_TYPE=CO;const bO="dropdown";function bC(n,e,t,i,o,s,r){Il.apply(this,[n,e,t,i,o,s,r])}bC.RENDERER_TYPE=bO;const fv=new WeakMap,gv=new WeakMap,vO="htBadValue",vl="data-row",Sl="data-col",SO="checkboxRenderer",KR="checkbox";V.getSingleton().add("modifyAutoColumnSizeSeed",function(n,e,t){const{label:i,type:o,row:s,column:r,prop:l}=e;if(o===KR){if(i){const{value:a,property:h}=i;let u=t;if(a)u=typeof a=="function"?a(s,r,l,t):a;else if(h){const c=this.getDataAtRowProp(s,h);u=c!==null?c:t}n=u}return n}});function vC(n,e,t,i,o,s,r){const{rootDocument:l}=n,a=n.getSettings().ariaTags;Hh.apply(this,[n,e,t,i,o,s,r]),yO(n);let h=RO(l);const u=r.label;let c=!1;if(typeof r.checkedTemplate>"u"&&(r.checkedTemplate=!0),typeof r.uncheckedTemplate>"u"&&(r.uncheckedTemplate=!1),si(e),s===r.checkedTemplate||Qe(s).toLocaleLowerCase(r.locale)===Qe(r.checkedTemplate).toLocaleLowerCase(r.locale)?h.checked=!0:s===r.uncheckedTemplate||Qe(s).toLocaleLowerCase(r.locale)===Qe(r.uncheckedTemplate).toLocaleLowerCase(r.locale)?h.checked=!1:Je(s)?P(h,"noValue"):(h.style.display="none",P(h,vO),c=!0),Y(h,[[vl,t],[Sl,i]]),a&&Y(h,[Oc(h.checked?n.getTranslatedPhrase(hC):n.getTranslatedPhrase(uC)),oy(h.checked),dM()]),!c&&u){let v="";if(u.value)v=typeof u.value=="function"?u.value.call(this,t,i,o,s):u.value;else if(u.property){const S=n.getDataAtRowProp(t,u.property);v=S!==null?S:""}const C=EO(l,v,u.separated!==!0);u.position==="before"?u.separated?(e.appendChild(C),e.appendChild(h)):(C.appendChild(h),h=C):(!u.position||u.position==="after")&&(u.separated?(e.appendChild(h),e.appendChild(C)):(C.insertBefore(h,C.firstChild),h=C))}(!u||u&&!u.separated)&&e.appendChild(h),c&&e.appendChild(l.createTextNode("#bad-value#")),fv.has(n)||(fv.set(n,!0),d());function d(){const C=n.getShortcutManager().getContext("grid"),S={group:SO,relativeToGroup:cs,position:"before"};C.addShortcuts([{keys:[["space"]],callback:()=>(g(),!p()),runOnlyIf:()=>{var R;return(R=n.getSelectedRangeLast())===null||R===void 0?void 0:R.highlight.isCell()}},{keys:[["enter"]],callback:()=>(g(),!p()),runOnlyIf:()=>{const R=n.getSelectedRangeLast();return n.getSettings().enterBeginsEditing&&(R==null?void 0:R.isSingle())&&R.highlight.isCell()}},{keys:[["delete"],["backspace"]],callback:()=>(g(!0),!p()),runOnlyIf:()=>{var R;return(R=n.getSelectedRangeLast())===null||R===void 0?void 0:R.highlight.isCell()}}],S)}function g(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=n.getSelectedRange(),S=[],R=new Map;let M=[],I=0;if(C){for(let H=0;H<C.length;H++){const{row:O,col:k}=C[H].getTopStartCorner(),{row:N,col:Ce}=C[H].getBottomEndCorner();for(let ie=O;ie<=N;ie+=1)for(let Ie=k;Ie<=Ce;Ie+=1){const oe=n.getCellMeta(ie,Ie),Fe={checkedTemplate:oe.checkedTemplate,uncheckedTemplate:oe.uncheckedTemplate};if(oe.type!=="checkbox"){v===!0&&!oe.readOnly&&(R.has(S.length)?R.set(S.length,[...R.get(S.length),[ie,Ie,null]]):R.set(S.length,[[ie,Ie,null]]));continue}if(oe.readOnly===!0)continue;typeof oe.checkedTemplate>"u"&&(oe.checkedTemplate=!0),typeof oe.uncheckedTemplate>"u"&&(oe.uncheckedTemplate=!1);const We=n.getDataAtCell(ie,Ie);v===!1?[oe.checkedTemplate,oe.checkedTemplate.toString()].includes(We)?M.push([ie,Ie,oe.uncheckedTemplate,Fe]):[oe.uncheckedTemplate,oe.uncheckedTemplate.toString(),null,void 0].includes(We)&&M.push([ie,Ie,oe.checkedTemplate,Fe]):M.push([ie,Ie,oe.uncheckedTemplate,Fe]),I+=1}S.push(I),I=0}M.every(H=>{let[,,O]=H;return O===M[0][2]})?M=M.map(H=>{let[O,k,N]=H;return[O,k,N]}):M=M.map(H=>{let[O,k,,N]=H;return[O,k,N.checkedTemplate]}),M.length>0&&S.forEach((H,O)=>{let k=M.splice(0,H);R.size&&R.has(O)&&(k=[...k,...R.get(O)]),n.setDataAtCell(k)})}}function p(){const v=n.getSelectedRange();if(v){for(let C=0;C<v.length;C++){const S=v[C].getTopStartCorner(),R=v[C].getBottomEndCorner();for(let M=S.row;M<=R.row;M++)for(let I=S.col;I<=R.col;I++){const H=n.getCellMeta(M,I),O=n.getCell(M,I);if(O==null)return!0;if(O.querySelectorAll("input[type=checkbox]").length>0&&!H.readOnly)return!0}}return!1}}}vC.RENDERER_TYPE=KR;function yO(n){let e=gv.get(n);if(!e){const{rootElement:t}=n;e=new kn(n),e.addEventListener(t,"click",i=>MO(i,n)),e.addEventListener(t,"mouseup",i=>TO(i,n)),e.addEventListener(t,"change",i=>PO(i,n)),gv.set(n,e)}return e}function RO(n){const e=n.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function EO(n,e,t){const i=n.createElement("label");return i.className=`htCheckboxRendererLabel ${t?"fullWidth":""}`,i.appendChild(n.createTextNode(e)),i.cloneNode(!0)}function TO(n,e){const{target:t}=n;SC(t)&&(!t.hasAttribute(vl)||!t.hasAttribute(Sl)||setTimeout(e.listen,10))}function MO(n,e){const{target:t}=n;if(!SC(t)||!t.hasAttribute(vl)||!t.hasAttribute(Sl))return;const i=parseInt(t.getAttribute(vl),10),o=parseInt(t.getAttribute(Sl),10);e.getCellMeta(i,o).readOnly&&n.preventDefault()}function PO(n,e){const{target:t}=n;if(!SC(t)||!t.hasAttribute(vl)||!t.hasAttribute(Sl))return;const i=parseInt(t.getAttribute(vl),10),o=parseInt(t.getAttribute(Sl),10),s=e.getCellMeta(i,o);if(!s.readOnly){let r=null;n.target.checked?r=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:r=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(i,o,r)}}function SC(n){return n.tagName==="INPUT"&&n.getAttribute("type")==="checkbox"}const IO="handsontable";function yC(n,e,t,i,o,s,r){Il.apply(this,[n,e,t,i,o,s,r])}yC.RENDERER_TYPE=IO;const HO="numeric";function XR(n,e){if(_t(n)){const t=e.numericFormat,i=t&&t.culture||"-",o=t&&t.pattern;if(typeof i<"u"&&!fs.languages()[i]){const s=i.replace("-",""),r=fs.allLanguages?fs.allLanguages[i]:fs[s];r&&fs.registerLanguage(r)}fs.setLanguage(i),n=fs(n).format(o||"0")}return n}function RC(n,e,t,i,o,s,r){let l=s;if(_t(l)){const a=r.className||"",h=a.length?a.split(" "):[];l=XR(l,r),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),r.className=h.join(" "),e.dir="ltr"}Eo(n,e,t,i,o,l,r)}RC.RENDERER_TYPE=HO;const xO="password";function EC(n,e,t,i,o,s,r){Eo.apply(this,[n,e,t,i,o,s,r]);const l=r.hashLength||e.innerHTML.length,a=r.hashSymbol||"*";let h="";j(l-1,()=>{h+=a}),wr(e,h)}EC.RENDERER_TYPE=xO;const AO="select";function TC(n,e,t,i,o,s,r){Eo.apply(this,[n,e,t,i,o,s,r])}TC.RENDERER_TYPE=AO;const _O="time";function MC(n,e,t,i,o,s,r){Eo.apply(this,[n,e,t,i,o,s,r]),e.dir="ltr"}MC.RENDERER_TYPE=_O;function OO(){cn(Il),cn(Hh),cn(vC),cn(bC),cn(yC),cn(CC),cn(RC),cn(EC),cn(TC),cn(Eo),cn(MC)}const NO="autocomplete";function Gd(n,e){let t=n;if(t==null&&(t=""),this.allowEmpty&&t===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(t,mv(t,e)):mv(t,e)(this.source):e(!0)}Gd.VALIDATOR_TYPE=NO;function mv(n,e){const t=n;return function(i){let o=!1;for(let s=0,r=i.length;s<r;s++)if(t===i[s]){o=!0;break}e(o)}}function qR(n){const e=new Date(n);return isNaN(new Date(`${n}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const DO=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:qR},Symbol.toStringTag,{value:"Module"})),LO="date";function PC(n,e){const t=Dy(BR,this.instance);let i=n,o=!0;i==null&&(i="");let s=pe(i,this.dateFormat||t.defaultDateFormat,!0).isValid(),r=pe(new Date(i)).isValid()||s;if(this.allowEmpty&&i===""&&(r=!0,s=!0),r||(o=!1),!r&&s&&(o=!0),r&&!s)if(this.correctFormat===!0){const l=kO(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,l,"dateValidator"),o=!0}else o=!1;e(o)}PC.VALIDATOR_TYPE=LO;function kO(n,e){const t=pe(qR(n)),i=pe(n,e),o=n.search(/[A-z]/g)>-1;let s;return t.isValid()&&t.format("x")===i.format("x")||!i.isValid()||o?s=t:s=i,s.format(e)}const $O="dropdown";function IC(n,e){Gd.apply(this,[n,e])}IC.VALIDATOR_TYPE=$O;const VO="numeric";function HC(n,e){let t=n;t==null&&(t=""),this.allowEmpty&&t===""?e(!0):e(t===""?!1:_t(n))}HC.VALIDATOR_TYPE=VO;const FO=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],WO="time";function xC(n,e){const t=this.timeFormat||"h:mm:ss a";let i=!0,o=n;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;const s=/^\d{1,2}$/.test(o);s&&(o+=":00");const r=pe(o,FO,!0).isValid()?pe(o):pe(o,t);let l=r.isValid(),a=pe(o,t,!0).isValid()&&!s;if(this.allowEmpty&&o===""&&(l=!0,a=!0),l||(i=!1),!l&&a&&(i=!0),l&&!a)if(this.correctFormat===!0){const h=r.format(t);this.instance.setDataAtCell(this.visualRow,this.visualCol,h,"timeValidator"),i=!0}else i=!1;e(i)}xC.VALIDATOR_TYPE=WO;function BO(){Qs(Gd),Qs(IC),Qs(PC),Qs(HC),Qs(xC)}const jO="autocomplete",UO={CELL_TYPE:jO,editor:mC,renderer:Il,validator:Gd},zO="checkbox",GO={CELL_TYPE:zO,editor:WR,renderer:vC},YO="date";function QR(n,e,t,i,o,s,r){Il.apply(this,[n,e,t,i,o,s,r])}QR.RENDERER_TYPE=YO;const KO="date",XO={CELL_TYPE:KO,editor:jR,renderer:QR,validator:PC},qO="dropdown",QO={CELL_TYPE:qO,editor:wC,renderer:bC,validator:IC},JO="handsontable",ZO={CELL_TYPE:JO,editor:gC,renderer:yC},e1="numeric",t1={CELL_TYPE:e1,editor:UR,renderer:RC,validator:HC,dataType:"number"},n1="password",i1={CELL_TYPE:n1,editor:zR,renderer:EC,copyable:!1},o1="select",s1={CELL_TYPE:o1,editor:GR,renderer:TC},r1="time",l1={CELL_TYPE:r1,editor:YR,renderer:MC,validator:xC};function a1(){Mn(UO),Mn(GO),Mn(XO),Mn(QO),Mn(ZO),Mn(t1),Mn(i1),Mn(s1),Mn(FR),Mn(l1)}function h1(n,e){JR(n,e),e.add(n)}function u1(n,e,t){JR(n,e),e.set(n,t)}function JR(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Or(n,e,t){return(e=c1(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function c1(n){var e=d1(n,"string");return typeof e=="symbol"?e:e+""}function d1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Nr(n,e){return n.get(ZR(n,e))}function ZR(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const pv=new Map([["plugin",A0],["cell-type",AR],["editor",Ny],["renderer",By],["validator",jy]]),f1="base",Uf=[];let bi=null;var Es=new WeakMap,wv=new WeakSet;class we{static get PLUGIN_KEY(){return f1}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){h1(this,wv),Or(this,"eventManager",new kn(this)),Or(this,"pluginName",null),Or(this,"pluginsInitializedCallbacks",[]),Or(this,"isPluginsReady",!1),Or(this,"enabled",!1),Or(this,"initialized",!1),u1(this,Es,{}),zi(this,"hot",e,{writable:!1}),bi=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const o=[];if(t.forEach(s=>{const[r,l]=s.split(":");if(!pv.has(r))throw new Error(`Unknown plugin dependency type "${r}" was found.`);pv.get(r)(l)||o.push(` - ${l} (${r})`)}),o.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${o.join(`
`)}
`].join("");Uf.push(s)}}if(bi||(bi=Ep()),bi.indexOf("UndoRedo")>=0&&bi.splice(bi.indexOf("UndoRedo"),1),bi.indexOf(this.pluginName)>=0&&bi.splice(bi.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),bi.length===0){if(Uf.length>0){const o=[`${Uf.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(o)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,t,i){Nr(Es,this)[e]=Nr(Es,this)[e]||[];const o=Nr(Es,this)[e];this.hot.addHook(e,t,i),o.push(t),Nr(Es,this)[e]=o}removeHooks(e){b(Nr(Es,this)[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=Nr(Es,this);te(e,(t,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){b(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=ZR(wv,this,g1).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),te(this,(t,i)=>{i!=="hot"&&(this[i]=null)}),delete this.t,delete this.hot}}function g1(n){if(!n)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let t=0;t<e.length;t++)if(n[e[t]]!==void 0)return!0;return!1}function Ts(n,e,t){return(e=m1(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function m1(n){var e=p1(n,"string");return typeof e=="symbol"?e:e+""}function p1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}let AC=class{constructor(e){Ts(this,"hot",null),Ts(this,"container",null),Ts(this,"injected",!1),Ts(this,"rows",[]),Ts(this,"columns",[]),Ts(this,"samples",null),Ts(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={row:e};this.rows.push(i),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(t!=null){const i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={col:e};this.columns.push(i),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),b(this.rows,t=>{const{height:i}=t.table.getBoundingClientRect();e(t.row,Math.ceil(i)-1)})}getWidths(e){this.injected||this.injectTable(),b(this.columns,t=>{const{width:i}=t.table.getBoundingClientRect();e(t.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{b(i.strings,o=>{t.appendChild(this.createColElement(o.col,e))})}),t}createRow(e){const{rootDocument:t}=this.hot,i=t.createDocumentFragment(),o=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,o),i.appendChild(o)),this.samples.forEach(s=>{b(s.strings,r=>{const l=r.col,a=this.hot.getCellMeta(e,l),h=this.hot.getCellRenderer(a),u=t.createElement("td");u.setAttribute("ghost-table",1),h(this.hot,u,e,l,this.hot.colToProp(l),r.value,a),i.appendChild(u)})}),i}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){const o=e.createElement("th");i.push([-1,o]),t.appendChild(o)}this.samples.forEach(o=>{b(o.strings,s=>{const r=s.col,l=e.createElement("th");i.push([r,l]),t.appendChild(l)})}),this.table.tHead.appendChild(t),b(i,o=>{const[s,r]=o;this.hot.view.appendColHeader(s,r)})}createCol(e){const{rootDocument:t}=this.hot,i=t.createDocumentFragment();return this.samples.forEach(o=>{b(o.strings,s=>{const r=s.row,l=this.hot.getCellMeta(r,e),a=this.hot.getCellRenderer(l),h=t.createElement("td"),u=t.createElement("tr");h.setAttribute("ghost-table",1),a(this.hot,h,r,e,this.hot.colToProp(e),s.value,l),u.appendChild(h),i.appendChild(u)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){const i=this.hot.rootDocument.createElement("col");let o=0;t>=0&&e>=0&&(o=this.hot.getCellMeta(t,e).colspan);let s=this.hot.getColWidth(e);if(o>1)for(let r=e+1;r<e+o;r++)s+=this.hot.getColWidth(r);return i.style.width=`${s}px`,i}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,i=t.createDocumentFragment(),o=t.createElement("table"),s=t.createElement("thead"),r=t.createElement("tbody"),l=t.createElement("colgroup"),a=t.createElement("tr"),h=t.createElement("th");return this.isVertical()&&o.appendChild(l),this.isHorizontal()&&(a.appendChild(h),s.appendChild(a),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(s),this.isVertical()&&r.appendChild(a),o.appendChild(r),P(o,e),i.appendChild(o),{fragment:i,table:o,tHead:s,tBody:r,colGroup:l,tr:a,th:h}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,i=t.createDocumentFragment(),o=t.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return P(o,s),i.appendChild(o),{fragment:i,container:o}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Su(n,e,t){return(e=w1(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function w1(n){var e=C1(n,"string");return typeof e=="symbol"?e:e+""}function C1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Yd{static get SAMPLE_COUNT(){return 3}constructor(e){Su(this,"samples",null),Su(this,"dataFactory",null),Su(this,"customSampleCount",null),Su(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Yd.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,i){const o=new Map,{from:s,to:r}=typeof i=="number"?{from:i,to:i}:i;return j(s,r,l=>{const a=this.generateSample(e,t,l);o.set(l,a)}),o}generateSample(e,t,i){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const o=new Map,s=e==="row"?"col":"row",r=[];return j(t.from,t.to,l=>{const a=e==="row"?this.dataFactory(i,l):this.dataFactory(l,i);if(a===!1)return;const{value:h,bundleSeed:u}=a,c=typeof u=="string"&&u.length>0;let d;c?d=u:ee(h)?d=`${Object.keys(h).length}`:Array.isArray(h)?d=`${h.length}`:d=`${Qe(h).length}`,o.has(d)||o.set(d,{needed:this.getSampleCount(),strings:[]});const g=o.get(d);g.needed&&(!(r.indexOf(h)>-1)||this.allowDuplicates||c)&&(g.strings.push({value:h,[s]:l}),r.push(h),g.needed-=1)}),o}}function b1(n,e){eE(n,e),e.add(n)}function Cv(n,e,t){eE(n,e),e.set(n,t)}function eE(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zl(n,e,t){return(e=v1(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function v1(n){var e=S1(n,"string");return typeof e=="symbol"?e:e+""}function S1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Zs(n,e){return n.get(Di(n,e))}function _C(n,e,t){return n.set(Di(n,e),t),t}function Di(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}V.getSingleton().register("modifyAutoColumnSizeSeed");const ea="autoColumnSize",y1=10,R1="autoColumnSize";var ol=new WeakMap,yl=new WeakMap,so=new WeakSet;class Wa extends we{static get PLUGIN_KEY(){return ea}static get PLUGIN_PRIORITY(){return y1}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),b1(this,so),Zl(this,"ghostTable",new AC(this.hot)),Zl(this,"samplesGenerator",new Yd((t,i)=>{const o=this.hot.toPhysicalRow(t),s=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(o)||this.hot.columnIndexMapper.isHidden(s))return!1;const r=this.hot.getCellMeta(t,i);let l="";r.spanned||(l=this.hot.getDataAtCell(t,i));let a="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(a=this.hot.runHooks("modifyAutoColumnSizeSeed",a,r,l)),{value:l,bundleSeed:a}})),Zl(this,"inProgress",!1),Zl(this,"measuredColumns",0),Zl(this,"columnWidthsMap",new us),Cv(this,ol,[]),Cv(this,yl,[]),this.hot.columnIndexMapper.registerMap(R1,this.columnWidthsMap),this.addHook("beforeColumnResize",(t,i,o)=>Di(so,this,bv).call(this,t,i,o))}isEnabled(){return this.hot.getSettings()[ea]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[ea];t&&t.useHeaders!==null&&t.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Di(so,e,M1).call(e,...o)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Di(so,e,P1).call(e,...o)}),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Di(so,e,H1).call(e,...o)}),this.addHook("beforeRender",()=>Di(so,this,T1).call(this)),this.addHook("modifyColWidth",(i,o)=>this.getColumnWidth(o,i)),this.addHook("init",()=>Di(so,this,I1).call(this)),super.enablePlugin()}updatePlugin(){_C(yl,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,i)=>Di(so,this,bv).call(this,e,t,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),t=this.getLastVisibleColumn();if(e===-1||t===-1)return;const i=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:t},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=typeof e=="number"?{from:e,to:e}:e,s=typeof t=="number"?{from:t,to:t}:t;j(o.from,o.to,r=>{let l=this.hot.toPhysicalColumn(r);l===null&&(l=r),(i||this.columnWidthsMap.getValueAtIndex(l)===null&&!this.hot._getColWidthFromSettings(l))&&this.samplesGenerator.generateColumnSamples(r,s).forEach((h,u)=>this.ghostTable.addColumn(u,h))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((r,l)=>{const a=this.hot.toPhysicalColumn(r);this.columnWidthsMap.setValueAtIndex(a,l)})},!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const o=this.hot.countCols()-1;let s=null;this.inProgress=!0;const r=()=>{if(!this.hot){rh(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+Wa.CALCULATION_STEP,o)},e,t),i=i+Wa.CALCULATION_STEP+1,i<o?s=_d(r):(rh(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},l=this.getSyncCalculationLimit();l>=0&&(this.calculateColumnsWidth({from:0,to:l},e,t),i=l+1),i<o?r():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[ea],t=e&&je(e,"samplingRatio")?e.samplingRatio:void 0,i=e&&je(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[ea];let t=Wa.SYNC_CALCULATION_LIMIT;const i=this.hot.countCols()-1;return ee(e)&&(t=e.syncLimit,tp(t)?t=yp(i,t):t>>=0),Math.min(t,i)}getColumnWidth(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=t;return o===void 0&&(o=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&typeof o=="number"&&(o=Math.max(o,Dd))),o}getFirstVisibleColumn(){var e;return(e=this.hot.view.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.view.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((i,o,s)=>{const r=Zs(ol,this).length;return(r-1<s||Zs(ol,this)[s]!==o)&&i.push(this.hot.toVisualColumn(s)),r-1<s?Zs(ol,this).push(o):Zs(ol,this)[s]=o,i},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function E1(n){const e={from:0,to:this.hot.countRows()-1};n.forEach(t=>{const i=this.hot.toPhysicalColumn(t);i!==null&&(this.hot._getColWidthFromSettings(i)||this.samplesGenerator.generateColumnSamples(t,e).forEach((s,r)=>this.ghostTable.addColumn(r,s)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,i)=>{const o=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(o,i)})},!0),this.ghostTable.clean())}function T1(){this.calculateVisibleColumnsWidth(),this.inProgress||(Di(so,this,E1).call(this,Zs(yl,this)),_C(yl,this,[]))}function M1(n,e){e||this.recalculateAllColumnsWidth()}function P1(n){const e=n.reduce((t,i)=>{let[,o]=i;const s=this.hot.propToCol(o);return Number.isInteger(s)&&t.indexOf(s)===-1&&t.push(s),t},[]);Zs(yl,this).push(...e)}function bv(n,e,t){let i=n;return t&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function I1(){_C(ol,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function H1(n){const e=n.reduce((t,i)=>{var o;const s=(o=i.address)===null||o===void 0?void 0:o.col;if(Number.isInteger(s)){const r=this.hot.toVisualColumn(s);t.indexOf(r)===-1&&t.push(r)}return t},[]);Zs(yl,this).push(...e)}const er={horizontal:"horizontal",vertical:"vertical"};function x1(n,e,t){let i,o,s;return e[0]===n[0]&&e[1]<n[1]?(s="left",i=t(e[0],e[1]),o=t(e[2],n[1]-1)):e[2]===n[2]&&e[0]===n[0]&&e[3]>n[3]?(s="right",i=t(e[0],n[3]+1),o=t(e[2],e[3])):e[0]<n[0]&&e[1]===n[1]?(s="up",i=t(e[0],e[1]),o=t(n[0]-1,e[3])):e[2]>n[2]&&e[1]===n[1]&&(s="down",i=t(n[2]+1,e[1]),o=t(e[2],e[3])),i&&i.normalize(),o&&o.normalize(),{directionOfDrag:s,startOfDragCoords:i,endOfDragCoords:o}}function A1(n){const e={};return n===!0?(e.directions=Object.keys(er),e.autoInsertRow=!0):ee(n)?(F(n.autoInsertRow)?n.direction===er.horizontal?e.autoInsertRow=!1:e.autoInsertRow=n.autoInsertRow:e.autoInsertRow=!1,F(n.direction)?e.directions=[n.direction]:e.directions=Object.keys(er)):typeof n=="string"?(e.directions=[n],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function _1(n,e){O1(n,e),e.add(n)}function O1(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dr(n,e,t){return(e=N1(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function N1(n){var e=D1(n,"string");return typeof e=="symbol"?e:e+""}function D1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ta(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}V.getSingleton().register("modifyAutofillRange");V.getSingleton().register("beforeAutofill");V.getSingleton().register("afterAutofill");const vv="autofill",L1=20,k1=["fillHandle"],$1="insert_row_below",V1=200;var Lr=new WeakSet;class F1 extends we{constructor(){super(...arguments),_1(this,Lr),Dr(this,"addingStarted",!1),Dr(this,"mouseDownOnCellCorner",!1),Dr(this,"mouseDragOutside",!1),Dr(this,"handleDraggedCells",0),Dr(this,"directions",[]),Dr(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return vv}static get PLUGIN_PRIORITY(){return L1}static get SETTING_KEYS(){return[vv,...k1]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>ta(Lr,this,B1).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>ta(Lr,this,W1).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,t)=>ta(Lr,this,j1).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),r=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:i,endRow:o,endCol:s}]),l=[],a=[],h=[];return b(r,u=>{for(let c=u.startRow;c<=u.endRow;c+=1)l.indexOf(c)===-1&&l.push(c);for(let c=u.startCol;c<=u.endCol;c+=1)a.indexOf(c)===-1&&a.push(c)}),b(l,u=>{const c=[];b(a,d=>{c.push(this.hot.getCopyableData(u,d))}),h.push(c)}),h}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,i,o]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),r=s.getTopStartCorner(),l=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const a=[r.row,r.col,l.row,l.col],h=this.hot.runHooks("modifyAutofillRange",[Math.min(r.row,e),Math.min(r.col,t),Math.max(l.row,i),Math.max(l.col,o)],a),{directionOfDrag:u,startOfDragCoords:c,endOfDragCoords:d}=x1(a,h,(g,p)=>this.hot._createCellCoords(g,p));if(c&&c.row>-1&&c.col>-1){const g=this.getSelectionData(),p=s.clone(),v=this.hot._createCellRange(c,c,d),C=this.hot.runHooks("beforeAutofill",g,p,v,u);if(C===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let S=C;const R=C;if(["up","left"].indexOf(u)>-1&&!(R.length===1&&R[0].length===0))if(S=[],u==="up"){const M=d.row-c.row+1,I=M%R.length;for(let H=0;H<M;H++)S.push(R[(H+(R.length-I))%R.length])}else{const M=d.col-c.col+1,I=M%R[0].length;for(let H=0;H<R.length;H++){S.push([]);for(let O=0;O<M;O++)S[H].push(R[H][(O+(R[H].length-I))%R[H].length])}}this.hot.populateFromArray(c.row,c.col,S,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(h),this.hot.runHooks("afterAutofill",S,p,v,u),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),i=t.getBottomEndCorner();let o=e;if(this.directions.includes(er.vertical)&&this.directions.includes(er.horizontal)){const s=t.getTopStartCorner();(i.col<=e.col||s.col>=e.col)&&(o=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||s.row>e.row)&&(o=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(er.vertical))o=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(er.horizontal))o=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(o)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter($1,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},V1)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&t[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),i=this.hot.countRows();let o;for(let s=e[2]+1;s<i;s++){for(let a=e[1];a<=e[3];a++){const h=t[s][a];if(!Je(h))return-1}const r=t[s][e[1]-1],l=t[s][e[3]+1];(!Je(r)||!Je(l))&&(o=s)}return o}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...ae(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return t===-1||t===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,i=mt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+ot(this.hot.table),o=mt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+De(this.hot.table);return e.clientY>i&&e.clientX<=o}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>ta(Lr,this,U1).call(this)),this.eventManager.addEventListener(e,"mousemove",t=>ta(Lr,this,z1).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=A1(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function W1(){this.selectAdjacent()&&this.fillIn()}function B1(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function j1(n){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(n),this.addNewRowIfNeeded())}function U1(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function z1(n){const e=this.getIfMouseWasDraggedOutside(n);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function G1(n,e){tE(n,e),e.add(n)}function Y1(n,e,t){tE(n,e),e.set(n,t)}function tE(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kr(n,e,t){return(e=K1(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function K1(n){var e=X1(n,"string");return typeof e=="symbol"?e:e+""}function X1(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function q1(n,e,t){return n.set(Li(n,e),t),t}function OC(n,e){return n.get(Li(n,e))}function Li(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const yu="autoRowSize",Q1=40,J1="autoRowSize";var ch=new WeakMap,ro=new WeakSet;class Ba extends we{static get PLUGIN_KEY(){return yu}static get PLUGIN_PRIORITY(){return Q1}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),G1(this,ro),kr(this,"headerHeight",null),kr(this,"ghostTable",new AC(this.hot)),kr(this,"samplesGenerator",new Yd((t,i)=>{const o=this.hot.toPhysicalRow(t),s=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(o)||this.hot.columnIndexMapper.isHidden(s)||t>=0&&i>=0&&this.hot.getCellMeta(t,i).hidden)return!1;let r;return t>=0?r=this.hot.getDataAtCell(t,i):t===-1&&(r=this.hot.getColHeader(i)),{value:r}})),kr(this,"inProgress",!1),kr(this,"measuredRows",0),kr(this,"rowHeightsMap",new us),Y1(this,ch,[]),this.hot.rowIndexMapper.registerMap(J1,this.rowHeightsMap),this.addHook("beforeRowResize",(t,i,o)=>Li(ro,this,Sv).call(this,t,i,o))}isEnabled(){const e=this.hot.getSettings()[yu];return e===!0||ee(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Li(ro,e,tN).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Li(ro,e,nN).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Li(ro,e,oN).call(e,...i)}),this.addHook("beforeRender",()=>Li(ro,this,eN).call(this)),this.addHook("modifyRowHeight",(t,i)=>this.getRowHeight(i,t)),this.addHook("init",()=>Li(ro,this,iN).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,i)=>Li(ro,this,Sv).call(this,e,t,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),t=this.getLastVisibleRow();if(e===-1||t===-1)return;const i=this.hot.renderCall;this.calculateRowsHeight({from:e,to:t},void 0,i)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=typeof e=="number"?{from:e,to:e}:e,s=typeof t=="number"?{from:t,to:t}:t;if(this.hot.getColHeader(0)!==null){const r=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(r.get(-1))}j(o.from,o.to,r=>{let l=this.hot.toPhysicalRow(r);l===null&&(l=r),(i||this.rowHeightsMap.getValueAtIndex(l)===null)&&this.samplesGenerator.generateRowSamples(r,s).forEach((h,u)=>this.ghostTable.addRow(u,h))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((r,l)=>{r<0?this.headerHeight=l:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(r),l)})},!0),this.measuredRows=o.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const o=this.hot.countRows()-1;let s=null;this.inProgress=!0;const r=()=>{if(!this.hot){rh(s),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+Ba.CALCULATION_STEP,o)},e,t),i=i+Ba.CALCULATION_STEP+1,i<o?s=_d(r):(rh(s),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},l=this.getSyncCalculationLimit();l>=0&&(this.calculateRowsHeight({from:0,to:l},e,t),i=l+1),i<o?r():(this.inProgress=!1,this.hot.view.adjustElementsSize())}setSamplingOptions(){const e=this.hot.getSettings()[yu],t=e&&je(e,"samplingRatio")?e.samplingRatio:void 0,i=e&&je(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[yu];let t=Ba.SYNC_CALCULATION_LIMIT;const i=this.hot.countRows()-1;return ee(e)&&(t=e.syncLimit,tp(t)?t=yp(i,t):t>>=0),Math.min(t,i)}getRowHeight(e,t){const i=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let o=t;return i!==null&&i>(t||0)&&(o=i),o}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.view.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.view.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(t=>{this.rowHeightsMap.setValueAtIndex(t,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:t,to:i}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{j(Math.min(t,i),Math.max(t,i),o=>{this.rowHeightsMap.setValueAtIndex(o,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Z1(n){const e={from:0,to:this.hot.countCols()-1};n.forEach(t=>{this.samplesGenerator.generateRowSamples(t,e).forEach((o,s)=>this.ghostTable.addRow(s,o))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((t,i)=>{const o=this.hot.toPhysicalRow(t);this.rowHeightsMap.setValueAtIndex(o,i)})},!0),this.ghostTable.clean())}function eN(){this.calculateVisibleRowsHeight(),this.inProgress||(Li(ro,this,Z1).call(this,OC(ch,this)),q1(ch,this,[]))}function Sv(n,e,t){let i=n;return t&&(this.calculateRowsHeight(e,void 0,!0),i=this.getRowHeight(e)),i}function tN(n,e){e||this.recalculateAllRowsHeight()}function nN(n){const e=n.reduce((t,i)=>{let[o]=i;return t.indexOf(o)===-1&&t.push(o),t},[]);OC(ch,this).push(...e)}function iN(){this.recalculateAllRowsHeight()}function oN(n){const e=n.reduce((t,i)=>{var o;const s=(o=i.address)===null||o===void 0?void 0:o.row;if(Number.isInteger(s)){const r=this.hot.toVisualRow(s);t.indexOf(r)===-1&&t.push(r)}return t},[]);OC(ch,this).push(...e)}const{getListWithInsertedItems:sN,getListWithRemovedItems:rN}=fR("physicallyIndexed");class lN extends Cr{constructor(){super(e=>e)}insert(e,t){const i=Xp(this.indexedValues,t);this.indexedValues=sN(i,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=rN(this.indexedValues,e);this.indexedValues=Kp(t,e),super.remove(e)}}const{getListWithInsertedItems:aN,getListWithRemovedItems:hN}=fR("physicallyIndexed");class uN extends Cr{constructor(){super(e=>e)}insert(e,t){this.indexedValues=aN(this.indexedValues,e,t,(i,o)=>this.getNextValue(o)),super.insert(e,t)}remove(e){this.indexedValues=hN(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function cN(n,e){dN(n,e),e.add(n)}function dN(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fN(n,e,t){return(e=gN(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gN(n){var e=mN(n,"string");return typeof e=="symbol"?e:e+""}function mN(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function pN(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const zf="bindRowsWithHeaders",wN=210,CN="loose",bN=new Map([["loose",lN],["strict",uN]]);var yv=new WeakSet;class vN extends we{constructor(){super(...arguments),cN(this,yv),fN(this,"headerIndexes",null)}static get PLUGIN_KEY(){return zf}static get PLUGIN_PRIORITY(){return wN}isEnabled(){return!!this.hot.getSettings()[zf]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[zf];typeof e!="string"&&(e=CN);const t=bN.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",i=>pN(yv,this,SN).call(this,i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function SN(n){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(n))}function yN(n,e){nE(n,e),e.add(n)}function RN(n,e,t){nE(n,e),e.set(n,t)}function nE(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rv(n,e,t){return(e=EN(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function EN(n){var e=TN(n,"string");return typeof e=="symbol"?e:e+""}function TN(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Ev(n,e){return n.get(hl(n,e))}function Gf(n,e,t){return n.set(hl(n,e),t),t}function hl(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Sc="collapsibleColumns",MN=290,PN=["nestedHeaders"],fl="collapsibleIndicator",Tv=Sc,Mv=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var $r=new WeakMap,na=new WeakSet;class IN extends we{constructor(){super(...arguments),yN(this,na),Rv(this,"nestedHeadersPlugin",null),Rv(this,"headerStateManager",null),RN(this,$r,null)}static get PLUGIN_KEY(){return Sc}static get PLUGIN_PRIORITY(){return MN}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Sc,...PN]}isEnabled(){return!!this.hot.getSettings()[Sc]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||ye("You need to configure the Nested Headers plugin in order to use collapsible headers."),Gf($r,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>hl(na,this,AN).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return hl(na,e,_N).call(e,...o)}),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return hl(na,e,HN).call(e,...o)}),this.addHook("beforeOnCellMouseDown",(i,o,s)=>hl(na,this,xN).call(this,i,o,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Gf($r,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:i}=this.hot.getSelectedRangeLast().highlight,{collapsible:o,isCollapsed:s,columnIndex:r}=(e=this.headerStateManager.getHeaderTreeNodeData(t,i))!==null&&e!==void 0?e:{};if(o)return s?this.expandSection({row:t,col:r}):this.collapseSection({row:t,col:r}),!1},runOnlyIf:()=>{var e,t;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.highlight.isHeader())},group:Tv,relativeToGroup:cs,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Tv)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(r){r&&r.parentNode.removeChild(r)};j(0,e-1,r=>{const l=t.childNodes[r],a=i.childNodes[r],h=o?o.childNodes[r]:null;j(0,l.childNodes.length-1,u=>{let c=l.childNodes[u].querySelector(`.${fl}`);s(c),a&&a.childNodes[u]&&(c=a.childNodes[u].querySelector(`.${fl}`),s(c)),o&&h&&h.childNodes[u]&&(c=h.childNodes[u].querySelector(`.${fl}`),s(c))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(i=>{const{collapsible:o,origColspan:s,headerLevel:r,columnIndex:l,isCollapsed:a}=i;if(o===!0&&s>1&&(a&&e==="expand"||!a&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(r),col:l}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!Mv.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const i=bo(e,g=>{let{row:p}=g;return p<0});let o=i.length>0;b(i,g=>{var p;let{row:v,col:C}=g;const{collapsible:S,isCollapsed:R}=(p=this.headerStateManager.getHeaderSettings(v,C))!==null&&p!==void 0?p:{};if(!S||R&&t==="collapse"||!R&&t==="expand")return o=!1,!1});const s=[],r=[];o&&b(i,g=>{let{row:p,col:v}=g;const{colspanCompensation:C,affectedColumns:S,rollbackModification:R}=this.headerStateManager.triggerNodeModification(t,p,v);C>0&&(r.push(...S),s.push(R))});const l=this.getCollapsedColumns();let a=[];t==="collapse"?a=Zm([...l,...r]):t==="expand"&&(a=bo(l,g=>!r.includes(g)));const h=Mv.get(t);if(this.hot.runHooks(h.beforeHook,l,a,o)===!1){b(s,g=>{g()});return}this.hot.batchExecution(()=>{b(r,g=>{Ev($r,this).setValueAtIndex(this.hot.toPhysicalColumn(g),h.hideColumn)})},!0);const c=this.getCollapsedColumns().length!==l.length,d=this.hot.getSelectedRangeLast();if(t==="collapse"&&c&&d){const{row:g,col:p}=d.highlight;if((this.hot.rowIndexMapper.isHidden(g)||this.hot.columnIndexMapper.isHidden(p))&&r.includes(p)){const C=g>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(g,1,!0):g,S=p>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(p,1,!0):p;C!==null&&S!==null&&this.hot.selectCell(C,S)}}this.hot.runHooks(h.afterHook,l,a,o,c),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return Ev($r,this).getHiddenIndexes()}destroy(){Gf($r,this,null),super.destroy()}}function HN(n,e,t){var i;const{collapsible:o,origColspan:s,isCollapsed:r}=(i=this.headerStateManager.getHeaderSettings(t,n))!==null&&i!==void 0?i:{},l=o&&s>1&&n>=this.hot.getSettings().fixedColumnsStart,a=this.hot.getSettings().ariaTags;let h=e.querySelector(`.${fl}`);if(pr(e,[Ln("")[0]]),l)h||(h=this.hot.rootDocument.createElement("div"),P(h,fl),e.querySelector("div:first-child").appendChild(h)),X(h,["collapsed","expanded"]),r?(P(h,"collapsed"),rs(h,"+"),a&&Y(e,...Ln(!1))):(P(h,"expanded"),rs(h,"-"),a&&Y(e,...Ln(!0))),a&&Y(h,...mr());else{var u;(u=h)===null||u===void 0||u.remove()}}function xN(n,e){K(n.target,fl)&&(K(n.target,"expanded")?(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):K(n.target,"collapsed")&&(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),$n(n))}function AN(){this.updatePlugin()}function _N(n,e){e||this.updatePlugin()}function Ms(n,e,t){return(e=ON(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ON(n){var e=NN(n,"string");return typeof e=="symbol"?e:e+""}function NN(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const DN=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],LN=!1,kN=!0,$N=!0;class VN{constructor(e,t){Ms(this,"hot",void 0),Ms(this,"sortingStates",new Fd),Ms(this,"sortEmptyCells",LN),Ms(this,"indicator",kN),Ms(this,"headerAction",$N),Ms(this,"compareFunctionFactory",void 0),Ms(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){ee(e)&&te(e,(t,i)=>{DN.includes(i)&&(this[i]=t)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||t===void 0?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[i]=t;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return ee(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(t=>{let[i,o]=t;return{column:this.hot.toVisualColumn(i),...o}})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(F(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function iE(n,e,t){const i=e.locale;return function(o,s){const{sortEmptyCells:r}=t;return typeof o=="string"&&(o=o.toLocaleLowerCase(i)),typeof s=="string"&&(s=s.toLocaleLowerCase(i)),o===s?ji:Je(o)?Je(s)?ji:r&&n==="asc"?Xe:qe:Je(s)?r&&n==="asc"?qe:Xe:isNaN(o)&&!isNaN(s)?n==="asc"?qe:Xe:!isNaN(o)&&isNaN(s)||(isNaN(o)||isNaN(s)||(o=parseFloat(o),s=parseFloat(s)),o<s)?n==="asc"?Xe:qe:o>s?n==="asc"?qe:Xe:ji}}const oE="default";function FN(n,e,t){return function(i,o){const s=parseFloat(i),r=parseFloat(o),{sortEmptyCells:l}=t;if(s===r||isNaN(s)&&isNaN(r))return ji;if(l){if(Je(i))return n==="asc"?Xe:qe;if(Je(o))return n==="asc"?qe:Xe}return isNaN(s)?qe:isNaN(r)?Xe:s<r?n==="asc"?Xe:qe:s>r?n==="asc"?qe:Xe:ji}}const WN="numeric";function BN(n,e,t){const i=e.checkedTemplate,o=e.uncheckedTemplate,{sortEmptyCells:s}=t;return function(r,l){const a=Je(r),h=Je(l),u=a?o:r,c=h?o:l,d=u===o||u===i,g=c===o||c===i;if(s===!1){if(a&&h===!1)return qe;if(a===!1&&h)return Xe}return d===!1&&g?n==="asc"?Xe:qe:d&&g===!1?n==="asc"?qe:Xe:d===!1&&g===!1?iE(n,e,t)(r,l):u===o&&c===i?n==="asc"?Xe:qe:u===i&&c===o?n==="asc"?qe:Xe:ji}}const jN="checkbox";function UN(n,e,t){return uE(n,e.dateFormat,t)}const zN="date";function GN(n,e,t){return uE(n,e.timeFormat,t)}const YN="time",{register:xh,getItem:Pv,hasItem:KN}=ai("sorting.compareFunctionFactory"),{register:sE,getItem:XN}=ai("sorting.mainSortComparator");function rE(n){return KN(n)?Pv(n):Pv(oE)}xh(jN,BN);xh(zN,UN);xh(oE,iE);xh(WN,FN);xh(YN,GN);const ji=0,Xe=-1,qe=1;function qN(n,e){const t=XN(e);for(var i=arguments.length,o=new Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];n.sort(t(...o))}const qc="asc",Qc="desc",lE="colHeader";function QN(n){if(ee(n)===!1)return!1;const{column:e,sortOrder:t}=n;return Number.isInteger(e)&&[qc,Qc].includes(t)}function JN(n){if(n.some(t=>QN(t)===!1))return!1;const e=n.map(t=>{let{column:i}=t;return i});return new Set(e).size===e.length}function Iv(n){if(n!==Qc)return n===qc?Qc:qc}function aE(n){return n.querySelector(`.${lE}`)}function hE(n,e){if(n<0||!e.parentNode)return!1;const t=e.parentNode.parentNode.childNodes;return Array.from(t).indexOf(e.parentNode)-t.length===-1}function NC(n,e,t){return n===-1&&e>=0&&ls(t)===!1}function uE(n,e,t){return function(i,o){const{sortEmptyCells:s}=t;if(i===o)return ji;if(Je(i))return Je(o)?ji:s&&n==="asc"?Xe:qe;if(Je(o))return s&&n==="asc"?qe:Xe;const r=pe(i,e),l=pe(o,e);return r.isValid()?l.isValid()?l.isAfter(r)?n==="asc"?Xe:qe:l.isBefore(r)?n==="asc"?qe:Xe:ji:Xe:qe}}const ZN="ascending",eD="descending",cE="indicatorDisabled",dE="columnSorting",fE="sortAction",gE=new Map([[qc,ZN],[Qc,eD]]);function tD(n,e,t,i){const o=[dE];if(i&&o.push(fE),t===!1)return o.push(cE),o;const s=n.getSortOrderOfColumn(e);return F(s)&&o.push(gE.get(s)),o}function nD(){return Array.from(gE.values()).concat(fE,cE,dE)}function iD(n,e){return function(t,i){const[,...o]=t,[,...s]=i;return function(l){const a=n[l],h=e[l],u=o[l],c=s[l],d=h.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:rE(h.type))(a,h,d)(u,c)}(0)}}function oD(n,e){sD(n,e),e.add(n)}function sD(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ru(n,e,t){return(e=rD(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rD(n){var e=lD(n,"string");return typeof e=="symbol"?e:e+""}function lD(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function sl(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Jc="columnSorting",aD=50,Zc="append",hD="replace",Hv=Jc;sE(Jc,iD);V.getSingleton().register("beforeColumnSort");V.getSingleton().register("afterColumnSort");var Xs=new WeakSet;class mE extends we{constructor(){super(...arguments),oD(this,Xs),Ru(this,"columnStatesManager",null),Ru(this,"columnMetaCache",null),Ru(this,"pluginKey",Jc),Ru(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Jc}static get PLUGIN_PRIORITY(){return aD}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new VN(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new us(t=>{let i=this.hot.toVisualColumn(t);return i===null&&(i=t),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,i)=>sl(Xs,this,uD).call(this,t,i)),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return sl(Xs,e,dD).call(e,...i)}),this.addHook("afterOnCellMouseDown",(t,i)=>this.onAfterOnCellMouseDown(t,i)),this.addHook("afterInit",()=>sl(Xs,this,Hm).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return sl(Xs,e,cD).call(e,...i)}),this.hot.view&&sl(Xs,this,Hm).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(t,i)=>{const o=aE(i);hE(t,i)===!1||o===null||this.updateHeaderClasses(o)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(i)&&i.row===-1&&i.col>=0},relativeToGroup:cs,position:"before",group:Hv})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Hv)}sort(e){const t=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),o=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",t,i,o)!==!1&&(t.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new gR),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),o&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",t,o?i:t,o),o&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return F(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return JN(e)&&e.every(i=>{let{column:o}=i;return o<=t&&o>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties(),i=o=>{let{column:s,...r}=o;return{column:this.hot.toPhysicalColumn(s),...r}};t.initialConfig=ae(e,i),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,i=o=>{let{column:s,...r}=o;return{column:this.hot.toVisualColumn(s),...r}};return F(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=ae(t.initialConfig,i)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(F(t)){const o=Iv(t);return F(o)?{column:e,sortOrder:o}:void 0}const i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:Iv()}}getNextSortConfig(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Zc;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),o=i!==-1,s=this.getSortConfig(),r=this.getColumnNextConfig(e);if(o){if(Ne(r))return[...s.slice(0,i),...s.slice(i+1)];if(t===Zc)return[...s.slice(0,i),...s.slice(i+1),r];if(t===hD)return[...s.slice(0,i),r,...s.slice(i+1)]}return F(r)?s.concat(r):s}getPluginColumnConfig(e){if(ee(e)){const t=e[this.pluginKey];if(ee(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),o=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(o);return Array.isArray(s.columns)?Object.assign(i,t,this.getPluginColumnConfig(s.columns[e])):_e(s.columns)?Object.assign(i,t,this.getPluginColumnConfig(s.columns(e))):Object.assign(i,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),i=Object.create(t);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const t=[],i=this.hot.countRows(),o=h=>ae(e,u=>this.hot.getDataAtCell(h,u.column));for(let h=0;h<this.getNumberOfRowsToSort(i);h+=1)t.push([this.hot.toPhysicalRow(h)].concat(o(h)));const s=ae(t,h=>h[0]);qN(t,this.pluginKey,ae(e,h=>h.sortOrder),ae(e,h=>this.getFirstCellSettings(h.column)));for(let h=t.length;h<i;h+=1)t.push([h].concat(o(h)));const r=ae(t,h=>h[0]),l=new Map(ae(s,(h,u)=>[h,r[u]])),a=ae(this.hot.rowIndexMapper.getIndexesSequence(),h=>l.has(h)?l.get(h):h);this.hot.rowIndexMapper.setIndexesSequence(a)}sortBySettings(e){if(ee(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||ee(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if(X(e,nD()),this.enabled!==!1){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];P(e,tD(...i))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),F(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&K(e.target,lE)}onAfterOnCellMouseDown(e,t){if(NC(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col));const i=this.hot.getActiveEditor(),o=this.getColumnNextConfig(t.col);i!=null&&i.isOpened()&&this.hot.getCellValidator(i.row,i.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(o)}):this.sort(o)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function Hm(){const n=this.getAllSavedSortSettings();if(ee(n))this.sortBySettings(n);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function uD(n,e){const t=aE(e);if(hE(n,e)===!1||t===null)return;const i=this.getFirstCellSettings(n)[this.pluginKey],o=i.indicator,s=i.headerAction;if(this.updateHeaderClasses(t,this.columnStatesManager,n,o,s),this.hot.getSettings().ariaTags){const r=this.columnStatesManager.getSortOrderOfColumn(n);Y(e,...CM(r?`${r}ending`:"none"))}}function cD(n){n===!0&&this.hot.view&&sl(Xs,this,Hm).call(this)}function dD(n,e,t,i){NC(e.row,e.col,n)!==!1&&this.wasClickableHeaderClicked(n,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}function Ps(n,e,t){return(e=fD(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function fD(n){var e=gD(n,"string");return typeof e=="symbol"?e:e+""}function gD(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class mD{constructor(e,t){Ps(this,"plugin",void 0),Ps(this,"hot",void 0),Ps(this,"endpoints",[]),Ps(this,"settings",void 0),Ps(this,"settingsType","array"),Ps(this,"currentEndpoint",null),Ps(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),b(i,o=>{const s={};this.assignSetting(o,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(o,s,"reversedRowCoords",!1),this.assignSetting(o,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(o,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(o,s,"sourceColumn",o.destinationColumn),this.assignSetting(o,s,"type","sum"),this.assignSetting(o,s,"forceNumeric",!1),this.assignSetting(o,s,"suppressDataTypeErrors",!0),this.assignSetting(o,s,"customFunction",null),this.assignSetting(o,s,"readOnly",!0),this.assignSetting(o,s,"roundFloat",!1),t.push(s)}),t}assignSetting(e,t,i,o){if(i==="ranges"&&e[i]===void 0){t[i]=o;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(o instanceof Error)throw o;t[i]=o}else i==="destinationRow"&&t.reversedRowCoords?t[i]=this.hot.countRows()-e[i]-1:t[i]=e[i]}resetSetupBeforeStructureAlteration(e,t,i){if(this.settingsType!=="function")return;const o=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();b(s,r=>{o==="row"&&r.destinationRow>=t&&(e==="insert_row"?r.alterRowOffset=i:e==="remove_row"&&(r.alterRowOffset=-1*i)),o==="col"&&r.destinationColumn>=t&&(e==="insert_col"?r.alterColumnOffset=i:e==="remove_col"&&(r.alterColumnOffset=-1*i))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,t,i,o,s){let r=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const l=e.indexOf("row")>-1?"row":"col",a=e.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),u=e.indexOf("move_row")===0,c=t;b(h,d=>{l==="row"&&d.destinationRow>=c&&(d.alterRowOffset=a*i),l==="col"&&d.destinationColumn>=c&&(d.alterColumnOffset=a*i)}),this.resetAllEndpoints(h,!u),u?b(h,d=>{this.extendEndpointRanges(d,c,o[0],o.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):b(h,d=>{this.shiftEndpointCoordinates(d,c)}),r&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,i,o){b(e.ranges,s=>{s[1]&&(t>=s[0]&&t<=s[1]?i>s[1]?s[1]+=o:i<s[0]&&(s[0]-=o):i>=s[0]&&i<=s[1]&&(s[1]-=o,t<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,i=[],o=[];b(t,s=>{const r=[];if(s[1])for(let l=s[0];l<=s[1];l++)r.push(this.hot.toPhysicalRow(l));else r.push(this.hot.toPhysicalRow(s[0]));o.push(r)}),b(o,s=>{let r=[];b(s,(l,a)=>{a===0?r.push(l):s[a]!==s[a-1]+1&&(r.push(s[a-1]),i.push(r),r=[],r.push(l)),a===s.length-1&&(r.push(l),i.push(r))})}),e.ranges=i}shiftEndpointCoordinates(e,t){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,b(e.ranges,i=>{b(i,(o,s)=>{o>=t&&(i[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(o=>{const s=o.alterRowOffset||0,r=o.alterColumnOffset||0;return o.destinationRow+s>=this.hot.countRows()||o.destinationColumn+r>=this.hot.countCols()})||(this.cellsToSetCache=[],b(e,o=>{this.resetEndpointValue(o,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],b(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],b(e,(i,o,s)=>{`${i[2]||""}`!=`${i[3]}`&&b(this.getAllEndpoints(),(r,l)=>{this.hot.propToCol(s[o][1])===r.sourceColumn&&t.indexOf(l)===-1&&t.push(l)})}),b(t,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const t=this.hot.toVisualRow(e.destinationRow);if(t!==null){const i=this.hot.getCellMeta(t,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.alterRowOffset||0,o=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?i:0)),this.hot.toVisualColumn(e.destinationColumn+(t?o:0)),""])}setEndpointValue(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const r=this.hot.getCellMeta(s,e.destinationColumn);(t==="init"||r.readOnly!==e.readOnly)&&(r.readOnly=e.readOnly,r.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const r=e.roundFloat;let l=0;Number.isInteger(r)&&(l=Math.min(Math.max(0,r),100)),e.result=e.result.toFixed(l)}i?this.hot.setDataAtCell(o,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([o,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){ye("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function Yf(n){return n==null||isNaN(n)}function pD(n,e){wD(n,e),e.add(n)}function wD(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CD(n,e,t){return(e=bD(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function bD(n){var e=vD(n,"string");return typeof e=="symbol"?e:e+""}function vD(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Eu(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Kf="columnSummary",SD=220;var ia=new WeakSet;class yD extends we{constructor(){super(...arguments),pD(this,ia),CD(this,"endpoints",null)}static get PLUGIN_KEY(){return Kf}static get PLUGIN_PRIORITY(){return SD}isEnabled(){return!!this.hot.getSettings()[Kf]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Kf],this.endpoints=new mD(this,this.settings),this.addHook("afterInit",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Eu(ia,e,RD).call(e,...i)}),this.addHook("afterChange",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Eu(ia,e,TD).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Eu(ia,e,ED).call(e,...i)}),this.addHook("beforeCreateRow",(t,i,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,i,null,o)),this.addHook("beforeCreateCol",(t,i,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,i,null,o)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(t,i,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,i,null,o)),this.addHook("afterCreateCol",(t,i,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,i,null,o)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Eu(ia,e,MD).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let t=0;return te(e.ranges,i=>{t+=this.getPartialSum(i,e.sourceColumn)}),t}getPartialSum(e,t){let i=0,o=e[1]||e[0],s=null,r=0;do{if(s=this.getCellValue(o,t),s=Yf(s)?null:s,s!==null){const l=(`${s}`.split(".")[1]||[]).length||1;l>r&&(r=l)}i+=s||0,o-=1}while(o>=e[0]);return Math.round(i*10**r)/10**r}calculateMinMax(e,t){let i=null;return te(e.ranges,o=>{const s=this.getPartialMinMax(o,e.sourceColumn,t);if(i===null&&s!==null&&(i=s),s!==null)switch(t){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}}),i===null?"Not enough data":i}getPartialMinMax(e,t,i){let o=null,s=e[1]||e[0],r;do{if(r=this.getCellValue(s,t),r=Yf(r)?null:r,o===null)o=r;else if(r!==null)switch(i){case"min":o=Math.min(o,r);break;case"max":o=Math.max(o,r);break}s-=1}while(s>=e[0]);return o}countEmpty(e,t){let i,o=0,s=e[1]||e[0];do i=this.getCellValue(s,t),i=Yf(i)?null:i,i===null&&(o+=1),s-=1;while(s>=e[0]);return o}countEntries(e){let t=0;const i=e.ranges;return te(i,o=>{const s=o[1]===void 0?1:o[1]-o[0]+1,r=this.countEmpty(o,e.sourceColumn);t+=s,t-=r}),t}calculateAverage(e){const t=this.calculateSum(e),i=this.countEntries(e);return t/i}getCellValue(e,t){const i=this.hot.toVisualRow(e),o=this.hot.toVisualColumn(t);let s=this.hot.getSourceDataAtCell(e,t),r="";if(i!==null&&o!==null&&(r=this.hot.getCellMeta(i,o).className||""),r.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Re`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function RD(){this.endpoints.initEndpoints()}function ED(n){n.columns!==void 0&&this.endpoints.refreshCellMetas()}function TD(n,e){n&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(n)}function MD(n,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",n[0],n.length,n,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,n.length,n,this.pluginName)}function PD(n,e){pE(n,e),e.add(n)}function Xf(n,e,t){pE(n,e),e.set(n,t)}function pE(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rl(n,e){return n.get(DC(n,e))}function xm(n,e,t){return n.set(DC(n,e),t),t}function DC(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ed=new WeakMap,Tu=new WeakMap,Mu=new WeakMap,xv=new WeakSet;class wE{constructor(){PD(this,xv),Xf(this,ed,!0),Xf(this,Tu,null),Xf(this,Mu,new ResizeObserver(e=>DC(xv,this,ID).call(this,e)))}setObservedElement(e){xm(Tu,this,e)}unobserve(){rl(Mu,this).unobserve(rl(Tu,this))}observe(){xm(ed,this,!0),rl(Mu,this).observe(rl(Tu,this))}destroy(){rl(Mu,this).disconnect()}}function ID(n){if(rl(ed,this)||!Array.isArray(n)||!n.length){xm(ed,this,!1);return}n.forEach(e=>{let{borderBoxSize:t}=e;const{inlineSize:i,blockSize:o}=t[0];this.runLocalHooks("resize",i,o)})}Ee(wE,Et);function Is(n,e,t){HD(n,e),e.set(n,t)}function HD(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function He(n,e){return n.get(CE(n,e))}function eo(n,e,t){return n.set(CE(n,e),t),t}function CE(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Hs=new WeakMap,qf=new WeakMap,to=new WeakMap,xs=new WeakMap,Io=new WeakMap,Pu=new WeakMap,Vr=new WeakMap;class tr{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){var i=this;Is(this,Hs,void 0),Is(this,qf,!1),Is(this,to,null),Is(this,xs,void 0),Is(this,Io,void 0),Is(this,Pu,!0),Is(this,Vr,new wE),eo(Hs,this,e),eo(qf,this,t),eo(xs,this,this.createEditor()),eo(Io,this,He(xs,this).style),He(Vr,this).setObservedElement(this.getInputElement()),He(Vr,this).addLocalHook("resize",function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return i.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,t){He(Io,this).left=`${e}px`,He(Io,this).top=`${t}px`}setSize(e,t){if(e&&t){const i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${t}px`}}getSize(){return{width:De(this.getInputElement()),height:ot(this.getInputElement())}}observeSize(){He(Vr,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const t=this.getInputElement();t.readOnly=e}show(){He(Io,this).display="block",eo(Pu,this,!1)}hide(){He(Vr,this).unobserve(),He(Pu,this)||(He(Io,this).display="none"),eo(Pu,this,!0)}isVisible(){return He(Io,this).display==="block"}setValue(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return He(Hs,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=He(Hs,this).createElement("div"),t=He(Hs,this).createElement("textarea");return e.style.display="none",eo(to,this,He(Hs,this).createElement("div")),He(to,this).setAttribute("dir",He(qf,this)?"rtl":"ltr"),P(He(to,this),tr.CLASS_EDITOR_CONTAINER),He(Hs,this).body.appendChild(He(to,this)),P(e,tr.CLASS_EDITOR),P(t,tr.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),He(to,this).appendChild(e),e}getInputElement(){return He(xs,this).querySelector(`.${tr.CLASS_INPUT}`)}destroy(){const e=He(to,this)?He(to,this).parentNode:null;He(xs,this).parentNode.removeChild(He(xs,this)),eo(xs,this,null),eo(Io,this,null),He(Vr,this).destroy(),e&&e.removeChild(He(to,this))}}Ee(tr,Et);function Qf(n,e,t){return(e=xD(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function xD(n){var e=AD(n,"string");return typeof e=="symbol"?e:e+""}function AD(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const _D=250,OD=250;class bE{constructor(e){Qf(this,"wasLastActionShow",!0),Qf(this,"showDebounced",null),Qf(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},OD)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_D;this.showDebounced=Hd(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},e)}destroy(){this.clearLocalHooks()}}Ee(bE,Et);function ND(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function DD(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function As(n,e){const t={};return b(n,i=>{i.forAll((o,s)=>{o>=0&&s>=0&&(t[o]||(t[o]=[]),t[o][s]=e(o,s))})}),t}function Wo(n,e,t,i,o){b(n,s=>{s.forAll((r,l)=>{r>=0&&l>=0&&LD(r,l,e,t,i,o)})})}function LD(n,e,t,i,o,s){const r=o(n,e);let l=i;r.className&&(t==="vertical"?l=ND(r.className,i):l=DD(r.className,i)),s(n,e,"className",l)}function ao(n){return`<span class="selected">✓</span>${n}`}function ja(n,e){let t=!1;return Array.isArray(n)&&b(n,i=>(i.forAll((o,s)=>{if(o>=0&&s>=0&&e(o,s))return t=!0,!1}),t)),t}function Kd(n,e){const t={top:0,left:0};if(e!==n.ownerDocument){const{frameElement:i}=e.defaultView,{top:o,left:s}=i.getBoundingClientRect();t.top=o,t.left=s}return t}function kD(n){return function(e,t){const i=this.getCellMeta(e,t).className;return i&&i.indexOf(n)!==-1}}function qt(n,e){return ja(n.getSelectedRange(),kD(e).bind(n))}const ne="---------";function $D(){return{name:ne}}const Hn="alignment";function VD(){return{key:Hn,name(){return this.getTranslatedPhrase(vw)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Hn}:left`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Fc)},ariaChecked(){return qt(this,"htLeft")},name(){let n=this.getTranslatedPhrase(Fc);return qt(this,"htLeft")&&(n=ao(n)),n},callback(){const n=this.getSelectedRange(),e=As(n,(o,s)=>this.getCellMeta(o,s).className),t="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,n,t,i),Wo(n,t,i,(o,s)=>this.getCellMeta(o,s),(o,s,r,l)=>this.setCellMeta(o,s,r,l)),this.render()},disabled:!1},{key:`${Hn}:center`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Wc)},ariaChecked(){return qt(this,"htCenter")},name(){let n=this.getTranslatedPhrase(Wc);return qt(this,"htCenter")&&(n=ao(n)),n},callback(){const n=this.getSelectedRange(),e=As(n,(o,s)=>this.getCellMeta(o,s).className),t="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,n,t,i),Wo(n,t,i,(o,s)=>this.getCellMeta(o,s),(o,s,r,l)=>this.setCellMeta(o,s,r,l)),this.render()},disabled:!1},{key:`${Hn}:right`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Bc)},ariaChecked(){return qt(this,"htRight")},name(){let n=this.getTranslatedPhrase(Bc);return qt(this,"htRight")&&(n=ao(n)),n},callback(){const n=this.getSelectedRange(),e=As(n,(o,s)=>this.getCellMeta(o,s).className),t="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,n,t,i),Wo(n,t,i,(o,s)=>this.getCellMeta(o,s),(o,s,r,l)=>this.setCellMeta(o,s,r,l)),this.render()},disabled:!1},{key:`${Hn}:justify`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(jc)},ariaChecked(){return qt(this,"htJustify")},name(){let n=this.getTranslatedPhrase(jc);return qt(this,"htJustify")&&(n=ao(n)),n},callback(){const n=this.getSelectedRange(),e=As(n,(o,s)=>this.getCellMeta(o,s).className),t="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,n,t,i),Wo(n,t,i,(o,s)=>this.getCellMeta(o,s),(o,s,r,l)=>this.setCellMeta(o,s,r,l)),this.render()},disabled:!1},{name:ne},{key:`${Hn}:top`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Uc)},ariaChecked(){return qt(this,"htTop")},name(){let n=this.getTranslatedPhrase(Uc);return qt(this,"htTop")&&(n=ao(n)),n},callback(){const n=this.getSelectedRange(),e=As(n,(o,s)=>this.getCellMeta(o,s).className),t="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,n,t,i),Wo(n,t,i,(o,s)=>this.getCellMeta(o,s),(o,s,r,l)=>this.setCellMeta(o,s,r,l)),this.render()},disabled:!1},{key:`${Hn}:middle`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(zc)},ariaChecked(){return qt(this,"htMiddle")},name(){let n=this.getTranslatedPhrase(zc);return qt(this,"htMiddle")&&(n=ao(n)),n},callback(){const n=this.getSelectedRange(),e=As(n,(o,s)=>this.getCellMeta(o,s).className),t="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,n,t,i),Wo(n,t,i,(o,s)=>this.getCellMeta(o,s),(o,s,r,l)=>this.setCellMeta(o,s,r,l)),this.render()},disabled:!1},{key:`${Hn}:bottom`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(Gc)},ariaChecked(){return qt(this,"htBottom")},name(){let n=this.getTranslatedPhrase(Gc);return qt(this,"htBottom")&&(n=ao(n)),n},callback(){const n=this.getSelectedRange(),e=As(n,(o,s)=>this.getCellMeta(o,s).className),t="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,n,t,i),Wo(n,t,i,(o,s)=>this.getCellMeta(o,s),(o,s,r,l)=>this.setCellMeta(o,s,r,l)),this.render()},disabled:!1}]}}}const Xd="clear_column";function FD(){return{key:Xd,name(){return this.getTranslatedPhrase(rw)},callback(n,e){const t=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,t,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const Ah="col_left";function WD(){return{key:Ah,name(){return this.getTranslatedPhrase(ew)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,n.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const _h="col_right";function BD(){return{key:_h,name(){return this.getTranslatedPhrase(tw)},callback(){const n=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,n.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Oh="make_read_only";function jD(){return{key:Oh,checkable:!0,ariaChecked(){return ja(this.getSelectedRange(),(e,t)=>this.getCellMeta(e,t).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Vc)},name(){let n=this.getTranslatedPhrase(Vc);return ja(this.getSelectedRange(),(t,i)=>this.getCellMeta(t,i).readOnly)&&(n=ao(n)),n},callback(){const n=this.getSelectedRange(),e=ja(n,(t,i)=>this.getCellMeta(t,i).readOnly);b(n,t=>{t.forAll((i,o)=>{i>=0&&o>=0&&this.setCellMeta(i,o,"readOnly",!e)})}),this.render()},disabled(){const n=this.getSelectedRangeLast();return!!(!n||n.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const qd="redo";function UD(){return{key:qd,name(){return this.getTranslatedPhrase(sw)},callback(){this.redo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Nh="remove_col";function zD(){return{key:Nh,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[,t,,i]=n[0];t-i!==0&&(e=1)}return this.getTranslatedPhrase(iw,e)},callback(){this.alter("remove_col",Nx(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Qd="remove_row";function GD(){return{key:Qd,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[t,,i]=n[0];t-i!==0&&(e=1)}return this.getTranslatedPhrase(nw,e)},callback(){this.alter("remove_row",Dx(this),1,"ContextMenu.removeRow")},disabled(){const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Jd="row_above";function YD(){return{key:Jd,name(){return this.getTranslatedPhrase(Jp)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",n.row,1,"ContextMenu.rowAbove")},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Zd="row_below";function KD(){return{key:Zd,name(){return this.getTranslatedPhrase(Zp)},callback(){const n=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",n.row,1,"ContextMenu.rowBelow")},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const dh="no_items";function XD(){return{key:dh,name(){return this.getTranslatedPhrase(Qp)},disabled:!0,isCommand:!1}}const ef="undo";function qD(){return{key:ef,name(){return this.getTranslatedPhrase(ow)},callback(){this.undo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const QD=[Jd,Zd,Ah,_h,Xd,Qd,Nh,ef,qd,Oh,Hn,ne,dh],JD={[ne]:$D,[dh]:XD,[Jd]:YD,[Zd]:KD,[Ah]:WD,[_h]:BD,[Xd]:FD,[Qd]:GD,[Nh]:zD,[ef]:qD,[qd]:UD,[Oh]:jD,[Hn]:VD};function vE(){const n={};return te(JD,(e,t)=>{n[t]=e()}),n}function ZD(n){return{key:"commentsAddEdit",name(){var e;const t=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t!=null&&t.isCell()&&n.getCommentAtCell(t.row,t.col)?this.getTranslatedPhrase(ww):this.getTranslatedPhrase(pw)},callback(){const e=this.getSelectedRangeLast();n.setRange(e),n.show(),n.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function eL(n){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(Cw)},callback(){this.getSelectedRangeLast().forAll((t,i)=>{t>=0&&i>=0&&n.removeCommentAtCell(t,i,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function tL(n){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(bw);return ja(this.getSelectedRange(),(i,o)=>n.getCommentMeta(i,o,yc))?ao(e):e},callback(){this.getSelectedRangeLast().forAll((t,i)=>{if(t>=0&&i>=0){const o=!!n.getCommentMeta(t,i,yc);n.updateCommentMeta(t,i,{[yc]:!o})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!n.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function nL(n,e){SE(n,e),e.add(n)}function Fr(n,e,t){SE(n,e),e.set(n,t)}function SE(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iL(n,e,t){return(e=oL(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function oL(n){var e=sL(n,"string");return typeof e=="symbol"?e:e+""}function sL(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Jo(n,e,t){return n.set(Jn(n,e),t),t}function le(n,e){return n.get(Jn(n,e))}function Jn(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Ua="comments",rL=60,ho="comment",_a="value",yE="style",yc="readOnly",Iu=Ua,Am=`plugin:${Ua}`;var Ae=new WeakMap,_i=new WeakMap,tf=new WeakMap,Rc=new WeakMap,_m=new WeakMap,td=new WeakMap,vi=new WeakSet;class lL extends we{constructor(){super(...arguments),nL(this,vi),iL(this,"range",{}),Fr(this,Ae,null),Fr(this,_i,null),Fr(this,tf,!1),Fr(this,Rc,!1),Fr(this,_m,null),Fr(this,td,"")}static get PLUGIN_KEY(){return Ua}static get PLUGIN_PRIORITY(){return rL}isEnabled(){return!!this.hot.getSettings()[Ua]}enablePlugin(){var e=this;this.enabled||(le(Ae,this)||(Jo(Ae,this,new tr(this.hot.rootDocument,this.hot.isRtl())),le(Ae,this).addLocalHook("resize",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Jn(vi,e,gL).call(e,...i)})),le(_i,this)||Jo(_i,this,new bE(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",t=>this.addToContextMenu(t)),this.addHook("afterRenderer",(t,i,o,s,r,l)=>Jn(vi,this,cL).call(this,t,l)),this.addHook("afterScroll",()=>Jn(vi,this,pL).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",t=>Jn(vi,this,mL).call(this,t)),le(_i,this).addLocalHook("hide",()=>this.hide()),le(_i,this).addLocalHook("show",(t,i)=>this.showAtCell(t,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){le(_i,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),i=e.addContext(Am);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const o=this.hot.getSelectedRangeLast();Jo(Rc,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(o),this.show(),this.focusEditor(),e.setActiveContextName(Am),this.hot._registerTimeout(()=>{Jo(Rc,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var o;return((o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight.isCell())&&!le(Ae,this).isVisible()},group:Iu}),i.addShortcut({keys:[["Escape"]],callback:()=>{le(Ae,this).setValue(le(td,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>le(Ae,this).isVisible()&&le(Ae,this).isFocused(),group:Iu}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>le(Ae,this).isVisible()&&le(Ae,this).isFocused(),group:Iu})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Iu)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",i=>Jn(vi,this,hL).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Jn(vi,this,aL).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>Jn(vi,this,uL).call(this)),this.eventManager.addEventListener(t,"focus",()=>Jn(vi,this,fL).call(this)),this.eventManager.addEventListener(t,"blur",()=>Jn(vi,this,dL).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=ss(e.target,"TD","TBODY");return!!(t&&K(t,"htCommentCell")&&ss(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=le(Ae,this).getValue();let i="";e!=null?i=e:t!=null&&(i=t);const o=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(o,s,{[_a]:i}),this.hot.render()}setCommentAtCell(e,t,i){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,ho),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(i)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,_a)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,_a)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:t,col:i}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;const o=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return le(_i,this).cancelHiding(),le(Ae,this).setValue((e=o[ho]?o[ho][_a]:null)!==null&&e!==void 0?e:""),le(Ae,this).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){le(Ae,this).hide()}refreshEditor(){var e,t;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!le(Ae,this).isVisible()))return;const{rowIndexMapper:o,columnIndexMapper:s}=this.hot,{row:r,col:l}=this.range.from;let a=o.getRenderableFromVisualIndex(r),h=s.getRenderableFromVisualIndex(l);const u=a===null;le(Ae,this).setPosition(0,0),a===null&&(a=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r,-1))),h===null&&(h=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(l,-1)));const c=a===null,d=h===null;a=(e=a)!==null&&e!==void 0?e:0,h=(t=h)!==null&&t!==void 0?t:0;const{rootWindow:g,view:{_wt:p}}=this.hot,{wtTable:v}=p,C=p.getCell({row:a,col:h},!0),S=this.getCommentMeta(r,l,yE);S?le(Ae,this).setSize(S.width,S.height):le(Ae,this).resetSize();const R=d?0:v.getStretchedColumnWidth(h),M=u&&!c?ot(C):0,{left:I,top:H,width:O,height:k}=C.getBoundingClientRect(),{width:N,height:Ce}=le(Ae,this).getSize(),{innerWidth:ie,innerHeight:Ie}=this.hot.rootWindow,oe=this.hot.rootDocument.documentElement;let Fe=I+g.scrollX+R,We=H+g.scrollY+M;this.hot.isRtl()&&(Fe-=N+R),this.hot.isLtr()&&I+O+N>ie?Fe=I+g.scrollX-N-1:this.hot.isRtl()&&Fe<-(oe.scrollWidth-oe.clientWidth)&&(Fe=I+g.scrollX+R+1),H+Ce>Ie&&(We-=Ce-k+1),le(Ae,this).setPosition(Fe,We),le(Ae,this).setReadOnlyState(this.getCommentMeta(r,l,yc)),le(Ae,this).observeSize()}focusEditor(){le(Ae,this).focus()}updateCommentMeta(e,t,i){const o=this.hot.getCellMeta(e,t)[ho];let s;o?(s=Dt(o),Rh(s,i)):s=i,this.hot.setCellMeta(e,t,ho,s)}getCommentMeta(e,t,i){const o=this.hot.getCellMeta(e,t);if(o[ho])return o[ho][i]}addToContextMenu(e){e.items.push({name:ne},ZD(this),eL(this),tL(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[Ua];if(ee(e))return e.displayDelay}getEditorInputElement(){return le(Ae,this).getInputElement()}destroy(){var e,t;(e=le(Ae,this))===null||e===void 0||e.destroy(),(t=le(_i,this))===null||t===void 0||t.destroy(),super.destroy()}}function aL(n){if(!(!this.hot.view||!this.hot.view._wt)&&!le(tf,this)&&!this.targetIsCommentTextArea(n)){const e=ss(n.target,"TD","TBODY");let t=null;e&&(t=this.hot.getCoords(e)),(!e||this.range.from&&t&&(this.range.from.row!==t.row||this.range.from.col!==t.col))&&this.hide()}}function hL(n){const{rootDocument:e}=this.hot;if(!(le(tf,this)||le(Ae,this).isFocused()||K(n.target,"wtBorder")||le(_m,this)===n.target||!le(Ae,this)))if(Jo(_m,this,e.elementFromPoint(n.clientX,n.clientY)),this.targetIsCellWithComment(n)){const t=this.hot._createCellRange(this.hot.getCoords(n.target));le(_i,this).show(t)}else ts(n.target,e)&&!this.targetIsCommentTextArea(n)&&le(_i,this).hide()}function uL(){Jo(tf,this,!1)}function cL(n,e){e[ho]&&e[ho][_a]&&P(n,e.commentedCellClassName)}function dL(){Jo(td,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function fL(){Jo(td,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(Am)}function gL(n,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[yE]:{width:n,height:e}})}function mL(n){le(Ae,this).isVisible()&&$n(n)}function pL(){le(Rc,this)||this.hide()}function Jf(n,e,t){return(e=wL(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wL(n){var e=CL(n,"string");return typeof e=="symbol"?e:e+""}function CL(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class RE{constructor(e){Jf(this,"hot",void 0),Jf(this,"commands",{}),Jf(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];const s=e.split(":"),r=s[0],l=s.length===2?s[1]:null;let a=this.commands[r];if(!a)throw new Error(`Menu command '${r}' not exists.`);if(l&&a.submenu&&(a=bL(l,a.submenu.items)),a.disabled===!0||typeof a.disabled=="function"&&a.disabled.call(this.hot)===!0||je(a,"submenu"))return;const h=[];typeof a.callback=="function"&&h.push(a.callback),typeof this.commonCallback=="function"&&h.push(this.commonCallback),i.unshift(s.join(":")),b(h,u=>u.apply(this.hot,i))}}function bL(n,e){let t;return b(e,i=>{const o=i.key?i.key.split(":"):null;if(Array.isArray(o)&&o[1]===n)return t=i,!1}),t}function Zf(n,e,t){return(e=vL(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function vL(n){var e=SL(n,"string");return typeof e=="symbol"?e:e+""}function SL(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class EE{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Zf(this,"hot",void 0),Zf(this,"predefinedItems",vE()),Zf(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,te(e,(i,o)=>{let s="";i.name===ne?(t[ne]=i,s=ne):isNaN(parseInt(o,10))?(i.key=i.key===void 0?o:i.key,t[o]=i,s=i.key):(t[i.key]=i,s=i.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return yL(e,this.defaultOrderPattern,this.predefinedItems)}}function yL(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=[];let o=n;return o&&o.items?o=o.items:Array.isArray(o)||(o=e),ee(o)?te(o,(s,r)=>{let l=t[typeof s=="string"?s:r];l||(l=s),ee(s)?lt(l,s):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=r),i.push(l)}):b(o,(s,r)=>{let l=t[s];!l&&QD.indexOf(s)>=0||(l||(l={name:s,key:`${r}`}),ee(s)&&lt(l,s),l.key===void 0&&(l.key=r),i.push(l))}),i}function Ho(n,e,t){return(e=RL(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function RL(n){var e=EL(n,"string");return typeof e=="symbol"?e:e+""}function EL(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class TL{constructor(e,t){Ho(this,"top",void 0),Ho(this,"topRelative",void 0),Ho(this,"left",void 0),Ho(this,"leftRelative",void 0),Ho(this,"scrollTop",void 0),Ho(this,"scrollLeft",void 0),Ho(this,"cellHeight",void 0),Ho(this,"cellWidth",void 0);const i=t.scrollY,o=t.scrollX;let s,r,l,a,h,u;this.rootWindow=t,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),l=parseInt(e.left,10),h=e.height||0,u=e.width||0,r=s,a=l,s+=i,l+=o):this.type==="event"&&(s=parseInt(e.pageY,10),l=parseInt(e.pageX,10),h=e.target.clientHeight,u=e.target.clientWidth,r=s-i,a=l-o),this.top=s,this.topRelative=r,this.left=l,this.leftRelative=a,this.scrollTop=i,this.scrollLeft=o,this.cellHeight=h,this.cellWidth=u}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function oa(n,e,t){ML(n,e),e.set(n,t)}function ML(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function he(n,e){return n.get(TE(n,e))}function Hu(n,e,t){return n.set(TE(n,e),t),t}function TE(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ft=new WeakMap,xo=new WeakMap,Qt=new WeakMap,eg=new WeakMap,Wr=new WeakMap;class PL{constructor(e){oa(this,Ft,void 0),oa(this,xo,void 0),oa(this,Qt,void 0),oa(this,eg,!1),oa(this,Wr,{above:0,below:0,left:0,right:0}),Hu(eg,this,e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return he(Wr,this)[e]=t,this}setElement(e){return Hu(Ft,this,e),this}setParentElement(e){return Hu(xo,this,e),this}updatePosition(e){Hu(Qt,this,new TL(e,he(Ft,this).ownerDocument.defaultView)),he(eg,this)?(he(Qt,this).fitsBelow(he(Ft,this))?this.setPositionBelowCursor():he(Qt,this).fitsAbove(he(Ft,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){he(Ft,this).dir==="rtl"?he(Qt,this).fitsOnLeft(he(Ft,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():he(Qt,this).fitsOnRight(he(Ft,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=he(Wr,this).above+he(Qt,this).top-he(Ft,this).offsetHeight;he(xo,this)&&(e=he(Qt,this).top+he(Qt,this).cellHeight-he(Ft,this).offsetHeight+3),he(Ft,this).style.top=`${e}px`}setPositionBelowCursor(){let e=he(Wr,this).below+he(Qt,this).top+1;he(xo,this)&&(e=he(Qt,this).top-1),he(Ft,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=he(Qt,this).left;if(he(xo,this)){const t=Number.parseInt(getComputedStyle(he(xo,this).querySelector(".htCore")).borderRightWidth,10);e+=he(Qt,this).cellWidth+t}else e+=he(Wr,this).right;he(Ft,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=he(Wr,this).left+he(Qt,this).left-he(Ft,this).offsetWidth;if(he(xo,this)){const t=Number.parseInt(getComputedStyle(he(xo,this).querySelector(".htCore")).borderLeftWidth,10);e-=t}he(Ft,this).style.left=`${e}px`}}function ME(n){let{initialPage:e=-1,size:t=()=>0,onItemSelect:i=()=>{},onClear:o=()=>{}}=n;const s=new Set;let r=Se(e,-1,p()-1);function l(C,S){const R=p()-1;return C<0&&(C=R),C>R&&(C=0),s.has(C)?-1:(s.add(C),i(C,!1)===!1&&(C=l(S===1?++C:--C,S)),C)}function a(C){C>-1&&C<p()&&i(C,!0)!==!1&&(r=C)}function h(){return r}function u(){p()>0&&(s.clear(),r=l(0,1))}function c(){p()>0&&(s.clear(),r=l(p()-1,-1))}function d(){p()>0&&(s.clear(),r=l(++r,1))}function g(){p()>0&&(s.clear(),r=l(--r,-1))}function p(){return Math.max(t(),0)}function v(){s.clear(),r=e,o()}return{setCurrentPage:a,getCurrentPage:h,toFirstItem:u,toLastItem:c,toNextItem:d,toPreviousItem:g,getSize:p,clear:v}}function IL(n){return ae(n,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Om(n){return je(n,"submenu")}function Nm(n){return new RegExp(ne,"i").test(n.name)}function Ec(n,e){return n.disabled===!0||typeof n.disabled=="function"&&n.disabled.call(e)===!0}function Av(n){return je(n,"disableSelection")}function HL(n){return K(n,"htSeparator")}function xL(n){return K(n,"htSubmenu")}function AL(n){return K(n,"htDisabled")}function _L(n){return K(n,"htSelectionDisabled")}function OL(n,e){return!n.hidden||!(typeof n.hidden=="function"&&n.hidden.call(e))}function PE(n,e){const t=n.slice(0);for(let i=0;i<t.length&&t[i].name===e;)t.shift();return t}function NL(n,e){let t=n.slice(0);return t.reverse(),t=PE(t,e),t.reverse(),t}function DL(n){const e=[];return b(n,(t,i)=>{i>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}function LL(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ne,t=n.slice(0);return t=PE(t,e),t=NL(t,e),t=DL(t),t}function kL(n){return n.checkable===!0}function $L(n){return ME({size:()=>n.countRows(),onItemSelect(e,t){const i=n.getCell(e,0);if(!i||HL(i)||AL(i)||_L(i))return!1;n.selectCell(e,0,...t?[e,0,!1,!1]:[])},onClear(){n.deselectCell()}})}function VL(n){const{hot:e,hotMenu:t}=n;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>n.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,o)=>{const s=e.getSettings(),r=typeof s.tabMoves=="function"?s.tabMoves(i):s.tabMoves;o.includes("shift")?e.selection.transformStart(-r.row,-r.col):e.selection.transformStart(r.row,r.col),n.close(!0)}},{keys:[["Escape"]],callback:()=>n.close()},{keys:[["ArrowDown"]],callback:()=>n.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>n.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const i=t.getSelectedLast();if(i){const o=n.openSubMenu(i[0]);o&&o.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.getSelectedLast()&&n.isSubMenu()&&(n.close(),n.isSubMenu()&&n.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>n.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>n.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:i=>{const o=t.getSelectedLast();o&&(t.getSourceDataAtRow(o[0]).submenu?n.openSubMenu(o[0]).getNavigator().toFirstItem():(n.executeCommand(i),n.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.getSelectedLast()?t.selection.transformStart(-t.countVisibleRows(),0):n.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.getSelectedLast()?t.selection.transformStart(t.countVisibleRows(),0):n.getNavigator().toLastItem()}}]}const IE="menu",_v=IE;function FL(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=[];i(VL(n)),e.forEach(h=>{let{shortcuts:u,contextName:c}=h;o(u,c)});function i(h,u){l(u).addShortcuts(h,{group:IE})}function o(h,u){const c=l(u);h.forEach(d=>{let{keys:g}=d;g.forEach(p=>c.removeShortcutsByKeys(p))}),t.push({shortcuts:h,contextName:u}),i(h,u)}function s(){return[...t]}function r(h){return h?`${_v}:${h}`:_v}function l(h){var u;const c=n.hotMenu.getShortcutManager(),d=r(h);return(u=c.getContext(d))!==null&&u!==void 0?u:c.addContext(d)}function a(h){n.hotMenu.getShortcutManager().setActiveContextName(r(h))}return{addCustomShortcuts:o,getCustomShortcuts:s,getContext:l,listen:a}}function WL(n){return(e,t,i,o,s,r)=>{const l=e.getSourceDataAtRow(i),a=n.rootDocument.createElement("div"),h=typeof r=="function"?r.call(n):r,u=typeof l.ariaLabel=="function"?l.ariaLabel.call(n):l.ariaLabel,c=typeof l.ariaChecked=="function"?l.ariaChecked.call(n):l.ariaChecked;if(si(t),P(a,"htItemWrapper"),n.getSettings().ariaTags){const d=!Ec(l,n)&&!Av(l)&&!Nm(l);Y(t,[...kL(l)?[hM(),Oc(u),oy(c)]:[aM(),Oc(h)],...d?[Rl(-1)]:[],...Ec(l,n)?[pM()]:[],...Om(l)?[Ln(!1)]:[]])}t.className="",t.appendChild(a),Nm(l)?P(t,"htSeparator"):typeof l.renderer=="function"?(P(t,"htCustomMenuRenderer"),t.appendChild(l.renderer(e,a,i,o,s,h))):wr(a,h),Ec(l,n)?P(t,"htDisabled"):Av(l)?P(t,"htSelectionDisabled"):Om(l)&&P(t,"htSubmenu")}}function tg(n,e,t){BL(n,e),e.set(n,t)}function BL(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Si(n,e,t){return(e=jL(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function jL(n){var e=UL(n,"string");return typeof e=="symbol"?e:e+""}function UL(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ng(n,e,t){return n.set(HE(n,e),t),t}function _s(n,e){return n.get(HE(n,e))}function HE(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Ov=215;var sa=new WeakMap,xu=new WeakMap,Au=new WeakMap;class Hl{get tableBorderWidth(){return _s(Au,this)===void 0&&this.hotMenu&&ng(Au,this,parseInt(Ui(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),_s(Au,this)}constructor(e,t){var i=this;Si(this,"hot",void 0),Si(this,"options",void 0),Si(this,"eventManager",new kn(this)),Si(this,"container",void 0),Si(this,"positioner",void 0),Si(this,"hotMenu",null),Si(this,"hotSubMenus",{}),Si(this,"parentMenu",void 0),Si(this,"menuItems",null),Si(this,"origOutsideClickDeselects",null),tg(this,sa,void 0),tg(this,xu,void 0),tg(this,Au,void 0),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:Ov,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new PL(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return i.parentMenu.runLocalHooks("afterSelectionChange",...s)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"touchstart",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"contextmenu",t=>this.onDocumentContextMenu(t)),e=rr(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return _s(sa,this)}getKeyboardShortcutsCtrl(){return _s(xu,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Hd(l=>this.openSubMenu(l),300),t=this.options.minWidth||Ov;let i=!1,o=bo(this.menuItems,l=>(l.key===dh&&(i=!0),OL(l,this.hot)));if(o.length<1&&!i)o.push(vE()[dh]);else if(o.length===0)return;o=LL(o,ne);let s=!1;const r={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(l){return F(l)&&l<t?t:l},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:WL(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(l,a)=>{_s(sa,this).setCurrentPage(a.row)},afterOnCellMouseOver:(l,a)=>{this.isAllSubMenusClosed()?e(a.row):this.openSubMenu(a.row)},rowHeights:l=>o[l].name===ne?1:void 0,afterOnCellContextMenu:l=>{l.preventDefault(),dm()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(l,a,h,u,c)=>{this.hotMenu.view.isMouseDown()&&(c.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:l=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(l))},afterOnCellMouseUp:l=>{(!dm()||!ls(l))&&s&&this.hasSelectedItem()&&(go()||Cp()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,r),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),ng(sa,this,$L(this.hotMenu)),ng(xu,this,FL(this)),_s(xu,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(_s(sa,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();if(t){const i=this.parentMenu.hotMenu.getCell(t[0],0);Y(i,[Ln(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!xL(t))return!1;const i=this.hotMenu.getSourceDataAtRow(e),o=new Hl(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(i.submenu.items),o.open(),o.setPosition(t.getBoundingClientRect()),this.hotSubMenus[i.key]=o,this.hot.getSettings().ariaTags&&Y(t,[Ln(!0)]),o}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[t.key];if(i){i.destroy(),delete this.hotSubMenus[t.key];const o=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Y(o,[Ln(!1)])}}closeAllSubMenus(){b(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const i=this.hot.getSelectedRange(),o=i?IL(i):[];this.runLocalHooks("executeCommand",t.key,o,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,o,e)}isCommandPassive(e){return e.isCommand===!1||Nm(e)||Ec(e,this.hot)||Om(e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,t)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,t=this.hotMenu.getSettings().data,i=e.hider.style,o=e.holder.style,s=parseInt(i.width,10),r=at(t,(l,a,h)=>{const c=this.hotMenu.getCell(h,0)?ot(this.hotMenu.getCell(h,0)):0;return l+(a.name===ne?1:c)},0);o.width=`${s+3}px`,o.height=`${r+3}px`,i.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const t=this.options.container.ownerDocument;let i=e,o;return i&&(_e(i)&&(i=i.call(this.hot),i===null||Ne(i)?i="":i=i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,o=t.querySelector(`.${this.options.className}.${i}`)),o||(o=t.createElement("div"),P(o,`htMenu ${this.options.className}`),i&&P(o,i),this.options.container.appendChild(o)),o}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Y(this.hotMenu.rootElement,[lM(),Rl(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!ts(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ts(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&K(e.target,"htCore")&&ts(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Ee(Hl,Et);function zL(n,e){GL(n,e),e.add(n)}function GL(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ig(n,e,t){return(e=YL(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function YL(n){var e=KL(n,"string");return typeof e=="symbol"?e:e+""}function KL(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function _u(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Oa="contextMenu",XL=70,Nv=Oa;V.getSingleton().register("afterContextMenuDefaultOptions");V.getSingleton().register("beforeContextMenuShow");V.getSingleton().register("afterContextMenuShow");V.getSingleton().register("afterContextMenuHide");V.getSingleton().register("afterContextMenuExecute");var ra=new WeakSet;class nf extends we{constructor(){super(...arguments),zL(this,ra),ig(this,"commandExecutor",new RE(this.hot)),ig(this,"itemsFactory",null),ig(this,"menu",null)}static get PLUGIN_KEY(){return Oa}static get PLUGIN_PRIORITY(){return XL}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Jd,Zd,ne,Ah,_h,ne,Qd,Nh,ne,ef,qd,ne,Oh,ne,Hn]}isEnabled(){return!!this.hot.getSettings()[Oa]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Oa];typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new Hl(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>_u(ra,this,QL).call(this)),this.menu.addLocalHook("afterOpen",()=>_u(ra,this,JL).call(this)),this.menu.addLocalHook("afterClose",()=>_u(ra,this,ZL).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return e.executeCommand.call(e,...o)}),this.addHook("afterOnCellContextMenu",i=>_u(ra,this,qL).call(this,i)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const t=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),i=Kd(this.menu.container,this.hot.rootDocument);this.open({left:t.left+i.left,top:t.top+i.top-1+t.height},{left:t.width,above:-t.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&!this.menu.isOpened()},group:Nv})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Nv)}open(e){var t;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((t=this.menu)!==null&&t!==void 0&&t.isOpened())return;this.prepareMenuItems(),this.menu.open(),this.menu.tableBorderWidth>0||(i.below+=1,i.right+=1,i.above-=1,i.left-=1),te(i,(s,r)=>{this.menu.setOffset(r,s)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new EE(this.hot,nf.DEFAULT_ITEMS);const e=this.hot.getSettings()[Oa],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),b(i,o=>this.commandExecutor.registerCommand(o.key,o))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function qL(n){const e=this.hot.getSettings(),t=e.rowHeaders,i=e.colHeaders;function o(l){return l.nodeName==="TD"||l.parentNode.nodeName==="TD"}const s=n.target;if(this.close(),K(s,"handsontableInput")||(n.preventDefault(),n.stopPropagation(),!(t||i)&&!o(s)&&!(K(s,"current")&&K(s,"wtBorder"))))return;const r=Kd(this.menu.container,this.hot.rootDocument);this.open({top:n.clientY+r.top,left:n.clientX+r.left})}function QL(){this.hot.runHooks("beforeContextMenuShow",this)}function JL(){this.hot.runHooks("afterContextMenuShow",this)}function ZL(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}nf.SEPARATOR={name:ne};function ek(n){return{key:"copy",name(){return this.getTranslatedPhrase(lw)},callback(){n.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function tk(n){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?Se(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(uw,t)},callback(){n.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function nk(n){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?Se(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(hw,t)},callback(){n.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function ik(n){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?Se(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(aw,t)},callback(){n.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function ok(n){return{key:"cut",name(){return this.getTranslatedPhrase(cw)},callback(){n.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}class sk{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class rk{constructor(){this.clipboardData=new sk}preventDefault(){}}function lk(n,e){xE(n,e),e.add(n)}function Br(n,e,t){xE(n,e),e.set(n,t)}function xE(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jt(n,e){return n.get(ul(n,e))}function jr(n,e,t){return n.set(ul(n,e),t),t}function ul(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ao=new WeakMap,og=new WeakMap,la=new WeakMap,Dm=new WeakMap,Lm=new WeakMap,aa=new WeakMap,ha=new WeakSet;class ak{constructor(e){let{countRows:t,countColumns:i,rowsLimit:o,columnsLimit:s,countColumnHeaders:r}=e;lk(this,ha),Br(this,Ao,void 0),Br(this,og,void 0),Br(this,la,void 0),Br(this,Dm,void 0),Br(this,Lm,void 0),Br(this,aa,void 0),jr(og,this,t),jr(la,this,i),jr(Dm,this,o),jr(Lm,this,s),jr(aa,this,r)}setSelectedRange(e){jr(Ao,this,e)}getCellsRange(){if(jt(og,this).call(this)===0||jt(la,this).call(this)===0)return null;const{row:e,col:t}=jt(Ao,this).getTopStartCorner(),{row:i,col:o}=jt(Ao,this).getBottomEndCorner(),s=ul(ha,this,hk).call(this,e,i),r=ul(ha,this,sg).call(this,t,o);return{isRangeTrimmed:i!==s||o!==r,startRow:e,startCol:t,endRow:s,endCol:r}}getMostBottomColumnHeadersRange(){if(jt(la,this).call(this)===0||jt(aa,this).call(this)===0)return null;const{col:e}=jt(Ao,this).getTopStartCorner(),{col:t}=jt(Ao,this).getBottomEndCorner(),i=ul(ha,this,sg).call(this,e,t);return{isRangeTrimmed:t!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(jt(la,this).call(this)===0||jt(aa,this).call(this)===0)return null;const{col:e}=jt(Ao,this).getTopStartCorner(),{col:t}=jt(Ao,this).getBottomEndCorner(),i=ul(ha,this,sg).call(this,e,t);return{isRangeTrimmed:t!==i,startRow:-jt(aa,this).call(this),startCol:e,endRow:-1,endCol:i}}}function sg(n,e){return Math.min(e,Math.max(n+jt(Lm,this).call(this)-1,n))}function hk(n,e){return Math.min(e,Math.max(n+jt(Dm,this).call(this)-1,n))}function AE(n){const e=[],t=[];return b(n,i=>{const o=Math.min(i.startRow,i.endRow),s=Math.max(i.startRow,i.endRow);j(o,s,a=>{e.indexOf(a)===-1&&e.push(a)});const r=Math.min(i.startCol,i.endCol),l=Math.max(i.startCol,i.endCol);j(r,l,a=>{t.indexOf(a)===-1&&t.push(a)})}),{rows:e,columns:t}}function uk(n,e){_E(n,e),e.add(n)}function _o(n,e,t){_E(n,e),e.set(n,t)}function _E(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ua(n,e,t){return(e=ck(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ck(n){var e=dk(n,"string");return typeof e=="symbol"?e:e+""}function dk(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function on(n,e){return n.get(sn(n,e))}function Qn(n,e,t){return n.set(sn(n,e),t),t}function sn(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}V.getSingleton().register("afterCopyLimit");V.getSingleton().register("modifyCopyableRange");V.getSingleton().register("beforeCut");V.getSingleton().register("afterCut");V.getSingleton().register("beforePaste");V.getSingleton().register("afterPaste");V.getSingleton().register("beforeCopy");V.getSingleton().register("afterCopy");const Ou="copyPaste",fk=80,gk=["fragmentSelection"],Dv=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var km=new WeakMap,$m=new WeakMap,Vm=new WeakMap,Ur=new WeakMap,Nu=new WeakMap,Du=new WeakMap,zr=new WeakMap,nd=new WeakMap,fn=new WeakSet;class mk extends we{constructor(){super(...arguments),uk(this,fn),ua(this,"columnsLimit",1/0),ua(this,"rowsLimit",1/0),ua(this,"pasteMode","overwrite"),ua(this,"uiContainer",this.hot.rootDocument.body),_o(this,km,!1),_o(this,$m,!1),_o(this,Vm,!1),_o(this,Ur,"cells-only"),_o(this,Nu,!1),_o(this,Du,!1),_o(this,zr,new ak({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),_o(this,nd,!1),ua(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Ou}static get SETTING_KEYS(){return[Ou,...gk]}static get PLUGIN_PRIORITY(){return fk}isEnabled(){return!!this.hot.getSettings()[Ou]}enablePlugin(){var e=this;if(this.enabled)return;const{[Ou]:t}=this.hot.getSettings();if(typeof t=="object"){var i,o;this.pasteMode=(i=t.pasteMode)!==null&&i!==void 0?i:this.pasteMode,this.rowsLimit=isNaN(t.rowsLimit)?this.rowsLimit:t.rowsLimit,this.columnsLimit=isNaN(t.columnsLimit)?this.columnsLimit:t.columnsLimit,Qn(km,this,!!t.copyColumnHeaders),Qn($m,this,!!t.copyColumnGroupHeaders),Qn(Vm,this,!!t.copyColumnHeadersOnly),this.uiContainer=(o=t.uiContainer)!==null&&o!==void 0?o:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",s=>sn(fn,this,Ck).call(this,s)),this.addHook("afterSelection",function(){for(var s=arguments.length,r=new Array(s),l=0;l<s;l++)r[l]=arguments[l];return sn(fn,e,bk).call(e,...r)}),this.addHook("afterSelectionEnd",()=>sn(fn,this,vk).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),pp()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var s=arguments.length,r=new Array(s),l=0;l<s;l++)r[l]=arguments[l];return sn(fn,e,Sk).call(e,...r)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var s=arguments.length,r=new Array(s),l=0;l<s;l++)r[l]=arguments[l];return sn(fn,e,yk).call(e,...r)}),this.addHook("afterSelection",()=>sn(fn,this,Rk).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Qn(Ur,this,e),Qn(Nu,this,!0),sn(fn,this,Lv).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Qn(Du,this,!0),sn(fn,this,Lv).call(this,"cut")}getRangedCopyableData(e){return Fa(this.getRangedData(e))}getRangedData(e){const t=[],{rows:i,columns:o}=AE(e);return b(i,s=>{const r=[];b(o,l=>{s<0?r.push(this.hot.getColHeader(l,s)):r.push(this.hot.getCopyableData(s,l))}),t.push(r)}),t}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!t)return;const i=new rk;e&&i.clipboardData.setData("text/plain",e),t&&i.clipboardData.setData("text/html",t),this.onPaste(i)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}on(zr,this).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);on(Ur,this)==="column-headers-only"?t.set("headers",on(zr,this).getMostBottomColumnHeadersRange()):(on(Ur,this)==="with-column-headers"?t.set("headers",on(zr,this).getMostBottomColumnHeadersRange()):on(Ur,this)==="with-column-group-headers"&&t.set("headers",on(zr,this).getAllColumnHeadersRange()),t.set("cells",on(zr,this).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(o=>o!==null).map(o=>{let{startRow:s,startCol:r,endRow:l,endCol:a}=o;return{startRow:s,startCol:r,endRow:l,endCol:a}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const i=t.get("cells");if(i!==null&&i.isRangeTrimmed){const{startRow:o,startCol:s,endRow:r,endCol:l}=i;this.hot.runHooks("afterCopyLimit",r-o+1,l-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const i=e.length,o=e[0].length,s=[],{row:r,col:l}=t.getTopStartCorner(),{row:a,col:h}=t.getBottomEndCorner();let u=r,c=l,d=r,g=l;for(;s.length<i||u<=a;){const{skipRowOnPaste:p,visualRow:v}=this.hot.getCellMeta(u,l);if(u=v+1,p===!0)continue;d=v,c=l;const C=[],S=s.length%i;for(;C.length<o||c<=h;){const{skipColumnOnPaste:R,visualCol:M}=this.hot.getCellMeta(r,c);if(c=M+1,R===!0)continue;g=M;const I=C.length%o;C.push(e[S][I])}s.push(C)}return Qn(nd,this,!0),this.hot.populateFromArray(r,l,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[r,l,d,g]}onCopy(e){var t,i;const o=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input"),r=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight,l=r?this.hot.getCell(r.row,r.col,!0):null;if(!this.hot.isListening()&&!on(Nu,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(s&&e.target!==o||!s&&e.target!==this.hot.rootDocument.body&&l!==e.target))return;e.preventDefault(),this.setCopyableText(),Qn(Nu,this,!1);const a=this.getRangedData(this.copyableRanges),h=sn(fn,this,pk).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",a,this.copyableRanges,h)){const c=Fa(a);if(e&&e.clipboardData){const d=pm(a,this.hot.rootDocument);e.clipboardData.setData("text/plain",c),e.clipboardData.setData("text/html",[Dv,d].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",c);this.hot.runHooks("afterCopy",a,this.copyableRanges,h)}Qn(Ur,this,"cells-only")}onCut(e){var t,i;const o=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input"),r=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight,l=r?this.hot.getCell(r.row,r.col,!0):null;if(!this.hot.isListening()&&!on(Du,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(s&&e.target!==o||!s&&e.target!==this.hot.rootDocument.body&&l!==e.target))return;e.preventDefault(),this.setCopyableText(),Qn(Du,this,!1);const a=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",a,this.copyableRanges)){const u=Fa(a);if(e&&e.clipboardData){const c=pm(a,this.hot.rootDocument);e.clipboardData.setData("text/plain",u),e.clipboardData.setData("text/html",[Dv,c].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",u);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",a,this.copyableRanges)}}onPaste(e){var t,i;const o=this.hot.getFocusManager().getRefocusElement(),s=(t=e.target)===null||t===void 0?void 0:t.hasAttribute("data-hot-input"),r=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight,l=r?this.hot.getCell(r.row,r.col,!0):null;if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||e.target instanceof HTMLElement&&(s&&e.target!==o||!s&&e.target!==this.hot.rootDocument.body&&l!==e.target))return;e.preventDefault();let a;if(e&&typeof e.clipboardData<"u"){const g=Rd(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});g&&/(<table)|(<TABLE)/g.test(g)?a=$y(g,this.hot.rootDocument).data:a=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(a=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof a=="string"&&(a=Fx(a)),a===void 0||a&&a.length===0||this.hot.runHooks("beforePaste",a,this.copyableRanges)===!1)return;const[h,u,c,d]=this.populateValues(a);this.hot.selectCell(h,u,Math.min(this.hot.countRows()-1,c),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",a,this.copyableRanges)}destroy(){super.destroy()}}function Lv(n){if(pp()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:i}=e.highlight,o=this.hot.getCell(t,i,!0);o&&Cy(o,()=>{this.hot.rootDocument.execCommand(n)})}}else this.hot.rootDocument.execCommand(n)}function pk(n){const{rows:e}=AE(n);let t=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)t+=1;return{columnHeadersCount:t}}function wk(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeLast();if(n){const{row:e,col:t}=n.highlight,i=this.hot.getCell(e,t,!0);i&&cp(i)}}}function OE(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeLast();if(n){const{row:e,col:t}=n.highlight,i=this.hot.getCell(e,t,!0);i!=null&&i.hasAttribute("contenteditable")&&dp(i)}}}function Ck(n){n.items.push({name:"---------"},ek(this)),on(km,this)&&n.items.push(ik(this)),on($m,this)&&n.items.push(nk(this)),on(Vm,this)&&n.items.push(tk(this)),n.items.push(ok(this))}function bk(n,e,t,i,o){on(nd,this)&&(o.value=!0),Qn(nd,this,!1)}function vk(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function Sk(){sn(fn,this,OE).call(this)}function yk(){sn(fn,this,wk).call(this)}function Rk(){sn(fn,this,OE).call(this)}function NE(n,e){return`border_row${n}col${e}`}function Na(){return{width:1,color:"#000"}}function mo(){return{hide:!0}}function Ek(){return{width:1,color:"#000",cornerVisible:!1}}function rg(n){if(F(n.start)||F(n.left)){var e;n.start=(e=n.start)!==null&&e!==void 0?e:n.left}if(F(n.end)||F(n.right)){var t;n.end=(t=n.end)!==null&&t!==void 0?t:n.right}return delete n.left,delete n.right,n}function ca(n){return F(n.start)&&(n.left=n.start),F(n.end)&&(n.right=n.end),n}function lg(n,e){return{id:NE(n,e),border:Ek(),row:n,col:e,top:mo(),bottom:mo(),start:mo(),end:mo()}}function Tk(n,e){return je(e,"border")&&e.border&&(n.border=e.border),je(e,"top")&&F(e.top)&&(e.top?(ee(e.top)||(e.top=Na()),n.top=e.top):(e.top=mo(),n.top=e.top)),je(e,"bottom")&&F(e.bottom)&&(e.bottom?(ee(e.bottom)||(e.bottom=Na()),n.bottom=e.bottom):(e.bottom=mo(),n.bottom=e.bottom)),je(e,"start")&&F(e.start)&&(e.start?(ee(e.start)||(e.start=Na()),n.start=e.start):(e.start=mo(),n.start=e.start)),je(e,"end")&&F(e.end)&&(e.end?(ee(e.end)||(e.end=Na()),n.end=e.end):(e.end=mo(),n.end=e.end)),n}function vo(n,e){let t=!1;return b(n.getSelectedRange(),i=>{i.forAll((o,s)=>{if(o<0||s<0)return;const r=n.getCellMeta(o,s).borders;if(r)if(e){if(!je(r[e],"hide")||r[e].hide===!1)return t=!0,!1}else return t=!0,!1})}),t}function of(n){return`<span class="selected">✓</span>${n}`}function Mk(n){return n.some(e=>F(e.left)||F(e.right))}function Pk(n){return n.some(e=>F(e.start)||F(e.end))}const Ik=new Map([["left","start"],["right","end"]]);function Hk(n){var e;return(e=Ik.get(n))!==null&&e!==void 0?e:n}function xk(n){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(Ew);return vo(this,"bottom")&&(e=of(e)),e},callback(e,t){const i=vo(this,"bottom");n.prepareBorder(t,"bottom",i)}}}function Ak(n){const e=n.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(Tw);return vo(this,e)&&(t=of(t)),t},callback(t,i){const o=vo(this,e);n.prepareBorder(i,e,o)}}}function _k(n){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Mw)},callback(e,t){n.prepareBorder(t,"noBorders")},disabled(){return!vo(this)}}}function Ok(n){const e=n.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(Rw);return vo(this,e)&&(t=of(t)),t},callback(t,i){const o=vo(this,e);n.prepareBorder(i,e,o)}}}function Nk(n){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(yw);return vo(this,"top")&&(e=of(e)),e},callback(e,t){const i=vo(this,"top");n.prepareBorder(t,"top",i)}}}function Dk(n,e){Lk(n,e),e.add(n)}function Lk(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kk(n,e,t){return(e=$k(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $k(n){var e=Vk(n,"string");return typeof e=="symbol"?e:e+""}function Vk(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function kv(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Tc="customBorders",Fk=90;var ag=new WeakSet;class Wk extends we{constructor(){super(...arguments),Dk(this,ag),kk(this,"savedBorders",[])}static get PLUGIN_KEY(){return Tc}static get PLUGIN_PRIORITY(){return Fk}isEnabled(){return!!this.hot.getSettings()[Tc]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>kv(ag,this,Bk).call(this,e)),this.addHook("init",()=>kv(ag,this,jk).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let i=["top","bottom","start","end"],o=null;t&&(this.checkSettingsCohesion([t]),i=Object.keys(t),o=rg(t));const s=bl(e),r=uh(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});b(e,l=>{r(l).forAll((a,h)=>{b(i,u=>{this.prepareBorderFromCustomAdded(a,h,o,Hk(u))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=bl(e),i=uh(t,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),o=[];return b(e,s=>{i(s).forAll((r,l)=>{b(this.savedBorders,a=>{a.row===r&&a.col===l&&o.push(ca(a))})})}),o}clearBorders(e){e?this.setBorders(e):(b(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const o=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,o,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:o})}prepareBorderFromCustomAdded(e,t,i,o){const s=this.hot.countRows(),r=this.hot.countCols();if(e>=s||t>=r)return;let l=lg(e,t);i&&(l=Tk(l,i),b(this.hot.selection.highlight.customSelections,a=>{if(l.id===a.settings.id)return Object.assign(a.settings,i),l.id=a.settings.id,l.top=a.settings.top,l.bottom=a.settings.bottom,l.start=a.settings.start,l.end=a.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",ca(l)),this.insertBorderIntoSettings(l,o)}prepareBorderFromCustomAddedRange(e,t){const i=Math.min(e.to.row,this.hot.countRows()-1),o=Math.min(e.to.col,this.hot.countCols()-1);j(e.from.row,i,s=>{j(e.from.col,o,r=>{const l=lg(s,r);let a=0;s===e.from.row&&je(t,"top")&&(a+=1,l.top=t.top),s===e.to.row&&je(t,"bottom")&&(a+=1,l.bottom=t.bottom),r===e.from.col&&je(t,"start")&&(a+=1,l.start=t.start),r===e.to.col&&je(t,"end")&&(a+=1,l.end=t.end),a>0&&(this.hot.setCellMeta(s,r,"borders",ca(l)),this.insertBorderIntoSettings(l))})})}removeAllBorders(e,t){const i=NE(e,t);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,i,o){let s=this.hot.getCellMeta(e,t).borders;!s||s.border===void 0?s=lg(e,t):s=rg(s),o?(s[i]=mo(),this.countHide(s)===4?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(s,i,o)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,t,"borders",ca(s)))):(s[i]=Na(),this.checkCustomSelectionsFromContextMenu(s,i,o)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,t,"borders",ca(s)))}prepareBorder(e,t,i){b(e,o=>{let{start:s,end:r}=o;if(s.row===r.row&&s.col===r.col)t==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,t,i);else switch(t){case"noBorders":j(s.col,r.col,l=>{j(s.row,r.row,a=>{this.removeAllBorders(a,l)})});break;case"top":j(s.col,r.col,l=>{this.setBorder(s.row,l,t,i)});break;case"bottom":j(s.col,r.col,l=>{this.setBorder(r.row,l,t,i)});break;case"start":j(s.row,r.row,l=>{this.setBorder(l,s.col,t,i)});break;case"end":j(s.row,r.row,l=>{this.setBorder(l,r.col,t,i)});break}})}createCustomBorders(e){b(e,t=>{const i=rg(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,i):this.prepareBorderFromCustomAdded(t.row,t.col,i)})}countHide(e){const{top:t,bottom:i,start:o,end:s}=e;return at([t,i,o,s],(l,a)=>{let h=l;return a&&a.hide&&(h+=1),h},0)}clearBordersFromSelectionSettings(e){const t=ae(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){b(this.hot.selection.highlight.customSelections,(e,t)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){b(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=ae(this.savedBorders,i=>i.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),t=!0):b(this.savedBorders,(o,s)=>{if(e.id===o.id)return this.savedBorders[s]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,i){let o=!1;return b(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const r=this.hot.view._wt.selectionManager.getBorderInstances(s);return b(r,l=>{l.toggleHiddenClass(t,i)}),o=!0,!1}}),o}checkCustomSelections(e,t,i){const o=this.countHide(e);let s=!1;return o===4?(this.removeAllBorders(e.row,e.col),s=!0):b(this.hot.selection.highlight.customSelections,r=>{if(e.id===r.settings.id){if(r.visualCellRange=t,r.commit(),i){const l=this.hot.view._wt.selectionManager.getBorderInstances(r);b(l,a=>{a.changeBorderStyle(i,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[Tc];if(Array.isArray(e)){const t=Dt(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=Mk(e),i=Pk(e);if(t&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function Bk(n){this.hot.getSettings()[Tc]&&n.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(Sw)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[Nk(this),Ok(this),xk(this),Ak(this),_k(this)]}})}function jk(){this.changeBorderSettings()}function Uk(n,e){zk(n,e),e.add(n)}function zk(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hg(n,e,t){return(e=Gk(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Gk(n){var e=Yk(n,"string");return typeof e=="symbol"?e:e+""}function Yk(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function $v(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Vv="dragToScroll",Kk=100;var ug=new WeakSet;class Xk extends we{constructor(){super(...arguments),Uk(this,ug),hg(this,"boundaries",null),hg(this,"callback",null),hg(this,"listening",!1)}static get PLUGIN_KEY(){return Vv}static get PLUGIN_PRIORITY(){return Kk}isEnabled(){return!!this.hot.getSettings()[Vv]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>$v(ug,this,Fv).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>$v(ug,this,Fv).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let i=0,o=0;t<this.boundaries.top?o=t-this.boundaries.top:t>this.boundaries.bottom&&(o=t-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,o)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",i=>this.onMouseMove(i)),t=rr(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function Fv(n){if(ls(n))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((t,i)=>{var o,s;const r=(o=e.scrollLeft)!==null&&o!==void 0?o:e.scrollX,l=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(r+Math.sign(t)*50,l+Math.sign(i)*20)}),this.listen()}function qk(n,e){DE(n,e),e.add(n)}function Qk(n,e,t){DE(n,e),e.set(n,t)}function DE(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cg(n,e,t){return(e=Jk(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Jk(n){var e=Zk(n,"string");return typeof e=="symbol"?e:e+""}function Zk(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function e$(n,e){return n.get(xn(n,e))}function LE(n,e,t){return n.set(xn(n,e),t),t}function xn(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}V.getSingleton().register("afterDropdownMenuDefaultOptions");V.getSingleton().register("beforeDropdownMenuShow");V.getSingleton().register("afterDropdownMenuShow");V.getSingleton().register("afterDropdownMenuHide");V.getSingleton().register("afterDropdownMenuExecute");const Mc="dropdownMenu",t$=230,fh="changeType",dg=Mc;var sf=new WeakMap,Zn=new WeakSet;class rf extends we{static get PLUGIN_KEY(){return Mc}static get PLUGIN_PRIORITY(){return t$}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Ah,_h,ne,Nh,ne,Xd,ne,Oh,ne,Hn]}constructor(e){super(e),qk(this,Zn),cg(this,"commandExecutor",new RE(this.hot)),cg(this,"itemsFactory",null),cg(this,"menu",null),Qk(this,sf,!1),this.hot.addHook("afterGetColHeader",(t,i)=>xn(Zn,this,i$).call(this,t,i))}isEnabled(){return this.hot.getSettings()[Mc]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new EE(this.hot,rf.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return xn(Zn,e,h$).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return xn(Zn,e,a$).call(e,...s)});const t=this.hot.getSettings()[Mc],i={items:this.itemsFactory.getItems(t)};this.registerEvents(),typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const o=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new Hl(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",o),this.menu.setMenuItems(o),this.menu.addLocalHook("beforeOpen",()=>xn(Zn,this,o$).call(this)),this.menu.addLocalHook("afterOpen",()=>xn(Zn,this,s$).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>xn(Zn,this,r$).call(this,s)),this.menu.addLocalHook("afterClose",()=>xn(Zn,this,l$).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,r=new Array(s),l=0;l<s;l++)r[l]=arguments[l];return e.executeCommand.call(e,...r)}),b(o,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),t=()=>{const{highlight:i}=this.hot.getSelectedRangeLast();if((i.isHeader()&&i.row===-1||i.isCell())&&i.col>=0){this.hot.selectColumns(i.col,i.col,-1);const{from:o}=this.hot.getSelectedRangeLast(),s=Kd(this.menu.container,this.hot.rootDocument),r=this.hot.getCell(-1,o.col,!0).querySelector(`.${fh}`),l=r.getBoundingClientRect();this.open({left:l.left+s.left,top:l.top+r.offsetHeight+s.top},{left:l.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:t,runOnlyIf:()=>{var i;const o=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return o&&this.hot.selection.isCellVisible(o)&&o.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:dg},{keys:[["Shift","Alt","ArrowDown"]],callback:t,runOnlyIf:()=>{var i;const o=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return o&&this.hot.selection.isCellVisible(o)&&o.isCell()&&!this.menu.isOpened()},group:dg}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dg)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>xn(Zn,this,n$).call(this,e))}open(e){var t;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(t=this.menu)!==null&&t!==void 0&&t.isOpened()||(this.menu.open(),te(i,(o,s)=>{this.menu.setOffset(s,o)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];this.commandExecutor.execute(e,...i)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function kE(n){n.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function n$(n){if(K(n.target,fh)){const e=Kd(this.menu.container,this.hot.rootDocument),t=n.target.getBoundingClientRect();n.stopPropagation(),LE(sf,this,!1),this.open({left:t.left+e.left,top:t.top+n.target.offsetHeight+e.top},{left:t.width,right:0,above:0,below:3})}}function i$(n,e){const t=e.parentNode;if(!t)return;const i=t.parentNode.childNodes,o=Array.prototype.indexOf.call(i,t);if(n<0||o!==i.length-1)return;const s=e.querySelector(`.${fh}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const r=this.hot.rootDocument.createElement("button");r.className=fh,r.type="button",r.tabIndex=-1,this.hot.getSettings().ariaTags&&(Y(r,[mr(),Oc(" ")]),Y(e,[ty("menu")])),r.onclick=function(){return!1},e.firstChild.insertBefore(r,e.firstChild.firstChild)}function o$(){this.hot.runHooks("beforeDropdownMenuShow",this)}function s$(){this.hot.runHooks("afterDropdownMenuShow",this),xn(Zn,this,kE).call(this,this.menu)}function r$(n){xn(Zn,this,kE).call(this,n)}function l$(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function a$(n){return e$(sf,this)?null:n}function h$(n){K(n.target,fh)&&LE(sf,this,!0)}rf.SEPARATOR={name:ne};function Wv(n,e,t){return(e=u$(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function u$(n){var e=c$(n,"string");return typeof e=="symbol"?e:e+""}function c$(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class d${constructor(e){Wv(this,"hot",void 0),Wv(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:i,endCol:o}=this._getDataRange(),s=this.options,r=[];return j(e,i,l=>{const a=[];!s.exportHiddenRows&&this._isHiddenRow(l)||(j(t,o,h=>{!s.exportHiddenColumns&&this._isHiddenColumn(h)||a.push(this.hot.getDataAtCell(l,h))}),r.push(a))}),r}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:i}=this._getDataRange(),o=this.hot.getRowHeader();j(t,i,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(o[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:i}=this._getDataRange(),o=this.hot.getColHeader();j(t,i,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(o[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[i=0,o=0,s=t,r=e]=this.options.range;return i=Math.max(i,0),o=Math.max(o,0),s=Math.min(s,t),r=Math.min(r,e),{startRow:i,startCol:o,endRow:s,endCol:r}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function Bv(n,e,t){return(e=f$(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function f$(n){var e=g$(n,"string");return typeof e=="symbol"?e:e+""}function g$(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class LC{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){Bv(this,"dataProvider",void 0),Bv(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=ri(this.constructor.DEFAULT_OPTIONS);const i=new Date;return t=lt(ri(LC.DEFAULT_OPTIONS),t),t=lt(t,e),t.filename=np(t.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),t}}const m$="\r",p$='"',w$=`
`;class C$ extends LC{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,t=this.dataProvider.getData();let i=this.dataProvider.getColumnHeaders();const o=i.length>0,s=this.dataProvider.getRowHeaders(),r=s.length>0;let l=e.bom?"\uFEFF":"";return o&&(i=ae(i,a=>this._escapeCell(a,!0)),r&&(l+=e.columnDelimiter),l+=i.join(e.columnDelimiter),l+=e.rowDelimiter),b(t,(a,h)=>{h>0&&(l+=e.rowDelimiter),r&&(l+=this._escapeCell(s[h])+e.columnDelimiter),l+=a.map(u=>this._escapeCell(u)).join(e.columnDelimiter)}),l}_escapeCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=Qe(e);return i!==""&&(t||i.indexOf(m$)>=0||i.indexOf(p$)>=0||i.indexOf(w$)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`),i}}const b$="csv",Fm={[b$]:C$};function v$(n,e,t){return typeof Fm[n]=="function"?new Fm[n](e,t):null}const S$="exportFile",y$=240;class R$ extends we{static get PLUGIN_KEY(){return S$}static get PLUGIN_PRIORITY(){return y$}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:i,rootWindow:o}=this.hot,s=this._createTypeFormatter(e,t),r=this._createBlob(s),l=o.URL||o.webkitURL,a=i.createElement("a"),h=`${s.options.filename}.${s.options.fileExtension}`;if(a.download!==void 0){const u=l.createObjectURL(r);a.style.display="none",a.setAttribute("href",u),a.setAttribute("download",h),i.body.appendChild(a),a.dispatchEvent(new MouseEvent("click")),i.body.removeChild(a),setTimeout(()=>{l.revokeObjectURL(u)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(r,h)}_createTypeFormatter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Fm[e])throw new Error(`Export format type "${e}" is not supported.`);return v$(e,new d$(this.hot),t)}_createBlob(e){let t=null;return typeof Blob<"u"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}function Gr(n,e,t){return(e=E$(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function E$(n){var e=T$(n,"string");return typeof e=="symbol"?e:e+""}function T$(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Dh{constructor(e,t){let{id:i,stateless:o=!0}=t;Gr(this,"hot",void 0),Gr(this,"id",void 0),Gr(this,"elements",[]),Gr(this,"hidden",!1),Gr(this,"stateId",""),Gr(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=o?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Fd)}getElements(){return this.elements}reset(){b(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),b(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}Ee(Dh,Et);const gh={};function as(n,e){if(!gh[n])throw Error(`Filter condition "${n}" does not exist.`);const{condition:t,descriptor:i}=gh[n];let o=e;return i.inputValuesDecorator&&(o=i.inputValuesDecorator(o)),function(s){return t.apply(s.meta.instance,[].concat([s],[o]))}}function nr(n){if(!gh[n])throw Error(`Filter condition "${n}" does not exist.`);return gh[n].descriptor}function ht(n,e,t){t.key=n,gh[n]={condition:e,descriptor:t}}const yt="none";function M$(){return!0}ht(yt,M$,{name:Wd,inputsCount:0,showOperators:!1});const za="empty";function P$(n){return Je(n.value)}ht(za,P$,{name:Ow,inputsCount:0,showOperators:!0});const Pc="not_empty";function I$(n,e){return!as(za,e)(n)}ht(Pc,I$,{name:Nw,inputsCount:0,showOperators:!0});const Ga="eq";function H$(n,e){let[t]=e;return Qe(n.value).toLocaleLowerCase(n.meta.locale)===Qe(t)}ht(Ga,H$,{name:Dw,inputsCount:1,showOperators:!0});const Ic="neq";function x$(n,e){return!as(Ga,e)(n)}ht(Ic,x$,{name:Lw,inputsCount:1,showOperators:!0});const $E="gt";function A$(n,e){let[t]=e,i=t;return n.meta.type==="numeric"&&(i=parseFloat(i,10)),n.value>i}ht($E,A$,{name:Ww,inputsCount:1,showOperators:!0});const VE="gte";function _$(n,e){let[t]=e,i=t;return n.meta.type==="numeric"&&(i=parseFloat(i,10)),n.value>=i}ht(VE,_$,{name:Bw,inputsCount:1,showOperators:!0});const FE="lt";function O$(n,e){let[t]=e,i=t;return n.meta.type==="numeric"&&(i=parseFloat(i,10)),n.value<i}ht(FE,O$,{name:jw,inputsCount:1,showOperators:!0});const WE="lte";function N$(n,e){let[t]=e,i=t;return n.meta.type==="numeric"&&(i=parseFloat(i,10)),n.value<=i}ht(WE,N$,{name:Uw,inputsCount:1,showOperators:!0});const kC="date_after";function D$(n,e){let[t]=e;const i=pe(n.value,n.meta.dateFormat),o=pe(t,n.meta.dateFormat);return!i.isValid()||!o.isValid()?!1:i.diff(o)>=0}ht(kC,D$,{name:Yw,inputsCount:1,showOperators:!0});const $C="date_before";function L$(n,e){let[t]=e;const i=pe(n.value,n.meta.dateFormat),o=pe(t,n.meta.dateFormat);return!i.isValid()||!o.isValid()?!1:i.diff(o)<=0}ht($C,L$,{name:Kw,inputsCount:1,showOperators:!0});const id="between";function k$(n,e){let[t,i]=e,o=t,s=i;if(n.meta.type==="numeric"){const r=parseFloat(o,10),l=parseFloat(s,10);o=Math.min(r,l),s=Math.max(r,l)}else if(n.meta.type==="date"){const r=as($C,[s]),l=as(kC,[o]);return r(n)&&l(n)}return n.value>=o&&n.value<=s}ht(id,k$,{name:zw,inputsCount:2,showOperators:!0});const BE="not_between";function $$(n,e){return!as(id,e)(n)}ht(BE,$$,{name:Gw,inputsCount:2,showOperators:!0});const jE="begins_with";function V$(n,e){let[t]=e;return Qe(n.value).toLocaleLowerCase(n.meta.locale).startsWith(Qe(t))}ht(jE,V$,{name:kw,inputsCount:1,showOperators:!0});const UE="ends_with";function F$(n,e){let[t]=e;return Qe(n.value).toLocaleLowerCase(n.meta.locale).endsWith(Qe(t))}ht(UE,F$,{name:$w,inputsCount:1,showOperators:!0});const VC="contains";function W$(n,e){let[t]=e;return Qe(n.value).toLocaleLowerCase(n.meta.locale).indexOf(Qe(t))>=0}ht(VC,W$,{name:Vw,inputsCount:1,showOperators:!0});const zE="not_contains";function B$(n,e){return!as(VC,e)(n)}ht(zE,B$,{name:Fw,inputsCount:1,showOperators:!0});const GE="date_tomorrow";function j$(n){const e=pe(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(pe().subtract(-1,"days").startOf("day"),"d"):!1}ht(GE,j$,{name:qw,inputsCount:0});const YE="date_today";function U$(n){const e=pe(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(pe().startOf("day"),"d"):!1}ht(YE,U$,{name:Xw,inputsCount:0});const KE="date_yesterday";function z$(n){const e=pe(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(pe().subtract(1,"days").startOf("day"),"d"):!1}ht(KE,z$,{name:Qw,inputsCount:0});Ry();function G$(n,e){let t=n;return t===""&&(t=`(${e})`),t}const Wm=new Set([1]).has(1),Y$=Wm&&typeof Array.from=="function";function Lh(n){let e=n;return Wm&&(e=new Set(e)),function(t){let i;return Wm?i=e.has(t):i=!!~e.indexOf(t),i}}function XE(n){return n??""}function Bm(n){let e=n;return Y$?e=Array.from(new Set(e)):e=Zm(e),e=e.sort((t,i)=>typeof t=="number"&&typeof i=="number"?t-i:t===i?0:t>i?1:-1),e}function jv(n,e,t,i){const o=[],s=n===e;let r;return s||(r=Lh(e)),b(n,l=>{let a=!1;(s||r(l))&&(a=!0);const h={checked:a,value:l,visualValue:G$(l,t)};i&&i(h),o.push(h)}),o}const ir="by_value";function K$(n,e){let[t]=e;return t(n.value)}ht(ir,K$,{name:"By value",inputsCount:0,inputValuesDecorator(n){let[e]=n;return[Lh(e)]},showOperators:!1});const mh={};function X$(n){if(!mh[n])throw Error(`Operation with id "${n}" does not exist.`);const e=mh[n].func;return function(t,i){return e(t,i)}}function q$(n){return mh[n].name}function FC(n,e,t){mh[n]={name:e,func:t}}const is="conjunction",Q$=eC;function J$(n,e){return n.every(t=>t.func(e))}FC(is,Q$,J$);const od="disjunction",Z$=Bd;function eV(n,e){return n.some(t=>t.func(e))}FC(od,Z$,eV);const WC="disjunctionWithExtraCondition",tV=Bd;function nV(n,e){if(n.length<3)throw Error("Operation doesn't work on less then three conditions.");return n.slice(0,n.length-1).some(t=>t.func(e))&&n[n.length-1].func(e)}FC(WC,tV,nV);const iV="numeric",qE="text",oV="date",Uv={[iV]:[yt,ne,za,Pc,ne,Ga,Ic,ne,$E,VE,FE,WE,id,BE],[qE]:[yt,ne,za,Pc,ne,Ga,Ic,ne,jE,UE,ne,VC,zE],[oV]:[yt,ne,za,Pc,ne,Ga,Ic,ne,$C,kC,id,ne,GE,YE,KE]};function sV(n){const e=[];let t=n;return Uv[t]||(t=qE),b(Uv[t],i=>{let o;i===ne?o={name:ne}:o=ri(nr(i)),e.push(o)}),e}function da(n,e,t){return(e=rV(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rV(n){var e=lV(n,"string");return typeof e=="symbol"?e:e+""}function lV(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const fg="built",gg="building",zv=["click","input","keydown","keypress","keyup","focus","blur","change"];let oi=class QE{static get DEFAULTS(){return ri({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){da(this,"hot",void 0),da(this,"eventManager",new kn(this)),da(this,"options",void 0),da(this,"_element",void 0),da(this,"buildState",void 0),this.hot=e,this.options=lt(QE.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===gg?this._element:this.buildState===fg?(this.update(),this._element):(this.buildState=gg,this.build(),this.buildState=fg,this._element)}isBuilt(){return this.buildState===fg}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Yt)?this.hot.getTranslatedPhrase(e):e}build(){const e=(t,i)=>{this.eventManager.addEventListener(t,i,o=>this.runLocalHooks(i,o,this))};if(this.buildState||(this.buildState=gg),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&P(this._element,this.options.className),this.options.children.length)b(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);t.setAttribute("data-hot-input",!0),te(this.options,(i,o)=>{t[o]!==void 0&&o!=="className"&&o!=="tagName"&&o!=="children"&&(t[o]=this.translateIfPossible(i))}),this._element.appendChild(t),b(zv,i=>e(t,i))}else b(zv,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};Ee(oi,Et);function aV(n,e){JE(n,e),e.add(n)}function hV(n,e,t){JE(n,e),e.set(n,t)}function JE(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lu(n,e){return n.get(BC(n,e))}function uV(n,e,t){return n.set(BC(n,e),t),t}function BC(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Yr=new WeakMap,Gv=new WeakSet;class os extends oi{static get DEFAULTS(){return ri({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){super(e,lt(os.DEFAULTS,t)),aV(this,Gv),hV(this,Yr,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>BC(Gv,this,cV).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");uV(Yr,this,this._element.firstChild),P(this._element,"htUIInput"),P(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Lu(Yr,this).type=this.options.type,Lu(Yr,this).placeholder=this.translateIfPossible(this.options.placeholder),Lu(Yr,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Lu(Yr,this).focus()}}function cV(n){this.options.value=n.target.value}function dV(n,e){ZE(n,e),e.add(n)}function fa(n,e,t){ZE(n,e),e.set(n,t)}function ZE(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kr(n,e,t){return n.set(Ya(n,e),t),t}function ze(n,e){return n.get(Ya(n,e))}function Ya(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var dt=new WeakMap,ku=new WeakMap,$u=new WeakMap,mg=new WeakMap,Vu=new WeakMap,Fu=new WeakSet;class ph extends oi{static get DEFAULTS(){return ri({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){super(e,lt(ph.DEFAULTS,t)),dV(this,Fu),fa(this,dt,null),fa(this,ku,[]),fa(this,$u,void 0),fa(this,mg,void 0),fa(this,Vu,void 0),this.registerHooks()}getMenu(){return ze(dt,this)}registerHooks(){this.addLocalHook("click",()=>Ya(Fu,this,mV).call(this))}setItems(e){Kr(ku,this,this.translateNames(e)),ze(dt,this)&&ze(dt,this).setMenuItems(ze(ku,this))}translateNames(e){return b(e,t=>{t.name=this.translateIfPossible(t.name)}),e}build(){super.build(),Kr(dt,this,new Hl(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),ze(dt,this).setMenuItems(ze(ku,this));const e=new oi(this.hot,{className:"htUISelectCaption"}),t=new oi(this.hot,{className:"htUISelectDropdown"});Kr($u,this,e),Kr(mg,this,e.element),Kr(Vu,this,t),this.hot.getSettings().ariaTags&&(Y(t.element,[mr()]),Y(this._element,[ey()])),b([e,t],i=>this._element.appendChild(i.element)),ze(dt,this).addLocalHook("select",i=>Ya(Fu,this,fV).call(this,i)),ze(dt,this).addLocalHook("afterClose",()=>Ya(Fu,this,gV).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=ze(dt,this).hot.getTranslatedPhrase(Wd),ze(mg,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();ze(dt,this)&&(ze(dt,this).open(),ze(dt,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),ze(dt,this).getNavigator().toFirstItem(),ze(dt,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){ze(dt,this)&&ze(dt,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){ze(dt,this)&&(ze(dt,this).destroy(),Kr(dt,this,null)),ze($u,this)&&ze($u,this).destroy(),ze(Vu,this)&&ze(Vu,this).destroy(),super.destroy()}}function fV(n){n.name!==ne&&(this.options.value=n,this.update(),this.runLocalHooks("select",this.options.value))}function gV(){this.runLocalHooks("afterClose")}function mV(){this.openOptions()}function pV(n,e){wV(n,e),e.add(n)}function wV(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yv(n,e,t){return(e=CV(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function CV(n){var e=bV(n,"string");return typeof e=="symbol"?e:e+""}function bV(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Kv(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var pg=new WeakSet;class jm extends Dh{constructor(e,t){super(e,{id:t.id,stateless:!1}),pV(this,pg),Yv(this,"name",""),Yv(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new ph(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new os(this.hot,{placeholder:rC})),this.elements.push(new os(this.hot,{placeholder:lC})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>Kv(pg,this,vV).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),b(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>Kv(pg,this,SV).call(this,t))})}setState(e){if(this.reset(),!e)return;const t=ri(e.command);t.name.startsWith(Ze)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),b(e.args,(i,o)=>{if(o>t.inputsCount-1)return!1;const s=this.getInputElement(o);s.setValue(i),s[t.inputsCount>o?"show":"hide"](),o||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||nr(yt),t=[];return b(this.getInputElements(),(i,o)=>{e.inputsCount>o&&t.push(i.getValue())}),{command:e,args:t}}updateState(e,t){const i=nr(e?e.name:yt);this.state.setValueAtIndex(t,{command:i,args:e?e.args:[]}),e||b(this.getInputElements(),o=>o.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof ph)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof os)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,i,o,s,r)=>{P(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&P(t.parentNode,"border");const l=this.hot.rootDocument.createElement("div");return P(l,"htFiltersMenuLabel"),l.textContent=r,t.appendChild(l),t.parentElement.hasAttribute("ghost-table")||b(this.elements,a=>t.appendChild(a.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[nr(yt)];if(e!==null){const{visualIndex:i}=e;t=sV(this.hot.getDataType(0,i,this.hot.countRows(),i))}b(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function vV(n){b(this.getInputElements(),(e,t)=>{e[n.inputsCount>t?"show":"hide"](),t===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",n)}function SV(n){Tl(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),$n(n))}function Xv(n,e,t){yV(n,e),e.set(n,t)}function yV(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ga(n,e){return n.get(eT(n,e))}function qv(n,e,t){return n.set(eT(n,e),t),t}function eT(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Xr=new WeakMap,wg=new WeakMap;class sd extends oi{static get DEFAULTS(){return ri({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,lt(sd.DEFAULTS,t)),Xv(this,Xr,void 0),Xv(this,wg,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),qv(wg,this,e),qv(Xr,this,this._element.firstChild),ga(Xr,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(ga(wg,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?ga(Xr,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(ga(Xr,this).checked=e)}focus(){this.isBuilt()&&ga(Xr,this).focus()}}function RV(n,e){EV(n,e),e.add(n)}function EV(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TV(n,e,t){return(e=MV(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function MV(n){var e=PV(n,"string");return typeof e=="symbol"?e:e+""}function PV(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function IV(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Qv=0;var Jv=new WeakSet;class HV extends Dh{constructor(e,t){super(e,{id:t.id,stateless:!1}),RV(this,Jv),TV(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(P(t.parentNode,"htFiltersMenuOperators"),b(this.elements,i=>t.appendChild(i.element)),t)}}buildOperatorsElement(){const e=[is,od];b(e,t=>{const i=new sd(this.hot,{name:"operator",label:{htmlFor:t,textContent:q$(t)},value:t,checked:t===e[Qv],id:t});i.addLocalHook("change",o=>IV(Jv,this,xV).call(this,o)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error(Re`Radio button with index ${e} doesn't exist.`);b(this.elements,(t,i)=>{t.setChecked(i===e)})}getActiveOperationId(){const e=this.elements.find(t=>t instanceof sd&&t.isChecked());return e?e.getValue():is}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&b(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:is,t=arguments.length>1?arguments[1]:void 0,i=e;i===WC&&(i=od),this.state.setValueAtIndex(t,i)}reset(){this.setChecked(Qv)}}function xV(n){this.setState(n.target.value)}function AV(n,e,t){_V(n,e),e.set(n,t)}function _V(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cg(n,e){return n.get(tT(n,e))}function OV(n,e,t){return n.set(tT(n,e),t),t}function tT(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ma=new WeakMap;class wh extends oi{static get DEFAULTS(){return ri({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,lt(wh.DEFAULTS,t)),AV(this,ma,void 0)}build(){super.build(),OV(ma,this,this._element.firstChild)}update(){this.isBuilt()&&(Cg(ma,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Cg(ma,this).focus()}activate(){Cg(ma,this).click()}}function NV(n,e){nT(n,e),e.add(n)}function qr(n,e,t){nT(n,e),e.set(n,t)}function nT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Z(n,e){return n.get(cl(n,e))}function Kn(n,e,t){return n.set(cl(n,e),t),t}function cl(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Zv="multipleSelect.itemBox";var ei=new WeakMap,rt=new WeakMap,bg=new WeakMap,no=new WeakMap,Oo=new WeakMap,No=new WeakMap,pa=new WeakSet;class Ch extends oi{static get DEFAULTS(){return ri({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,lt(Ch.DEFAULTS,t)),NV(this,pa),qr(this,ei,[]),qr(this,rt,void 0),qr(this,bg,void 0),qr(this,no,void 0),qr(this,Oo,void 0),qr(this,No,void 0),Kn(no,this,new os(this.hot,{placeholder:sC,className:"htUIMultipleSelectSearch"})),Kn(Oo,this,new wh(this.hot,{textContent:tC,className:"htUISelectAll"})),Kn(No,this,new wh(this.hot,{textContent:nC,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Z(rt,this)}registerHooks(){Z(no,this).addLocalHook("keydown",e=>cl(pa,this,LV).call(this,e)),Z(no,this).addLocalHook("input",e=>cl(pa,this,DV).call(this,e)),Z(Oo,this).addLocalHook("click",e=>cl(pa,this,kV).call(this,e)),Z(No,this).addLocalHook("click",e=>cl(pa,this,$V).call(this,e))}setItems(e){var t;Kn(ei,this,e),(t=Z(rt,this))===null||t===void 0||t.loadData(Z(ei,this))}setLocale(e){Kn(bg,this,e)}getLocale(){return Z(bg,this)}getItems(){return[...Z(ei,this)]}getValue(){return FV(Z(ei,this))}getSearchInputElement(){return Z(no,this)}getSelectAllElement(){return Z(Oo,this)}getClearAllElement(){return Z(No,this)}isSelectedAllValues(){return Z(ei,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),i=new oi(this.hot,{className:"htUISelectionControls",children:[Z(Oo,this),Z(No,this)]});this._element.appendChild(Z(no,this).element),this._element.appendChild(i.element),this._element.appendChild(t);const o=s=>{var r;if(!this._element)return;(r=Z(rt,this))===null||r===void 0||r.destroy(),P(s,"htUIMultipleSelectHot"),Kn(rt,this,new this.hot.constructor(s,{data:Z(ei,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(h,u,c,d,g,p)=>{h.title=p.instance.getDataAtRowProp(u,p.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Z(rt,this).listen()},colWidths:()=>Z(rt,this).container.scrollWidth-pt(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Z(rt,this).init();const a=Z(rt,this).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:h=>{this.runLocalHooks("keydown",h,this)},group:Zv}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:h=>{Z(rt,this).deselectCell(),this.runLocalHooks("keydown",h,this),this.runLocalHooks("listTabKeydown",h,this)},group:Zv})};o(t),this.hot._registerTimeout(()=>o(t),100)}focus(){this.isBuilt()&&Z(rt,this).listen()}reset(){Z(no,this).reset(),Z(Oo,this).reset(),Z(No,this).reset()}update(){this.isBuilt()&&(Z(rt,this).loadData(VV(Z(ei,this),this.options.value)),super.update())}destroy(){var e;(e=Z(rt,this))===null||e===void 0||e.destroy(),Z(no,this).destroy(),Z(No,this).destroy(),Z(Oo,this).destroy(),Kn(no,this,null),Kn(No,this,null),Kn(Oo,this,null),Kn(rt,this,null),Kn(ei,this,null),super.destroy()}}function DV(n){const e=n.target.value.toLocaleLowerCase(this.getLocale());let t;e===""?t=[...Z(ei,this)]:t=Z(ei,this).filter(i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Z(rt,this).loadData(t)}function LV(n){this.runLocalHooks("keydown",n,this),fp(Tl,n.keyCode)("ARROW_DOWN")&&(n.preventDefault(),$n(n),Z(rt,this).listen(),Z(rt,this).selectCell(0,0))}function kV(n){const e=[];n.preventDefault(),Z(rt,this).getSourceData().forEach((t,i)=>{t.checked=!0,e.push(jp(t,i)[0])}),Z(rt,this).setSourceDataAtCell(e)}function $V(n){const e=[];n.preventDefault(),Z(rt,this).getSourceData().forEach((t,i)=>{t.checked=!1,e.push(jp(t,i)[0])}),Z(rt,this).setSourceDataAtCell(e)}function VV(n,e){const t=Lh(e);return n.map(i=>(i.checked=t(i.value),i))}function FV(n){const e=[];return n.forEach(t=>{t.checked&&e.push(t.value)}),e}function WV(n,e){BV(n,e),e.add(n)}function BV(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jV(n,e,t){return(e=UV(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function UV(n){var e=zV(n,"string");return typeof e=="symbol"?e:e+""}function zV(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Wu(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var wa=new WeakSet;class GV extends Dh{constructor(e,t){super(e,{id:t.id,stateless:!1}),WV(this,wa),jV(this,"name",""),this.name=t.name,this.elements.push(new Ch(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Wu(wa,this,YV).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,t)=>Wu(wa,this,KV).call(this,e,t))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===ir){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?yt:ir},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(i,o,s,r,l)=>{const[a]=bo(o,c=>c.name===ir),h={},u=this.hot.getTranslatedPhrase(Yc);if(a){const c=r(i,l),d=ae(c,R=>R.value),g=new Map(c.map(R=>[R.value,this.hot.getCellMeta(R.meta.visualRow,R.meta.visualCol)])),p=Bm(d);s&&(a.args[0]=s);const v=[],C=jv(p,a.args[0],u,R=>{R.checked&&v.push(R.value),Wu(wa,this,eS).call(this,R,g)}),S=e.editedConditionStack.column;h.locale=this.hot.getCellMeta(0,S).locale,h.args=[v],h.command=nr(ir),h.itemsSnapshot=C}else h.args=[],h.command=nr(yt);this.state.setValueAtIndex(i,h)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Ch)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,i,o,s,r)=>{P(t.parentNode,"htFiltersMenuValue");const l=this.hot.rootDocument.createElement("div");return P(l,"htFiltersMenuLabel"),l.textContent=r,t.appendChild(l),t.parentElement.hasAttribute("ghost-table")||b(this.elements,a=>t.appendChild(a.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(Yc),t=this._getColumnVisibleValues(),i=t.map(a=>a.value),o=new Map(t.map(a=>[a.value,a.meta])),s=Bm(i),r=jv(s,s,e,a=>{Wu(wa,this,eS).call(this,a,o)});this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(s);const l=this.hot.getPlugin("filters").getSelectedColumn();l!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,l.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:ae(this.hot.getDataAtCol(e.visualIndex),(t,i)=>({value:XE(t),meta:this.hot.getCellMeta(i,e.visualIndex)}))}}function YV(n){Tl(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),$n(n))}function eS(n,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(n.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",n.visualValue,e.get(n.value)))}function KV(n,e){switch(e.type){case"numeric":return XR(n,e);default:return n}}var iT;function XV(n,e){qV(n,e),e.add(n)}function qV(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QV(n,e,t){return(e=JV(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function JV(n){var e=ZV(n,"string");return typeof e=="symbol"?e:e+""}function ZV(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function eF(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var tS=new WeakSet;class bh extends Dh{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),XV(this,tS),QV(this,"name",""),this.name=t.name,this.elements.push(new os(this.hot,{type:"button",value:iC,className:"htUIButton htUIButtonOK",identifier:bh.BUTTON_OK})),this.elements.push(new os(this.hot,{type:"button",value:oC,className:"htUIButton htUIButtonCancel",identifier:bh.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){b(this.elements,e=>{e.addLocalHook("click",(t,i)=>eF(tS,this,tF).call(this,t,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(P(t.parentNode,"htFiltersMenuActionBar"),b(this.elements,i=>t.appendChild(i.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}iT=bh;function tF(n,e){e.options.identifier===iT.BUTTON_OK?this.accept():this.cancel()}function Bu(n,e,t){return(e=nF(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function nF(n){var e=iF(n,"string");return typeof e=="symbol"?e:e+""}function iF(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const nS="ConditionCollection.filteringStates";class jC{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Bu(this,"hot",void 0),Bu(this,"isMapRegistrable",void 0),Bu(this,"filteringStates",new Fd),Bu(this,"previousConditionStack",null),this.hot=e,this.isMapRegistrable=t,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(nS,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,t){var i;const o=this.filteringStates.getValueAtIndex(t),s=(i=o==null?void 0:o.conditions)!==null&&i!==void 0?i:[],r=o==null?void 0:o.operation;return this.isMatchInConditions(s,e,r)}isMatchInConditions(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:is;return e.length?X$(i)(e,t):!0}addCondition(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:is,o=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,r=ae(t.args,u=>typeof u=="string"?u.toLocaleLowerCase(s):u),l=t.name||t.command.key;this.previousConditionStack===null&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",e);const a=this.getOperation(e);if(a){if(a!==i)throw Error(Re`The column of index ${e} has been already applied with a \`${a}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Ne(mh[i]))throw new Error(Re`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const h=this.getConditions(e);h.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:l,args:r,func:as(l,r)}]},o):h.push({name:l,args:r,func:as(l,r)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,i;return(t=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&t!==void 0?t:[]}getOperation(e){var t;return(t=this.filteringStates.getValueAtIndex(e))===null||t===void 0?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return at(this.filteringStates.getEntries(),(e,t)=>{let[i,{operation:o,conditions:s}]=t;return e.push({column:i,operation:o,conditions:ae(s,r=>{let{name:l,args:a}=r;return{name:l,args:a}})}),e},[])}importAllConditions(e){this.clean(),b(e,t=>{b(t.conditions,i=>this.addCondition(t.column,i))})}removeConditions(e){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const i=this.getConditions(e);return t?i.some(o=>o.name===t):i.length>0}setPreviousConditionStack(e){this.previousConditionStack=e}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(nS),this.filteringStates=null,this.clearLocalHooks()}}Ee(jC,Et);function iS(n,e,t){return(e=oF(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function oF(n){var e=sF(n,"string");return typeof e=="symbol"?e:e+""}function sF(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class oT{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];iS(this,"conditionCollection",void 0),iS(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return b(this.conditionCollection.getFilteredColumns(),(t,i)=>{let o=this.columnDataFactory(t);i&&(o=this._getIntersectData(o,e)),e=this.filterByColumn(t,o)}),e}filterByColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];return b(t,o=>{o!==void 0&&this.conditionCollection.isMatch(o,e)&&i.push(o)}),i}_getIntersectData(e,t){const i=[];return b(t,o=>{const s=o.meta.visualRow;e[s]!==void 0&&(i[s]=e[s])}),i}}function rF(n,e){lF(n,e),e.add(n)}function lF(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Os(n,e,t){return(e=aF(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function aF(n){var e=hF(n,"string");return typeof e=="symbol"?e:e+""}function hF(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function vg(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var ju=new WeakSet;class sT{constructor(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];rF(this,ju),Os(this,"hot",void 0),Os(this,"conditionCollection",void 0),Os(this,"columnDataFactory",void 0),Os(this,"changes",[]),Os(this,"grouping",!1),Os(this,"latestEditedColumnPosition",-1),Os(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",o=>vg(ju,this,uF).call(this,o)),this.conditionCollection.addLocalHook("afterRemove",o=>this.updateStatesAtColumn(o)),this.conditionCollection.addLocalHook("afterAdd",o=>this.updateStatesAtColumn(o)),this.conditionCollection.addLocalHook("beforeClean",()=>vg(ju,this,cF).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>vg(ju,this,dF).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,b(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,t){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const o=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const r=o.slice(0,s),l=o.slice(s);l.length&&l[0].column===e&&l.shift();const a=vy(function(u,c){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const g=new jC(i.hot,!1),p=[].concat(u,d);g.importAllConditions(p);const v=i.columnDataFactory(c);let C;g.isEmpty()?C=v:C=new oT(g,R=>i.columnDataFactory(R)).filter(),C=ae(C,R=>R.meta.visualRow);const S=Lh(C);return g.destroy(),bo(v,R=>S(R.meta.visualRow))})(r),h=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:h},dependentConditionStacks:l,filteredRowsFactory:a,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),te(this,(e,t)=>{this[t]=null})}}function uF(n){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(n)}function cF(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function dF(){b(this.latestOrderStack,n=>{this.updateStatesAtColumn(n)})}Ee(sT,Et);function fF(n){return ME({initialPage:0,size:()=>n.length,onItemSelect:(t,i)=>{const o=n[t];if(o instanceof Ch)return i;if(o.element&&!lr(o.element))return!1;o.focus()}})}const Ca="filters";function gF(n,e){let t=-1;const i=fF(e),o=a=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(Ca),i.setCurrentPage(e.indexOf(a))};e.forEach(a=>{a instanceof oi&&(a.addLocalHook("click",o(a)),a.addLocalHook("focus",o(a)),a.addLocalHook("afterClose",o(a)))}),n.addLocalHook("afterSelectionChange",a=>{a.key.startsWith("filter_")||i.clear()});function s(a){const h=n.getKeyboardShortcutsCtrl(),u=a.getKeyboardShortcutsCtrl();i.clear(),u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:h.getContext(Ca),callback:()=>{a.isSubMenu()&&a.close(),h.listen(Ca)}}]),!a.isSubMenu()&&h.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:c=>{const d=n.getNavigator();d.getCurrentPage()>-1&&(t=d.getCurrentPage()),d.clear(),c.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:c=>{const d=e[i.getCurrentPage()];d instanceof ph&&(d.openOptions(),c.preventDefault()),d instanceof wh&&(d.activate(),c.preventDefault()),d instanceof oi||c.preventDefault()}}],Ca)}n.addLocalHook("afterSubmenuOpen",s),n.addLocalHook("afterOpen",s);function r(){n.focus(),n.getKeyboardShortcutsCtrl().listen(Ca)}function l(){return t}return{...i,listen:r,getLastMenuPage:l}}function mF(n,e){rT(n,e),e.add(n)}function pF(n,e,t){rT(n,e),e.set(n,t)}function rT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ba(n,e,t){return(e=wF(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wF(n){var e=CF(n,"string");return typeof e=="symbol"?e:e+""}function CF(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function bF(n,e,t){return n.set(dn(n,e),t),t}function va(n,e){return n.get(dn(n,e))}function dn(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Um="filters",vF=250,oS=Um;var Ns=new WeakMap,Tn=new WeakSet;class SF extends we{static get PLUGIN_KEY(){return Um}static get PLUGIN_PRIORITY(){return vF}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),mF(this,Tn),ba(this,"dropdownMenuPlugin",null),ba(this,"conditionCollection",null),ba(this,"conditionUpdateObserver",null),ba(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),ba(this,"filtersRowsMap",null),pF(this,Ns,void 0),this.hot.addHook("afterGetColHeader",(t,i)=>dn(Tn,this,PF).call(this,t,i))}isEnabled(){return!!this.hot.getSettings()[Um]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Ih),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,t=e&&e.uiContainer||this.hot.rootDocument.body,i=r=>(r.addLocalHook("accept",()=>dn(Tn,this,sS).call(this,"accept")),r.addLocalHook("cancel",()=>dn(Tn,this,sS).call(this,"cancel")),r.addLocalHook("change",l=>dn(Tn,this,MF).call(this,r,l)),r),o=()=>`${this.hot.getTranslatedPhrase(Jw)}:`,s=()=>`${this.hot.getTranslatedPhrase(Zw)}:`;if(!this.components.get("filter_by_condition")){const r=new jm(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:t});r.addLocalHook("afterClose",()=>dn(Tn,this,rS).call(this)),this.components.set("filter_by_condition",i(r))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new HV(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const r=new jm(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:t});r.addLocalHook("afterClose",()=>dn(Tn,this,rS).call(this)),this.components.set("filter_by_condition2",i(r))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new GV(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new bh(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new jC(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new sT(this.hot,this.conditionCollection,r=>this.getDataMapAtColumn(r)),this.conditionUpdateObserver.addLocalHook("update",r=>dn(Tn,this,IF).call(this,r))),this.components.forEach(r=>r.show()),this.addHook("afterDropdownMenuDefaultOptions",r=>dn(Tn,this,TF).call(this,r)),this.addHook("afterDropdownMenuShow",()=>dn(Tn,this,RF).call(this)),this.addHook("afterDropdownMenuHide",()=>dn(Tn,this,EF).call(this)),this.addHook("afterChange",r=>dn(Tn,this,yF).call(this,r)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!va(Ns,this)&&this.dropdownMenuPlugin.enabled){const r=this.dropdownMenuPlugin.menu,l=[{focus:()=>{const h=r.getNavigator(),u=va(Ns,this).getLastMenuPage();r.focus(),u>0?h.setCurrentPage(u):h.toFirstItem()}},...Array.from(this.components).map(h=>{let[,u]=h;return u.getElements()}).flat()];bF(Ns,this,gF(r,l));const a=h=>{va(Ns,this).listen(),h.preventDefault(),Tl(h.keyCode,"TAB")&&(h.shiftKey?va(Ns,this).toPreviousItem():va(Ns,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",a),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",a)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,i)=>{t.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:oS})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(oS)}addCondition(e,t,i){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:is;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:t},args:i},o)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),i=!this.conditionCollection.isEmpty();let o=[];const s=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",s,this.conditionCollection.previousConditionStack)!==!1)if(i){const l=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),o=ae(t.filter(),h=>h.meta.visualRow);const a=Lh(o);j(this.hot.countSourceRows()-1,h=>{a(h)||l.push(h)}),b(l,h=>{this.filtersRowsMap.setValueAtIndex(h,!0)})},!0),!e&&!o.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),i=[];return b(this.hot.getSourceDataAtCol(t),(o,s)=>{var r;const{row:l,col:a,visualCol:h,visualRow:u,type:c,instance:d,dateFormat:g,locale:p}=this.hot.getCellMeta(s,t),v=(r=this.hot.getDataAtCell(this.hot.toVisualRow(s),t))!==null&&r!==void 0?r:o;i.push({meta:{row:l,col:a,visualCol:h,visualRow:u,type:c,instance:d,dateFormat:g,locale:p},value:XE(v)})}),i}updateValueComponentCondition(e){const t=this.hot.getDataAtCol(e),i=Bm(t);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var t;const i=(t=this.getSelectedColumn())===null||t===void 0?void 0:t.physicalIndex;e.forEach(o=>{o.isHidden()||o.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,i,o){let s=e;return s===od&&t.command.key!==yt&&i.command.key!==yt&&o.command.key!==yt?s=WC:o.command.key!==yt&&(t.command.key===yt||i.command.key===yt)&&(s=is),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new oT(e,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return b(o,r=>{b(t.menuItems,(l,a)=>{l.key===r.getMenuItemDescriptor().key&&e.push(a)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const i=this.dropdownMenuPlugin.menu.hotMenu,o=i.getPlugin("hiddenRows");for(var s=arguments.length,r=new Array(s>1?s-1:0),l=1;l<s;l++)r[l-1]=arguments[l];const a=this.getIndexesOfComponents(...r);e?o.showRows(a):o.hideRows(a),i.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{e!==null&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function yF(n){n&&b(n,e=>{const[,t]=e,i=this.hot.propToCol(t);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function RF(){const n=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),n.updateMenuDimensions()}function EF(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function TF(n){n.items.push({name:ne}),this.components.forEach(e=>{n.items.push(e.getMenuItemDescriptor())})}function sS(n){var e;if(n==="accept"){const i=this.getSelectedColumn();if(i===null){var t;(t=this.dropdownMenuPlugin)===null||t===void 0||t.close();return}const{physicalIndex:o}=i,s=this.components.get("filter_by_condition").getState(),r=this.components.get("filter_by_condition2").getState(),l=this.components.get("filter_by_value").getState(),a=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,r,l);this.conditionUpdateObserver.groupChanges();let h=this.conditionCollection.getColumnStackPosition(o);h===-1&&(h=void 0),this.conditionCollection.removeConditions(o),s.command.key!==yt&&(this.conditionCollection.addCondition(o,s,a,h),r.command.key!==yt&&this.conditionCollection.addCondition(o,r,a,h)),l.command.key!==yt&&this.conditionCollection.addCondition(o,l,a,h),this.conditionUpdateObserver.flush(),this.components.forEach(u=>u.saveState(o)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function MF(n,e){this.updateDependentComponentsVisibility(),n.constructor===jm&&!e.inputsCount&&this.setListeningDropdownMenu()}function rS(){this.setListeningDropdownMenu()}function PF(n,e){const t=this.hot.toPhysicalColumn(n);this.enabled&&this.conditionCollection.hasConditions(t)?P(e,"htFiltersActive"):X(e,"htFiltersActive")}function IF(n){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:t,column:i}}=n,o=t.filter(r=>r.name===ir),s=t.filter(r=>r.name!==ir);if(o.length>=2||s.length>=3)ye(Re`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const r=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(s[0],i),this.components.get("filter_by_condition2").updateState(s[1],i),this.components.get("filter_operators").updateState(r,i),this.components.get("filter_by_value").updateState(n)}}const lT="internal-use-in-handsontable",zm={licenseKey:lT,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function aT(n){var e;return{maxColumns:n.maxColumns,maxRows:n.maxRows,language:(e=n[Ot])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function hT(n){return Object.keys(n).reduce((e,t)=>(t!=="hyperformula"&&(e[t]=n[t]),e),{})}function HF(n){var e;const t=n[Ot],i=hT(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),o=aT(n);return{...zm,...i,...o}}function xF(n){var e;const t=n[Ot],i=hT(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),o=aT(n);return{...i,...o}}function AF(n,e){return Object.keys(e).some(t=>e[t]!==void 0&&e[t]!==n[t])}function lf(){const n="engine_relationship",e=ai(Ot);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function UC(){const n="shared_engine_usage",e=ai(Ot);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function _F(n){const e=n.getSettings(),t=e[Ot],i=t==null?void 0:t.engine;if(t===!0||Ne(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var o;return OF((o=i.hyperformula)!==null&&o!==void 0?o:i,e,n)}else if(typeof i=="object"&&Ne(i.hyperformula)){const s=lf(),r=UC().get(i);return s.has(i)||s.set(i,[]),s.get(i).push(n),r&&r.push(n.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:lT}),(i.getConfig().leapYear1900!==zm.leapYear1900||xd(i.getConfig().nullDate,zm.nullDate)===!1)&&ye(Re`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function OF(n,e,t){const i=e[Ot],o=HF(e),s=lf(),r=UC();NF(n,i.functions),DF(n,i.language);const l=n.buildEmpty(o);return s.set(l,[t]),r.set(l,[t.guid]),LF(l,i.namedExpressions),l.on("sheetAdded",()=>{l.rebuildAndRecalculate()}),l.on("sheetRemoved",()=>{l.rebuildAndRecalculate()}),l}function lS(n){var e;const t=lf(),i=t.size===0?[]:Array.from((e=t.get(n))!==null&&e!==void 0?e:[]);return new Map(i.map(o=>[o.getPlugin("formulas").sheetId,o]))}function aS(n,e){if(n){const t=lf(),i=t.get(n),o=UC(),s=o.get(n);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),i.length===0&&t.delete(n)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(o.delete(n),n.destroy()))}}function NF(n,e){e&&e.forEach(t=>{const{name:i,plugin:o,translations:s}=t;try{n.registerFunction(i,o,s)}catch(r){ye(r.message)}})}function DF(n,e){if(e){const{langCode:t}=e;try{n.registerLanguage(t,e)}catch(i){ye(i.message)}}}function LF(n,e){e&&(n.suspendEvaluation(),e.forEach(t=>{const{name:i,expression:o,scope:s,options:r}=t;try{n.addNamedExpression(i,o,s,r)}catch(l){ye(l.message)}}),n.resumeEvaluation())}function kF(n,e){return(Ne(e)||!n.doesSheetExist(e))&&(e=n.addSheet(e)),e}const uT="DD/MM/YYYY";function cT(n){return typeof n=="string"&&n.charAt(0)==="'"&&n.charAt(1)==="="}function $F(n){return cT(n)?n.substr(1):n}function VF(n){return typeof n=="string"&&n.startsWith("=")}function zC(n,e){return typeof n=="string"&&e==="date"}function dT(n,e){return pe(n,e,!0).isValid()}function fT(n,e){return pe(n,e,!0).format(uT)}function FF(n,e){return pe(n,uT,!0).format(e)}function gT(n,e){const i=new Date(Date.UTC(0,0,n+-1));return pe(i).format(e)}function WF(n,e,t){const i=Array.from(Array(t).keys()).filter(s=>n.includes(s)===!1);if(e===0){var o;return(o=i[e])!==null&&o!==void 0?o:0}return i[e-1]+1}function BF(n,e){const t=[];return n.forEach(i=>{const o={from:i,to:e};t.forEach(s=>{const r=s.from>s.to,l=s.to<=o.from;s.from>o.from&&l&&r&&(o.from+=1)}),o.from>=e&&(e+=1),t.push(o)}),t}function jF(n){return n.forEach((e,t)=>{n.slice(t+1).forEach(o=>{const s=o.from<o.to;o.from>e.from&&s&&(o.from-=1)})}),n}function GC(n,e,t){const i=BF(n,WF(n,e,t));return jF(i)}function Ds(n,e,t){UF(n,e),e.set(n,t)}function UF(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ve(n,e){return n.get(mT(n,e))}function Do(n,e,t){return n.set(mT(n,e),t),t}function mT(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Sa=new WeakMap,Lo=new WeakMap,an=new WeakMap,Uu=new WeakMap,Sg=new WeakMap,yg=new WeakMap,zu=new WeakMap;class hS{constructor(e,t,i){Ds(this,Sa,void 0),Ds(this,Lo,void 0),Ds(this,an,void 0),Ds(this,Uu,[]),Ds(this,Sg,[]),Ds(this,yg,void 0),Ds(this,zu,[]),Do(Sa,this,e),Do(Lo,this,t),Do(an,this,i)}setRemovedHfIndexes(e){return Do(zu,this,e.map(t=>{const i=Ve(Lo,this).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(i)})),Ve(zu,this)}getRemovedHfIndexes(){return Ve(zu,this)}getHfIndexFromVisualIndex(e){const t=Ve(Lo,this).getIndexesSequence(),i=Ve(Lo,this).getNotTrimmedIndexes();return t.indexOf(i[e])}syncMoves(e){const i=`move${Nt(Ve(Sa,this))}s`;Ve(an,this).getEngine().batch(()=>{e.forEach(o=>{const s=o.from!==o.to,r=o.from+1!==o.to;s&&r&&Ve(an,this).getEngine()[i](Ve(an,this).getSheetId(),o.from,1,o.to)})})}storeMovesInformation(e,t,i){i!==!1&&(Do(Sg,this,e.map(o=>this.getHfIndexFromVisualIndex(o))),Do(yg,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(Ve(an,this).isPerformingUndoRedo()||e===!1||t===!1)return;const i=GC(Ve(Sg,this),Ve(yg,this),Ve(Lo,this).getNumberOfIndexes());Ve(an,this).getSheetId()===null?Ve(an,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){const e=`set${Nt(Ve(Sa,this))}Order`;return t=>{if(Ve(an,this).isPerformingUndoRedo())return;const i=Ve(Lo,this).getIndexesSequence();if(t==="update"&&i.length>0){const o=Ve(Uu,this).map(a=>i.indexOf(a)),s=Ve(an,this).getEngine().getSheetDimensions(Ve(an,this).getSheetId());let r;Ve(Sa,this)==="row"?r=s.height:r=s.width;const l=o.length;for(let a=l;a<r;a+=1)o.push(a);Ve(an,this).getEngine()[e](Ve(an,this).getSheetId(),o)}Do(Uu,this,i)}}init(){Do(Uu,this,Ve(Lo,this).getIndexesSequence())}}function Ls(n,e,t){zF(n,e),e.set(n,t)}function zF(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function io(n,e){return n.get(pT(n,e))}function ks(n,e,t){return n.set(pT(n,e),t),t}function pT(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Gu=new WeakMap,Yu=new WeakMap,Rg=new WeakMap,Eg=new WeakMap,Tg=new WeakMap,Mg=new WeakMap,Pg=new WeakMap;class GF{constructor(e,t,i){Ls(this,Gu,void 0),Ls(this,Yu,void 0),Ls(this,Rg,void 0),Ls(this,Eg,!1),Ls(this,Tg,!1),Ls(this,Mg,null),Ls(this,Pg,null),ks(Gu,this,new hS("row",e,this)),ks(Yu,this,new hS("column",t,this)),ks(Rg,this,i)}getForAxis(e){return e==="row"?io(Gu,this):io(Yu,this)}setPerformUndo(e){ks(Eg,this,e)}setPerformRedo(e){ks(Tg,this,e)}isPerformingUndoRedo(){return io(Eg,this)||io(Tg,this)}getSheetId(){return io(Pg,this)}getEngine(){return io(Mg,this)}getPostponeAction(){return io(Rg,this)}setupSyncEndpoint(e,t){ks(Mg,this,e),ks(Pg,this,t),io(Gu,this).init(),io(Yu,this).init()}}function YF(n,e){wT(n,e),e.add(n)}function Qr(n,e,t){return(e=KF(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function KF(n){var e=XF(n,"string");return typeof e=="symbol"?e:e+""}function XF(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Ig(n,e,t){wT(n,e),e.set(n,t)}function wT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hs(n,e,t){return n.set(Me(n,e),t),t}function gl(n,e){return n.get(Me(n,e))}function Me(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Ot="formulas",qF=["maxRows","maxColumns","language"],QF=260;V.getSingleton().register("afterNamedExpressionAdded");V.getSingleton().register("afterNamedExpressionRemoved");V.getSingleton().register("afterSheetAdded");V.getSingleton().register("afterSheetRemoved");V.getSingleton().register("afterSheetRenamed");V.getSingleton().register("afterFormulasValuesUpdate");const xl=n=>n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto";var So=new WeakMap,YC=new WeakMap,ya=new WeakMap,xe=new WeakSet;class JF extends we{constructor(){var e;super(...arguments),e=this,YF(this,xe),Ig(this,So,!1),Ig(this,YC,!1),Ig(this,ya,[["valuesUpdated",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Me(xe,e,gW).call(e,...i)}],["namedExpressionAdded",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Me(xe,e,mW).call(e,...i)}],["namedExpressionRemoved",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Me(xe,e,pW).call(e,...i)}],["sheetAdded",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Me(xe,e,wW).call(e,...i)}],["sheetRenamed",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Me(xe,e,CW).call(e,...i)}],["sheetRemoved",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Me(xe,e,bW).call(e,...i)}]]),Qr(this,"staticRegister",ai("formulas")),Qr(this,"engine",null),Qr(this,"sheetName",null),Qr(this,"indexSyncer",null),Qr(this,"rowAxisSyncer",null),Qr(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Ot}static get PLUGIN_PRIORITY(){return QF}static get SETTING_KEYS(){return[Ot,...qF]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Ot]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=(e=_F(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){ye("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const i=this.addSheet(this.sheetName,this.hot.getSourceDataArray());i!==!1&&(this.sheetName=i)}this.addHook("beforeLoadData",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,uS).call(t,...o)}),this.addHook("afterLoadData",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,cS).call(t,...o)}),this.addHook("beforeUpdateData",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,uS).call(t,...o)}),this.addHook("afterUpdateData",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,cS).call(t,...o)}),this.addHook("modifyData",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,nW).call(t,...o)}),this.addHook("modifySourceData",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,iW).call(t,...o)}),this.addHook("beforeValidate",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,ZF).call(t,...o)}),this.addHook("afterSetSourceDataAtCell",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,oW).call(t,...o)}),this.addHook("afterSetDataAtCell",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,dS).call(t,...o)}),this.addHook("afterSetDataAtRowProp",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,dS).call(t,...o)}),this.addHook("beforeCreateRow",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,sW).call(t,...o)}),this.addHook("beforeCreateCol",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,rW).call(t,...o)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,hW).call(t,...o)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,uW).call(t,...o)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,lW).call(t,...o)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,aW).call(t,...o)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,cW).call(t,...o)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,dW).call(t,...o)}),this.indexSyncer=new GF(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,o,s,r)=>{this.rowAxisSyncer.storeMovesInformation(i,o,r)}),this.hot.addHook("beforeColumnMove",(i,o,s,r)=>{this.columnAxisSyncer.storeMovesInformation(i,o,r)}),this.hot.addHook("afterRowMove",(i,o,s,r,l)=>{this.rowAxisSyncer.calculateAndSyncMoves(r,l)}),this.hot.addHook("afterColumnMove",(i,o,s,r,l)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,l)}),this.hot.addHook("beforeColumnFreeze",(i,o)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,o)}),this.hot.addHook("afterColumnFreeze",(i,o)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,o)}),this.hot.addHook("beforeColumnUnfreeze",(i,o)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,o)}),this.hot.addHook("afterColumnUnfreeze",(i,o)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,o)}),this.addHook("afterCellMetaReset",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,tW).call(t,...o)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,fW).call(t,...o)}),this.addHook("beforeAutofill",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Me(xe,t,eW).call(t,...o)}),gl(ya,this).forEach(i=>{let[o,s]=i;return this.engine.on(o,s)}),super.enablePlugin()}}disablePlugin(){gl(ya,this).forEach(e=>{let[t,i]=e;return this.engine.off(t,i)}),aS(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=xF(this.hot.getSettings());AF(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const i=this.hot.getSettings()[Ot];if(F(i)&&F(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){const o=this.hot.getSettings()[Ot].sheetName;o&&this.engine.doesSheetExist(o)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(o??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){gl(ya,this).forEach(e=>{var t;let[i,o]=e;return(t=this.engine)===null||t===void 0?void 0:t.off(i,o)}),hs(ya,this,null),aS(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(F(t)&&!cR(t))return ye("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return ye("Sheet with the provided name already exists."),!1;try{const i=this.engine.addSheet(e??void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(i),t),i}catch(i){return ye(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){vp(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${Nt(Ot)}.switchSheet`)}getCellType(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const o=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(t);return o!==null&&s!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=new Set;e.forEach(o=>{var s;const r=o==null||(s=o.address)===null||s===void 0?void 0:s.sheet;r!==void 0&&(i.has(r)||i.add(r))}),lS(this.engine).forEach((o,s)=>{if((t||s!==this.sheetId)&&i.has(s)){var r;o.render(),(r=o.view)===null||r===void 0||r.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=s=>{var r;const{row:l,col:a,sheet:h}=(r=s==null?void 0:s.address)!==null&&r!==void 0?r:{};return F(h)?`${h}:${l}x${a}`:""},o=new Set(t.map(s=>i(s)));e.forEach(s=>{var r,l;const{row:a,col:h}=(r=s.address)!==null&&r!==void 0?r:{};if(F(a)===!1||F(h)===!1||a>=this.hot.countRows()||h>=this.hot.countCols())return;const u=s==null||(l=s.address)===null||l===void 0?void 0:l.sheet,c=i(s);if(u!==void 0&&!o.has(c)){const d=lS(this.engine).get(u);if(!d)return;d.validateCell(d.getDataAtCell(a,h),d.getCellMeta(a,h),()=>{})}})}syncChangeWithEngine(e,t,i){const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(o)){ye(`Not possible to set cell data at ${JSON.stringify(o)}`);return}const s=this.hot.getCellMeta(e,t);return zC(i,s.type)&&(dT(i,s.dateFormat)?i=fT(i,s.dateFormat):VF(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(o,i)}}function ZF(n,e,t){const i=this.hot.propToCol(t);if(this.isFormulaCellType(e,i)){const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},s=this.hot.getCellMeta(e,i);let r=this.engine.getCellValue(o);return s.type==="date"&&_t(r)&&(r=gT(r,s.dateFormat)),typeof r=="object"&&r!==null?r.value:r}return n}function eW(n,e,t){const{row:i,col:o}=e.getTopStartCorner(),{row:s,col:r}=e.getBottomEndCorner(),{row:l,col:a}=t.getTopStartCorner(),{row:h,col:u}=t.getBottomEndCorner(),c={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const g=this.engine.getFillRangeData(c,d),{row:p,col:v}=c.start,{row:C,col:S}=c.end,R=C-p+1,M=S-v+1;for(let I=0;I<g.length;I+=1)for(let H=0;H<g[I].length;H+=1){const O=g[I][H],k=p+I%R,N=v+H%M,Ce=this.hot.getCellMeta(k,N);zC(O,Ce.type)&&(O.startsWith("'")?g[I][H]=O.slice(1):this.isFormulaCellType(k,N,this.sheetId)===!1&&(g[I][H]=FF(O,Ce.dateFormat)))}return g}function uS(n,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Nt(Ot))||hs(YC,this,Ne(this.hot.getSettings().data))}function tW(){const n=this.hot.getSourceDataArray();let e=!1;n.forEach((t,i)=>{t.forEach((o,s)=>{const r=this.hot.getCellMeta(i,s),l=r.dateFormat;zC(o,r.type)&&(e=!0,dT(o,l)?n[i][s]=fT(o,l):this.isFormulaCellType(i,s)===!1&&(n[i][s]=`'${o}`))})}),e===!0&&(hs(So,this,!0),this.engine.setSheetContent(this.sheetId,n),hs(So,this,!1))}function cS(n,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Nt(Ot)))if(this.sheetName=kF(this.engine,this.hot.getSettings()[Ot].sheetName),gl(YC,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){hs(So,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),hs(So,this,!1)}}}function nW(n,e,t,i){if(i!=="get"||gl(So,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const o=this.hot.toVisualRow(n);if(o===null||e===null)return;if(!this.isFormulaCellType(o,e)&&this.getCellType(o,e)!=="ARRAY"){cT(t.value)&&(t.value=$F(t.value));return}const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let l=this.engine.getCellValue(r),a=this.hot.getCellsMeta().find(u=>u.visualRow===o&&u.visualCol===e);a===void 0&&(a={}),a.type==="date"&&_t(l)&&(l=gT(l,a.dateFormat));const h=typeof l=="object"&&l!==null?l.value:l;t.value=h}function iW(n,e,t,i){if(i!=="get"||gl(So,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const o=this.hot.toVisualRow(n),s=this.hot.propToCol(e);if(o===null||s===null||!this.isFormulaCellType(o,s)&&this.getCellType(o,s)!=="ARRAY")return;const l=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(l.width===0&&l.height===0)return;const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};t.value=this.engine.getCellSerialized(a)}function dS(n,e){if(xl(e))return;const t=[],i=[],o=this.engine.batch(()=>{n.forEach(s=>{let[r,l,,a]=s;const h=this.hot.propToCol(l),u=this.hot.toPhysicalRow(r),c=this.hot.toPhysicalColumn(h),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId};u!==null&&c!==null?this.syncChangeWithEngine(r,h,a):t.push([r,h,a]),i.push({address:d})})});t.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{t.forEach(r=>{let[l,a,h]=r;this.syncChangeWithEngine(l,a,h)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(o),this.validateDependentCells(o,i)}function oW(n,e){if(xl(e))return;const t=[],i=[];n.forEach(o=>{let[s,r,,l]=o;const a=this.hot.propToCol(r);if(!_t(a))return;const h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(h)){ye(`Not possible to set source cell data at ${JSON.stringify(h)}`);return}i.push({address:h}),t.push(...this.engine.setCellContents(h,l))}),this.renderDependentSheets(t),this.validateDependentCells(t,i)}function sW(n,e){let t=this.rowAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countRows()&&(t=n),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[t,e]))return!1}function rW(n,e){let t=this.columnAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countCols()&&(t=n),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[t,e]))return!1}function lW(n,e,t){return this.rowAxisSyncer.setRemovedHfIndexes(t).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function aW(n,e,t){return this.columnAxisSyncer.setRemovedHfIndexes(t).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function hW(n,e,t){if(xl(t))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(n),e]);this.renderDependentSheets(i)}function uW(n,e,t){if(xl(t))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(n),e]);this.renderDependentSheets(i)}function cW(n,e,t,i){if(xl(i))return;const o=this.rowAxisSyncer.getRemovedHfIndexes().sort((r,l)=>l-r),s=this.engine.batch(()=>{o.forEach(r=>{this.engine.removeRows(this.sheetId,[r,1])})});this.renderDependentSheets(s)}function dW(n,e,t,i){if(xl(i))return;const o=this.columnAxisSyncer.getRemovedHfIndexes().sort((r,l)=>l-r),s=this.engine.batch(()=>{o.forEach(r=>{this.engine.removeColumns(this.sheetId,[r,1])})});this.renderDependentSheets(s)}function fW(n,e,t){var i;hs(So,this,!0);const o=this.hot.getSourceDataArray(t,0,t+(((i=e.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());hs(So,this,!1),o.forEach((s,r)=>{s.forEach((l,a)=>{this.engine.setCellContents({col:a,row:t+r,sheet:this.sheetId},[[l]])})})}function gW(n){this.hot.runHooks("afterFormulasValuesUpdate",n)}function mW(n,e){this.hot.runHooks("afterNamedExpressionAdded",n,e)}function pW(n,e){this.hot.runHooks("afterNamedExpressionRemoved",n,e)}function wW(n){this.hot.runHooks("afterSheetAdded",n)}function CW(n,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",n,e)}function bW(n,e){this.hot.runHooks("afterSheetRemoved",n,e)}function vW(n){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,i,,o]=e;i-o!==0&&(t=1)}return this.getTranslatedPhrase(Hw,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.col,t.col),0),o=Math.max(e.col,t.col),s=[];for(let a=i;a<=o;a+=1)s.push(a);n.hideColumns(s);const r=s[s.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(r,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function SW(n){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(xw,t)},callback(){var t,i;if(e.length===0)return;let o=e[0],s=e[e.length-1];o=(t=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&t!==void 0?t:0,s=(i=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&i!==void 0?i:this.countCols()-1,n.showColumns(e),this.render(),this.view.adjustElementsSize(),s-o+1===this.countCols()||this.selectColumns(o,s)},disabled:!1,hidden(){const t=ae(n.getHiddenColumns(),c=>this.toPhysicalColumn(c));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),o=i.getTopStartCorner().col,s=i.getBottomEndCorner().col,r=this.columnIndexMapper,l=r.getRenderableFromVisualIndex(o),a=r.getRenderableFromVisualIndex(s),h=r.getNotTrimmedIndexes(),u=[];if(o!==s){const c=s-o+1,d=a-l+1;if(c>d){const g=h.slice(o,s+1);u.push(...g.filter(p=>t.includes(p)))}}else if(l===0&&l<o)u.push(...h.slice(0,o));else if(l===null)u.push(...h.slice(0,this.countCols()));else{const c=this.countCols()-1,d=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(c,-1));a===d&&c>s&&u.push(...h.slice(s+1))}return b(u,c=>{e.push(this.toVisualColumn(c))}),e.length===0}}}function yW(n,e){CT(n,e),e.add(n)}function fS(n,e,t){CT(n,e),e.set(n,t)}function CT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cn(n,e){return n.get(jo(n,e))}function Ra(n,e,t){return n.set(jo(n,e),t),t}function jo(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}V.getSingleton().register("beforeHideColumns");V.getSingleton().register("afterHideColumns");V.getSingleton().register("beforeUnhideColumns");V.getSingleton().register("afterUnhideColumns");const Hg="hiddenColumns",RW=310;var Bi=new WeakMap,yi=new WeakMap,$s=new WeakSet;class EW extends we{constructor(){super(...arguments),yW(this,$s),fS(this,Bi,{}),fS(this,yi,null)}static get PLUGIN_KEY(){return Hg}static get PLUGIN_PRIORITY(){return RW}isEnabled(){return!!this.hot.getSettings()[Hg]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Hg];ee(t)&&(Ra(Bi,this,t),Ne(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),Ra(yi,this,new Vd),Cn(yi,this).addLocalHook("init",()=>jo($s,this,xW).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Cn(yi,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return jo($s,e,HW).call(e,...o)}),this.addHook("afterGetCellMeta",(i,o,s)=>jo($s,this,MW).call(this,i,o,s)),this.addHook("modifyColWidth",(i,o)=>jo($s,this,TW).call(this,i,o),2),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return jo($s,e,IW).call(e,...o)}),this.addHook("modifyCopyableRange",i=>jo($s,this,PW).call(this,i)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Ra(Bi,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),i=this.isValidConfig(e);let o=t;const s=Cn(yi,this).getValues().slice(),r=e.length>0;if(i&&r){const a=e.map(h=>this.hot.toPhysicalColumn(h));b(a,h=>{s[h]=!1}),o=at(s,(h,u,c)=>(u&&h.push(this.hot.toVisualColumn(c)),h),[])}this.hot.runHooks("beforeUnhideColumns",t,o,i&&r)!==!1&&(i&&r&&Cn(yi,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,o,i&&r,i&&o.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),i=this.isValidConfig(e);let o=t;i&&(o=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideColumns",t,o,i)!==!1&&(i&&this.hot.batchExecution(()=>{b(e,r=>{Cn(yi,this).setValueAtIndex(this.hot.toPhysicalColumn(r),!0)})},!0),this.hot.runHooks("afterHideColumns",t,o,i,i&&o.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.hideColumns(t)}getHiddenColumns(){return ae(Cn(yi,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Cn(yi,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<t):!1}resetCellsMeta(){b(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){Ra(Bi,this,null),Ra(yi,this,null),super.destroy()}}function TW(n,e){if(this.isHidden(e))return 0;if(Cn(Bi,this).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof n=="number"&&this.hot.hasColHeaders())return n+15}function MW(n,e,t){if(Cn(Bi,this).copyPasteEnabled===!1&&this.isHidden(e)&&(t.skipColumnOnPaste=!0),this.isHidden(e-1))t.className=t.className||"",t.className.indexOf("afterHiddenColumn")===-1&&(t.className+=" afterHiddenColumn");else if(t.className){const i=t.className.split(" ");if(i.length>0){const o=i.indexOf("afterHiddenColumn");o>-1&&i.splice(o,1),t.className=i.join(" ")}}}function PW(n){if(Cn(Bi,this).copyPasteEnabled)return n;const e=[],t=(i,o,s,r)=>{e.push({startRow:i,endRow:o,startCol:s,endCol:r})};return b(n,i=>{let o=!0,s=0;j(i.startCol,i.endCol,r=>{this.isHidden(r)?(o||t(i.startRow,i.endRow,s,r-1),o=!0):(o&&(s=r),r===i.endCol&&t(i.startRow,i.endRow,s,r),o=!1)})}),e}function IW(n,e){if(!Cn(Bi,this).indicators||n<0)return;const t=[];n>=1&&this.isHidden(n-1)&&t.push("afterHiddenColumn"),n<this.hot.countCols()-1&&this.isHidden(n+1)&&t.push("beforeHiddenColumn"),P(e,t)}function HW(n){n.items.push({name:ne},vW(this),SW(this))}function xW(){Array.isArray(Cn(Bi,this).columns)&&this.hideColumns(Cn(Bi,this).columns)}function AW(n){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[i,,o]=e;i-o!==0&&(t=1)}return this.getTranslatedPhrase(Aw,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.row,t.row),0),o=Math.max(e.row,t.row),s=[];for(let a=i;a<=o;a+=1)s.push(a);n.hideRows(s);const r=s[s.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(r,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function _W(n){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(_w,t)},callback(){var t,i;if(e.length===0)return;let o=e[0],s=e[e.length-1];o=(t=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&t!==void 0?t:0,s=(i=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&i!==void 0?i:this.countRows()-1,n.showRows(e),this.render(),this.view.adjustElementsSize(),s-o+1===this.countRows()||this.selectRows(o,s)},disabled:!1,hidden(){const t=ae(n.getHiddenRows(),c=>this.toPhysicalRow(c));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),o=i.getTopStartCorner().row,s=i.getBottomEndCorner().row,r=this.rowIndexMapper,l=r.getRenderableFromVisualIndex(o),a=r.getRenderableFromVisualIndex(s),h=r.getNotTrimmedIndexes(),u=[];if(o!==s){const c=s-o+1,d=a-l+1;if(c>d){const g=h.slice(o,s+1);u.push(...g.filter(p=>t.includes(p)))}}else if(l===0&&l<o)u.push(...h.slice(0,o));else if(l===null)u.push(...h.slice(0,this.countRows()));else{const c=this.countRows()-1,d=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(c,-1));a===d&&c>s&&u.push(...h.slice(s+1))}return b(u,c=>{e.push(this.toVisualRow(c))}),e.length===0}}}function OW(n,e){bT(n,e),e.add(n)}function gS(n,e,t){bT(n,e),e.set(n,t)}function bT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _n(n,e){return n.get(Uo(n,e))}function Ea(n,e,t){return n.set(Uo(n,e),t),t}function Uo(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}V.getSingleton().register("beforeHideRows");V.getSingleton().register("afterHideRows");V.getSingleton().register("beforeUnhideRows");V.getSingleton().register("afterUnhideRows");const xg="hiddenRows",NW=320;var po=new WeakMap,Ri=new WeakMap,Vs=new WeakSet;class DW extends we{constructor(){super(...arguments),OW(this,Vs),gS(this,po,{}),gS(this,Ri,null)}static get PLUGIN_KEY(){return xg}static get PLUGIN_PRIORITY(){return NW}isEnabled(){return!!this.hot.getSettings()[xg]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[xg];ee(t)&&(Ea(po,this,t),Ne(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),Ea(Ri,this,new Vd),_n(Ri,this).addLocalHook("init",()=>Uo(Vs,this,WW).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,_n(Ri,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Uo(Vs,e,FW).call(e,...o)}),this.addHook("afterGetCellMeta",(i,o,s)=>Uo(Vs,this,kW).call(this,i,o,s)),this.addHook("modifyRowHeight",(i,o)=>Uo(Vs,this,LW).call(this,i,o)),this.addHook("afterGetRowHeader",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Uo(Vs,e,VW).call(e,...o)}),this.addHook("modifyCopyableRange",i=>Uo(Vs,this,$W).call(this,i)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Ea(po,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),i=this.isValidConfig(e);let o=t;const s=_n(Ri,this).getValues().slice(),r=e.length>0;if(i&&r){const a=e.map(h=>this.hot.toPhysicalRow(h));b(a,h=>{s[h]=!1}),o=at(s,(h,u,c)=>(u&&h.push(this.hot.toVisualRow(c)),h),[])}this.hot.runHooks("beforeUnhideRows",t,o,i&&r)!==!1&&(i&&r&&_n(Ri,this).setValues(s),this.hot.runHooks("afterUnhideRows",t,o,i&&r,i&&o.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),i=this.isValidConfig(e);let o=t;i&&(o=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideRows",t,o,i)!==!1&&(i&&this.hot.batchExecution(()=>{b(e,r=>{_n(Ri,this).setValueAtIndex(this.hot.toPhysicalRow(r),!0)})},!0),this.hot.runHooks("afterHideRows",t,o,i,i&&o.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.hideRows(t)}getHiddenRows(){return ae(_n(Ri,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return _n(Ri,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<t):!1}resetCellsMeta(){b(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){Ea(po,this,null),Ea(Ri,this,null),super.destroy()}}function LW(n,e){return this.isHidden(e)?0:n}function kW(n,e,t){if(_n(po,this).copyPasteEnabled===!1&&this.isHidden(n)&&(t.skipRowOnPaste=!0),this.isHidden(n-1))t.className=t.className||"",t.className.indexOf("afterHiddenRow")===-1&&(t.className+=" afterHiddenRow");else if(t.className){const i=t.className.split(" ");if(i.length>0){const o=i.indexOf("afterHiddenRow");o>-1&&i.splice(o,1),t.className=i.join(" ")}}}function $W(n){if(_n(po,this).copyPasteEnabled)return n;const e=[],t=(i,o,s,r)=>{e.push({startRow:i,endRow:o,startCol:s,endCol:r})};return b(n,i=>{let o=!0,s=0;j(i.startRow,i.endRow,r=>{this.isHidden(r)?(o||t(s,r-1,i.startCol,i.endCol),o=!0):(o&&(s=r),r===i.endRow&&t(s,r,i.startCol,i.endCol),o=!1)})}),e}function VW(n,e){if(!_n(po,this).indicators||n<0)return;const t=[];n>=1&&this.isHidden(n-1)&&t.push("afterHiddenRow"),n<this.hot.countRows()-1&&this.isHidden(n+1)&&t.push("beforeHiddenRow"),P(e,t)}function FW(n){n.items.push({name:ne},AW(this),_W(this))}function WW(){Array.isArray(_n(po,this).rows)&&this.hideRows(_n(po,this).rows)}function BW(n){return{key:"freeze_column",name(){return this.getTranslatedPhrase(dw)},callback(e,t){const[{start:{col:i}}]=t;n.freezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}function jW(n){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(fw)},callback(e,t){const[{start:{col:i}}]=t;n.unfreezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}function UW(n,e){vT(n,e),e.add(n)}function zW(n,e,t){vT(n,e),e.set(n,t)}function vT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gm(n,e){return n.get(rd(n,e))}function Ag(n,e,t){return n.set(rd(n,e),t),t}function rd(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}V.getSingleton().register("beforeColumnFreeze");V.getSingleton().register("afterColumnFreeze");V.getSingleton().register("beforeColumnUnfreeze");V.getSingleton().register("afterColumnUnfreeze");const mS="manualColumnFreeze",GW=110;var qs=new WeakMap,_g=new WeakSet;class YW extends we{constructor(){super(...arguments),UW(this,_g),zW(this,qs,!1)}static get PLUGIN_KEY(){return mS}static get PLUGIN_PRIORITY(){return GW}isEnabled(){return!!this.hot.getSettings()[mS]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>rd(_g,this,KW).call(this,e)),this.addHook("beforeColumnMove",(e,t)=>rd(_g,this,XW).call(this,e,t)),super.enablePlugin())}disablePlugin(){Ag(qs,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=this.hot.getSettings(),i=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;Gm(qs,this)||Ag(qs,this,!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const t=this.hot.getSettings(),i=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;Gm(qs,this)||Ag(qs,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}}function KW(n){n.items.push({name:"---------"},BW(this),jW(this))}function XW(n,e){if(Gm(qs,this)){const t=this.hot.getSettings().fixedColumnsStart;if(e<t||n.some(i=>i<t))return!1}}function Ku(n,e,t){return(e=qW(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function qW(n){var e=QW(n,"string");return typeof e=="symbol"?e:e+""}function QW(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Og=0,pS=1,wS=2,Jr="px";let ST=class{constructor(e){Ku(this,"hot",void 0),Ku(this,"_element",null),Ku(this,"state",Og),Ku(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=wS}build(){this.state===Og&&(this._element=this.hot.rootDocument.createElement("div"),this.state=pS)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Og}isAppended(){return this.state===wS}isBuilt(){return this.state>=pS}setPosition(e,t){_t(e)&&(this._element.style.top=e+Jr),_t(t)&&(this._element.style[this.inlineProperty]=t+Jr)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){_t(e)&&(this._element.style.width=e+Jr),_t(t)&&(this._element.style.height=t+Jr)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){_t(e)&&(this._element.style.marginTop=e+Jr),_t(t)&&(this._element.style[`margin${Nt(this.inlineProperty)}`]=t+Jr)}getOffset(){const e=this._element.style,t=`margin${Nt(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}};const JW="ht__manualColumnMove--backlight";let ZW=class extends ST{build(){super.build(),P(this._element,JW)}};const eB="ht__manualColumnMove--guideline";let tB=class extends ST{build(){super.build(),P(this._element,eB)}};function nB(n,e){yT(n,e),e.add(n)}function Xn(n,e,t){yT(n,e),e.set(n,t)}function yT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rn(n,e,t){return n.set(zo(n,e),t),t}function W(n,e){return n.get(zo(n,e))}function zo(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}V.getSingleton().register("beforeColumnMove");V.getSingleton().register("afterColumnMove");const Ng="manualColumnMove",iB=120,CS="ht__manualColumnMove",ld="show-ui",Ym="on-moving--columns",Km="after-selection--columns";var zt=new WeakMap,Ko=new WeakMap,wo=new WeakMap,Hc=new WeakMap,Zo=new WeakMap,Ut=new WeakMap,Xu=new WeakMap,Pn=new WeakMap,ll=new WeakMap,ad=new WeakMap,Ka=new WeakMap,Fs=new WeakSet;class oB extends we{constructor(){super(...arguments),nB(this,Fs),Xn(this,zt,new ZW(this.hot)),Xn(this,Ko,new tB(this.hot)),Xn(this,wo,[]),Xn(this,Hc,0),Xn(this,Zo,!1),Xn(this,Ut,{}),Xn(this,Xu,void 0),Xn(this,Pn,void 0),Xn(this,ll,void 0),Xn(this,ad,void 0),Xn(this,Ka,void 0)}static get PLUGIN_KEY(){return Ng}static get PLUGIN_PRIORITY(){return iB}isEnabled(){return!!this.hot.getSettings()[Ng]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return zo(Fs,e,sB).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return zo(Fs,e,lB).call(e,...i)}),this.addHook("afterScrollVertically",()=>zo(Fs,this,hB).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return zo(Fs,e,uB).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),P(this.hot.rootElement,CS),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){X(this.hot.rootElement,CS),this.unregisterEvents(),W(zt,this).destroy(),W(Ko,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const i=W(Xu,this),o=this.isMovePossible(e,t),s=this.hot.runHooks("beforeColumnMove",e,t,i,o);if(rn(Xu,this,void 0),s===!1)return;o&&this.hot.columnIndexMapper.moveIndexes(e,t);const r=o&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,i,o,r),r}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const i=this.countFinalIndex(e,t);return rn(Xu,this,t),this.moveColumns(e,i)}isMovePossible(e,t){const i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),o=e.length+t>i,s=t<0,r=e.some(a=>a<0),l=e.some(a=>a>=i);return!(o||s||r||l)}isColumnOrderChanged(e,t){return e.some((i,o)=>i-o!==t)}countFinalIndex(e,t){const i=at(e,(o,s)=>(s<t&&(o+=1),o),0);return t-i}getColumnsWidth(e,t){const i=this.hot.columnIndexMapper;let o=0;for(let s=e;s<=t;s+=1){const r=i.getRenderableFromVisualIndex(s);s<0?o+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:r!==null&&(o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(r)||0)}return o}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Ng];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const i=[];return j(e,t,o=>{i.push(o)}),i}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(W(Pn,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const t=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,o=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,W(Pn,this)-1);const r=t.hider.offsetWidth,l=t.TBODY.offsetLeft,a=W(zt,this).getOffset().start,h=W(zt,this).getSize().width;let u=0,c=0;if(this.hot.isRtl()){const p=this.hot.rootWindow,v=De(this.hot.rootElement),C=p.innerWidth-W(ll,this)-v;c=p.innerWidth-W(Ut,this).eventPageX-C-(i.scrollX===void 0?o:0)}else c=W(Ut,this).eventPageX-(W(ll,this)-(i.scrollX===void 0?o:0));if(W(ad,this)&&(u=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(W(Pn,this))&&(s+=o),s+=u,W(Pn,this)<0)W(Ka,this)>0?W(Ut,this).col=0:W(Ut,this).col=e>0?e-1:e;else if(W(Ut,this).TD.offsetWidth/2+s<=c){const p=W(Pn,this)>=W(Hc,this)?W(Hc,this)-1:W(Pn,this);W(Ut,this).col=p+1,s+=W(Ut,this).TD.offsetWidth}else W(Ut,this).col=W(Pn,this);let d=c,g=s;c+h+a>=r?d=r-h-a:c+a<l+u&&(d=l+u+Math.abs(a)),s>=r-1?g=r-1:g===0?g=1:i.scrollX!==void 0&&W(Pn,this)<W(Ka,this)&&(g-=W(ll,this)<=i.scrollX?W(ll,this):0),W(zt,this).setPosition(null,d),W(Ko,this).setPosition(null,g)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>zo(Fs,this,rB).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>zo(Fs,this,aB).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){W(zt,this).build(),W(Ko,this).build()}destroy(){W(zt,this).destroy(),W(Ko,this).destroy(),super.destroy()}}function sB(n,e,t,i){const o=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),r=this.hot.getSelectedRangeLast(),l=K(n.target,"sortAction");if(!r||!s||W(Zo,this)||n.button!==0||l){rn(Zo,this,!1),W(wo,this).length=0,X(this.hot.rootElement,[Ym,ld]);return}const a=W(Ko,this).isBuilt()&&!W(Ko,this).isAppended(),h=W(zt,this).isBuilt()&&!W(zt,this).isAppended();a&&h&&(W(Ko,this).appendTo(o.hider),W(zt,this).appendTo(o.hider));const{from:u,to:c}=r,d=Math.min(u.col,c.col),g=Math.max(u.col,c.col);if(e.row<0&&e.col>=d&&e.col<=g){i.column=!0,rn(Zo,this,!0);const p=t.firstChild?_y(n,t.firstChild).x:n.offsetX;W(Ut,this).eventPageX=n.pageX,rn(Pn,this,e.col),W(Ut,this).TD=t,W(Ut,this).col=e.col,rn(wo,this,this.prepareColumnsToMoving(d,g)),rn(ad,this,!!this.hot.getSettings().rowHeaders),rn(Hc,this,this.hot.countCols()),rn(Ka,this,this.hot.getSettings().fixedColumnsStart),rn(ll,this,mt(this.hot.rootElement).left);const v=W(ad,this)?-1:0,C=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,S=e.col<W(Ka,this),R=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),M=Math.abs(p-(this.hot.isRtl()?t.offsetWidth:0)),I=this.getColumnsWidth(d,e.col-1)+M,H=this.getColumnsWidth(v,d-1)+(S?R:0)+I;W(zt,this).setPosition(C,H),W(zt,this).setSize(this.getColumnsWidth(d,g),o.hider.offsetHeight-C),W(zt,this).setOffset(null,-I),P(this.hot.rootElement,Ym)}else X(this.hot.rootElement,Km),rn(Zo,this,!1),W(wo,this).length=0}function rB(n){W(Zo,this)&&(W(Ut,this).eventPageX=n.pageX,this.refreshPositions())}function lB(n,e,t,i){!this.hot.getSelectedRangeLast()||!W(Zo,this)||(W(wo,this).indexOf(e.col)>-1?X(this.hot.rootElement,ld):P(this.hot.rootElement,ld),i.row=!0,i.column=!0,i.cell=!0,rn(Pn,this,e.col),W(Ut,this).TD=t)}function aB(){const n=W(Ut,this).col,e=W(wo,this).length;if(rn(Pn,this,void 0),rn(Zo,this,!1),X(this.hot.rootElement,[Ym,ld,Km]),this.hot.selection.isSelectedByColumnHeader()&&P(this.hot.rootElement,Km),e<1||n===void 0)return;const t=W(wo,this)[0],i=this.hot.toPhysicalColumn(t),o=this.dragColumns(W(wo,this),n);if(W(wo,this).length=0,o===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualColumn(i),r=s+e-1;this.hot.selectColumns(s,r)}}function hB(){const n=this.hot.view._wt.wtTable,e=n.getColumnHeaderHeight(0)+1,t=n.holder.scrollTop,i=e+t;W(zt,this).setPosition(i),W(zt,this).setSize(null,n.hider.offsetHeight-i)}function uB(){this.moveBySettingsOrLoad()}function cB(n,e){RT(n,e),e.add(n)}function Ht(n,e,t){RT(n,e),e.set(n,t)}function RT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function it(n,e,t){return n.set(ti(n,e),t),t}function $(n,e){return n.get(ti(n,e))}function ti(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const hd="manualColumnResize",dB=130,bS="manualColumnWidths";var uo=new WeakMap,qu=new WeakMap,mn=new WeakMap,ud=new WeakMap,Vi=new WeakMap,fB=new WeakMap,ml=new WeakMap,Qu=new WeakMap,en=new WeakMap,lo=new WeakMap,fr=new WeakMap,cd=new WeakMap,Xa=new WeakMap,qa=new WeakMap,wn=new WeakMap,Qa=new WeakMap,Ei=new WeakSet;class gB extends we{static get PLUGIN_KEY(){return hd}static get PLUGIN_PRIORITY(){return dB}constructor(e){super(e),cB(this,Ei),Ht(this,uo,null),Ht(this,qu,null),Ht(this,mn,[]),Ht(this,ud,null),Ht(this,Vi,null),Ht(this,fB,null),Ht(this,ml,null),Ht(this,Qu,null),Ht(this,en,this.hot.rootDocument.createElement("DIV")),Ht(this,lo,this.hot.rootDocument.createElement("DIV")),Ht(this,fr,null),Ht(this,cd,!1),Ht(this,Xa,0),Ht(this,qa,null),Ht(this,wn,void 0),Ht(this,Qa,void 0),P($(en,this),"manualColumnResizer"),P($(lo,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[hd]}enablePlugin(){this.enabled||(it(wn,this,new us),$(wn,this).addLocalHook("init",()=>ti(Ei,this,mB).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,$(wn,this)),this.addHook("modifyColWidth",(e,t)=>ti(Ei,this,SB).call(this,e,t),1),this.addHook("beforeStretchingColumnWidth",(e,t)=>ti(Ei,this,yB).call(this,e,t)),this.addHook("beforeColumnResize",(e,t,i)=>ti(Ei,this,RB).call(this,e,t,i)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){it(Qa,this,$(wn,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",bS,$(wn,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",bS,e),e.value}setManualSize(e,t){const i=Math.max(t,20),o=this.hot.toPhysicalColumn(e);return $(wn,this).setValueAtIndex(o,i),i}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);$(wn,this).setValueAtIndex(t,null)}setupHandlePosition(e){if(!e.parentNode)return;it(uo,this,e);const{_wt:t}=this.hot.view,i=t.wtTable.getCoords($(uo,this)),o=i.col;if(o<0)return;const s=ot($(uo,this)),r=$(uo,this).getBoundingClientRect(),l=o<t.getSetting("fixedColumnsStart");let a;l&&(a=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition($(uo,this),i.row,i.col)),a||(a=t.wtOverlays.topOverlay.getRelativeCellPosition($(uo,this),i.row,i.col)),it(qu,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)),it(mn,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&h){const u=this.hot.getSelectedRange();b(u,c=>{const d=c.getTopStartCorner().col,g=c.getBottomEndCorner().col;j(d,g,p=>{$(mn,this).includes(p)||$(mn,this).push(p)})})}$(mn,this).includes($(qu,this))||it(mn,this,[$(qu,this)]),it(Qu,this,a.start-6),it(ml,this,parseInt(r.width,10)),$(en,this).style.top=`${a.top}px`,$(en,this).style[this.inlineDir]=`${$(Qu,this)+$(ml,this)}px`,$(en,this).style.height=`${s}px`,this.hot.rootElement.appendChild($(en,this))}refreshHandlePosition(){$(en,this).style[this.inlineDir]=`${$(Qu,this)+$(ud,this)}px`}setupGuidePosition(){const e=parseInt(ot($(en,this)),10),t=parseInt($(en,this).style.top,10)+e,i=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);P($(en,this),"active"),P($(lo,this),"active"),$(lo,this).style.top=`${t}px`,this.refreshGuidePosition(),$(lo,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild($(lo,this))}refreshGuidePosition(){$(lo,this).style[this.inlineDir]=$(en,this).style[this.inlineDir]}hideHandleAndGuide(){X($(en,this),"active"),X($(lo,this),"active")}checkIfColumnHeader(e){const t=ss(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,o.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(i,o)=>{const s=this.hot.runHooks("beforeColumnResize",$(Vi,this),i,!0);s!==void 0&&it(Vi,this,s),this.hot.getSettings().stretchH==="all"?this.clearManualSize(i):this.setManualSize(i,$(Vi,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",$(Vi,this),i,!0),o&&e()};$(Xa,this)>=2&&($(mn,this).length>1?(b($(mn,this),o=>{t(o)}),e()):b($(mn,this),o=>{t(o,!0)})),it(Xa,this,0),it(qa,this,null)}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",i=>ti(Ei,this,pB).call(this,i)),this.eventManager.addEventListener(t,"mousedown",i=>ti(Ei,this,wB).call(this,i)),this.eventManager.addEventListener(e,"mousemove",i=>ti(Ei,this,CB).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>ti(Ei,this,bB).call(this)),this.eventManager.addEventListener($(en,this),"contextmenu",()=>ti(Ei,this,vB).call(this))}destroy(){super.destroy()}}function mB(){const n=this.hot.getSettings()[hd],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((t,i)=>{$(wn,this).setValueAtIndex(i,t)})},!0):Array.isArray(n)?(this.hot.batchExecution(()=>{n.forEach((t,i)=>{$(wn,this).setValueAtIndex(i,t)})},!0),it(Qa,this,n)):n===!0&&Array.isArray($(Qa,this))&&this.hot.batchExecution(()=>{$(Qa,this).forEach((t,i)=>{$(wn,this).setValueAtIndex(i,t)})},!0)}function pB(n){if(!up(n.target)&&$(cd,this)!==!0&&this.checkIfColumnHeader(n.target)){const e=this.getClosestTHParent(n.target);if(!e)return;const t=e.getAttribute("colspan");e&&(t===null||t==="1")&&($(fr,this)||this.setupHandlePosition(e))}}function wB(n){n.target.parentNode===this.hot.rootElement&&K(n.target,"manualColumnResizer")&&(this.setupHandlePosition($(uo,this)),this.setupGuidePosition(),it(fr,this,!0),$(qa,this)===null&&(it(qa,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout($(qa,this))),it(Xa,this,$(Xa,this)+1),this.startX=n.pageX,it(Vi,this,$(ml,this)))}function CB(n){if($(fr,this)){const e=(n.pageX-this.startX)*this.hot.getDirectionFactor();it(ud,this,$(ml,this)+e),b($(mn,this),t=>{it(Vi,this,this.setManualSize(t,$(ud,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function bB(){const n=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(t,i)=>{this.hot.runHooks("beforeColumnResize",$(Vi,this),t,!1),i&&n(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",$(Vi,this),t,!1)};$(fr,this)&&(this.hideHandleAndGuide(),it(fr,this,!1),$(Vi,this)!==$(ml,this)&&($(mn,this).length>1?(b($(mn,this),i=>{e(i)}),n()):b($(mn,this),i=>{e(i,!0)})),this.setupHandlePosition($(uo,this)))}function vB(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild($(en,this)),this.hot.rootElement.removeChild($(lo,this)),it(fr,this,!1),it(cd,this,!0),this.hot._registerImmediate(()=>{it(cd,this,!1)})}function SB(n,e){let t=n;if(this.enabled){const i=this.hot.toPhysicalColumn(e),o=$(wn,this).getValueAtIndex(i);this.hot.getSettings()[hd]&&o&&(t=o)}return t}function yB(n,e){let t=$(wn,this).getValueAtIndex(e);return t===null&&(t=n),t}function RB(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function Dg(n,e,t){return(e=EB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function EB(n){var e=TB(n,"string");return typeof e=="symbol"?e:e+""}function TB(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Lg=0,vS=1,SS=2,Zr="px";let ET=class{constructor(e){Dg(this,"hot",void 0),Dg(this,"_element",null),Dg(this,"state",Lg),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=SS}build(){this.state===Lg&&(this._element=this.hot.rootDocument.createElement("div"),this.state=vS)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Lg}isAppended(){return this.state===SS}isBuilt(){return this.state>=vS}setPosition(e,t){e!==void 0&&(this._element.style.top=e+Zr),t!==void 0&&(this._element.style.left=t+Zr)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+Zr),t&&(this._element.style.height=t+Zr)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+Zr),t&&(this._element.style.marginLeft=t+Zr)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const MB="ht__manualRowMove--backlight";class PB extends ET{build(){super.build(),P(this._element,MB)}}const IB="ht__manualRowMove--guideline";class HB extends ET{build(){super.build(),P(this._element,IB)}}function xB(n,e){TT(n,e),e.add(n)}function el(n,e,t){TT(n,e),e.set(n,t)}function TT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function or(n,e,t){return n.set(Go(n,e),t),t}function Q(n,e){return n.get(Go(n,e))}function Go(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}V.getSingleton().register("beforeRowMove");V.getSingleton().register("afterRowMove");const kg="manualRowMove",AB=140,yS="ht__manualRowMove",dd="show-ui",Xm="on-moving--rows",qm="after-selection--rows";var Gt=new WeakMap,Xo=new WeakMap,Co=new WeakMap,es=new WeakMap,ln=new WeakMap,Ju=new WeakMap,Ws=new WeakSet;class _B extends we{constructor(){super(...arguments),xB(this,Ws),el(this,Gt,new PB(this.hot)),el(this,Xo,new HB(this.hot)),el(this,Co,[]),el(this,es,void 0),el(this,ln,{}),el(this,Ju,void 0)}static get PLUGIN_KEY(){return kg}static get PLUGIN_PRIORITY(){return AB}isEnabled(){return!!this.hot.getSettings()[kg]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Go(Ws,e,OB).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Go(Ws,e,DB).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>Go(Ws,this,kB).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Go(Ws,e,$B).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),P(this.hot.rootElement,yS),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){X(this.hot.rootElement,yS),this.unregisterEvents(),Q(Gt,this).destroy(),Q(Xo,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const i=Q(Ju,this),o=this.isMovePossible(e,t),s=this.hot.runHooks("beforeRowMove",e,t,i,o);if(or(Ju,this,void 0),s===!1)return;o&&this.hot.rowIndexMapper.moveIndexes(e,t);const r=o&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,i,o,r),r}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const i=this.countFinalIndex(e,t);return or(Ju,this,t),this.moveRows(e,i)}isMovePossible(e,t){const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),o=e.length+t>i,s=t<0,r=e.some(a=>a<0),l=e.some(a=>a>=i);return!(o||s||r||l)}isRowOrderChanged(e,t){return e.some((i,o)=>i-o!==t)}countFinalIndex(e,t){const i=at(e,(o,s)=>(s<t&&(o+=1),o),0);return t-i}getRowsHeight(e,t){const i=this.hot.rowIndexMapper;let o=0;for(let s=e;s<=t;s++){const r=i.getRenderableFromVisualIndex(s);r!==null&&(o+=this.hot.view._wt.wtTable.getRowHeight(r)||23)}return o}moveBySettingsOrLoad(){const e=this.hot.getSettings()[kg];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:i,to:o}=e,s=Math.min(i.row,o.row),r=Math.max(i.row,o.row);return j(s,r,l=>{t.push(l)}),t}refreshPositions(){const e=Q(ln,this).coords,t=this.hot.view.getFirstFullyVisibleRow(),i=this.hot.view.getLastFullyVisibleRow(),o=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&i<o&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,r=Q(ln,this).TD,l=this.hot.rootElement,a=mt(l),h=ar(l),u=s.holder.scrollTop,c=this.hot.rootWindow!==h?h.scrollTop:0,d=a.top-c,g=Q(ln,this).eventPageY-d+u,p=s.hider.offsetHeight,v=s.TBODY.offsetTop,C=Q(Gt,this).getOffset().top,S=Q(Gt,this).getSize().height,R=r.offsetHeight/2,M=r.offsetHeight;let I=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const H=g>=I+R;this.isFixedRowTop(e.row)&&(I+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Q(ln,this).row=t>0?t-1:t:H?(Q(ln,this).row=e.row+1,I+=e.row===0?M-1:M):Q(ln,this).row=e.row;let O=g,k=I;g+S+C>=p?O=p-S-C:g+C<v&&(O=v+Math.abs(C)),I>=p-1&&(k=p-1),Q(Gt,this).setPosition(O),Q(Xo,this).setPosition(k)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>Go(Ws,this,NB).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>Go(Ws,this,LB).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Q(Gt,this).build(),Q(Xo,this).build()}destroy(){Q(Gt,this).destroy(),Q(Xo,this).destroy(),super.destroy()}}function OB(n,e,t,i){const{wtTable:o,wtViewport:s}=this.hot.view._wt,r=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast();if(!l||!r||Q(es,this)||n.button!==0){or(es,this,!1),Q(Co,this).length=0,X(this.hot.rootElement,[Xm,dd]);return}const a=Q(Xo,this).isBuilt()&&!Q(Xo,this).isAppended(),h=Q(Gt,this).isBuilt()&&!Q(Gt,this).isAppended();a&&h&&(Q(Xo,this).appendTo(o.hider),Q(Gt,this).appendTo(o.hider));const{from:u,to:c}=l,d=Math.min(u.row,c.row),g=Math.max(u.row,c.row);if(e.col<0&&e.row>=d&&e.row<=g){i.row=!0,or(es,this,!0),Q(ln,this).eventPageY=n.pageY,Q(ln,this).coords=e,Q(ln,this).TD=t,or(Co,this,this.prepareRowsToMoving());const p=o.holder.scrollLeft+s.getRowHeaderWidth(),v=this.getRowsHeight(d,e.row-1)+n.offsetY;Q(Gt,this).setPosition(null,p),Q(Gt,this).setSize(o.hider.offsetWidth-p,this.getRowsHeight(d,g)),Q(Gt,this).setOffset(-v,null),P(this.hot.rootElement,Xm),this.refreshPositions()}else X(this.hot.rootElement,qm),or(es,this,!1),Q(Co,this).length=0}function NB(n){Q(es,this)&&(Q(ln,this).eventPageY=n.pageY,this.refreshPositions())}function DB(n,e,t,i){!this.hot.getSelectedRangeLast()||!Q(es,this)||(Q(Co,this).indexOf(e.row)>-1?X(this.hot.rootElement,dd):P(this.hot.rootElement,dd),i.row=!0,i.column=!0,i.cell=!0,Q(ln,this).coords=e,Q(ln,this).TD=t)}function LB(){const n=Q(ln,this).row,e=Q(Co,this).length;if(or(es,this,!1),X(this.hot.rootElement,[Xm,dd,qm]),this.hot.selection.isSelectedByRowHeader()&&P(this.hot.rootElement,qm),e<1||n===void 0)return;const t=Q(Co,this)[0],i=this.hot.toPhysicalRow(t),o=this.dragRows(Q(Co,this),n);if(Q(Co,this).length=0,o===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualRow(i),r=s+e-1;this.hot.selectRows(s,r)}}function kB(){const n=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),t=n.holder.scrollLeft,i=e+t;Q(Gt,this).setPosition(null,i),Q(Gt,this).setSize(n.hider.offsetWidth-i)}function $B(){this.moveBySettingsOrLoad()}function VB(n,e){MT(n,e),e.add(n)}function xt(n,e,t){MT(n,e),e.set(n,t)}function MT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ke(n,e,t){return n.set(co(n,e),t),t}function L(n,e){return n.get(co(n,e))}function co(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const fd="manualRowResize",FB=30,RS="manualRowHeights";var Oi=new WeakMap,Zu=new WeakMap,pn=new WeakMap,Ja=new WeakMap,qo=new WeakMap,KC=new WeakMap,pl=new WeakMap,ec=new WeakMap,Bt=new WeakMap,Ai=new WeakMap,gr=new WeakMap,gd=new WeakMap,Za=new WeakMap,eh=new WeakMap,ni=new WeakMap,th=new WeakMap,ko=new WeakSet;class WB extends we{static get PLUGIN_KEY(){return fd}static get PLUGIN_PRIORITY(){return FB}constructor(e){super(e),VB(this,ko),xt(this,Oi,null),xt(this,Zu,null),xt(this,pn,[]),xt(this,Ja,null),xt(this,qo,null),xt(this,KC,null),xt(this,pl,null),xt(this,ec,null),xt(this,Bt,this.hot.rootDocument.createElement("DIV")),xt(this,Ai,this.hot.rootDocument.createElement("DIV")),xt(this,gr,!1),xt(this,gd,!1),xt(this,Za,0),xt(this,eh,null),xt(this,ni,void 0),xt(this,th,void 0),P(L(Bt,this),"manualRowResizer"),P(L(Ai,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[fd]}enablePlugin(){this.enabled||(Ke(ni,this,new us),L(ni,this).addLocalHook("init",()=>co(ko,this,KB).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,L(ni,this)),this.addHook("modifyRowHeight",(e,t)=>co(ko,this,YB).call(this,e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Ke(th,this,L(ni,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",RS,L(ni,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",RS,e),e.value}setManualSize(e,t){const i=this.hot.toPhysicalRow(e),o=Math.max(t,Yy);return L(ni,this).setValueAtIndex(i,o),o}getLastDesiredRowHeight(){return L(Ja,this)}setupHandlePosition(e){Ke(Oi,this,e);const{view:t}=this.hot,{_wt:i}=t,o=i.wtTable.getCoords(L(Oi,this)),s=o.row;if(s<0)return;const r=De(L(Oi,this)),l=L(Oi,this).getBoundingClientRect(),a=s<i.getSetting("fixedRowsTop"),h=s>=t.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom");let u;a?u=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(L(Oi,this),o.row,o.col):h&&(u=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(L(Oi,this),o.row,o.col)),u||(u=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(L(Oi,this),o.row,o.col)),Ke(Zu,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),Ke(pn,this,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&c){const d=this.hot.getSelectedRange();b(d,g=>{const p=g.getTopStartCorner().row,v=g.getBottomStartCorner().row;j(p,v,C=>{L(pn,this).includes(C)||L(pn,this).push(C)})})}L(pn,this).includes(L(Zu,this))||Ke(pn,this,[L(Zu,this)]),Ke(ec,this,u.top-6),Ke(pl,this,parseInt(l.height,10)),L(Bt,this).style.top=`${L(ec,this)+L(pl,this)}px`,L(Bt,this).style[this.inlineDir]=`${u.start}px`,L(Bt,this).style.width=`${r}px`,this.hot.rootElement.appendChild(L(Bt,this))}refreshHandlePosition(){L(Bt,this).style.top=`${L(ec,this)+L(Ja,this)}px`}setupGuidePosition(){const e=parseInt(De(L(Bt,this)),10),t=parseInt(L(Bt,this).style[this.inlineDir],10)+e,i=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);P(L(Bt,this),"active"),P(L(Ai,this),"active"),L(Ai,this).style.top=L(Bt,this).style.top,L(Ai,this).style[this.inlineDir]=`${t}px`,L(Ai,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(L(Ai,this))}refreshGuidePosition(){L(Ai,this).style.top=L(Bt,this).style.top}hideHandleAndGuide(){X(L(Bt,this),"active"),X(L(Ai,this),"active")}checkIfRowHeader(e){const t=ss(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:o,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,o.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return t!==void 0&&L(qo,this)<t?t:L(qo,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(i,o)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);s!==void 0&&Ke(qo,this,s),this.setManualSize(i,L(qo,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),o&&e()};L(Za,this)>=2&&(L(pn,this).length>1?(b(L(pn,this),o=>{t(o)}),e()):b(L(pn,this),o=>{t(o,!0)})),Ke(Za,this,0),Ke(eh,this,null)}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>co(ko,this,BB).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>co(ko,this,jB).call(this,i)),this.eventManager.addEventListener(t,"mousemove",i=>co(ko,this,UB).call(this,i)),this.eventManager.addEventListener(t,"mouseup",()=>co(ko,this,zB).call(this)),this.eventManager.addEventListener(L(Bt,this),"contextmenu",()=>co(ko,this,GB).call(this))}destroy(){super.destroy()}}function BB(n){if(!up(n.target)&&L(gd,this)!==!0&&this.checkIfRowHeader(n.target)){const e=this.getClosestTHParent(n.target);e&&(L(gr,this)||this.setupHandlePosition(e))}}function jB(n){K(n.target,"manualRowResizer")&&(this.setupHandlePosition(L(Oi,this)),this.setupGuidePosition(),Ke(gr,this,!0),L(eh,this)===null&&(Ke(eh,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(L(eh,this))),Ke(Za,this,L(Za,this)+1),Ke(KC,this,n.pageY),Ke(qo,this,L(pl,this)))}function UB(n){L(gr,this)&&(Ke(Ja,this,L(pl,this)+(n.pageY-L(KC,this))),b(L(pn,this),e=>{Ke(qo,this,this.setManualSize(e,L(Ja,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function zB(){const n=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(t,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!1),i&&n(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!1)};L(gr,this)&&(this.hideHandleAndGuide(),Ke(gr,this,!1),L(qo,this)!==L(pl,this)&&(L(pn,this).length>1?(b(L(pn,this),i=>{e(i)}),n()):b(L(pn,this),i=>{e(i,!0)})),this.setupHandlePosition(L(Oi,this)))}function GB(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(L(Bt,this)),this.hot.rootElement.removeChild(L(Ai,this)),Ke(gr,this,!1),Ke(gd,this,!0),this.hot._registerImmediate(()=>{Ke(gd,this,!1)})}function YB(n,e){let t=n;if(this.enabled){const i=this.hot.toPhysicalRow(e),o=L(ni,this).getValueAtIndex(i);this.hot.getSettings()[fd]&&o&&(t=o)}return t}function KB(){const n=this.hot.getSettings()[fd],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((t,i)=>{L(ni,this).setValueAtIndex(i,t)}):Array.isArray(n)?(n.forEach((t,i)=>{L(ni,this).setValueAtIndex(i,t)}),Ke(th,this,n)):n===!0&&Array.isArray(L(th,this))&&L(th,this).forEach((t,i)=>{L(ni,this).setValueAtIndex(i,t)})},!0)}function XB(n,e,t){qB(n,e),e.set(n,t)}function qB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bs(n,e,t){return(e=QB(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function QB(n){var e=JB(n,"string");return typeof e=="symbol"?e:e+""}function JB(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ES(n,e){return n.get(PT(n,e))}function tc(n,e,t){return n.set(PT(n,e),t),t}function PT(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var js=new WeakMap;class Ni{constructor(e,t,i,o,s,r){Bs(this,"row",void 0),Bs(this,"col",void 0),Bs(this,"rowspan",void 0),Bs(this,"colspan",void 0),Bs(this,"removed",!1),Bs(this,"cellCoordsFactory",void 0),Bs(this,"cellRangeFactory",void 0),XB(this,js,null),this.row=e,this.col=t,this.rowspan=i,this.colspan=o,this.cellCoordsFactory=s,this.cellRangeFactory=r}static NEGATIVE_VALUES_WARNING(e){let{row:t,col:i,rowspan:o,colspan:s}=e;return Re`The merged cell declared with {row: ${t}, col: ${i},\x20
      rowspan: ${o}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:t,col:i}=e;return Re`The merged cell declared at [${t}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:t,col:i}=e;return Re`The merged cell declared at [${t}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:t,col:i}=e;return Re`The merged cell declared at [${t}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:t,col:i,rowspan:o,colspan:s}=e;return t<0||i<0||o<0||s<0}static isSingleCell(e){let{rowspan:t,colspan:i}=e;return i===1&&t===1}static containsZeroSpan(e){let{rowspan:t,colspan:i}=e;return i===0||t===0}static isOutOfBounds(e,t,i){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=i||e.col+e.colspan-1>=i}normalize(e){const t=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),tc(js,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const i=e[0]||e[1],o=t+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",r=e[0]?"col":"row",l=Math.min(t,o),a=Math.max(t,o),h=this[r],u=this[r]+this[s]-1;if(h>=t&&(this[r]+=i),i>0)t<=u&&t>h&&(this[s]+=i);else if(i<0){if(l<=h&&a>=u)return this.removed=!0,tc(js,this,null),!1;if(h>=l&&h<=a){const c=a-h+1,d=Math.abs(i)-c;this[r]-=d+i,this[s]-=c}else if(h<=l&&u>=a)this[s]+=i;else if(h<=l&&u>=l&&u<a){const c=u-l+1;this[s]-=c}}return tc(js,this,null),!0}isFarther(e,t){return e?t==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:t==="up"?e.row>this.row:t==="right"?e.col+e.colspan-1<this.col+this.colspan-1:t==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return ES(js,this)||tc(js,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),ES(js,this)}}function ZB(n,e){ej(n,e),e.add(n)}function ej(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nc(n,e,t){return(e=tj(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function tj(n){var e=nj(n,"string");return typeof e=="symbol"?e:e+""}function nj(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Us(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var $o=new WeakSet;class md{constructor(e){ZB(this,$o),nc(this,"plugin",void 0),nc(this,"mergedCells",[]),nc(this,"mergedCellsMatrix",new Map),nc(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:t,col:i}=e;return Re`The merged cell declared at [${t}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){var i;return this.mergedCellsMatrix.has(e)&&(i=this.mergedCellsMatrix.get(e).get(t))!==null&&i!==void 0?i:!1}getByRange(e){let t=!1;return b(this.mergedCells,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(t=i,t):!0),t}filterOverlappingMergeCells(e){const t=new Set;return this.mergedCells.forEach(o=>{const{row:s,col:r,colspan:l,rowspan:a}=o;for(let h=s;h<s+a;h++)for(let u=r;u<r+l;u++)t.add(`r${h},c${u}`)}),e.filter(o=>{const{row:s,col:r,colspan:l,rowspan:a}=o,h=new Set;let u=!1;for(let c=s;c<s+a;c++){for(let d=r;d<r+l;d++){const g=`r${c},c${d}`;if(t.has(g)){ye(md.IS_OVERLAPPING_WARNING(o)),u=!0;break}h.add(g)}if(u)break}return u||t.add(...h),!u})}getWithinRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:i,col:o}=e.getTopStartCorner(),{row:s,col:r}=e.getBottomEndCorner(),l=[];for(let a=i;a<=s;a++)for(let h=o;h<=r;h++){const u=this.get(a,h);u&&(t||!t&&u.row===a&&u.col===h)&&l.push(u)}return l}add(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=e.row,o=e.col,s=e.rowspan,r=e.colspan,l=new Ni(i,o,s,r,this.hot._createCellCoords,this.hot._createCellRange),a=this.get(i,o),h=t?!1:this.isOverlapping(l);return!a&&!h?(this.hot&&l.normalize(this.hot),this.mergedCells.push(l),Us($o,this,TS).call(this,l),l):(ye(md.IS_OVERLAPPING_WARNING(l)),!1)}remove(e,t){const i=this.get(e,t),o=i?this.mergedCells.indexOf(i):-1;return i&&o!==-1?(this.mergedCells.splice(o,1),Us($o,this,ij).call(this,i),i):!1}clear(){b(this.mergedCells,e=>{let{row:t,col:i,rowspan:o,colspan:s}=e;j(t,t+o,r=>{j(i,i+s,l=>{const a=this.hot.getCell(r,l);a&&(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const t=e.getRange();for(let i=0;i<this.mergedCells.length;i++)if(this.mergedCells[i].getRange().overlaps(t))return!0;return!1}isFirstRenderableMergedCell(e,t){const i=this.get(e,t);return i&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)===t}getFirstRenderableCoords(e,t){const i=this.get(e,t);if(!i||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(o,s)}getStartMostColumnIndex(e,t){const i=Us($o,this,ic).call(this,e,"col",-1);let o=t;for(let s=0;s<i.length;s++)if(i[s]<=t){o=i[s];break}return o}getEndMostColumnIndex(e,t){const i=Us($o,this,ic).call(this,e,"col",1);let o=t;for(let s=0;s<i.length;s++)if(i[s]>=t){o=i[s];break}return o}getTopMostRowIndex(e,t){const i=Us($o,this,ic).call(this,e,"row",-1);let o=t;for(let s=0;s<i.length;s++)if(i[s]<=t){o=i[s];break}return o}getBottomMostRowIndex(e,t){const i=Us($o,this,ic).call(this,e,"row",1);let o=t;for(let s=0;s<i.length;s++)if(i[s]>=t){o=i[s];break}return o}shiftCollections(e,t,i){const o=[0,0];switch(e){case"right":o[0]+=i;break;case"left":o[0]-=i;break;case"down":o[1]+=i;break;case"up":o[1]-=i;break}const s=[];this.mergedCells.forEach(r=>{r.shift(o,t),r.removed&&s.push(r)}),s.forEach(r=>{this.mergedCells.splice(this.mergedCells.indexOf(r),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(r=>{Us($o,this,TS).call(this,r)})}}function ic(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=new Map,o=t===1?n.getTopStartCorner():n.getBottomEndCorner(),s=t===1?n.getBottomEndCorner():n.getTopStartCorner();for(let r=o.row;t===1?r<=s.row:r>=s.row;r+=t)for(let l=o.col;t===1?l<=s.col:l>=s.col;l+=t){const a=e==="row"?r:l,h=this.get(r,l);let u=a;h&&(u=t===1?h[e]+h[`${e}span`]-1:h[e]),i.has(a)||i.set(a,new Set),i.get(a).add(u)}return Array.from(new Set(Array.from(i.entries()).filter(r=>{let[,l]=r;return l.size===1}).flatMap(r=>{let[,l]=r;return Array.from(l)})))}function TS(n){for(let e=n.row;e<n.row+n.rowspan;e++)for(let t=n.col;t<n.col+n.colspan;t++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(t,n)}function ij(n){for(let e=n.row;e<n.row+n.rowspan;e++)for(let t=n.col;t<n.col+n.colspan;t++)this.mergedCellsMatrix.get(e).delete(t)}function $g(n,e,t){return(e=oj(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function oj(n){var e=sj(n,"string");return typeof e=="symbol"?e:e+""}function sj(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class rj{constructor(e){$g(this,"plugin",void 0),$g(this,"mergedCellsCollection",void 0),$g(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}getDirection(e,t){let i=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?i="down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?i="up":t[1]===e[1]&&t[2]===e[2]?i="right":i="left",i}snapDragArea(e,t,i,o){const s=t.slice(0),r=this.getAutofillSize(e,t,i),[l,a,h,u]=e,d=["up","down"].indexOf(i)>-1?h-l+1:u-a+1,g=Math.floor(r/d)*d,p=r-g,v=this.getFarthestCollection(e,t,i,o);if(v){if(i==="down"){const C=v.row+v.rowspan-l-p;s[2]+C>=this.plugin.hot.countRows()?s[2]-=p:s[2]+=p?C:0}else if(i==="right"){const C=v.col+v.colspan-a-p;s[3]+C>=this.plugin.hot.countCols()?s[3]-=p:s[3]+=p?C:0}else if(i==="up"){const C=h-p-v.row+1;s[0]+C<0?s[0]+=p:s[0]-=p?C:0}else if(i==="left"){const C=u-p-v.col+1;s[1]+C<0?s[1]+=p:s[1]-=p?C:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:o,fillSize:r,dragArea:s,cycleLength:d}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),lt(this.currentFillData,e)}getAutofillSize(e,t,i){const[o,s,r,l]=e,[a,h,u,c]=t;switch(i){case"up":return o-a;case"down":return u-r;case"left":return s-h;case"right":return c-l;default:return null}}getDragArea(e,t,i){const[o,s,r,l]=e,[a,h,u,c]=t;switch(i){case"up":return[a,h,o-1,l];case"down":return[r+1,s,u,l];case"left":return[a,h,r,s-1];case"right":return[o,l+1,u,c];default:return null}}getFarthestCollection(e,t,i,o){const[s,r,l,a]=e,h=["up","down"].indexOf(i)>-1,u=h?l:a,c=h?s:r,d=this.getAutofillSize(e,t,i),g=h?l-s+1:a-r+1,p=Math.floor(d/g)*g,v=d-p;let C=null,S=null,R=null;switch(i){case"up":C="includesVertically",R=u-v+1;break;case"left":C="includesHorizontally",R=u-v+1;break;case"down":C="includesVertically",R=c+v-1;break;case"right":C="includesHorizontally",R=c+v-1;break}return b(o,M=>{M[C](R)&&M.isFarther(S,i)&&(S=M)}),S}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,s=(h,u)=>{switch(o){case"up":return h.row-u>=t.from.row;case"down":return h.row+h.rowspan-1+u<=t.to.row;case"left":return h.col-u>=t.from.column;case"right":return h.col+h.colspan-1+u<=t.to.column;default:return null}};let r=0,l=null,a=1;do for(let h=0;h<i.length;h+=1){if(l=i[h],r=a*this.currentFillData.cycleLength,s(l,r))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:l.row-r,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+r,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-r,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+r,colspan:l.colspan});break}h===i.length-1&&(a+=1)}while(s(l,r));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},i={min:null,max:null};return b(e,o=>{const s=o[0],r=this.plugin.hot.propToCol(o[1]);(t.min===null||s<t.min)&&(t.min=s),(t.max===null||s>t.max)&&(t.max=s),(i.min===null||r<i.min)&&(i.min=r),(i.max===null||r>i.max)&&(i.max=r)}),{from:{row:t.min,column:i.min},to:{row:t.max,column:i.max}}}dragAreaOverlapsCollections(e,t,i){const o=this.getDragArea(e,t,i),[s,r,l,a]=o,h=this.plugin.hot._createCellCoords(s,r),u=this.plugin.hot._createCellCoords(l,a),c=this.plugin.hot._createCellRange(h,h,u);return this.mergedCellsCollection.getWithinRange(c,!0).length>0}}function Vg(n,e,t){return(e=lj(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function lj(n){var e=aj(n,"string");return typeof e=="symbol"?e:e+""}function aj(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class hj{constructor(e){Vg(this,"plugin",void 0),Vg(this,"hot",void 0),Vg(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,i,o){const s=Math.min(i[0],i[2]),r=Math.min(i[1],i[3]),l=Math.max(i[0],i[2]),a=Math.max(i[1],i[3]);if(o===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const u=this.plugin.mergedCellsCollection.get(e,t);if(!u)return;const c=u.getLastRow(),d=u.getLastColumn();if(s<=u.row&&r<=u.col&&l>=c&&a>=d)return`${this.fullySelectedMergedCellClassName}-${o}`;if(this.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,t){const i=[];if(!t||!e)return!1;for(let o=0;o<e.rowspan;o+=1)for(let s=0;s<e.colspan;s+=1)i.push(this.hot._createCellCoords(e.row+o,e.col+s));for(let o=0;o<i.length;o+=1){const s=[];for(let r=0;r<t.length;r+=1)s[r]=t[r].includes(i[o]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function uj(n){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const t=n.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(mw)}return this.getTranslatedPhrase(gw)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:t,to:i}=e;n.toggleMerge(e),this.selectCell(t.row,t.col,i.row,i.col,!1)},disabled(){const e=this.getSelectedLast();return e?Ni.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function nh(n,e,t){return(e=cj(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cj(n){var e=dj(n,"string");return typeof e=="symbol"?e:e+""}function dj(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class MS{constructor(e){nh(this,"data",void 0),nh(this,"next",null),nh(this,"prev",null),this.data=e}}class oc{constructor(){nh(this,"first",null),nh(this,"last",null)}push(e){const t=new MS(e);if(this.first===null)this.first=t,this.last=t;else{const i=this.last;this.last=t,t.prev=i,i.next=t}return t}unshift(e){const t=new MS(e);if(this.first===null)this.first=t,this.last=t;else{const i=this.first;this.first=t,t.next=i,i.prev=t}}inorder(e){let t=this.first;for(;t;){const i=e(t);if(t===this.last||i===!0)break;t=t.next}}remove(e){if(this.first===null)return!1;let t=this.first,i,o;for(;t;){if(t.data===e)return i=t.next,o=t.prev,i&&(i.prev=o),o&&(o.next=i),t===this.first&&(this.first=i),t===this.last&&(this.last=o),!0;t=t.next}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,t=t.next,e===t)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(i,o){o&&(e(o,o.next),o.next=i)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const t=this.first;this.first=this.last,this.last=t}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,t=this.first,i;for(;e;)i=e.next,e.next=t,t.prev=e,t=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=t,this.last=i}}function fj(n,e){IT(n,e),e.add(n)}function zs(n,e,t){IT(n,e),e.set(n,t)}function IT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function be(n,e){return n.get(pd(n,e))}function hn(n,e,t){return n.set(pd(n,e),t),t}function pd(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Ti=new WeakMap,Mi=new WeakMap,Pi=new WeakMap,Ii=new WeakMap,Qm=new WeakMap,sc=new WeakMap,rc=new WeakMap,Fg=new WeakSet;class gj{constructor(e){let{mergedCellsGetter:t,rowIndexMapper:i,columnIndexMapper:o}=e;fj(this,Fg),zs(this,Ti,new oc),zs(this,Mi,new oc),zs(this,Pi,null),zs(this,Ii,null),zs(this,Qm,null),zs(this,sc,null),zs(this,rc,null),hn(Qm,this,t),hn(sc,this,i),hn(rc,this,o)}getCurrentVerticalNode(){return be(Ii,this).data}getFirstVerticalNode(){return be(Mi,this).first.data}getNextVerticalNode(){return be(Ii,this).next.data}getPrevVerticalNode(){return be(Ii,this).prev.data}getCurrentHorizontalNode(){return be(Pi,this).data}getFirstHorizontalNode(){return be(Ti,this).first.data}getNextHorizontalNode(){return be(Pi,this).next.data}getPrevHorizontalNode(){return be(Pi,this).prev.data}setPrevNodeAsActive(){hn(Ii,this,be(Ii,this).prev),hn(Pi,this,be(Pi,this).prev)}setNextNodeAsActive(){hn(Ii,this,be(Ii,this).next),hn(Pi,this,be(Pi,this).next)}buildFocusOrder(e){const t=e.getTopStartCorner(),i=e.getBottomEndCorner(),o=new WeakSet;hn(Ti,this,new oc);for(let r=t.row;r<=i.row;r++)if(!be(sc,this).isHidden(r))for(let l=t.col;l<=i.col;l++){if(be(rc,this).isHidden(l))continue;const a=pd(Fg,this,PS).call(this,e,be(Ti,this),o,r,l);a&&hn(Pi,this,a)}be(Ti,this).first&&(be(Ti,this).first.prev=be(Ti,this).last,be(Ti,this).last.next=be(Ti,this).first);const s=new WeakSet;hn(Mi,this,new oc);for(let r=t.col;r<=i.col;r++)if(!be(rc,this).isHidden(r))for(let l=t.row;l<=i.row;l++){if(be(sc,this).isHidden(l))continue;const a=pd(Fg,this,PS).call(this,e,be(Mi,this),s,l,r);a&&hn(Ii,this,a)}be(Mi,this).first&&(be(Mi,this).first.prev=be(Mi,this).last,be(Mi,this).last.next=be(Mi,this).first)}setActiveNode(e,t){return be(Ti,this).inorder(i=>{const{rowStart:o,rowEnd:s,colStart:r,colEnd:l}=i.data;if(e>=o&&e<=s&&t>=r&&t<=l)return hn(Pi,this,i),!1}),be(Mi,this).inorder(i=>{const{rowStart:o,rowEnd:s,colStart:r,colEnd:l}=i.data;if(e>=o&&e<=s&&t>=r&&t<=l)return hn(Ii,this,i),!1}),this}}function PS(n,e,t,i,o){const s=n.getTopStartCorner(),r=n.getBottomEndCorner(),l=n.highlight.clone().normalize(),a=be(Qm,this).call(this,i,o);if(a&&t.has(a))return null;const h={colStart:o,colEnd:o,rowStart:i,rowEnd:i};if(a){if(t.add(a),a.row<s.row||a.row+a.rowspan-1>r.row||a.col<s.col||a.col+a.colspan-1>r.col)return null;h.colStart=a.col,h.colEnd=a.col+a.colspan-1,h.rowStart=a.row,h.rowEnd=a.row+a.rowspan-1}const u=e.push(h);return i===l.row&&o===l.col||a&&l.row>=a.row&&l.row<=a.row+a.rowspan-1&&l.col>=a.col&&l.col<=a.col+a.colspan-1?u:null}function mj(n){const{hot:e}=n,{rowIndexMapper:t,columnIndexMapper:i}=e;function o(){}function s(r,l,a){const h=n.mergedCellsCollection.get(l,a);if(!ee(h)){r.removeAttribute("rowspan"),r.removeAttribute("colspan"),r.style.display="";return}const{row:u,col:c,colspan:d,rowspan:g}=h,[p,v]=n.translateMergedCellToRenderable(u,g,c,d),C=t.getRenderableFromVisualIndex(l),S=i.getRenderableFromVisualIndex(a),R=p-C+1,M=v-S+1,I=t.getNearestNotHiddenIndex(u,1),H=i.getNearestNotHiddenIndex(c,1),O=Math.min(g,R),k=Math.min(d,M);I===l&&H===a?(r.setAttribute("rowspan",O),r.setAttribute("colspan",k)):(r.removeAttribute("rowspan"),r.removeAttribute("colspan"),r.style.display="none")}return{before:o,after:s}}function pj(n,e){HT(n,e),e.add(n)}function lc(n,e,t){HT(n,e),e.set(n,t)}function HT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wg(n,e,t){return(e=wj(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wj(n){var e=Cj(n,"string");return typeof e=="symbol"?e:e+""}function Cj(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function vh(n,e,t){return n.set(ve(n,e),t),t}function Oe(n,e){return n.get(ve(n,e))}function ve(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}V.getSingleton().register("beforeMergeCells");V.getSingleton().register("afterMergeCells");V.getSingleton().register("beforeUnmergeCells");V.getSingleton().register("afterUnmergeCells");const ih="mergeCells",bj=150,IS=ih;var On=new WeakMap,Nn=new WeakMap,Fi=new WeakMap,HS=new WeakMap,Te=new WeakSet;class vj extends we{constructor(){super(...arguments),pj(this,Te),Wg(this,"mergedCellsCollection",null),Wg(this,"autofillCalculations",null),Wg(this,"selectionCalculations",null),lc(this,On,null),lc(this,Nn,{row:0,col:0}),lc(this,Fi,new gj({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),lc(this,HS,mj(this))}static get PLUGIN_KEY(){return ih}static get PLUGIN_PRIORITY(){return bj}isEnabled(){return!!this.hot.getSettings()[ih]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new md(this),this.autofillCalculations=new rj(this),this.selectionCalculations=new hj(this),this.addHook("afterInit",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,Sj).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,Rj).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,Ej).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,Tj).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,Mj).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,xS).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,xS).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,Hj).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,xj).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,Aj).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,Pj).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,yj).call(e,...i)}),this.addHook("afterRenderer",function(){return Oe(HS,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,Ij).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,_j).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,Oj).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,Nj).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,Dj).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,Lj).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,kj).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,$j).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,Vj).call(e,...i)}),this.addHook("afterChange",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,Fj).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,Wj).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,Bj).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,jj).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,Uj).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return ve(Te,e,zj).call(e,...i)}),this.addHook("beforeUndoStackChange",(t,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[ih];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!mp())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(i=>{const{row:o,rowspan:s}=i;for(let r=o+1;r<o+s;r++)t.push(r)}),t=[...new Set(t)],t.forEach(i=>{const o=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>(s==null?void 0:s.name)==="master"?s:s.clone.wtTable).forEach(s=>{const r=s.getRow(o);r&&(r.style.background=wl(r,"backgroundColor").replace(")",", 0.99)"),e.push(r))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{i.style.background=wl(i,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?Ni.containsNegativeValues(e)?(ye(Ni.NEGATIVE_VALUES_WARNING(e)),!1):Ni.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(ye(Ni.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Ni.isSingleCell(e)?(ye(Ni.IS_SINGLE_CELL(e)),!1):Ni.containsZeroSpan(e)?(ye(Ni.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(e){if(!Array.isArray(e))return;const t=e.filter(s=>this.validateSetting(s)),i=this.mergedCellsCollection.filterOverlappingMergeCells(t),o=[];i.forEach(s=>{const{row:r,col:l,rowspan:a,colspan:h}=s,u=this.hot._createCellCoords(r,l),c=this.hot._createCellCoords(r+a-1,l+h-1),d=this.hot._createCellRange(u,u,c);this.mergeRange(d,!0,!0);for(let g=r;g<r+a;g++)for(let p=l;p<l+h;p++)(g!==r||p!==l)&&o.push([g,p,null])}),o.length!==0&&this.hot.setDataAtCell(o,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,i.row,i.col,!1)}mergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=e.getTopStartCorner(),s=e.getBottomEndCorner(),r={row:o.row,col:o.col,rowspan:s.row-o.row+1,colspan:s.col-o.col+1},l=[];let a=null;return this.canMergeRange(r,t)?(this.hot.runHooks("beforeMergeCells",e,t),j(0,r.rowspan-1,u=>{j(0,r.colspan-1,c=>{let d=null;l[u]||(l[u]=[]),u===0&&c===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(r.row),this.hot.toPhysicalColumn(r.col)):this.hot.setCellMeta(r.row+u,r.col+c,"hidden",!0),l[u][c]=d})}),this.hot.setCellMeta(r.row,r.col,"spanned",!0),this.mergedCellsCollection.add(r,t)?(i?a=[r.row,r.col,l]:this.hot.populateFromArray(r.row,r.col,l,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,r,t),a):!0):!1}unmergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.mergedCellsCollection.getWithinRange(e);i.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,t),b(i,o=>{this.mergedCellsCollection.remove(o.row,o.col),j(0,o.rowspan-1,s=>{j(0,o.colspan-1,r=>{this.hot.removeCellMeta(o.row+s,o.col+r,"hidden"),this.hot.removeCellMeta(o.row+s,o.col+r,"copyable")})}),this.hot.removeCellMeta(o.row,o.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,i,o){const s=this.hot._createCellCoords(e,t),r=this.hot._createCellCoords(i,o);this.mergeRange(this.hot._createCellRange(s,s,r))}unmerge(e,t,i,o){const s=this.hot._createCellCoords(e,t),r=this.hot._createCellCoords(i,o);this.unmergeRange(this.hot._createCellRange(s,s,r))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const i=this.hot.getSelectedRangeLast();i&&!i.isSingleHeader()&&(this.toggleMerge(i),this.hot.render())},runOnlyIf:i=>!i.altKey,group:IS})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(IS)}modifyViewportRowStart(e,t){const i=this.hot.rowIndexMapper,o=i.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<t;s+=1){const r=this.mergedCellsCollection.get(o,s);if(ee(r)){const l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r.row,1));if(l<e.startRow){e.startRow=l,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){const i=this.hot.rowIndexMapper,o=i.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<t;s+=1){const r=this.mergedCellsCollection.get(o,s);if(ee(r)){const l=r.row+r.rowspan-1,a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(l,-1));if(a>e.endRow){e.endRow=a,this.modifyViewportRowEnd(e,t);return}}}}modifyViewportColumnStart(e,t){const i=this.hot.columnIndexMapper,o=i.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<t;s+=1){const r=this.mergedCellsCollection.get(s,o);if(ee(r)){const l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r.col,1));if(l<e.startColumn){e.startColumn=l,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){const i=this.hot.columnIndexMapper,o=i.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<t;s+=1){const r=this.mergedCellsCollection.get(s,o);if(ee(r)){const l=r.col+r.colspan-1,a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(l,-1));if(a>e.endColumn){e.endColumn=a,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,i,o){const{rowIndexMapper:s,columnIndexMapper:r}=this.hot;let l,a;t===0?l=s.getNearestNotHiddenIndex(e,1):l=s.getNearestNotHiddenIndex(e+t-1,-1),o===0?a=r.getNearestNotHiddenIndex(i,1):a=r.getNearestNotHiddenIndex(i+o-1,-1);const h=e>=0?s.getRenderableFromVisualIndex(l):e,u=i>=0?r.getRenderableFromVisualIndex(a):i;return[h,u]}}function Sj(){this.generateFromSettings(this.hot.getSettings()[ih]),this.hot.render()}function yj(n){if(n){const e=this.mergedCellsCollection.mergedCells,t=this.hot.getSelectedRangeLast(),i=t.getTopStartCorner(),o=t.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(i.row===e[s].row&&i.col===e[s].col&&o.row===e[s].row+e[s].rowspan-1&&o.col===e[s].col+e[s].colspan-1)return!1}return n}function Rj(n){Oe(Nn,this).row=n.row,Oe(Nn,this).col=n.col}function Ej(n){const e=this.hot.getSelectedRangeLast(),{highlight:t}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot;Oe(On,this)&&(o.getRenderableFromVisualIndex(Oe(On,this).row)!==null&&(t.row=Oe(On,this).row),i.getRenderableFromVisualIndex(Oe(On,this).col)!==null&&(t.col=Oe(On,this).col),vh(On,this,null));const s=this.mergedCellsCollection.get(t.row,t.col);if(!s)return;const r=s.col,l=s.col+s.colspan-1;if(n.col<0){const u=t.col>=r&&t.col<=l?r-1:l,c=i.getNearestNotHiddenIndex(u,-1);c===null?n.col=-this.hot.view.countRenderableColumnsInRange(0,t.col):n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(c,t.col)-1,1)}else if(n.col>0){const u=t.col>=r&&t.col<=l?l+1:r,c=i.getNearestNotHiddenIndex(u,1);c===null?n.col=this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):n.col=Math.max(this.hot.view.countRenderableColumnsInRange(t.col,c)-1,1)}const a=s.row,h=s.row+s.rowspan-1;if(n.row<0){const u=t.row>=a&&t.row<=h?a-1:h,c=o.getNearestNotHiddenIndex(u,-1);c===null?n.row=-this.hot.view.countRenderableRowsInRange(0,t.row):n.row=-Math.max(this.hot.view.countRenderableRowsInRange(c,t.row)-1,1)}else if(n.row>0){const u=t.row>=a&&t.row<=h?h+1:a,c=o.getNearestNotHiddenIndex(u,1);c===null?n.row=this.hot.view.countRenderableRowsInRange(t.row,this.hot.countRows()):n.row=Math.max(this.hot.view.countRenderableRowsInRange(t.row,c)-1,1)}}function Tj(n){const e=this.hot.getSelectedRangeLast(),t=e.clone(),{to:i}=e,{columnIndexMapper:o,rowIndexMapper:s}=this.hot,r=(l,a)=>{t.expand(this.hot._createCellCoords(l,a));for(let h=0;h<this.mergedCellsCollection.mergedCells.length;h+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[h].getRange())};if(n.col<0){let l=this.mergedCellsCollection.getStartMostColumnIndex(e,i.col)+n.col;r(i.row,l),e.getHorizontalDirection()==="E-W"&&t.getHorizontalDirection()==="E-W"&&(l=t.getTopStartCorner().col);const a=o.getNearestNotHiddenIndex(l,1);a!==null&&(n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,i.col)-1,1))}else if(n.col>0){let l=this.mergedCellsCollection.getEndMostColumnIndex(e,i.col)+n.col;r(i.row,l),e.getHorizontalDirection()==="W-E"&&t.getHorizontalDirection()==="W-E"&&(l=t.getBottomEndCorner().col);const a=o.getNearestNotHiddenIndex(l,-1);a!==null&&(n.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,a)-1,1))}if(n.row<0){let l=this.mergedCellsCollection.getTopMostRowIndex(e,i.row)+n.row;r(l,i.col),e.getVerticalDirection()==="S-N"&&t.getVerticalDirection()==="S-N"&&(l=t.getTopStartCorner().row);const a=s.getNearestNotHiddenIndex(l,1);a!==null&&(n.row=-Math.max(this.hot.view.countRenderableRowsInRange(a,i.row)-1,1))}else if(n.row>0){let l=this.mergedCellsCollection.getBottomMostRowIndex(e,i.row)+n.row;r(l,i.col),e.getVerticalDirection()==="N-S"&&t.getVerticalDirection()==="N-S"&&(l=t.getBottomStartCorner().row);const a=s.getNearestNotHiddenIndex(l,-1);a!==null&&(n.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,a)-1,1))}}function Mj(){const n=this.hot.getSelectedRangeLast(),{highlight:e}=n;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){vh(On,this,e.clone());return}for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const t=this.mergedCellsCollection.get(e.row,e.col);vh(On,this,e.clone()),t&&e.assign(t)}function Pj(n,e){if(n<0||e<0)return;const t=this.mergedCellsCollection.get(n,e);if(!t)return;const{row:i,col:o,colspan:s,rowspan:r}=t;return[i,o,i+r-1,o+s-1]}function Ij(n){n.items.push({name:"---------"},uj(this))}function xS(){vh(On,this,null)}function Hj(){if(Oe(On,this).isCell())return;const n=this.hot.getSelectedRangeLast(),e=n.getVerticalDirection(),t=n.getHorizontalDirection(),i=Oe(On,this).clone().normalize();Oe(Fi,this).setActiveNode(i.row,i.col),Oe(Nn,this).row>0||Oe(Nn,this).col>0?Oe(Fi,this).setPrevNodeAsActive():(t==="E-W"&&Oe(Nn,this).col<0||e==="S-N"&&Oe(Nn,this).row<0)&&Oe(Fi,this).setNextNodeAsActive()}function xj(n,e){const t=this.hot.getSelectedRangeLast(),{columnIndexMapper:i,rowIndexMapper:o}=this.hot;let s=null,r=null;if(Oe(Nn,this).col<0){const{rowEnd:l,colEnd:a}=Oe(Fi,this).getPrevHorizontalNode();r=i.getNearestNotHiddenIndex(a,-1),s=o.getNearestNotHiddenIndex(l,-1)}else if(Oe(Nn,this).col>0){const{rowStart:l,colStart:a}=Oe(Fi,this).getNextHorizontalNode();r=i.getNearestNotHiddenIndex(a,1),s=o.getNearestNotHiddenIndex(l,1)}else if(Oe(Nn,this).row<0){const{rowEnd:l,colEnd:a}=Oe(Fi,this).getPrevVerticalNode();r=i.getNearestNotHiddenIndex(a,-1),s=o.getNearestNotHiddenIndex(l,-1)}else if(Oe(Nn,this).row>0){const{rowStart:l,colStart:a}=Oe(Fi,this).getNextVerticalNode();r=i.getNearestNotHiddenIndex(a,1),s=o.getNearestNotHiddenIndex(l,1)}if(s!==null||r!==null){const l=this.hot._createCellCoords(s,r),a=this.mergedCellsCollection.get(l.row,l.col),h=this.hot.selection.highlight.getFocus();n=l.row,e=l.col,a?t.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(a.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(a.col,1)}):t.highlight.assign(l),h.clear(),h.add(l).commit()}Oe(Fi,this).setActiveNode(n,e),vh(Nn,this,{row:0,col:0})}function Aj(){this.hot.getSelectedRangeLast().isHeader()||Oe(Fi,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function _j(n,e,t){const i=this.mergedCellsCollection.get(n,e);i&&(i.row!==n||i.col!==e?t.copyable=!1:(t.rowspan=i.rowspan,t.colspan=i.colspan))}function Oj(n){const e=this.hot.countCols();this.modifyViewportRowStart(n,e),this.modifyViewportRowEnd(n,e)}function Nj(n){const e=this.hot.countRows();this.modifyViewportColumnStart(n,e),this.modifyViewportColumnEnd(n,e)}function Dj(n,e){this.autofillCalculations.correctSelectionAreaSize(e);const t=this.autofillCalculations.getDirection(e,n);let i=n;if(this.autofillCalculations.dragAreaOverlapsCollections(e,i,t))return i=e,i;const o=this.hot._createCellCoords(e[0],e[1]),s=this.hot._createCellCoords(e[2],e[3]),r=this.hot._createCellRange(o,o,s),l=this.mergedCellsCollection.getWithinRange(r);return l.length===0||(i=this.autofillCalculations.snapDragArea(e,i,t,l)),i}function Lj(n,e){this.mergedCellsCollection.shiftCollections("right",n,e)}function kj(n,e){this.mergedCellsCollection.shiftCollections("left",n,e)}function $j(n,e,t){t!=="auto"&&this.mergedCellsCollection.shiftCollections("down",n,e)}function Vj(n,e){this.mergedCellsCollection.shiftCollections("up",n,e)}function Fj(n,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(n)}function Wj(n,e){if(e&&e==="area"){const t=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(t);b(i,o=>{t.getBottomEndCorner().row===o.getLastRow()&&t.getBottomEndCorner().col===o.getLastColumn()&&(n[2]=o.row,n[3]=o.col)})}}function Bj(n,e,t,i){if(t)return this.selectionCalculations.getSelectedMergedCellClassName(n,e,t,i)}function jj(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Uj(n,e,t,i){if(!(i instanceof MouseEvent))return;const o=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getByRange(o);if(!s)return;const r=this.hot._createCellCoords(s.row,s.col),l=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&o.isEqual(this.hot._createCellRange(r,r,l))}function zj(n,e,t){if(this.hot.getSettings().rowHeaders||t==="bottom"||t==="bottom_inline_start_corner")return n;let i,o;if(t==="master")i=this.hot.view.getFirstRenderedVisibleColumn(),o=this.hot.view.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(t);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,i))return n;const r=this.hot._createCellCoords(e,i),l=this.hot._createCellCoords(e,o),a=this.hot._createCellRange(r,r,l),h=this.mergedCellsCollection.getWithinRange(a),u=h.reduce((d,g)=>{let{rowspan:p}=g;return Math.max(d,p)},1);let c=0;return h.length>1&&h[0].rowspan<u&&(c=u-h[0].rowspan),h.forEach(d=>{var g;let{rowspan:p}=d,v=0;t==="top"||t==="top_inline_start_corner"?v=Math.min(u,this.hot.view.countNotHiddenFixedRowsTop()-e):v=p-c,n=Math.max((g=n)!==null&&g!==void 0?g:0,ve(Te,this,Gj).call(this,e,v))}),n}function Gj(n,e){const t=this.hot.view._wt.wtSettings.getSettingPure("defaultRowHeight"),i=this.hot.getPlugin("autoRowSize");let o=0;for(let r=n;r<n+e;r++)if(!this.hot.rowIndexMapper.isHidden(r)){var s;o+=(s=i==null?void 0:i.getRowHeight(r))!==null&&s!==void 0?s:t}return o}function Yj(n,e){return function(t,i){const[,...o]=t,[,...s]=i;return function r(l){const a=n[l],h=e[l],u=o[l],c=s[l],d=h.multiColumnSorting,p=(d.compareFunctionFactory?d.compareFunctionFactory:rE(h.type))(a,h,d)(u,c);if(p===ji){const v=l+1;if(typeof e[v]<"u")return r(v)}return p}(0)}}function AS(){ye(Re`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const xT="sort";function Kj(n,e,t){const i=[];return t===!1||n.isColumnSorted(e)&&n.getNumberOfSortedColumns()>1&&i.push(`${xT}-${n.getIndexOfColumnInSortQueue(e)+1}`),i}function Xj(n){const e=n.className.split(" "),t=new RegExp(`^${xT}-[0-9]{1,2}$`);return e.filter(i=>t.test(i))}function qj(n,e,t){return(e=Qj(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Qj(n){var e=Jj(n,"string");return typeof e=="symbol"?e:e+""}function Jj(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const wd="multiColumnSorting",Zj=170,Bg="columnSorting",_S=wd;sE(wd,Yj);class eU extends mE{constructor(){super(...arguments),qj(this,"pluginKey",wd)}static get PLUGIN_KEY(){return wd}static get PLUGIN_PRIORITY(){return Zj}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Bg]&&(AS(),this.hot.getPlugin(Bg).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Zc)),!1},runOnlyIf:()=>{var e,t;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:cs,position:"before",group:_S})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(_S)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];super.updateHeaderClasses(e,...i),X(e,Xj(e)),this.enabled!==!1&&P(e,Kj(...i))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Bg]&&AS(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){NC(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,Zc))):this.sort(this.getColumnNextConfig(t.col)))}}function OS(n,e,t){return(e=tU(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function tU(n){var e=nU(n,"string");return typeof e=="symbol"?e:e+""}function nU(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const iU="multipleSelectionHandles",oU=160;class sU extends we{constructor(){super(...arguments),OS(this,"dragged",[]),OS(this,"lastSetCell",null)}static get PLUGIN_KEY(){return iU}static get PLUGIN_PRIORITY(){return oU}isEnabled(){return go()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function i(o){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(o);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",o=>{let s;if(K(o.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},o.preventDefault(),!1;if(K(o.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},o.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchend",o=>{if(K(o.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,o.preventDefault(),!1;if(K(o.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,o.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchmove",o=>{const{rootDocument:s}=this.hot;let r,l,a,h,u,c;if(e.dragged.length===0)return;const d=s.elementFromPoint(o.touches[0].clientX,o.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(r=e.hot.getCoords(d),r.col===-1&&(r.col=0),l=e.hot.getSelectedRangeLast(),a=l.getWidth(),h=l.getHeight(),u=l.getDirection(),a===1&&h===1&&e.hot.selection.setRangeEnd(r),c=e.getCurrentRangeCoords(l,r,e.touchStartRange.direction,u,e.dragged[0]),c.start!==null&&e.hot.selection.setRangeStart(c.start),e.hot.selection.setRangeEnd(c.end),e.lastSetCell=d),o.preventDefault())})}getCurrentRangeCoords(e,t,i,o,s){const r=e.getTopStartCorner(),l=e.getBottomEndCorner(),a=e.getBottomStartCorner(),h=e.getTopEndCorner();let u={start:null,end:null};switch(i){case"NE-SW":switch(o){case"NE-SW":case"NW-SE":s==="top"?u={start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(a.row,t.col)}:u={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,r.col)};break;case"SE-NW":s==="bottom"&&(u={start:this.hot._createCellCoords(l.row,t.col),end:this.hot._createCellCoords(t.row,r.col)});break}break;case"NW-SE":switch(o){case"NE-SW":s==="top"?u={start:t,end:a}:u.end=t;break;case"NW-SE":s==="top"?u={start:t,end:l}:u.end=t;break;case"SE-NW":s==="top"?u={start:t,end:r}:u.end=t;break;case"SW-NE":s==="top"?u={start:t,end:h}:u.end=t;break}break;case"SW-NE":switch(o){case"NW-SE":s==="bottom"?u={start:this.hot._createCellCoords(t.row,r.col),end:this.hot._createCellCoords(a.row,t.col)}:u={start:this.hot._createCellCoords(r.row,t.col),end:this.hot._createCellCoords(t.row,l.col)};break;case"SW-NE":s==="top"?u={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,l.col)}:u={start:this.hot._createCellCoords(t.row,r.col),end:this.hot._createCellCoords(r.row,t.col)};break;case"SE-NW":s==="bottom"?u={start:this.hot._createCellCoords(t.row,h.col),end:this.hot._createCellCoords(r.row,t.col)}:s==="top"&&(u={start:a,end:t});break}break;case"SE-NW":switch(o){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(u.end=t);break;case"SE-NW":s==="top"?u.end=t:u={start:t,end:r};break}break}return u}isDragged(){return this.dragged.length>0}}function Jm(){let{label:n="",colspan:e=1,origColspan:t=1,collapsible:i=!1,crossHiddenColumns:o=[],isCollapsed:s=!1,isHidden:r=!1,isRoot:l=!1,isPlaceholder:a=!1,headerClassNames:h=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:n,colspan:e,origColspan:t,collapsible:i,isCollapsed:s,crossHiddenColumns:o,isHidden:r,isRoot:l,isPlaceholder:a,headerClassNames:h}}function AT(){return{label:"",isPlaceholder:!0}}function rU(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const t=[];if(e===0)return t;b(n,o=>{const s=[];let r=0;t.push(s),b(o,l=>{const a=Jm();if(ee(l)){const{label:u,colspan:c,headerClassName:d}=l;a.label=Qe(u),typeof c=="number"&&c>1&&(a.colspan=c,a.origColspan=c),typeof d=="string"&&(a.headerClassNames=[...d.split(" ")])}else a.label=Qe(l);r+=a.origColspan;let h=!1;if(r>=e&&(a.colspan=a.origColspan-(r-e),a.origColspan=a.colspan,h=!0),s.push(a),a.colspan>1)for(let u=0;u<a.colspan-1;u++)s.push(AT());return!h})});const i=Math.max(...ae(t,o=>o.length));return b(t,o=>{if(o.length<i){const s=ae(new Array(i-o.length),()=>Jm());o.splice(o.length,0,...s)}}),t}function jg(n,e,t){lU(n,e),e.set(n,t)}function lU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qn(n,e){return n.get(_T(n,e))}function Ta(n,e,t){return n.set(_T(n,e),t),t}function _T(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const NS=["label","collapsible"];var oo=new WeakMap,Gs=new WeakMap,Ug=new WeakMap;class aU{constructor(){jg(this,oo,[]),jg(this,Gs,0),jg(this,Ug,1/0)}setColumnsLimit(e){Ta(Ug,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Ta(oo,this,rU(e,qn(Ug,this))),Ta(Gs,this,qn(oo,this).length)}getData(){return qn(oo,this)}mergeWith(e){b(e,t=>{let{row:i,col:o,...s}=t;const r=this.getHeaderSettings(i,o);r!==null&&lt(r,s,NS)})}map(e){b(qn(oo,this),t=>{b(t,i=>{const o=e({...i});ee(o)&&lt(i,o,NS)})})}getHeaderSettings(e,t){var i;if(e>=qn(Gs,this)||e<0)return null;const o=qn(oo,this)[e];return Array.isArray(o)===!1||t>=o.length?null:(i=o[t])!==null&&i!==void 0?i:null}getHeadersSettings(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const o=[];if(e>=qn(Gs,this)||e<0)return o;const s=qn(oo,this)[e];let r=0;for(let l=t;l<s.length;l++){const a=s[l];if(a.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(r+=a.colspan,o.push(a),a.colspan>1&&(l+=a.colspan-1),r===i)break;if(r>i)throw new Error("The last column settings cannot overlap the other header layers")}return o}getLayersCount(){return qn(Gs,this)}getColumnsCount(){return qn(Gs,this)>0?qn(oo,this)[0].length:0}clear(){Ta(oo,this,[]),Ta(Gs,this,0)}}function zg(n,e,t){return(e=hU(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hU(n){var e=uU(n,"string");return typeof e=="symbol"?e:e+""}function uU(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const OT="DF-pre-order";function NT(n,e){let t=n.call(e,this);for(let i=0;i<this.childs.length;i++){if(t===!1)return!1;t=NT.call(this.childs[i],n,e)}return t}const cU="DF-post-order";function DT(n,e){for(let t=0;t<this.childs.length;t++)if(DT.call(this.childs[t],n,e)===!1)return!1;return n.call(e,this)}const LT="BF";function dU(n,e){const t=[this];function i(){if(t.length===0)return;const o=t.shift();t.push(...o.childs),n.call(e,o)!==!1&&i()}i()}const fU=LT,DS=new Map([[OT,NT],[cU,DT],[LT,dU]]);class Cd{constructor(e){zg(this,"data",{}),zg(this,"parent",null),zg(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const t=new Cd({...e.data});for(let i=0;i<e.childs.length;i++)t.addChild(this.cloneTree(e.childs[i]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fU;if(!DS.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);DS.get(t).call(this,e,this)}walkUp(e){const t=this,i=o=>{e.call(t,o)!==!1&&o.parent!==null&&i(o.parent)};i(this)}}function Gg(n,e,t){gU(n,e),e.set(n,t)}function gU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wt(n,e){return n.get(kT(n,e))}function mU(n,e,t){return n.set(kT(n,e),t),t}function kT(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var tl=new WeakMap,Ys=new WeakMap,nl=new WeakMap;class pU{constructor(e){Gg(this,tl,new Map),Gg(this,Ys,new Map),Gg(this,nl,null),mU(nl,this,e)}getRoots(){return Array.from(Wt(tl,this).values())}getRootByColumn(e){let t;return Wt(Ys,this).has(e)&&(t=Wt(tl,this).get(Wt(Ys,this).get(e))),t}getNode(e,t){const i=this.getRootByColumn(t);if(!i)return;const o=t-Wt(Ys,this).get(t);let s=0,r;return i.walkDown(l=>{const{data:{origColspan:a,headerLevel:h}}=l;if(e===h){if(o>=s&&o<=s+a-1)return r=l,r.data.isRoot=t===r.data.columnIndex,!1;s+=a}}),r}rebuildTreeIndex(){let e=0;Wt(Ys,this).clear(),b(Wt(tl,this),t=>{let[,{data:{colspan:i}}]=t;for(let o=e;o<e+i;o++)Wt(Ys,this).set(o,e);e+=i})}buildTree(){this.clear();const e=Wt(nl,this).getColumnsCount();let t=0;for(;t<e;){const i=Wt(nl,this).getHeaderSettings(0,t),o=new Cd;Wt(tl,this).set(t,o),this.buildLeaves(o,t,0,i.origColspan),t+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,i){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=Wt(nl,this).getHeadersSettings(i,t,o);i+=1,b(s,r=>{const l={...r,headerLevel:i-1,columnIndex:t};let a;i===1?(e.data=l,a=e):(a=new Cd(l),e.addChild(a)),i<Wt(nl,this).getLayersCount()&&this.buildLeaves(a,t,i,r.origColspan),t+=r.origColspan})}clear(){Wt(tl,this).clear(),Wt(Ys,this).clear()}}function $T(n,e){n.walkDown(t=>{let{data:i,childs:o}=t;if(!i.isHidden&&(e(i.columnIndex),o.length===0))for(let s=1;s<i.colspan;s++)e(i.columnIndex+s)})}function bd(n,e){let{childs:t}=n;if(t.length!==0)return t[0].data[e]}function vd(n){return bd(n,"origColspan")===n.data.origColspan}function XC(n){const{data:e,childs:t}=n;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(vd(n))return XC(t[0]);e.isCollapsed=!1;const o=t.slice(1),s=new Set;let r=0;if(o.length>0)b(o,l=>{l.replaceTreeWith(l.data.clonedTree),l.data.clonedTree=null;const a=l.data;r+=a.colspan,$T(l,h=>{s.add(h)})});else{const{colspan:l,origColspan:a,columnIndex:h}=e;r=a-l;for(let u=1;u<a;u++)s.add(h+u)}return n.walkUp(l=>{const{data:a}=l;a.colspan+=r,a.colspan>=a.origColspan?(a.colspan=a.origColspan,a.isCollapsed=!1):vd(l)&&(a.isCollapsed=bd(l,"isCollapsed"))}),{rollbackModification:()=>qC(n),affectedColumns:Array.from(s),colspanCompensation:r}}function qC(n){var e;const{data:t,childs:i}=n;if(t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(vd(n))return qC(i[0]);t.isCollapsed=!0;const s=i.slice(1),r=new Set;if(s.length>0)b(s,a=>{$T(a,h=>{r.add(h)}),a.data.clonedTree=a.cloneTree(),a.walkDown(h=>{let{data:u}=h;u.isHidden=!0})});else{const{origColspan:a,columnIndex:h}=t;for(let u=1;u<a;u++){const c=h+u;r.add(c)}}const l=t.colspan-((e=bd(n,"colspan"))!==null&&e!==void 0?e:1);return n.walkUp(a=>{const{data:h}=a;h.colspan-=l,h.colspan<=1?(h.colspan=1,h.isCollapsed=!0):vd(a)&&(h.isCollapsed=bd(a,"isCollapsed"))}),{rollbackModification:()=>XC(n),affectedColumns:Array.from(r),colspanCompensation:l}}function wU(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(Re`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(t.includes(e))return;let i=!1;n.walkUp(o=>{const{data:{collapsible:s}}=o;if(s)return i=!0,!1}),!i&&n.walkUp(o=>{const{data:s}=o;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function CU(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(Re`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(!t.includes(e))return;let i=!1;n.walkUp(o=>{const{data:{collapsible:s}}=o;if(s)return i=!0,!1}),!i&&n.walkUp(o=>{const{data:s}=o;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const LS=new Map([["collapse",qC],["expand",XC],["hide-column",wU],["show-column",CU]]);function bU(n,e,t){if(!LS.has(n))throw new Error(`The node modifier action ("${n}") does not exist.`);return LS.get(n)(e,t)}function ac(n){const e=[];return b(n,t=>{t.walkDown(i=>{const o=i.data,{origColspan:s,columnIndex:r,headerLevel:l,crossHiddenColumns:a}=o,h=SU(e,l);let u=!1;for(let c=r;c<r+s;c++)if(a.includes(c)||u)h.push(AT());else{const g=vU(o);g.isRoot=!0,h.push(g),u=!0}})}),e}function vU(n){const{crossHiddenColumns:e,...t}=Jm(n);return t}function SU(n,e){let t;return Array.isArray(n[e])?t=n[e]:(t=[],n[e]=t),t}function Yg(n,e,t){yU(n,e),e.set(n,t)}function yU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ma(n,e,t){return n.set(VT(n,e),t),t}function Ge(n,e){return n.get(VT(n,e))}function VT(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var Hi=new WeakMap,Jt=new WeakMap,Ks=new WeakMap;class RU{constructor(){Yg(this,Hi,new aU),Yg(this,Jt,new pU(Ge(Hi,this))),Yg(this,Ks,[[]])}setState(e){Ge(Hi,this).setData(e);let t=!1;try{Ge(Jt,this).buildTree()}catch{Ge(Jt,this).clear(),Ge(Hi,this).clear(),t=!0}return Ma(Ks,this,ac(Ge(Jt,this).getRoots())),t}setColumnsLimit(e){Ge(Hi,this).setColumnsLimit(e)}mergeStateWith(e){const t=ae(e,i=>{let{row:o,...s}=i;return{row:o<0?this.rowCoordsToLevel(o):o,...s}});Ge(Hi,this).mergeWith(t),Ge(Jt,this).buildTree(),Ma(Ks,this,ac(Ge(Jt,this).getRoots()))}mapState(e){Ge(Hi,this).map(e),Ge(Jt,this).buildTree(),Ma(Ks,this,ac(Ge(Jt,this).getRoots()))}mapNodes(e){return at(Ge(Jt,this).getRoots(),(t,i)=>(i.walkDown(o=>{const s=e(o.data);s!==void 0&&t.push(s)}),t),[])}triggerNodeModification(e,t,i){t<0&&(t=this.rowCoordsToLevel(t));const o=Ge(Jt,this).getNode(t,i);let s;return o&&(s=bU(e,o,i),Ma(Ks,this,ac(Ge(Jt,this).getRoots()))),s}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var i,o;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(o=Ge(Ks,this)[e])===null||o===void 0?void 0:o[t])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,t){const i=this.getHeaderTreeNode(e,t);return i?{...i.data}:null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const i=Ge(Jt,this).getNode(e,t);return i||null}findTopMostEntireHeaderLevel(e){var t;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const o=i-e+1;let s=!1,r=null;for(let l=e;l<=i;l++){const a=Ge(Jt,this).getRootByColumn(l);if(!a)break;s=!0,a.walkDown(h=>{const{columnIndex:u,headerLevel:c,origColspan:d,isHidden:g}=h.data;g||d<=o&&u>=e&&u+d-1<=i&&(r===null||c<r)&&(r=c)},OT)}return s&&r===null?-1:this.levelToRowCoords((t=r)!==null&&t!==void 0?t:0)}findLeftMostColumnIndex(e,t){var i;const{isRoot:o}=(i=this.getHeaderSettings(e,t))!==null&&i!==void 0?i:{isRoot:!0};if(o)return t;let s=t-1;for(;s>=0;){var r;const{isRoot:l}=(r=this.getHeaderSettings(e,s))!==null&&r!==void 0?r:{isRoot:!0};if(l)break;s-=1}return s}findRightMostColumnIndex(e,t){var i;const{isRoot:o,origColspan:s}=(i=this.getHeaderSettings(e,t))!==null&&i!==void 0?i:{isRoot:!0,origColspan:1};if(o)return t+s-1;let r=t+1;for(;r<this.getColumnsCount();){var l;const{isRoot:a}=(l=this.getHeaderSettings(e,r))!==null&&l!==void 0?l:{isRoot:!0};if(a)break;r+=1}return r-1}getLayersCount(){return Ge(Hi,this).getLayersCount()}getColumnsCount(){return Ge(Hi,this).getColumnsCount()}clear(){Ma(Ks,this,[]),Ge(Hi,this).clear(),Ge(Jt,this).clear()}}function Pa(n,e,t){return(e=EU(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function EU(n){var e=TU(n,"string");return typeof e=="symbol"?e:e+""}function TU(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class MU{constructor(e,t){Pa(this,"hot",void 0),Pa(this,"nestedHeaderSettingsGetter",void 0),Pa(this,"layersCount",0),Pa(this,"container",void 0),Pa(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(let i=0;i<t;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,e[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:i}=this.hot,o=t.createDocumentFragment(),s=t.createElement("table"),r=!!this.hot.getSettings().dropdownMenu,l=i.getRenderableIndexesLength();for(let a=0;a<this.layersCount;a++){const h=t.createElement("tr");for(let u=0;u<l;u++){let c=i.getVisualFromRenderableIndex(u);c===null&&(c=u);const d=t.createElement("th"),g=this.nestedHeaderSettingsGetter(a,c);if(g&&(!g.isPlaceholder||g.isHidden)){let p=g.label;r&&(p+='<button class="changeType"></button>'),wr(d,p),d.colSpan=g.colspan,h.appendChild(d)}}s.appendChild(h)}o.appendChild(s),e.appendChild(o)}clear(){this.widthsMap.clear(),this.container=null}}function PU(n,e){FT(n,e),e.add(n)}function kS(n,e,t){return(e=IU(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function IU(n){var e=HU(n,"string");return typeof e=="symbol"?e:e+""}function HU(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function hc(n,e,t){FT(n,e),e.set(n,t)}function FT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sr(n,e,t){return n.set(Ye(n,e),t),t}function ue(n,e){return n.get(Ye(n,e))}function Ye(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const $S="nestedHeaders",xU=280;var Pe=new WeakMap,Vo=new WeakMap,oh=new WeakMap,af=new WeakMap,tt=new WeakSet;class AU extends we{constructor(){super(...arguments),PU(this,tt),hc(this,Pe,new RU),hc(this,Vo,null),hc(this,oh,null),hc(this,af,!1),kS(this,"ghostTable",new MU(this.hot,(e,t)=>this.getHeaderSettings(e,t))),kS(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return $S}static get PLUGIN_PRIORITY(){return xU}isEnabled(){return!!this.hot.getSettings()[$S]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&ye(Re`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Ye(tt,this,YU).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ye(tt,e,KU).call(e,...o)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ye(tt,e,DU).call(e,...o)}),this.addHook("afterOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ye(tt,e,LU).call(e,...o)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ye(tt,e,kU).call(e,...o)}),this.addHook("beforeOnCellMouseUp",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ye(tt,e,$U).call(e,...o)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ye(tt,e,VU).call(e,...o)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ye(tt,e,FU).call(e,...o)}),this.addHook("afterSelection",()=>Ye(tt,this,uc).call(this)),this.addHook("afterSelectionFocusSet",()=>Ye(tt,this,uc).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ye(tt,e,_U).call(e,...o)}),this.addHook("afterGetColumnHeaderRenderers",i=>Ye(tt,this,BU).call(this,i)),this.addHook("modifyColWidth",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ye(tt,e,UU).call(e,...o)}),this.addHook("modifyColumnHeaderValue",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ye(tt,e,zU).call(e,...o)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ye(tt,e,OU).call(e,...o)}),this.addHook("beforeCopy",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ye(tt,e,NU).call(e,...o)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ye(tt,e,WU).call(e,...o)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ye(tt,e,jU).call(e,...o)}),this.addHook("modifyFocusedElement",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ye(tt,e,GU).call(e,...o)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Ye(tt,this,uc).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Ye(tt,this,uc).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();ue(Pe,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=ue(Pe,this).setState(e)),this.detectedOverlappedHeaders&&ye(Re`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,i)=>{const o=t===!0?"hide-column":"show-column";ue(Pe,this).triggerColumnModification(o,i)}),!ue(Vo,this)&&this.enabled&&sr(Vo,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(i=>{let{op:o,index:s,newValue:r}=i;if(o==="replace"){const l=r===!0?"hide-column":"show-column";ue(Pe,this).triggerColumnModification(l,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),ue(Pe,this).clear(),ue(Vo,this).unsubscribe(),sr(Vo,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return ue(Pe,this)}getLayersCount(){return ue(Pe,this).getLayersCount()}getHeaderSettings(e,t){return ue(Pe,this).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,o=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let r=0;r<t;r++){const l=i.childNodes[r];if(!l)break;const a=o.childNodes[r],h=s?s.childNodes[r]:null;for(let u=0,c=l.childNodes.length;u<c;u++)l.childNodes[u].removeAttribute("colspan"),X(l.childNodes[u],"hiddenHeader"),a&&a.childNodes[u]&&(a.childNodes[u].removeAttribute("colspan"),X(a.childNodes[u],"hiddenHeader")),s&&h&&h.childNodes[u]&&(h.childNodes[u].removeAttribute("colspan"),X(h.childNodes[u],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const i=this.hot.view._wt.getSetting("fixedColumnsStart");return(o,s)=>{var r;const{columnIndexMapper:l,view:a}=this.hot;let h=l.getVisualFromRenderableIndex(o);h===null&&(h=o),s.removeAttribute("colspan"),X(s,"hiddenHeader");const{colspan:u,isHidden:c,isPlaceholder:d,headerClassNames:g}=(r=ue(Pe,this).getHeaderSettings(e,h))!==null&&r!==void 0?r:{};if(d||c)P(s,"hiddenHeader");else if(u>1){var p,v;const{wtOverlays:C}=a._wt,S=(p=C.topInlineStartCornerOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(s),R=(v=C.inlineStartOverlay)===null||v===void 0?void 0:v.clone.wtTable.THEAD.contains(s),M=S||R?Math.min(u,i-o):u;M>1&&s.setAttribute("colspan",M)}if(this.hot.view.appendColHeader(h,s,function(){return t.getColumnHeaderValue(...arguments)},e),!d&&!c){const C=s.querySelector("div.relative");C&&g&&g.length>0&&(X(C,this.hot.getColumnMeta(h).headerClassName),P(C,g))}}}getColumnHeaderValue(e,t){var i;const{isHidden:o,isPlaceholder:s}=(i=ue(Pe,this).getHeaderSettings(t,e))!==null&&i!==void 0?i:{};return s||o?"":this.hot.getColHeader(e,t)}destroy(){sr(Pe,this,null),ue(Vo,this)!==null&&(ue(Vo,this).unsubscribe(),sr(Vo,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return ue(Pe,this).getHeaderTreeNodeData(e.row,e.col)}}function uc(){var n;const e=(n=this.hot)===null||n===void 0?void 0:n.getSelectedRangeLast();if(!e)return;const{highlight:t}=e;if(t.isHeader()&&t.col>=0){const o=ue(Pe,this).findLeftMostColumnIndex(t.row,t.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=o,s.visualCellRange.from.col=o,s.visualCellRange.to.col=o,s.commit()}}function _U(n){const e=this.hot.getSelectedRangeLast();if(!e)return n;const{highlight:t}=e;if(!(t.isHeader()&&t.col>=0))return n;const o=this.hot.view.getFirstFullyVisibleColumn(),s=this.hot.view.getLastFullyVisibleColumn(),r=ue(Pe,this).findLeftMostColumnIndex(t.row,t.col),l=ue(Pe,this).findRightMostColumnIndex(t.row,t.col);return r<o&&l>s?n:r<o?r:l}function OU(n,e,t){const i=ue(Pe,this).getHeaderTreeNodeData(e,n);if(!i)return n;const{columnCursor:o,selectionType:s,selectionWidth:r}=t,{isRoot:l,colspan:a}=ue(Pe,this).getHeaderSettings(e,n);if(s===_p){if(!l)return i.columnIndex}else if(s===iR&&(a>r-o||!l))return null;return n}function NU(n,e,t){let{columnHeadersCount:i}=t;if(i!==0)for(let s=0;s<e.length;s++){const{startRow:r,startCol:l,endRow:a,endCol:h}=e[s],u=a-r+1,c=l-h+1;if(r>=0||c===1)break;for(let d=l;d<=h;d++)for(let g=r;g<=a;g++){var o;const p=u+g,v=d-l;if(v===0)continue;((o=ue(Pe,this).getHeaderTreeNodeData(g,d))===null||o===void 0?void 0:o.isRoot)===!1&&(n[p][v]="")}}}function DU(n,e,t,i){this._getHeaderTreeNodeDataByCoords(e)&&(i.column=!0)}function LU(n,e){const t=this._getHeaderTreeNodeDataByCoords(e);if(!t)return;sr(oh,this,e.clone()),sr(af,this,!0);const{selection:i}=this.hot,o=i.isSelected()?i.getSelectedRange().current():null,s=[],{columnIndex:r,origColspan:l}=t,a=!i.inInSelection(e);n.shiftKey&&o?e.col<o.from.col?s.push(o.getTopEndCorner().col,r,e.row):e.col>o.from.col?s.push(o.getTopStartCorner().col,r+l-1,e.row):s.push(r,r+l-1,e.row):(Od(n)||ls(n)&&a||Ay(n))&&s.push(r,r+l-1,e.row),i.selectColumns(...s)}function kU(n,e,t,i){if(!this.hot.view.isMouseDown())return;const o=this._getHeaderTreeNodeDataByCoords(e);if(!o)return;const{columnIndex:s,origColspan:r}=o,l=this.hot.getSelectedRangeLast(),a=l.getTopStartCorner(),h=l.getBottomEndCorner(),{from:u}=l;i.column=!0,i.cell=!0;const c=[],d=Se(e.row,-1/0,-1);e.col<u.col?c.push(h.col,s,d):e.col>u.col?c.push(a.col,s+r-1,d):c.push(s,s+r-1,d),this.hot.selection.selectColumns(...c)}function $U(){sr(af,this,!1)}function VU(){const{navigableHeaders:n}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!ue(af,this)||!n)return;const e=this.hot.getSelectedRangeLast(),t=e.getTopStartCorner().col,i=e.getBottomEndCorner().col,{columnIndex:o,origColspan:s}=ue(Pe,this).getHeaderTreeNodeData(ue(oh,this).row,ue(oh,this).col);if(e.setHighlight(ue(oh,this)),s>e.getWidth()||o<t||o+s-1>i){const r=ue(Pe,this).findTopMostEntireHeaderLevel(Se(t,o,o+s-1),Se(i,o,o+s-1));e.highlight.row=r,e.highlight.col=e.from.col}}function FU(n){const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.hot._createCellCoords(e.row+n.row,e.col+n.col);if(!(t.isHeader()&&t.col>=0))return;const o=ue(Pe,this).findLeftMostColumnIndex(t.row,t.col),s=ue(Pe,this).findRightMostColumnIndex(t.row,t.col);if(n.col<0){const r=e.col>=o&&e.col<=s?o-1:s,l=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r,-1);l===null?n.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):n.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,e.col)-1,1)}else if(n.col>0){const r=e.col>=o&&e.col<=s?s+1:o,l=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r,1);l===null?n.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):n.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,l)-1,1)}}function WU(n,e){const t=n.row,i=this._getHeaderTreeNodeDataByCoords({row:t,col:n.col}),o=this._getHeaderTreeNodeDataByCoords({row:t,col:e.col});e.col<n.col?(i&&(n.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=n.col&&(i&&(n.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function BU(n){n.length=0;for(let e=0;e<ue(Pe,this).getLayersCount();e++)n.push(this.headerRendererFactory(e))}function jU(n){const e=ue(Pe,this).getLayersCount();let t=n.startColumn,i=!!e;for(let o=0;o<e;o++){const s=ue(Pe,this).findLeftMostColumnIndex(o,n.startColumn),r=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(i=!1),_t(r)&&r<n.startColumn){t=r;break}}n.startColumn=i?ue(Pe,this).getHeaderTreeNodeData(0,t).columnIndex:t}function UU(n,e){const t=this.ghostTable.getWidth(e);return n>t?n:t}function zU(n,e,t){var i;const{label:o}=(i=ue(Pe,this).getHeaderTreeNodeData(t,e))!==null&&i!==void 0?i:{label:""};return o}function GU(n,e){if(n<0)return this.hot.getCell(n,ue(Pe,this).findLeftMostColumnIndex(n,e),!0)}function YU(){this.updatePlugin()}function KU(n,e){e||this.updatePlugin()}function Ia(n,e,t){return(e=XU(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function XU(n){var e=qU(n,"string");return typeof e=="symbol"?e:e+""}function qU(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class QU{constructor(e,t){Ia(this,"hot",void 0),Ia(this,"data",null),Ia(this,"plugin",void 0),Ia(this,"parentReference",new WeakMap),Ia(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},j(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,i){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&b(e.__children,o=>{this.cacheNode(o,t+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,t,i,o){let s=!1,r=t;if(isNaN(r)&&r.end)return r;let l=e;return l||(l={__children:this.data},s=!0,r-=1),i!=null&&r===i?{result:l,end:!0}:o!=null&&l===o?{result:r,end:!0}:(r+=1,l.__children&&b(l.__children,a=>{if(this.parentReference.set(a,s?null:l),r=this.readTreeNodes(a,r,i,o),isNaN(r)&&r.end)return!1}),r)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return te(this.data[0],(t,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;isNaN(e)?t=e:t=this.getDataObject(e);const i=this.getRowParent(e);return i==null?this.data.indexOf(t):i.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(b(i.__children,o=>{t+=1,o.__children&&(t+=this.countChildren(o))}),t)}getRowParent(e){let t;return isNaN(e)?t=e:t=this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let t=null;return isNaN(e)?t=e:t=this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,t){var i;return((i=e.__children)===null||i===void 0?void 0:i[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((t=i.__children)===null||t===void 0?void 0:t.length)!==0}addChild(e,t){let i=t;this.hot.runHooks("beforeAddChild",e,i);let o=null;e&&(o=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",o+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),i||(i=this.mockNode()),s.__children.push(i),this.rewriteCache();const r=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(r,1),this.hot.runHooks("afterCreateRow",r,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,t,i){let o=i,s;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",e,o,t),e){const l=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",l,1),e.__children.splice(t,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(l,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",l,1),s=l}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[t]);o=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,o,t)}addSibling(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const i=this.translateTrimmedRow(e),o=this.getRowParent(i),s=this.getRowIndexWithinParent(i);switch(t){case"below":this.addChildAtIndex(o,s+1,null);break;case"above":this.addChildAtIndex(o,s,null);break}}detachFromParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null;const o=[];Array.isArray(e)?(j(e[0],e[2],d=>{const g=this.translateTrimmedRow(d);o.push(this.getDataObject(g))}),j(0,o.length-2,d=>{this.detachFromParent(o[d],!1)}),i=o[o.length-1]):i=e;const s=this.getRowIndex(i),r=this.countChildren(i),l=this.getRowIndexWithinParent(i),a=this.getRowParent(i),h=this.getRowParent(a),u=this.getRowIndex(h);let c=null;if(this.hot.runHooks("beforeDetachChild",a,i),l!=null){const d=Array.from(new Array(s+r+1).keys()).splice(-1*(r+1));if(this.hot.runHooks("beforeRemoveRow",s,r+1,d,this.plugin.pluginName),a.__children.splice(l,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,r+1,d,this.plugin.pluginName),h){c=u+this.countChildren(h);const g=this.getChild(h,this.countChildren(h)-1),p=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",p+1,r+1,this.plugin.pluginName),h.__children.push(i)}else c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c-2,r+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",c-2,r+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",a,i,this.getRowIndex(i)),t&&this.hot.render()}filterData(e,t,i){const o=[];b(i,s=>{o.push(this.getDataObject(s))}),b(o,s=>{const r=this.getRowIndexWithinParent(s),l=this.getRowParent(s);l===null?this.data.splice(r,1):l.__children.splice(r,1)}),this.rewriteCache()}spliceData(e,t,i){const o=this.getDataObject(e-1);let s=null,r=e;o&&o.__children&&o.__children.length===0?(s=o,r=0):e<this.countAllRows()&&(s=this.getRowParent(e),r=this.getRowIndexWithinParent(e)),s?i?s.__children.splice(r,t,...i):s.__children.splice(r,t):i?this.data.splice(r,t,...i):this.data.splice(r,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,i=null;do i=this.getRowParent(i),i!==null&&(t=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,i,o){const s=t===this.hot.countRows(),r=this.getRowParent(e),l=this.getRowIndexWithinParent(e),a=r.__children.slice(l,l+1),h=e>t;let u=s?this.getRowParent(t-1):this.getRowParent(t);u==null&&(u=this.getRowParent(t-1)),u==null&&(u=this.getDataObject(t-1)),u?u.__children||(u.__children=[]):(u=this.getDataObject(t),u.__children=[]);const c=s||i||o?u.__children.length:this.getRowIndexWithinParent(t),d=r===u;u.__children.splice(c,0,a[0]),r.__children.splice(l+(h&&d?1:0),1),this.syncRowWithRawSource(r),d||this.syncRowWithRawSource(u)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function VS(n,e,t){return(e=JU(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function JU(n){var e=ZU(n,"string");return typeof e=="symbol"?e:e+""}function ZU(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class QC{constructor(e,t){VS(this,"hot",void 0),VS(this,"plugin",void 0),this.hot=t,this.plugin=e}}class ki extends QC{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const i=this.hot.toPhysicalRow(e),o=this.dataManager.getRowLevel(i),s=this.dataManager.getDataObject(i),r=t.getElementsByTagName("DIV")[0],l=r.querySelector("span.rowHeader"),a=r.querySelectorAll('[class^="ht_nesting"]'),h=this.hot.getSettings().ariaTags;if(b(a,u=>{u&&r.removeChild(u)}),P(t,ki.CSS_CLASSES.indicatorContainer),o){const{rootDocument:u}=this.hot,c=l.cloneNode(!0);r.innerHTML="",j(0,o-1,()=>{const d=u.createElement("SPAN");P(d,ki.CSS_CLASSES.emptyIndicator),r.appendChild(d)}),r.appendChild(c)}if(this.dataManager.hasChildren(s)){const u=this.hot.rootDocument.createElement("DIV");h&&Y(u,[mr()]),P(t,ki.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?(P(u,`${ki.CSS_CLASSES.button} ${ki.CSS_CLASSES.expandButton}`),h&&Y(t,[Ln(!1)])):(P(u,`${ki.CSS_CLASSES.button} ${ki.CSS_CLASSES.collapseButton}`),h&&Y(t,[Ln(!0)])),r.appendChild(u)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}class ez extends QC{constructor(e,t){var i;super(e,t),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,o)},shiftStash:function(o,s){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),b(i.lastCollapsedRows,(l,a)=>{l>=o&&l<s&&(i.lastCollapsedRows[a]=l+r)})},applyStash:function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,o),i.lastCollapsedRows=void 0},trimStash:(o,s)=>{j(o,o+s-1,r=>{const l=this.lastCollapsedRows.indexOf(r);l>-1&&this.lastCollapsedRows.splice(l,1)})}}}collapseChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];let s=null,r=null,l=null;return isNaN(e)?(s=e,r=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),r=e),this.dataManager.hasChildren(s)&&b(s.__children,a=>{o.push(this.dataManager.getRowIndex(a))}),l=this.collapseRows(o,!0,!1),i&&this.trimRows(l),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(r)===-1&&this.collapsedRows.push(r),l}collapseMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];b(e,s=>{o.push(...this.collapseChildren(s,!1,!1))}),i&&this.trimRows(o),t&&this.renderAndAdjust()}collapseRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],t)}collapseRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=[];return b(e,s=>{o.push(s),t&&this.collapseChildRows(s,o)}),i&&this.trimRows(o),o}collapseChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const o=this.dataManager.getDataObject(e);b(o.__children,s=>{const r=this.dataManager.getRowIndex(s);t.push(r),this.collapseChildRows(r,t)})}i&&this.trimRows(t)}expandRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],t)}expandRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=[];return b(e,s=>{o.push(s),t&&this.expandChildRows(s,o)}),i&&this.untrimRows(o),o}expandChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const o=this.dataManager.getDataObject(e);b(o.__children,s=>{if(!this.isAnyParentCollapsed(s)){const r=this.dataManager.getRowIndex(s);t.push(r),this.expandChildRows(r,t)}})}i&&this.untrimRows(t)}expandChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];let s=null,r=null,l=null;return isNaN(e)?(s=e,r=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),r=e),this.collapsedRows.splice(this.collapsedRows.indexOf(r),1),this.dataManager.hasChildren(s)&&b(s.__children,a=>{const h=this.dataManager.getRowIndex(a);o.push(h)}),l=this.expandRows(o,!0,!1),i&&this.untrimRows(l),t&&this.renderAndAdjust(),l}expandMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];b(e,s=>{o.push(...this.expandChildren(s,!1,!1))}),i&&this.untrimRows(o),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];b(e,i=>{this.dataManager.hasChildren(i)&&t.push(i)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];b(e,i=>{this.dataManager.hasChildren(i)&&t.push(i)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{b(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{b(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return t===null&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&b(t.__children,o=>{const s=this.dataManager.getRowIndex(o);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return i=!1,!1}),i}isAnyParentCollapsed(e){let t=e;for(;t!==null;){t=this.dataManager.getRowParent(t);const i=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const i=this.translateTrimmedRow(t.row);K(e.target,ki.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),$n(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function tz(n,e,t){nz(n,e),e.set(n,t)}function nz(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iz(n,e,t){return(e=oz(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function oz(n){var e=sz(n,"string");return typeof e=="symbol"?e:e+""}function sz(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function rz(n,e){return n.get(lz(n,e))}function lz(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}var FS=new WeakMap;class az extends QC{constructor(){super(...arguments),iz(this,"dataManager",this.plugin.dataManager),tz(this,FS,{row_above:(e,t)=>{const i=t[t.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,t)=>{const i=t[t.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(Pw)},callback:()=>{const i=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),o=this.dataManager.getDataObject(i);this.dataManager.addChild(o)},disabled:()=>{const i=this.hot.getSelectedLast();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Iw)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const i=this.hot.getSelectedLast(),o=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(o)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return j(0,e.items.length-1,i=>{if(i===0)return b(t,(o,s)=>{e.items.splice(i+s,0,o)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return j(0,e.items.length-1,t=>{const i=rz(FS,this)[e.items[t].key];i!=null&&(e.items[t].callback=i)}),e}}function cc(n,e,t){return(e=hz(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hz(n){var e=uz(n,"string");return typeof e=="symbol"?e:e+""}function uz(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class cz{constructor(e){cc(this,"plugin",void 0),cc(this,"hot",void 0),cc(this,"dataManager",void 0),cc(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,i,o){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:i,movePossible:o}))return!1;this.movedToCollapsed=!1;const r=i===this.hot.countRows(),l=r?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i);let a=!0;const h=e.map(p=>{if(!a)return!1;const v=this.dataManager.translateTrimmedRow(p);return a=this.shouldAllowMoving(v,l),v}),u=h.indexOf(l)===-1;if(!a||!u)return!1;const c=this.getBaseParent(h),d=this.getTargetParent(r,l),g=c===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(h,l,g),this.moveRows(h,l,d),this.dataManager.rewriteCache(),this.moveCellsMeta(h,l),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,i,o,o&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:i,dropIndex:o,movePossible:s}=e;let r=!1;return Ne(o)&&(ye(Re`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,i,o,s,!1),r=!0),r}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||t===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let i=this.dataManager.getRowParent(e?t-1:t);return i==null&&(i=this.dataManager.getRowParent(t-1)),i}shiftCollapsibleParentsLocations(e,t,i){i||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,i){const o=t===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,t,this.movedToCollapsed,o)})})}moveCellsMeta(e,t){const i=[],o=Math.max(...e)<t;e.forEach(s=>{i.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(o?i.length:0),0,...i)}selectCells(e,t){const i=e.length;let o=0,s=0,r=null,l=null;if(this.movedToCollapsed){let a=null;e[i-1]<t?a=this.dataManager.translateTrimmedRow(t-i):a=this.dataManager.translateTrimmedRow(t);const h=this.dataManager.getRowParent(a===null?this.hot.countSourceRows()-1:a-1),u=this.dataManager.getRowIndex(h);o=this.dataManager.untranslateTrimmedRow(u),s=o}else e[i-1]<t?(s=t-1,o=s-i+1):(o=t,s=o+i-1);r=this.hot.selection,l=this.hot.countCols()-1,r.setRangeStart(this.hot._createCellCoords(o,0)),r.setRangeEnd(this.hot._createCellCoords(s,l),!0)}isRowOrderChanged(e,t){return e.some((i,o)=>i-o!==t)}}function dz(n,e){WT(n,e),e.add(n)}function WS(n,e,t){WT(n,e),e.set(n,t)}function WT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kg(n,e,t){return(e=fz(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function fz(n){var e=gz(n,"string");return typeof e=="symbol"?e:e+""}function gz(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function xc(n,e){return n.get(gt(n,e))}function Sd(n,e,t){return n.set(gt(n,e),t),t}function gt(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const yd="nestedRows",mz=300,BS=yd,pz="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var hf=new WeakMap,il=new WeakMap,vt=new WeakSet;class wz extends we{constructor(){super(...arguments),dz(this,vt),Kg(this,"dataManager",null),Kg(this,"headersUI",null),Kg(this,"collapsedRowsMap",null),WS(this,hf,!1),WS(this,il,!1)}static get PLUGIN_KEY(){return yd}static get PLUGIN_PRIORITY(){return mz}isEnabled(){return!!this.hot.getSettings()[yd]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Ih),this.dataManager=new QU(this,this.hot),this.collapsingUI=new ez(this,this.hot),this.headersUI=new ki(this,this.hot),this.contextMenuUI=new az(this,this.hot),this.rowMoveController=new cz(this),this.addHook("afterInit",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return gt(vt,e,Az).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return gt(vt,e,_z).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return gt(vt,e,vz).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return gt(vt,e,Sz).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return gt(vt,e,yz).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return gt(vt,e,bz).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return gt(vt,e,Tz).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return gt(vt,e,Ez).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return gt(vt,e,Mz).call(e,...i)}),this.addHook("afterAddChild",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return gt(vt,e,Pz).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return gt(vt,e,Iz).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return gt(vt,e,Hz).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return gt(vt,e,Rz).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return gt(vt,e,xz).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return gt(vt,e,Cz).call(e,...i)}),this.addHook("beforeLoadData",t=>gt(vt,this,jS).call(this,t)),this.addHook("beforeUpdateData",t=>gt(vt,this,jS).call(this,t)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t),!1},runOnlyIf:()=>{var e,t;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())&&this.hot.selection.isCellVisible(i)&&i.col===-1&&i.row>=0},group:BS,relativeToGroup:cs,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(BS)}disableCoreAPIModifiers(){Sd(il,this,!0)}enableCoreAPIModifiers(){Sd(il,this,!1)}onModifyRowData(e){if(!xc(il,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!xc(il,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,i){return xc(il,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,t,i),!1)}destroy(){super.destroy()}}function Cz(n,e,t,i){return this.rowMoveController.onBeforeRowMove(n,e,t,i)}function bz(n,e,t){this.collapsingUI.toggleState(n,e,t)}function vz(n,e,t){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(t[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(t[0],null,-1*e),this.dataManager.filterData(n,e,t),Sd(hf,this,!0),this.dataManager.getData().slice()}function Sz(n){return this.contextMenuUI.appendOptions(n)}function yz(n,e){this.headersUI.appendLevelIndicators(n,e)}function Rz(n){return Math.max(this.headersUI.rowHeaderWidthCache,n)}function Ez(n,e,t,i){i!==this.pluginName&&this.hot._registerTimeout(()=>{Sd(hf,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Tz(n,e,t){const i=Array.from(t.reduce((o,s)=>{if(this.dataManager.isParent(s)){const r=this.dataManager.getDataObject(s).__children;return o.add(s),Array.isArray(r)&&r.forEach(l=>o.add(this.dataManager.getRowIndex(l))),o}return o.add(s)},new Set));t.length=0,t.push(...i)}function Mz(){this.collapsingUI.collapsedRowsStash.stash()}function Pz(n,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Iz(){this.collapsingUI.collapsedRowsStash.stash()}function Hz(n,e,t){this.collapsingUI.collapsedRowsStash.shiftStash(t,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function xz(){this.dataManager.rewriteCache()}function Az(){this.headersUI.updateRowHeaderWidth()}function _z(n,e){xc(hf,this)&&(e.skipRender=!0)}function jS(n){if(!dR(n)){vp(pz),this.hot.getSettings()[yd]=!1,this.disablePlugin();return}this.dataManager.setData(n),this.dataManager.rewriteCache()}function Xg(n,e,t){return(e=Oz(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Oz(n){var e=Nz(n,"string");return typeof e=="symbol"?e:e+""}function Nz(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Dz{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;Xg(this,"rootWindow",void 0),Xg(this,"prefix",void 0),Xg(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const i=typeof e>"u"?t:e,o=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return o===null?void 0:JSON.parse(o)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){b(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function Lz(n,e,t){return(e=kz(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kz(n){var e=$z(n,"string");return typeof e=="symbol"?e:e+""}function $z(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}V.getSingleton().register("persistentStateSave");V.getSingleton().register("persistentStateLoad");V.getSingleton().register("persistentStateReset");const US="persistentState",Vz=0;class Fz extends we{constructor(){super(...arguments),Lz(this,"storage",void 0)}static get PLUGIN_KEY(){return US}static get PLUGIN_PRIORITY(){return Vz}isEnabled(){return!!this.hot.getSettings()[US]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Dz(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Wz(n,e){Bz(n,e),e.add(n)}function Bz(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qg(n,e,t){return(e=jz(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function jz(n){var e=Uz(n,"string");return typeof e=="symbol"?e:e+""}function Uz(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function zS(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Qg="search",zz=190,Gz="htSearchResult",Yz=function(n,e,t,i,o){n.getCellMeta(e,t).isSearchResult=o},Kz=function(n,e,t){return Ne(n)||n===null||!n.toLocaleLowerCase||n.length===0||Ne(e)||e===null?!1:e.toString().toLocaleLowerCase(t.locale).indexOf(n.toLocaleLowerCase(t.locale))!==-1};var Jg=new WeakSet;class Xz extends we{constructor(){super(...arguments),Wz(this,Jg),qg(this,"callback",Yz),qg(this,"queryMethod",Kz),qg(this,"searchResultClass",Gz)}static get PLUGIN_KEY(){return Qg}static get PLUGIN_PRIORITY(){return zz}isEnabled(){return this.hot.getSettings()[Qg]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Qg];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return zS(Jg,e,GS).call(e,...o)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return zS(Jg,e,GS).call(e,...o)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const o=this.hot.countRows(),s=this.hot.countCols(),r=[],l=this.hot;return j(0,o-1,a=>{j(0,s-1,h=>{const u=this.hot.getDataAtCell(a,h),c=this.hot.getCellMeta(a,h),d=c.search.callback||t,p=(c.search.queryMethod||i)(e,u,c);if(p){const v={row:a,col:h,data:u};r.push(v)}d&&d(l,a,h,u,p)})}),r}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){ee(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function GS(n,e,t,i,o,s){const r=s.className||[];let l=[];typeof r=="string"?l=r.split(" "):l.push(...r),this.isEnabled()&&s.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),s.className=l.join(" ")}function qz(n,e){Qz(n,e),e.add(n)}function Qz(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dc(n,e,t){return(e=Jz(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Jz(n){var e=Zz(n,"string");return typeof e=="symbol"?e:e+""}function Zz(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Zg(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const eG="touchScroll",tG=200;var fc=new WeakSet;class nG extends we{constructor(){super(...arguments),qz(this,fc),dc(this,"scrollbars",[]),dc(this,"clones",[]),dc(this,"lockedCollection",!1),dc(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return eG}static get PLUGIN_PRIORITY(){return tG}static get SETTING_KEYS(){return!0}isEnabled(){return gp()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>Zg(fc,this,iG).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>Zg(fc,this,oG).call(this)),this.addHook("afterMomentumScroll",()=>Zg(fc,this,sG).call(this))}}function iG(){if(this.lockedCollection)return;const{topOverlay:n,bottomOverlay:e,inlineStartOverlay:t,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(n),e.clone&&this.scrollbars.push(e),this.scrollbars.push(t),i&&this.scrollbars.push(i),o&&o.clone&&this.scrollbars.push(o),this.clones=[],n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),o&&o.clone&&this.clones.push(o.clone.wtTable.holder.parentNode)}function oG(){this.freezeOverlays=!0,b(this.clones,n=>{P(n,"hide-tween")})}function sG(){this.freezeOverlays=!1,b(this.clones,n=>{X(n,"hide-tween"),P(n,"show-tween")}),this.hot._registerTimeout(()=>{b(this.clones,n=>{X(n,"show-tween")})},400),b(this.scrollbars,n=>{n.refresh(),n.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function rG(n,e){lG(n,e),e.add(n)}function lG(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aG(n,e,t){return(e=hG(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hG(n){var e=uG(n,"string");return typeof e=="symbol"?e:e+""}function uG(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function cG(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}const Ac="trimRows",dG=330;var YS=new WeakSet;class fG extends we{constructor(){super(...arguments),rG(this,YS),aG(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Ac}static get PLUGIN_PRIORITY(){return dG}isEnabled(){return!!this.hot.getSettings()[Ac]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Ih),this.trimmedRowsMap.addLocalHook("init",()=>cG(YS,this,gG).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Ac];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),b(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),i=this.isValidConfig(e);let o=t;i&&(o=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeTrimRow",t,o,i)!==!1&&(i&&this.hot.batchExecution(()=>{b(e,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0),this.hot.runHooks("afterTrimRow",t,o,i,i&&o.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),i=this.isValidConfig(e);let o=t;const s=this.trimmedRowsMap.getValues().slice(),r=e.length>0;i&&r&&(b(e,a=>{s[a]=!1}),o=at(s,(a,h,u)=>(h&&a.push(u),a),[])),this.hot.runHooks("beforeUntrimRow",t,o,i&&r)!==!1&&(i&&r&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",t,o,i&&r,i&&o.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<t)}destroy(){super.destroy()}}function gG(){const n=this.hot.getSettings()[Ac];Array.isArray(n)&&this.hot.batchExecution(()=>{b(n,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}const BT="undoRedo",mG="undoRedo";function _(n){const e=this;this.instance=n,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,n.addHook("afterChange",function(i,o){const s=i&&i.length;if(!s||!i.find(a=>{const[,,h,u]=a;return h!==u}))return;const l=()=>{const a=i.reduce((u,c)=>(u.push([...c]),u),[]);b(a,u=>{u[1]=n.propToCol(u[1])});const h=s>1?this.getSelected():[[a[0][0],a[0][1]]];return new _.ChangeAction(a,h)};e.done(l,o)}),n.addHook("afterCreateRow",(i,o,s)=>{e.done(()=>new _.CreateRowAction(i,o),s)});const t=(i,o,s,r)=>{const l=["visualRow","visualCol","row","col","prop"],a=l.length,h=[];return j(s,r,u=>{j(i,o,c=>{const d=n.getCellMeta(c,u);if(Object.keys(d).length!==a){const g=Object.fromEntries(Object.entries(d).filter(p=>{let[v]=p;return l.includes(v)===!1}));h.push([d.visualRow,d.visualCol,g])}})}),h};n.addHook("beforeRemoveRow",(i,o,s,r)=>{const l=()=>{const a=n.toPhysicalRow(i),h=a+o-1,u=Dt(e.instance.getSourceData(a,0,a+o-1,e.instance.countSourceCols()-1));return new _.RemoveRowAction(a,u,n.getSettings().fixedRowsBottom,n.getSettings().fixedRowsTop,n.rowIndexMapper.getIndexesSequence(),t(a,h,0,n.countCols()-1))};e.done(l,r)}),n.addHook("afterCreateCol",(i,o,s)=>{e.done(()=>new _.CreateColumnAction(i,o),s)}),n.addHook("beforeRemoveCol",(i,o,s,r)=>{const l=()=>{const a=e.instance.getSourceDataArray(),h=(e.instance.countCols()+i)%e.instance.countCols(),u=h+o-1,c=[],d=[],g=[];j(a.length-1,C=>{const S=[],R=a[C];j(h,u,M=>{S.push(R[n.toPhysicalColumn(M)])}),c.push(S)}),j(o-1,C=>{g.push(n.toPhysicalColumn(h+C))}),Array.isArray(n.getSettings().colHeaders)&&j(o-1,C=>{d.push(n.getSettings().colHeaders[n.toPhysicalColumn(h+C)]||null)});const p=n.columnIndexMapper.getIndexesSequence(),v=n.rowIndexMapper.getIndexesSequence();return new _.RemoveColumnAction(h,g,c,d,p,v,n.getSettings().fixedColumnsStart,t(0,n.countRows(),h,u))};e.done(l,r)}),n.addHook("beforeCellAlignment",(i,o,s,r)=>{e.done(()=>new _.CellAlignmentAction(i,o,s,r))}),n.addHook("beforeFilter",(i,o)=>{e.done(()=>new _.FiltersAction(i,o))}),n.addHook("beforeRowMove",(i,o)=>{i!==!1&&e.done(()=>new _.RowMoveAction(i,o))}),n.addHook("beforeColumnMove",(i,o)=>{i!==!1&&e.done(()=>new _.ColumnMoveAction(i,o))}),n.addHook("beforeMergeCells",(i,o)=>{o||e.done(()=>new _.MergeCellsAction(n,i))}),n.addHook("afterUnmergeCells",(i,o)=>{o||e.done(()=>new _.UnmergeCellsAction(n,i))}),n.addHook("beforeColumnSort",(i,o,s)=>{s&&e.done(()=>new _.ColumnSortAction(i,o))}),n.addHook("afterInit",()=>{e.init()})}_.prototype.done=function(n,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const i=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",i,e)===!1)return;const s=n(),r=this.undoneActions.slice();this.doneActions.push(s),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",r),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",r,this.undoneActions.slice())};_.prototype.undo=function(){if(this.isUndoAvailable()){const n=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",n);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice());const t=Dt(e);if(this.instance.runHooks("beforeUndo",t)===!1)return;this.ignoreNewActions=!0;const o=this,s=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",s),e.undo(this.instance,()=>{o.ignoreNewActions=!1,o.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.instance.runHooks("afterUndo",t)}};_.prototype.redo=function(){if(this.isRedoAvailable()){const n=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",n);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",n,this.undoneActions.slice());const t=Dt(e);if(this.instance.runHooks("beforeRedo",t)===!1)return;this.ignoreNewActions=!0;const o=this,s=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",s),e.redo(this.instance,()=>{o.ignoreNewActions=!1,o.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.instance.runHooks("afterRedo",t)}};_.prototype.isUndoAvailable=function(){return this.doneActions.length>0};_.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};_.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};_.prototype.isEnabled=function(){return this.enabled};_.prototype.enable=function(){if(this.isEnabled())return;const n=this.instance;this.enabled=!0,CG(n),this.registerShortcuts(),n.addHook("afterChange",jT)};_.prototype.disable=function(){if(!this.isEnabled())return;const n=this.instance;this.enabled=!1,bG(n),this.unregisterShortcuts(),n.removeHook("afterChange",jT)};_.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};_.Action=function(){};_.Action.prototype.undo=function(){};_.Action.prototype.redo=function(){};_.ChangeAction=function(n,e){this.changes=n,this.selected=e,this.actionType="change"};li(_.ChangeAction,_.Action);_.ChangeAction.prototype.undo=function(n,e){const t=Dt(this.changes),i=n.countEmptyRows(!0),o=n.countEmptyCols(!0);for(let r=0,l=t.length;r<l;r++)t[r].splice(3,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.undo");for(let r=0,l=t.length;r<l;r++){const[a,h]=t[r];n.getSettings().minSpareRows&&a+1+n.getSettings().minSpareRows===n.countRows()&&i===n.getSettings().minSpareRows&&(n.alter("remove_row",parseInt(a+1,10),n.getSettings().minSpareRows),n.undoRedo.doneActions.pop()),n.getSettings().minSpareCols&&h+1+n.getSettings().minSpareCols===n.countCols()&&o===n.getSettings().minSpareCols&&(n.alter("remove_col",parseInt(h+1,10),n.getSettings().minSpareCols),n.undoRedo.doneActions.pop())}const s=n.getSelectedLast();if(s!==void 0){const[r,l]=t[0],[a,h]=s,u=n.view.getFirstFullyVisibleRow(),c=n.view.getFirstFullyVisibleColumn(),d=r>=u,g=l>=c;if((d&&g)===!1&&(a!==r||h!==l)===!0){const C={row:r,col:l};d===!1&&(C.verticalSnap="top"),g===!1&&(C.horizontalSnap="start"),n.scrollViewportTo(C)}}n.selectCells(this.selected,!1,!1)};_.ChangeAction.prototype.redo=function(n,e){const t=Dt(this.changes);for(let i=0,o=t.length;i<o;i++)t[i].splice(2,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.redo"),this.selected&&n.selectCells(this.selected,!1,!1)};_.CreateRowAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_row"};li(_.CreateRowAction,_.Action);_.CreateRowAction.prototype.undo=function(n,e){const t=n.countRows(),i=n.getSettings().minSpareRows;this.index>=t&&this.index-i<t&&(this.index-=i),n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};_.CreateRowAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateRow",e),n.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};_.RemoveRowAction=function(n,e,t,i,o,s){this.index=n,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=t,this.fixedRowsTop=i,this.rowIndexesSequence=o,this.removedCellMetas=s};li(_.RemoveRowAction,_.Action);_.RemoveRowAction.prototype.undo=function(n,e){const t=n.getSettings(),i=[];t.fixedRowsBottom=this.fixedRowsBottom,t.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(r=>{const l=parseInt(r,10);i.push([this.index+s,isNaN(l)?r:l,o[r]])})}),n.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(o=>{let[s,r,l]=o;n.setCellMetaObject(s,r,l)}),n.addHookOnce("afterViewRender",e),n.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),n.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};_.RemoveRowAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};_.CreateColumnAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_col"};li(_.CreateColumnAction,_.Action);_.CreateColumnAction.prototype.undo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};_.CreateColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateCol",e),n.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};_.RemoveColumnAction=function(n,e,t,i,o,s,r,l){this.index=n,this.indexes=e,this.data=t,this.amount=this.data[0].length,this.headers=i,this.columnPositions=o.slice(0),this.rowPositions=s.slice(0),this.actionType="remove_col",this.fixedColumnsStart=r,this.removedCellMetas=l};li(_.RemoveColumnAction,_.Action);_.RemoveColumnAction.prototype.undo=function(n,e){const t=n.getSettings();t.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(h,u,c)=>c[this.indexes.indexOf(i[u])],s=this.data.length,r=[];for(let h=0;h<s;h++)r.push(ae(this.data[h],o));const l=ae(this.headers,o),a=[];n.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),b(n.getSourceDataArray(),(h,u)=>{b(i,(c,d)=>{h[c]=r[u][d],a.push([u,c,h[c]])})}),n.setSourceDataAtCell(a,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&b(l,(h,u)=>{n.getSettings().colHeaders[i[u]]=h}),this.removedCellMetas.forEach(h=>{let[u,c,d]=h;n.setCellMetaObject(u,c,d)}),n.batchExecution(()=>{n.rowIndexMapper.setIndexesSequence(this.rowPositions),n.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),n.addHookOnce("afterViewRender",e),n.render()};_.RemoveColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};_.CellAlignmentAction=function(n,e,t,i){this.stateBefore=n,this.range=e,this.type=t,this.alignment=i};_.CellAlignmentAction.prototype.undo=function(n,e){b(this.range,t=>{t.forAll((i,o)=>{i>=0&&o>=0&&n.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),n.addHookOnce("afterViewRender",e),n.render()};_.CellAlignmentAction.prototype.redo=function(n,e){Wo(this.range,this.type,this.alignment,(t,i)=>n.getCellMeta(t,i),(t,i,o,s)=>n.setCellMeta(t,i,o,s)),n.addHookOnce("afterViewRender",e),n.render()};_.FiltersAction=function(n,e){this.previousConditionsStack=e,this.conditionsStack=n,this.actionType="filter"};li(_.FiltersAction,_.Action);_.FiltersAction.prototype.undo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),this.previousConditionsStack&&t.conditionCollection.importAllConditions(this.previousConditionsStack),t.filter()};_.FiltersAction.prototype.redo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack),t.filter()};class pG extends _.Action{constructor(e,t){super(),this.cellRange=t;const i=this.cellRange.getTopStartCorner(),o=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(i.row,i.col,o.row,o.col)}undo(e,t){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.unmergeRange(this.cellRange,!0);const o=this.cellRange.getTopStartCorner();e.populateFromArray(o.row,o.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.mergeRange(this.cellRange)}}_.MergeCellsAction=pG;class wG extends _.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.mergeRange(this.cellRange,!0)}redo(e,t){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.unmergeRange(this.cellRange,!0),e.render()}}_.UnmergeCellsAction=wG;_.RowMoveAction=function(n,e){this.rows=n.slice(),this.finalRowIndex=e,this.actionType="row_move"};li(_.RowMoveAction,_.Action);_.RowMoveAction.prototype.undo=function(n,e){const t=n.getPlugin("manualRowMove");n.addHookOnce("afterViewRender",e),GC(this.rows,this.finalRowIndex,n.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:r}=o;s<r&&(r-=1),t.moveRow(r,s)}),n.render(),n.deselectCell(),n.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};_.RowMoveAction.prototype.redo=function(n,e){const t=n.getPlugin("manualRowMove");n.addHookOnce("afterViewRender",e),t.moveRows(this.rows.slice(),this.finalRowIndex),n.render(),n.deselectCell(),n.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)};_.ColumnMoveAction=function(n,e){this.columns=n.slice(),this.finalColumnIndex=e,this.actionType="col_move"};li(_.ColumnMoveAction,_.Action);_.ColumnMoveAction.prototype.undo=function(n,e){const t=n.getPlugin("manualColumnMove");n.addHookOnce("afterViewRender",e),GC(this.columns,this.finalColumnIndex,n.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:r}=o;s<r&&(r-=1),t.moveColumn(r,s)}),n.render(),n.deselectCell(),n.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)};_.ColumnMoveAction.prototype.redo=function(n,e){const t=n.getPlugin("manualColumnMove");n.addHookOnce("afterViewRender",e),t.moveColumns(this.columns.slice(),this.finalColumnIndex),n.render(),n.deselectCell(),n.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)};_.ColumnSortAction=function(n,e){this.previousSortState=n,this.nextSortState=e};li(_.ColumnSortAction,_.Action);_.ColumnSortAction.prototype.undo=function(n,e){const t=n.getPlugin("columnSorting"),i=n.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:t;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),e()};_.ColumnSortAction.prototype.redo=function(n,e){const t=n.getPlugin("columnSorting"),i=n.getPlugin("multiColumnSorting");(i.isEnabled()?i:t).sort(this.nextSortState),e()};_.prototype.init=function(){const n=this.instance.getSettings().undo,e=typeof n>"u"||n;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};_.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:BT};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)};_.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(BT)};function jT(n,e){const t=this;if(e==="loadData")return t.undoRedo.clear()}function CG(n){n.undo=function(){return n.undoRedo.undo()},n.redo=function(){return n.undoRedo.redo()},n.isUndoAvailable=function(){return n.undoRedo.isUndoAvailable()},n.isRedoAvailable=function(){return n.undoRedo.isRedoAvailable()},n.clearUndo=function(){return n.undoRedo.clear()}}function bG(n){delete n.undo,delete n.redo,delete n.isUndoAvailable,delete n.isRedoAvailable,delete n.clearUndo}const kh=V.getSingleton();kh.add("afterUpdateSettings",function(){var n;(n=this.getPlugin("undoRedo"))===null||n===void 0||n.init()});kh.register("beforeUndo");kh.register("afterUndo");kh.register("beforeRedo");kh.register("afterRedo");_.PLUGIN_KEY=mG;_.SETTING_KEYS=!0;function vG(){ce(Wa),ce(F1),ce(Ba),ce(vN),ce(IN),ce(mE),ce(yD),ce(lL),ce(nf),ce(mk),ce(Wk),ce(Xk),ce(rf),ce(R$),ce(SF),ce(JF),ce(EW),ce(DW),ce(YW),ce(oB),ce(gB),ce(_B),ce(WB),ce(vj),ce(eU),ce(sU),ce(AU),ce(wz),ce(Fz),ce(Xz),ce(nG),ce(fG),ce(_)}function SG(){pO(),OO(),BO(),a1(),vG()}function yG(n){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(t){const i=this.first();let o=i.data("handsontable");if(typeof t!="string"){const h=t||{};return o?o.updateSettings(h):(o=new n.Core(i[0],h),i.data("handsontable",o),o.init()),i}let s;if(o)if(typeof o[t]<"u"){for(var r=arguments.length,l=new Array(r>1?r-1:0),a=1;a<r;a++)l[a-1]=arguments[a];s=o[t].call(o,...l),t==="destroy"&&i.removeData()}else throw new Error(`Handsontable do not provide action: ${t}`);return s})}var em,tm,nm,im,om;SG();yG(q);q.__GhostTable=AC;q._getListenersCounter=l0;q._getRegisteredMapsCounter=FH;q.EventManager=kn;const RG=[qT,jM,PH,DO,FM,$M,eM,S0,VM,nM,GM,v0],EG=[NM,YM];q.helper={};q.dom={};b(RG,n=>{b(Object.getOwnPropertyNames(n),e=>{e.charAt(0)!=="_"&&(q.helper[e]=n[e])})});b(EG,n=>{b(Object.getOwnPropertyNames(n),e=>{e.charAt(0)!=="_"&&(q.dom[e]=n[e])})});q.cellTypes=(em=q.cellTypes)!==null&&em!==void 0?em:{};b(zx(),n=>{q.cellTypes[n]=fC(n)});q.cellTypes.registerCellType=Mn;q.cellTypes.getCellType=fC;q.editors=(tm=q.editors)!==null&&tm!==void 0?tm:{};b(t0(),n=>{q.editors[`${Nt(n)}Editor`]=Dc(n)});q.editors.registerEditor=tn;q.editors.getEditor=Dc;q.renderers=(nm=q.renderers)!==null&&nm!==void 0?nm:{};b(L0(),n=>{const e=Lc(n);n==="base"&&(q.renderers.cellDecorator=e),q.renderers[`${Nt(n)}Renderer`]=e});q.renderers.registerRenderer=cn;q.renderers.getRenderer=Lc;q.validators=(im=q.validators)!==null&&im!==void 0?im:{};b(V0(),n=>{q.validators[`${Nt(n)}Validator`]=Tp(n)});q.validators.registerValidator=Qs;q.validators.getValidator=Tp;q.plugins=(om=q.plugins)!==null&&om!==void 0?om:{};b(Ep(),n=>{q.plugins[n]=Eh(n)});q.plugins[`${Nt(we.PLUGIN_KEY)}Plugin`]=we;q.plugins.registerPlugin=ce;q.plugins.getPlugin=Eh;export{q as H,SG as r};
