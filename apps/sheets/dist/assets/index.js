import{d as ho,r as S,o as Co,a as So,c as R,b as O,e as l,f as W,w as h,g as Xt,F as ut,h as ct,i as U,v as G,t as et,n as dt,j as Ne,k as ft,l as Mo,m as le,p as Re,q as Ao}from"./vendor-vue.js";import{r as Eo,H as Oe}from"./vendor-handsontable.js";import"./vendor.js";(function(){const vt=document.createElement("link").relList;if(vt&&vt.supports&&vt.supports("modulepreload"))return;for(const B of document.querySelectorAll('link[rel="modulepreload"]'))q(B);new MutationObserver(B=>{for(const V of B)if(V.type==="childList")for(const Et of V.addedNodes)Et.tagName==="LINK"&&Et.rel==="modulepreload"&&q(Et)}).observe(document,{childList:!0,subtree:!0});function Q(B){const V={};return B.integrity&&(V.integrity=B.integrity),B.referrerPolicy&&(V.referrerPolicy=B.referrerPolicy),B.crossOrigin==="use-credentials"?V.credentials="include":B.crossOrigin==="anonymous"?V.credentials="omit":V.credentials="same-origin",V}function q(B){if(B.ep)return;B.ep=!0;const V=Q(B);fetch(B.href,V)}})();const ne={},ko={class:"sheets-app"},xo={class:"d-flex align-items-center gap-2 flex-wrap"},No={class:"menu-header d-flex align-items-center justify-content-between"},Ro={class:"palette-grid"},Oo=["onClick"],To={class:"palette-row"},Io=["onClick"],Bo={class:"custom-row d-flex gap-2 align-items-center"},Fo={class:"menu-header d-flex align-items-center justify-content-between"},Do={class:"palette-grid"},Lo=["onClick"],Uo={class:"palette-row"},$o=["onClick"],Po={class:"custom-row d-flex gap-2 align-items-center"},Vo={class:"border-actions"},jo={class:"thickness-row"},Ho={class:"small text-muted"},Go={class:"palette-row"},zo=["onClick"],Ko=["onKeydown"],Wo={class:"sheet-tabs border-bottom bg-white px-2 py-1 d-flex align-items-center gap-2 flex-wrap"},qo=["onClick"],Xo={class:"sheet-container"},Zo={key:0,class:"text-center py-5"},Jo={id:"hot-container",class:"pv-hot"},Qo=["onMousedown"],Yo={key:0,class:"status-bar bg-success text-white text-center py-2"},_o={class:"modal-card"},tl={class:"modal-header d-flex justify-content-between align-items-center"},el={class:"modal-body"},ol={class:"row g-2 align-items-center mb-2"},ll={class:"col-5"},nl={key:0,class:"col-7"},sl={class:"d-flex gap-2"},al={key:1,class:"col-7"},rl={class:"row g-2 align-items-center"},il={class:"col-auto"},ul={class:"col-auto"},cl={class:"col-auto form-check form-check-inline"},dl={class:"col-auto form-check form-check-inline"},fl={class:"modal-footer d-flex justify-content-between"},vl={class:"d-flex gap-2"},ml={class:"modal-card"},bl={class:"modal-header d-flex justify-content-between align-items-center"},pl={class:"modal-body"},yl={class:"row g-2 align-items-center mb-2"},gl={class:"col-auto"},wl={class:"col-auto"},hl={class:"form-check"},Cl={class:"modal-footer d-flex justify-content-between"},Sl={class:"d-flex gap-2"},Ml={class:"sheet-footer-fixed bg-light border-top py-2"},Al={class:"container-fluid"},El={class:"row align-items-center"},kl={class:"col-md-6 text-md-end"},xl={class:"text-muted"},Nl={class:"ms-3"},Rl=ho({__name:"App",setup(Bt){Eo(),Object.assign({SOMA:"SUM",MÉDIA:"AVERAGE",MINIMO:"MIN",MÍNIMO:"MIN",MAXIMO:"MAX",MÁXIMO:"MAX",CONTAR:"COUNT",CONTSE:"COUNTIF","CONT.SE":"COUNTIF",SE:"IF",E:"AND",OU:"OR",NÃO:"NOT",CONCATENAR:"CONCAT",TEXTO:"TEXT",PROCV:"VLOOKUP",PROCH:"HLOOKUP",HOJE:"TODAY",AGORA:"NOW",ARRED:"ROUND",ARREDONDAR:"ROUND",ABS:"ABS",MAIOR:"LARGE",MENOR:"SMALL",SUBSTITUIR:"SUBSTITUTE","EXT.TEXTO":"MID",ESQUERDA:"LEFT",DIREITA:"RIGHT","NÚM.CARACT":"LEN",NÚMERO:"VALUE",VALOR:"VALUE",SOMASE:"SUMIF","SOMA.SE":"SUMIF"},{"CONT.SES":"COUNTIFS",CONTSES:"COUNTIFS",SOMASES:"SUMIFS",MEDIASE:"AVERAGEIF",MÉDIASE:"AVERAGEIF",MÉDIASES:"AVERAGEIFS",MEDIASES:"AVERAGEIFS"});const Q=["SOMA","MÉDIA","MINIMO","MÍNIMO","MAXIMO","MÁXIMO","CONTAR","CONTSE","SOMASE","SE","E","OU","NÃO","CONCATENAR","TEXTO","PROCV","PROCH","HOJE","AGORA","ARRED","ARREDONDAR","ABS","MAIOR","MENOR","SUBSTITUIR","EXT.TEXTO","ESQUERDA","DIREITA","NÚM.CARACT","NÚMERO","VALOR","CONT.SES","CONTSES","SOMASES","MEDIASE","MÉDIASE","MÉDIASES","MEDIASES"];S((ne==null?void 0:ne.VITE_APP_VERSION)||"");const q=S(!1);function B(){q.value=!q.value}function V(...n){if(q.value)try{console.debug("[sheets-debug]",...n)}catch{}}function Et(){var r,s;if(!a.value)return;const n=a.value.countRows(),t=a.value.countCols(),o=(s=(r=a.value).getPlugin)==null?void 0:s.call(r,"customBorders");for(let e=0;e<n;e++)for(let i=0;i<t;i++){const u=(a.value.getCellMeta(e,i)||{}).borders;if(u&&(o!=null&&o.setBorders)){const f={};if(u.top&&(f.top=u.top),u.bottom&&(f.bottom=u.bottom),u.left&&(f.left=u.left),u.right&&(f.right=u.right),Object.keys(f).length)try{o.setBorders([{row:e,col:i,row2:e,col2:i}],f)}catch{}}}try{a.value.render()}catch{}N()}const a=S(null),Te=S(Array.from({length:200},()=>Array(26).fill(""))),Zt=S(null),Jt=S(""),Ft=S("Nunca"),b=S(null);S(!1);const Dt=S(!1),mt=S({sum:0,count:0,avg:0}),$=S(""),z=S("default"),Y=S([]),kt=S(0),xt=S(0),Lt=S(null),bt=S(null),pt=S(!1);let ot=null;const X=S(1),Nt=S("#000000"),T=S({show:!1,items:[],index:0,top:0,left:0}),lt=S({show:!1,top:0,left:0,width:0,height:0});let M=null,se=!1;const Z=S(!1),J=S(!1),K=S(!1),Qt=["#000000","#7f7f7f","#ffffff","#ff0000","#ffa500","#ffff00","#00ff00","#00b050","#00b0f0","#0000ff","#7030a0"],ae=["#000000","#404040","#7f7f7f","#bfbfbf","#d9d9d9","#efefef","#ffffff","#ffebee","#ffcdd2","#ef9a9a","#e57373","#ef5350","#f44336","#d32f2f","#b71c1c","#fff3e0","#ffe0b2","#ffcc80","#ffb74d","#ffa726","#ff9800","#f57c00","#e65100","#fffde7","#fff9c4","#fff59d","#fff176","#ffee58","#ffeb3b","#fbc02d","#f57f17","#f1f8e9","#dcedc8","#c5e1a5","#aed581","#9ccc65","#8bc34a","#689f38","#33691e","#e0f7fa","#b2ebf2","#80deea","#4dd0e1","#26c6da","#00bcd4","#0097a7","#006064","#e3f2fd","#bbdefb","#90caf9","#64b5f6","#42a5f5","#2196f3","#1976d2","#0d47a1","#ede7f6","#d1c4e9","#b39ddb","#9575cd","#7e57c2","#673ab7","#5e35b1","#311b92"];function Yt(){Z.value=!1,J.value=!1,K.value=!1}function k(){var n,t,o,r,s;if(Dt.value=!0,setTimeout(()=>{Dt.value=!1},200),!!a.value)try{const e=((t=(n=a.value).getSelectedLast)==null?void 0:t.call(n))||((s=(r=(o=a.value).getSelected)==null?void 0:r.call(o))==null?void 0:s[0]);e&&Array.isArray(e)&&e.length>=4&&(b.value=C(e[0],e[1],e[2],e[3]))}catch{}}function Ie(){Z.value=!Z.value,J.value=!1,K.value=!1}function Be(){J.value=!J.value,Z.value=!1,K.value=!1}function Fe(){var n,t,o,r,s;if(!K.value&&a.value)try{const e=((t=(n=a.value).getSelectedLast)==null?void 0:t.call(n))||((s=(r=(o=a.value).getSelected)==null?void 0:r.call(o))==null?void 0:s[0]);e&&Array.isArray(e)&&e.length>=4&&(b.value=C(e[0],e[1],e[2],e[3]))}catch{}K.value=!K.value,Z.value=!1,J.value=!1}function Ut(n){j(t=>({...t,textColor:n})),Z.value=!1}function $t(n){var t,o,r,s;if(!b.value&&a.value)try{const e=(((o=(t=a.value).getSelectedLast)==null?void 0:o.call(t))||((s=(r=a.value).getSelected)==null?void 0:s.call(r))||[])[0];e&&Array.isArray(e)&&e.length>=4&&(b.value=C(e[0],e[1],e[2],e[3]))}catch{}j(e=>({...e,bgColor:n})),J.value=!1}function _t(n,t,o,r){var e,i;if(!a.value)return;const s=(i=(e=a.value).getPlugin)==null?void 0:i.call(e,"customBorders");if(s!=null&&s.setBorders)for(let d=n;d<=o;d++)for(let u=t;u<=r;u++){if(!Number.isFinite(d)||!Number.isFinite(u)||d<0||u<0)continue;const m=(a.value.getCellMeta(d,u)||{}).borders;if(!m)continue;const v={};if(m.top&&(v.top={width:m.top.width||1,color:m.top.color||"#000"}),m.bottom&&(v.bottom={width:m.bottom.width||1,color:m.bottom.color||"#000"}),m.left&&(v.left={width:m.left.width||1,color:m.left.color||"#000"}),m.right&&(v.right={width:m.right.width||1,color:m.right.color||"#000"}),Object.keys(v).length)try{s.setBorders([{row:d,col:u,row2:d,col2:u}],v)}catch{}}}function De(n){var i,d,u,f,m;if(X.value=Math.max(1,Math.min(20,n)),!a.value)return;if(!b.value)try{const v=(((d=(i=a.value).getSelectedLast)==null?void 0:d.call(i))||((f=(u=a.value).getSelected)==null?void 0:f.call(u))||[])[0];v&&Array.isArray(v)&&v.length>=4&&(b.value=C(v[0],v[1],v[2],v[3]))}catch{}if(!b.value)return;const[t,o,r,s]=C(...b.value);let e=!1;for(let v=t;v<=r;v++)for(let p=o;p<=s;p++){if(!Number.isFinite(v)||!Number.isFinite(p)||v<0||p<0)continue;const w=a.value.getCellMeta(v,p)||{};if(!w.borders)continue;e=!0;const g={...w.borders||{}};for(const A of["top","bottom","left","right"])g[A]&&(g[A].width=X.value);a.value.setCellMeta(v,p,"borders",g)}if(e){_t(t,o,r,s);try{(m=a.value)==null||m.render()}catch{}N()}}function re(){De(X.value)}function Le(n){var i,d,u,f,m;if(Nt.value=n,!a.value)return;if(!b.value)try{const v=(((d=(i=a.value).getSelectedLast)==null?void 0:d.call(i))||((f=(u=a.value).getSelected)==null?void 0:f.call(u))||[])[0];v&&Array.isArray(v)&&v.length>=4&&(b.value=C(v[0],v[1],v[2],v[3]))}catch{}if(!b.value)return;const[t,o,r,s]=C(...b.value);let e=!1;for(let v=t;v<=r;v++)for(let p=o;p<=s;p++){if(!Number.isFinite(v)||!Number.isFinite(p)||v<0||p<0)continue;const w=a.value.getCellMeta(v,p)||{};if(!w.borders)continue;e=!0;const g={...w.borders||{}};for(const A of["top","bottom","left","right"])g[A]&&(g[A].color=Nt.value);a.value.setCellMeta(v,p,"borders",g)}if(e){_t(t,o,r,s);try{(m=a.value)==null||m.render()}catch{}N()}}function _(n){var o,r,s,e,i,d,u;try{console.debug("[sheets] applyBorderMode",n)}catch{}if(!a.value)return;if(!b.value)try{const f=((r=(o=a.value).getSelectedLast)==null?void 0:r.call(o))||((i=(e=(s=a.value).getSelected)==null?void 0:e.call(s))==null?void 0:i[0]);f&&Array.isArray(f)&&f.length>=4&&(b.value=C(f[0],f[1],f[2],f[3]))}catch{}if(!b.value){tt("Selecione uma ou mais células para aplicar bordas"),setTimeout(()=>tt(""),2e3);return}try{const f=(u=(d=a.value)==null?void 0:d.getPlugin)==null?void 0:u.call(d,"customBorders");(!f||!f.setBorders)&&(tt("Aplicando bordas (modo compatibilidade)"),setTimeout(()=>tt(""),1200))}catch{}const t=[...b.value];no(n),setTimeout(()=>{if(a.value&&t)try{a.value.selectCell(t[0],t[1],t[2],t[3]),b.value=t}catch{}},50),K.value=!1}const yt=S(!1),gt=S(!1),I=S({type:"greaterThan",value:"",value2:"",bgColor:"#fff3cd",textColor:"#000000",bold:!1,italic:!1}),nt=S({color1:"#f9fafb",color2:"#ffffff",hasHeader:!1});function ie(){yt.value=!0,Yt()}function ue(){gt.value=!0,Yt()}function Ue(){if(!a.value||!b.value)return;const[n,t,o,r]=C(...b.value),s={...I.value};for(let e=n;e<=o;e++)for(let i=t;i<=r;i++){const d=a.value.getCellMeta(e,i),u=Array.isArray(d.conditional)?d.conditional:[];u.push(s),a.value.setCellMeta(e,i,"conditional",u)}a.value&&a.value.render(),N(),yt.value=!1}function $e(){if(!a.value||!b.value)return;const[n,t,o,r]=C(...b.value);for(let s=n;s<=o;s++)for(let e=t;e<=r;e++)a.value.setCellMeta(s,e,"conditional",void 0);a.value&&a.value.render(),N()}function Pe(){if(!a.value||!b.value)return;const[n,t,o,r]=C(...b.value),s=`alt-${Date.now()}-${Math.random().toString(36).slice(2,7)}`,e={...nt.value,groupId:s};for(let i=n;i<=o;i++)for(let d=t;d<=r;d++)a.value.setCellMeta(i,d,"alternating",{groupId:s});window.__pvAltGroups=window.__pvAltGroups||{},window.__pvAltGroups[s]={r1:n,c1:t,r2:o,c2:r,cfg:e},a.value&&a.value.render(),N(),gt.value=!1}function Ve(){if(!a.value||!b.value)return;const[n,t,o,r]=C(...b.value);for(let s=n;s<=o;s++)for(let e=t;e<=r;e++)a.value.setCellMeta(s,e,"alternating",void 0);a.value&&a.value.render(),N()}const je=function(n,t,o,r,s,e,i){Oe.renderers.TextRenderer(n,t,o,r,s,e,i);const d=i||{};t.style.fontWeight=d.bold?"700":"",t.style.fontStyle=d.italic?"italic":"",t.style.textDecoration=d.underline?"underline":"",t.style.textAlign=d.align?d.align==="left"?"left":d.align==="center"?"center":"right":"",t.style.color=d.textColor||"",t.style.backgroundColor=d.bgColor||"";try{const u=d.borders;u?(u.top?t.style.setProperty("border-top",`${u.top.width||1}px solid ${u.top.color||"#000"}`,"important"):t.style.removeProperty("border-top"),u.bottom?t.style.setProperty("border-bottom",`${u.bottom.width||1}px solid ${u.bottom.color||"#000"}`,"important"):t.style.removeProperty("border-bottom"),u.left?t.style.setProperty("border-left",`${u.left.width||1}px solid ${u.left.color||"#000"}`,"important"):t.style.removeProperty("border-left"),u.right?t.style.setProperty("border-right",`${u.right.width||1}px solid ${u.right.color||"#000"}`,"important"):t.style.removeProperty("border-right")):(t.style.removeProperty("border-top"),t.style.removeProperty("border-right"),t.style.removeProperty("border-bottom"),t.style.removeProperty("border-left"))}catch{}try{const u=d.alternating;if(u&&window.__pvAltGroups){const f=window.__pvAltGroups[u.groupId];if(f){const{r1:m,c1:v,r2:p,c2:w,cfg:g}=f;if(o>=m&&o<=p&&r>=v&&r<=w){const A=g.hasHeader?1:0,L=o-m-A;if(L>=0){const x=L%2===0?g.color1:g.color2;d.bgColor||(t.style.backgroundColor=x)}}}}}catch{}try{const u=Array.isArray(d.conditional)?d.conditional:[];if(u.length){const f=e;for(const m of u)if(He(f,m)){m.bgColor&&(t.style.backgroundColor=m.bgColor),m.textColor&&(t.style.color=m.textColor),m.bold&&(t.style.fontWeight="700"),m.italic&&(t.style.fontStyle="italic");break}}}catch{}if(d.format&&e!==null&&e!==void 0&&e!==""){const u=typeof d.decimals=="number"?d.decimals:2;let f=null;if(typeof e=="number")f=e;else if(typeof e=="string"){const m=e.replace(/\./g,"").replace(/,/g,"."),v=Number(m);Number.isNaN(v)||(f=v)}if(f!==null){let m="";try{d.format==="currency"?m=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:u,maximumFractionDigits:u}).format(f):d.format==="percent"?m=new Intl.NumberFormat("pt-BR",{style:"percent",minimumFractionDigits:u,maximumFractionDigits:u}).format(f):d.format==="number"&&(m=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:u,maximumFractionDigits:u}).format(f))}catch{}m&&(t.textContent=m)}}};function He(n,t){const o=typeof n=="number"?n:typeof n=="string"?Number(n.replace(/\./g,"").replace(/,/g,".")):NaN,r=(n==null?"":String(n)).toLowerCase();switch(t.type){case"greaterThan":return!Number.isNaN(o)&&o>Number(t.value);case"lessThan":return!Number.isNaN(o)&&o<Number(t.value);case"equalTo":return!Number.isNaN(o)&&o===Number(t.value)||r===String(t.value).toLowerCase();case"between":{const s=Number(t.value),e=Number(t.value2);return!Number.isNaN(o)&&o>=Math.min(s,e)&&o<=Math.max(s,e)}case"textContains":return r.includes(String(t.value).toLowerCase());case"isEmpty":return r==="";case"notEmpty":return r!=="";default:return!1}}Co(()=>{const n=document.getElementById("hot-container");if(n){window.addEventListener("mousedown",s=>{window.__hotMouseDown=!0}),window.addEventListener("mouseup",s=>{window.__hotMouseDown=!1}),window.addEventListener("mouseup",s=>{});const r=(()=>{try{const s=document.querySelector(".sheet-container"),e=s?s.getBoundingClientRect().top:0,i=window.innerHeight-e-90;return Math.max(360,Math.floor(i))}catch{return 480}})();try{n.style.height=r+"px"}catch{}a.value=new Oe(n,{data:Te.value,rowHeaders:!0,colHeaders:!0,height:r,minRows:200,minCols:26,stretchH:"all",contextMenu:!0,editor:"text",readOnly:!1,fillHandle:!0,fragmentSelection:!1,customBorders:!0,undo:!0,outsideClickDeselects:s=>{try{const e=s==null?void 0:s.target;if(e&&(e.closest(".toolbar")||e.closest(".formula-bar")||e.closest(".sheet-tabs")||e.closest(".navbar"))||Dt.value)return!1}catch{}return!0},cells:()=>({renderer:je}),afterSelection:(s,e,i,d,u,f)=>{if(V("afterSelection",{row:s,col:e,row2:i,col2:d,isEditingFormula:pt.value,selectionLayerLevel:f}),f!==void 0&&f>0){Rt();return}const[m,v,p,w]=C(s,e,i,d);if(b.value=[m,v,p,w],Rt(),pt.value){try{uo(m,v,p,w),ge(m,v,p,w),setTimeout(()=>{bt.value&&bt.value.focus()},10)}catch{}return}try{const g=document.querySelector(".handsontableInput");if(g&&document.activeElement===g){const A=g.value||"";if(A.trimStart().startsWith("=")){const D=pe(m,v,p,w);let x=A;const Ot=window.__hotMouseDown===!0,wt=window.__lastKb||{},Vt=!!wt.shiftKey,jt=!!wt.ctrlKey||!!wt.metaKey;if(M&&Ot){x=x.slice(0,M.start)+D+x.slice(M.end),g.value=x;const H=M.start+D.length;g.setSelectionRange(H,H)}else if(M){if(!Ot){const H=g.selectionStart??x.length,F=x.slice(0,H);if(Vt&&M)x=x.slice(0,M.start)+D+x.slice(M.end),g.value=x,M.end=M.start+D.length,g.setSelectionRange(M.end,M.end);else if(jt){const ht=!F.trim().endsWith("=")&&!F.trim().endsWith("(")&&!F.endsWith(",")?",":"",at=ht+D;g.value=F+at+x.slice(H);const rt=F.length+ht.length,it=rt+D.length;g.setSelectionRange(it,it),M={start:rt,end:it}}else M&&(x=x.slice(0,M.start)+D+x.slice(M.end),g.value=x,M.end=M.start+D.length,g.setSelectionRange(M.end,M.end))}}else{const H=g.selectionStart??x.length,F=x.slice(0,H),Tt=F.slice(-1),at=F&&!/[+\-*/^(,]/.test(Tt)&&!F.trim().endsWith("=")&&!F.trim().endsWith("(")?",":"",rt=(F.match(/\(/g)||[]).length,it=(F.match(/\)/g)||[]).length,Ht=rt===0&&/=[A-ZÀ-ÚA-Z\.]+$/i.test(F.trim());let Ct="";Ht&&(Ct="(");let Gt=at+Ct+D;g.value=F+Gt+x.slice(H);let zt=!1;const St=g.value,Kt=(St.match(/\(/g)||[]).length,Wt=(St.match(/\)/g)||[]).length;Kt>Wt&&(g.value=St+")",zt=!0);const It=F.length+at.length+Ct.length,c=It+D.length;g.setSelectionRange(c,c),M={start:It,end:c}}g.dispatchEvent(new Event("input",{bubbles:!0})),ee(m,v,p,w);return}else{st(),M=null;return}}}catch{}if(b.value=[m,v,p,w],Rt(),a.value){const g=a.value.getDataAtCell(m,v);$.value=g==null?"":String(g)}},afterChange:()=>{if(Rt(),a.value&&b.value){const[s,e]=b.value,i=a.value.getDataAtCell(s,e);$.value=i==null?"":String(i)}},beforeChange:s=>{try{if(!Array.isArray(s))return;for(const e of s){const i=e==null?void 0:e[3];if(typeof i=="string"&&i.trim().startsWith("=")){const d=i.trim().slice(1);e[3]="="+d}}}catch{}},afterBeginEditing:(s,e)=>{try{const i=document.querySelector(".handsontableInput");if(!i)return;se=!0,setTimeout(()=>{const d=i.value||"";he(s,e,i,d),i.addEventListener("input",mo),i.addEventListener("keydown",vo)},0)}catch{}},afterOnCellMouseUp:()=>{M=null;try{const s=document.querySelector(".handsontableInput");if(s&&document.activeElement===s){const e=s.value;if(e.trimStart().startsWith("=")){const i=(e.match(/\(/g)||[]).length,d=(e.match(/\)/g)||[]).length;if(i>d){s.value=e+")";const u=s.value.length;s.setSelectionRange(u,u),s.dispatchEvent(new Event("input",{bubbles:!0}))}}}}catch{}},afterDeselect:()=>{const s=Z.value||J.value||K.value,e=pt.value;!s&&!e&&!Dt.value&&(b.value=null,mt.value={sum:0,count:0,avg:0})},licenseKey:"non-commercial-and-evaluation"}),window.addEventListener("keydown",fe),window.addEventListener("keydown",s=>{window.__lastKb=s}),window.addEventListener("keyup",s=>{window.__lastKb=s}),yo(),Zt.value=setInterval(async()=>{if(!a.value)return;const s=ve();try{localStorage.setItem("sheets-data",JSON.stringify(s))}catch{}try{typeof navigator<"u"&&navigator.onLine&&(await fetch("/server/api/sheets.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:z.value,...s})})).ok&&(Ft.value=new Date().toLocaleTimeString())}catch{}},3e4)}const t=()=>{try{if(a.value){const o=document.querySelector(".sheet-container"),r=o?o.getBoundingClientRect().top:0,s=Math.max(360,Math.floor(window.innerHeight-r-90));a.value.updateSettings({height:s})}}catch{}};window.addEventListener("resize",t),window.__pvSheetsOnResize=t,setTimeout(()=>{try{if(a.value){const o=document.querySelector(".sheet-container"),r=o?o.getBoundingClientRect().top:0,s=Math.max(360,Math.floor(window.innerHeight-r-90)),e=document.getElementById("hot-container");e&&(e.style.height=s+"px"),a.value.updateSettings({height:s}),a.value&&a.value.render()}}catch{}},0);try{const o=r=>{const s=r.target;s&&(s.closest(".toolbar-dropdown")||Yt())};document.addEventListener("mousedown",o,!0),window.__pvSheetsCloseMenus=o}catch{}}),So(()=>{Zt.value&&clearInterval(Zt.value),window.removeEventListener("keydown",fe);const n=window.__pvSheetsOnResize;n&&window.removeEventListener("resize",n);const t=window.__pvSheetsMouseBlocker;t&&document.removeEventListener("mousedown",t,!0);const o=window.__pvSheetsCloseMenus;o&&document.removeEventListener("mousedown",o,!0)});const tt=n=>{Jt.value=n},N=()=>{if(a.value&&b.value){const[n,t,o,r]=b.value;setTimeout(()=>{a.value&&b.value&&a.value.selectCell(n,t,o,r)},10)}};function C(n,t,o,r){const s=Math.min(n,o),e=Math.max(n,o),i=Math.min(t,r),d=Math.max(t,r);return[s,i,e,d]}const ce=()=>{if(a.value){const n=ve();localStorage.setItem("sheets-data",JSON.stringify(n)),fetch("/server/api/sheets.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:z.value,...n})}).then(t=>t.json()).then(()=>{tt("Planilha salva com sucesso!"),Ft.value=new Date().toLocaleTimeString(),setTimeout(()=>tt(""),3e3)}).catch(()=>{tt("Salvo localmente (sem conexão com servidor)"),Ft.value=new Date().toLocaleTimeString(),setTimeout(()=>tt(""),3e3)})}},Ge=()=>{const n=localStorage.getItem("sheets-data");if(n&&a.value){const t=JSON.parse(n);t&&t.data?(a.value.loadData(t.data),te(t.meta||{},t.altGroups||{},t.conditional||{},t.alternating||{})):a.value.loadData(t)}else fetch("/server/api/sheets.php?id="+encodeURIComponent(z.value)).then(t=>t.json()).then(t=>{t.success&&a.value?t.data&&t.data.data?(a.value.loadData(t.data.data),te(t.data.meta||{},t.data.altGroups||{},t.data.conditional||{},t.data.alternating||{}),Array.isArray(t.data.merges)&&t.data.merges.length&&a.value.updateSettings({mergeCells:t.data.merges})):a.value.loadData(t.data):console.log("No server data")}).catch(()=>{})},de=()=>{const n="Página";let t=1;const o=new Set(Y.value);for(;o.has(`${n}${t}`);)t++;const r=prompt("Nome da nova planilha:",`${n}${t}`);r&&(Y.value.includes(r)||(Y.value.push(r),Ce()),oe(r))};function j(n){if(!a.value||!b.value)return;const[t,o,r,s]=C(...b.value);for(let e=t;e<=r;e++)for(let i=o;i<=s;i++){const d=a.value.getCellMeta(e,i),u=n({...d},e,i);Object.keys(u).forEach(f=>{a.value.setCellMeta(e,i,f,u[f])})}a.value&&a.value.render(),N()}function fe(n){(n.ctrlKey||n.metaKey)&&n.key.toLowerCase()==="s"&&(n.preventDefault(),ce())}const ze=()=>{if(!a.value||!b.value)return;const[n,t]=b.value,r=!a.value.getCellMeta(n,t).bold;j(s=>({...s,bold:r}))},Ke=()=>{if(!a.value||!b.value)return;const[n,t]=b.value,r=!a.value.getCellMeta(n,t).italic;j(s=>({...s,italic:r}))},We=()=>{if(!a.value||!b.value)return;const[n,t]=b.value,r=!a.value.getCellMeta(n,t).underline;j(s=>({...s,underline:r}))},qe=()=>j(n=>({...n,align:"left"})),Xe=()=>j(n=>({...n,align:"center"})),Ze=()=>j(n=>({...n,align:"right"})),Je=n=>{const t=n.target.value;j(o=>({...o,format:t}))},Qe=()=>{j(n=>({...n,decimals:Math.min(8,(n.decimals??2)+1)}))},Ye=()=>{j(n=>({...n,decimals:Math.max(0,(n.decimals??2)-1)}))},_e=()=>{if(a.value&&b.value){const n=C(...b.value)[0];a.value.alter("insert_row_below",n),setTimeout(()=>{if(a.value&&b.value){const[,t,,o]=C(...b.value);b.value=[n+1,t,n+1,o],a.value&&a.value.render(),N()}},10)}},to=()=>{if(a.value&&b.value){const n=C(...b.value)[1];a.value.alter("insert_col_end",n),setTimeout(()=>{if(a.value&&b.value){const[t,,o]=C(...b.value);b.value=[t,n+1,o,n+1],a.value&&a.value.render(),N()}},10)}},eo=()=>{if(a.value&&b.value){const n=b.value[0];a.value.alter("remove_row",n),setTimeout(()=>{a.value&&a.value.render(),N()},10)}},oo=()=>{if(a.value&&b.value){const n=b.value[1];a.value.alter("remove_col",n),setTimeout(()=>{a.value&&a.value.render(),N()},10)}};function ve(){var u,f,m;if(!a.value)return{data:[]};const n=a.value.countRows(),t=a.value.countCols(),o={},r=["bold","italic","underline","align","textColor","bgColor","format","decimals","type","source","strict","borders"],s={},e={};for(let v=0;v<n;v++)for(let p=0;p<t;p++){const w=a.value.getCellMeta(v,p),g={};r.forEach(A=>{const L=w[A];L!=null&&L!==""&&(g[A]=L)}),Array.isArray(w.conditional)&&w.conditional.length&&(s[`${v}:${p}`]=w.conditional),w.alternating&&(e[`${v}:${p}`]=w.alternating),Object.keys(g).length&&(o[`${v}:${p}`]=g)}let i=[];try{const v=(f=(u=a.value).getPlugin)==null?void 0:f.call(u,"mergeCells");(m=v==null?void 0:v.mergedCellsCollection)!=null&&m.mergedCells?i=v.mergedCellsCollection.mergedCells.map(p=>({row:p.row,col:p.col,rowspan:p.rowspan,colspan:p.colspan})):Array.isArray(a.value.getSettings().mergeCells)&&(i=a.value.getSettings().mergeCells)}catch{}let d={};try{d=window.__pvAltGroups||{}}catch{}return{data:a.value.getSourceData(),meta:o,rows:n,cols:t,merges:i,conditional:s,alternating:e,altGroups:d}}function te(n,t,o,r){var s,e;if(a.value){Object.entries(n).forEach(([i,d])=>{const[u,f]=i.split(":").map(Number);!Number.isFinite(u)||!Number.isFinite(f)||u<0||f<0||Object.entries(d).forEach(([m,v])=>{a.value.setCellMeta(u,f,m,v)})});try{const i=(e=(s=a.value).getPlugin)==null?void 0:e.call(s,"customBorders");i!=null&&i.setBorders&&Object.entries(n).forEach(([d,u])=>{if(!u||!u.borders)return;const[f,m]=d.split(":").map(Number);if(!Number.isFinite(f)||!Number.isFinite(m)||f<0||m<0)return;const v=u.borders,p={};if(v.top&&(p.top={width:v.top.width||1,color:v.top.color||"#000"}),v.bottom&&(p.bottom={width:v.bottom.width||1,color:v.bottom.color||"#000"}),v.left&&(p.left={width:v.left.width||1,color:v.left.color||"#000"}),v.right&&(p.right={width:v.right.width||1,color:v.right.color||"#000"}),Object.keys(p).length)try{i.setBorders([{row:f,col:m,row2:f,col2:m}],p)}catch{}})}catch{}try{window.__pvAltGroups=t||{}}catch{}try{o&&Object.entries(o).forEach(([i,d])=>{const[u,f]=i.split(":").map(Number);a.value.setCellMeta(u,f,"conditional",Array.isArray(d)?d:void 0)}),r&&Object.entries(r).forEach(([i,d])=>{const[u,f]=i.split(":").map(Number);a.value.setCellMeta(u,f,"alternating",d)})}catch{}a.value&&a.value.render()}}function Bl(n){return n}function Rt(){if(!a.value){mt.value={sum:0,count:0,avg:0};return}let n=0,t=0;try{const r=a.value.getSelected();if(r&&r.length>0)r.forEach(s=>{const[e,i,d,u]=C(s[0],s[1],s[2],s[3]);for(let f=e;f<=d;f++)for(let m=i;m<=u;m++){const v=a.value.getDataAtCell(f,m);let p=null;if(typeof v=="number")p=v;else if(typeof v=="string"){const w=v.replace(/\./g,"").replace(/,/g,"."),g=Number(w);Number.isNaN(g)||(p=g)}p!==null&&(n+=p,t++)}});else if(b.value){const[s,e,i,d]=C(...b.value);for(let u=s;u<=i;u++)for(let f=e;f<=d;f++){const m=a.value.getDataAtCell(u,f);let v=null;if(typeof m=="number")v=m;else if(typeof m=="string"){const p=m.replace(/\./g,"").replace(/,/g,"."),w=Number(p);Number.isNaN(w)||(v=w)}v!==null&&(n+=v,t++)}}}catch(r){console.warn("Erro ao calcular estatísticas de seleção:",r)}const o=t?+(n/t).toFixed(2):0;mt.value={sum:+n.toFixed(2),count:t,avg:o}}function lo(){if(!a.value||!b.value)return;let n=$.value;typeof n=="string"&&n.startsWith("=")&&(n="="+n.slice(1));const[t,o,r,s]=C(...b.value);for(let e=t;e<=r;e++)for(let i=o;i<=s;i++)a.value.setDataAtCell(e,i,n);a.value&&a.value.render(),N()}function no(n){var p,w,g,A,L,D,x,Ot,wt,Vt,jt,H,F,Tt,ht,at,rt,it,Ht,Ct,Gt,zt,St,Kt,Wt,It;if(!a.value)return;if(!b.value)try{const c=(((w=(p=a.value).getSelectedLast)==null?void 0:w.call(p))||((A=(g=a.value).getSelected)==null?void 0:A.call(g))||[])[0];c&&Array.isArray(c)&&c.length>=4&&(b.value=C(c[0],c[1],c[2],c[3]))}catch{}if(!b.value)return;const[t,o,r,s]=C(...b.value);if(![t,o,r,s].every(c=>Number.isFinite(c)&&c>=0))return;const e=(D=(L=a.value).getPlugin)==null?void 0:D.call(L,"customBorders"),i=Math.max(1,Math.min(20,X.value||1)),d=Nt.value||"#000000",u=c=>({[c]:{width:i,color:d}}),f=(c,y,E)=>{if(!Number.isFinite(c)||!Number.isFinite(y)||c<0||y<0)return;const Mt={...(a.value.getCellMeta(c,y)||{}).borders||{}},qt={...Mt};for(const At of["top","bottom","left","right"])E&&E[At]&&(qt[At]={...Mt[At],...E[At]});a.value.setCellMeta(c,y,"borders",qt)},m=(c,y,E)=>{if(!Number.isFinite(c)||!Number.isFinite(y)||c<0||y<0)return;if(!E||!E.length){a.value.setCellMeta(c,y,"borders",void 0);return}const Mt={...(a.value.getCellMeta(c,y)||{}).borders||{}};for(const At of E)delete Mt[At];const qt=Object.keys(Mt).length>0;a.value.setCellMeta(c,y,"borders",qt?Mt:void 0)},v=()=>{var c,y;try{(c=e==null?void 0:e.clearBorders)==null||c.call(e,[{row:t,col:o,row2:r,col2:s}])}catch{}try{(y=e==null?void 0:e.clearBorders)==null||y.call(e,[[t,o,r,s]])}catch{}if(e!=null&&e.clearBorders)try{for(let E=t;E<=r;E++)for(let P=o;P<=s;P++){try{e.clearBorders([{row:E,col:P,row2:E,col2:P}])}catch{}try{e.clearBorders([[E,P,E,P]])}catch{}}}catch{}for(let E=t;E<=r;E++)for(let P=o;P<=s;P++)!Number.isFinite(E)||!Number.isFinite(P)||E<0||P<0||a.value.setCellMeta(E,P,"borders",void 0)};if(n==="none"){v(),a.value.render();return}if(n==="top")for(let c=o;c<=s;c++){try{(x=e==null?void 0:e.setBorders)==null||x.call(e,[{row:t,col:c,row2:t,col2:c}],u("top"))}catch{}f(t,c,u("top"))}else if(n==="bottom")for(let c=o;c<=s;c++){try{(Ot=e==null?void 0:e.setBorders)==null||Ot.call(e,[{row:r,col:c,row2:r,col2:c}],u("bottom"))}catch{}f(r,c,u("bottom"))}else if(n==="left")for(let c=t;c<=r;c++){try{(wt=e==null?void 0:e.setBorders)==null||wt.call(e,[{row:c,col:o,row2:c,col2:o}],u("left"))}catch{}f(c,o,u("left"))}else if(n==="right")for(let c=t;c<=r;c++){try{(Vt=e==null?void 0:e.setBorders)==null||Vt.call(e,[{row:c,col:s,row2:c,col2:s}],u("right"))}catch{}f(c,s,u("right"))}else if(n==="outer"){for(let c=o;c<=s;c++){try{(jt=e==null?void 0:e.setBorders)==null||jt.call(e,[{row:t,col:c,row2:t,col2:c}],u("top"))}catch{}f(t,c,u("top"));try{(H=e==null?void 0:e.setBorders)==null||H.call(e,[{row:r,col:c,row2:r,col2:c}],u("bottom"))}catch{}f(r,c,u("bottom"))}for(let c=t;c<=r;c++){try{(F=e==null?void 0:e.setBorders)==null||F.call(e,[{row:c,col:o,row2:c,col2:o}],u("left"))}catch{}f(c,o,u("left"));try{(Tt=e==null?void 0:e.setBorders)==null||Tt.call(e,[{row:c,col:s,row2:c,col2:s}],u("right"))}catch{}f(c,s,u("right"))}}else if(n==="inner"){for(let c=t;c<=r;c++)for(let y=o;y<=s;y++){const E=[];y<s&&E.push("right"),c<r&&E.push("bottom"),E.length&&m(c,y,E)}for(let c=o;c<s;c++)for(let y=t;y<=r;y++){f(y,c,{right:{width:i,color:d}}),f(y,c+1,{left:{width:i,color:d}});try{(ht=e==null?void 0:e.setBorders)==null||ht.call(e,[{row:y,col:c,row2:y,col2:c}],{right:{width:i,color:d}}),(at=e==null?void 0:e.setBorders)==null||at.call(e,[{row:y,col:c+1,row2:y,col2:c+1}],{left:{width:i,color:d}})}catch{}}for(let c=t;c<r;c++)for(let y=o;y<=s;y++){f(c,y,{bottom:{width:i,color:d}}),f(c+1,y,{top:{width:i,color:d}});try{(rt=e==null?void 0:e.setBorders)==null||rt.call(e,[{row:c,col:y,row2:c,col2:y}],{bottom:{width:i,color:d}}),(it=e==null?void 0:e.setBorders)==null||it.call(e,[{row:c+1,col:y,row2:c+1,col2:y}],{top:{width:i,color:d}})}catch{}}}else if(n==="all"){for(let c=o;c<=s;c++){f(t,c,{top:{width:i,color:d}}),f(r,c,{bottom:{width:i,color:d}});try{(Ht=e==null?void 0:e.setBorders)==null||Ht.call(e,[{row:t,col:c,row2:t,col2:c}],{top:{width:i,color:d}}),(Ct=e==null?void 0:e.setBorders)==null||Ct.call(e,[{row:r,col:c,row2:r,col2:c}],{bottom:{width:i,color:d}})}catch{}}for(let c=t;c<=r;c++){f(c,o,{left:{width:i,color:d}}),f(c,s,{right:{width:i,color:d}});try{(Gt=e==null?void 0:e.setBorders)==null||Gt.call(e,[{row:c,col:o,row2:c,col2:o}],{left:{width:i,color:d}}),(zt=e==null?void 0:e.setBorders)==null||zt.call(e,[{row:c,col:s,row2:c,col2:s}],{right:{width:i,color:d}})}catch{}}for(let c=o;c<s;c++)for(let y=t;y<=r;y++){f(y,c,{right:{width:i,color:d}}),f(y,c+1,{left:{width:i,color:d}});try{(St=e==null?void 0:e.setBorders)==null||St.call(e,[{row:y,col:c,row2:y,col2:c}],{right:{width:i,color:d}}),(Kt=e==null?void 0:e.setBorders)==null||Kt.call(e,[{row:y,col:c+1,row2:y,col2:c+1}],{left:{width:i,color:d}})}catch{}}for(let c=t;c<r;c++)for(let y=o;y<=s;y++){f(c,y,{bottom:{width:i,color:d}}),f(c+1,y,{top:{width:i,color:d}});try{(Wt=e==null?void 0:e.setBorders)==null||Wt.call(e,[{row:c,col:y,row2:c,col2:y}],{bottom:{width:i,color:d}}),(It=e==null?void 0:e.setBorders)==null||It.call(e,[{row:c+1,col:y,row2:c+1,col2:y}],{top:{width:i,color:d}})}catch{}}}try{_t(t,o,r,s)}catch{}try{a.value.render()}catch{}}function me(n){let t=n+1,o="";for(;t>0;){const r=(t-1)%26;o=String.fromCharCode(65+r)+o,t=Math.floor((t-1)/26)}return o}function be(n){let t=0;for(const o of n)t=t*26+(o.charCodeAt(0)-64);return t-1}function pe(n,t,o,r){const s=me(t)+(n+1);if(o===void 0||r===void 0||n===o&&t===r)return s;const e=me(r)+(o+1);return s+":"+e}function ye(n){const t=/^([A-Z]+)(\d+)(?::([A-Z]+)(\d+))?$/.exec(n.toUpperCase());if(!t)return null;const o=be(t[1]),r=parseInt(t[2],10)-1,s=t[3]?be(t[3]):o,e=t[4]?parseInt(t[4],10)-1:r;return[r,o,e,s]}function so(){ot&&(clearTimeout(ot),ot=null),pt.value=!0}function ao(){ot&&clearTimeout(ot),ot=setTimeout(()=>{pt.value=!1,ot=null},300)}function ro(){try{const n=bt.value,t=$.value;if(!n||!t)return;const o=n.selectionStart??t.length,s=t.slice(0,o).match(/([A-Z]+\d+(?::[A-Z]+\d+)?)(?!.*[A-Z]+\d+)/i),e=s?s[1]:"";if(!e)return;const i=ye(e);i&&a.value&&ge(i[0],i[1],i[2],i[3])}catch{}}function ge(n,t,o,r){try{if(!a.value)return;const[s,e,i,d]=C(n,t,o,r);ee(s,e,i,d),setTimeout(()=>{var u,f;pt.value?(u=bt.value)==null||u.focus():(f=document.querySelector(".handsontableInput"))==null||f.focus()},0)}catch{}}function io(n){const t=bt.value;if(!t)return;const o=t.selectionStart??$.value.length,r=t.selectionEnd??o,s=$.value.slice(0,o),e=$.value.slice(r);$.value=s+n+e;const i=(s+n).length;setTimeout(()=>{try{t.setSelectionRange(i,i),t.focus()}catch{}},0)}function uo(n,t,o,r){const[s,e,i,d]=C(n,t,o,r),u=pe(s,e,i,d);$.value.startsWith("=")||($.value="=");const f=$.value.slice(-1);f&&!/[+\-*/^(,]/.test(f)&&($.value+=f==="="?"":"+"),io(u)}function Pt(){T.value={show:!1,items:[],index:0,top:0,left:0}}function we(n){const t=Math.max(0,Math.min(T.value.items.length-1,n)),o=T.value.items[t];try{const r=document.querySelector(".handsontableInput");if(!r)return;const{value:s}=r,e=r.selectionStart??s.length,i=s.slice(0,e),d=i.match(/=([a-zA-Zçéêíóúãõâêôáàéíóúüñ\.]+)$/i);if(d){const u=i.slice(0,d.index+1),f=s.slice(e),m=u+o+"("+f;r.value=m;const v=(u+o+"(").length;r.setSelectionRange(v,v),r.dispatchEvent(new Event("input",{bubbles:!0}))}}catch{}Pt()}function co(n,t,o){try{const r=o.getBoundingClientRect(),s=document.getElementById("hot-container").getBoundingClientRect(),e=r.bottom-s.top+2,i=r.left-s.left;T.value={show:!0,items:Q,index:0,top:e,left:i,editorCell:{row:n,col:t}}}catch{}}function fo(n){const t=n.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase(),o=s=>s.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase(),r=Q.filter(s=>o(s).startsWith(t));T.value.items=r.length?r:Q,T.value.index=0}function vo(n){T.value.show&&(n.key==="ArrowDown"?(n.preventDefault(),T.value.index=Math.min(T.value.index+1,T.value.items.length-1)):n.key==="ArrowUp"?(n.preventDefault(),T.value.index=Math.max(T.value.index-1,0)):n.key==="Enter"||n.key==="Tab"?(n.preventDefault(),we(T.value.index)):n.key==="Escape"&&Pt(),["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Shift","Control","Alt","Meta","Tab"].includes(n.key)||(M=null))}function mo(){var t,o;const n=this;he(((t=T.value.editorCell)==null?void 0:t.row)??0,((o=T.value.editorCell)==null?void 0:o.col)??0,n,n.value)}function he(n,t,o,r){try{const s=o.selectionStart??r.length,e=r.slice(0,s),i=e.match(/=([a-zA-Zçéêíóúãõâêôáàéíóúüñ\.]+)$/i);if(i){const u=i[1];co(n,t,o),fo(u)}else Pt();const d=e.match(/([A-Za-z]+\d+(?::[A-Za-z]+\d+)?)$/);if(d&&a.value){const u=ye(d[1]);u?ee(u[0],u[1],u[2],u[3]):st()}else st()}catch{}}function st(){lt.value={show:!1,top:0,left:0,width:0,height:0}}function ee(n,t,o,r){try{if(!a.value)return;const[s,e,i,d]=C(n,t,o,r),u=document.getElementById("hot-container");if(!u)return;const f=a.value.getCell(s,e),m=a.value.getCell(i,d);if(!f||!m){st();return}const v=f.getBoundingClientRect(),p=m.getBoundingClientRect(),w=u.getBoundingClientRect(),g=v.top-w.top-1,A=v.left-w.left-1,L=p.right-v.left+2,D=p.bottom-v.top+2;lt.value={show:!0,top:g,left:A,width:L,height:D}}catch{st()}}document.addEventListener("mousedown",()=>{try{const n=document.querySelector(".handsontableInput");n?document.activeElement!==n&&(se=!1,M=null,st()):(Pt(),st())}catch{}},!0);function bo(){var d,u;if(!a.value||!b.value)return;const[n,t,o,r]=C(...b.value),s=o-n+1,e=r-t+1;if(s===1&&e===1)return;const i=(u=(d=a.value).getPlugin)==null?void 0:u.call(d,"mergeCells");if(i!=null&&i.mergeSelection){try{a.value.selectCell(n,t,o,r,!1,!1)}catch{}try{i.mergeSelection()}catch{}}else{const f=a.value.getSettings(),m=Array.isArray(f.mergeCells)?[...f.mergeCells]:[];m.push({row:n,col:t,rowspan:s,colspan:e}),a.value.updateSettings({mergeCells:m})}setTimeout(()=>{a.value&&a.value.render(),N()},10)}function po(){var e,i;if(!a.value||!b.value)return;const n=(i=(e=a.value).getPlugin)==null?void 0:i.call(e,"mergeCells"),[t,o,r,s]=C(...b.value);if(n!=null&&n.unmergeSelection){try{a.value.selectCell(t,o,r,s,!1,!1)}catch{}try{n.unmergeSelection()}catch{}}else{const d=a.value.getSettings(),f=(Array.isArray(d.mergeCells)?d.mergeCells:[]).filter(m=>{const v=m.row+(m.rowspan||1)-1,p=m.col+(m.colspan||1)-1;return!!(m.row>r||v<t||m.col>s||p<o)});a.value.updateSettings({mergeCells:f})}setTimeout(()=>{a.value&&a.value.render(),N()},10)}function yo(){const n=new URLSearchParams(window.location.search).get("id")||void 0;Y.value=go(),z.value=n||localStorage.getItem("sheets-last")||"default",Y.value.includes(z.value)||Y.value.push(z.value),Ce(),oe(z.value)}function oe(n){z.value=n,localStorage.setItem("sheets-last",n),a.value&&fetch("/server/api/sheets.php?id="+encodeURIComponent(n)).then(t=>t.json()).then(t=>{t.success&&t.data?t.data.data?(a.value.loadData(t.data.data),te(t.data.meta||{},t.data.altGroups||{},t.data.conditional||{},t.data.alternating||{}),Array.isArray(t.data.merges)&&t.data.merges.length&&a.value.updateSettings({mergeCells:t.data.merges})):a.value.loadData(t.data):a.value.loadData(Array.from({length:50},()=>Array(26).fill(""))),N()}).catch(()=>{a.value.loadData(Array.from({length:50},()=>Array(26).fill("")))})}function go(){try{return JSON.parse(localStorage.getItem("sheets-tabs")||"[]")}catch{return[]}}function Ce(){localStorage.setItem("sheets-tabs",JSON.stringify(Y.value))}function Se(){if(!a.value||!b.value)return;const[n,t,o,r]=C(...b.value);for(let s=n;s<=o;s++)for(let e=t;e<=r;e++)a.value.setDataAtCell(s,e,"");Rt(),a.value&&a.value.render(),N()}function Me(){var e,i,d,u,f,m,v,p,w;if(!a.value||!b.value)return;const[n,t,o,r]=C(...b.value),s=["bold","italic","underline","align","textColor","bgColor","format","decimals"];for(let g=n;g<=o;g++)for(let A=t;A<=r;A++)if(!(!Number.isFinite(g)||!Number.isFinite(A)||g<0||A<0)){for(const L of s)a.value.setCellMeta(g,A,L,void 0);a.value.setCellMeta(g,A,"borders",void 0)}try{(u=(d=(i=(e=a.value).getPlugin)==null?void 0:i.call(e,"customBorders"))==null?void 0:d.clearBorders)==null||u.call(d,[{row:n,col:t,row2:o,col2:r}])}catch{}try{(p=(v=(m=(f=a.value).getPlugin)==null?void 0:m.call(f,"customBorders"))==null?void 0:v.clearBorders)==null||p.call(v,[[n,t,o,r]])}catch{}try{(w=a.value)==null||w.render()}catch{}N()}function Ae(){var n;kt.value=kt.value>0?0:1,(n=a.value)==null||n.updateSettings({fixedRowsTop:kt.value}),N()}function Ee(){var n;xt.value=xt.value>0?0:1,(n=a.value)==null||n.updateSettings({fixedColumnsLeft:xt.value}),N()}function ke(){if(!a.value)return;const n=a.value.getData(),t=";",o=n.map(i=>i.map(d=>{const u=(d??"").toString();return u.includes('"')||u.includes(t)||u.includes(`
`)?'"'+u.replace(/"/g,'""')+'"':u}).join(t)).join(`
`),r=new Blob([o],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(r),e=document.createElement("a");e.href=s,e.download=`${z.value}.csv`,e.click(),URL.revokeObjectURL(s)}function xe(n){var s;const t=n.target,o=(s=t.files)==null?void 0:s[0];if(!o||!a.value)return;const r=new FileReader;r.onload=()=>{const e=String(r.result||""),i=e.indexOf(";")>=0?";":",",u=e.split(/\r?\n/).map(f=>wo(f,i));a.value.loadData(u),N(),t.value=""},r.readAsText(o)}function wo(n,t){const o=[];let r="",s=!1;for(let e=0;e<n.length;e++){const i=n[e];s?i==='"'?n[e+1]==='"'?(r+='"',e++):s=!1:r+=i:i==='"'?s=!0:i===t?(o.push(r),r=""):r+=i}return o.push(r),o}return(n,t)=>(O(),R("div",ko,[l("div",{class:"toolbar bg-white border-bottom p-2",onMousedownCapture:k},[l("div",xo,[l("button",{onClick:de,class:"btn btn-sm btn-outline-primary",title:"Nova Planilha"},[...t[48]||(t[48]=[l("span",{class:"material-symbols-outlined"},"add",-1)])]),l("button",{onClick:ce,class:"btn btn-sm btn-primary",title:"Salvar"},[...t[49]||(t[49]=[l("span",{class:"material-symbols-outlined"},"save",-1)])]),l("button",{onClick:Ge,class:"btn btn-sm btn-outline-secondary",title:"Carregar"},[...t[50]||(t[50]=[l("span",{class:"material-symbols-outlined"},"download",-1)])]),t[91]||(t[91]=l("div",{class:"vr"},null,-1)),l("button",{onMousedown:h(k,["stop"]),onClick:ze,class:"btn btn-sm btn-outline-secondary",title:"Negrito"},[...t[51]||(t[51]=[l("span",{class:"material-symbols-outlined"},"format_bold",-1)])],32),l("button",{onMousedown:h(k,["stop"]),onClick:Ke,class:"btn btn-sm btn-outline-secondary",title:"Itálico"},[...t[52]||(t[52]=[l("span",{class:"material-symbols-outlined"},"format_italic",-1)])],32),l("button",{onMousedown:h(k,["stop"]),onClick:We,class:"btn btn-sm btn-outline-secondary",title:"Sublinhado"},[...t[53]||(t[53]=[l("span",{class:"material-symbols-outlined"},"format_underlined",-1)])],32),t[92]||(t[92]=l("div",{class:"vr"},null,-1)),l("button",{onMousedown:h(k,["stop"]),onClick:qe,class:"btn btn-sm btn-outline-secondary",title:"Alinhar à esquerda"},[...t[54]||(t[54]=[l("span",{class:"material-symbols-outlined"},"format_align_left",-1)])],32),l("button",{onMousedown:h(k,["stop"]),onClick:Xe,class:"btn btn-sm btn-outline-secondary",title:"Centralizar"},[...t[55]||(t[55]=[l("span",{class:"material-symbols-outlined"},"format_align_center",-1)])],32),l("button",{onMousedown:h(k,["stop"]),onClick:Ze,class:"btn btn-sm btn-outline-secondary",title:"Alinhar à direita"},[...t[56]||(t[56]=[l("span",{class:"material-symbols-outlined"},"format_align_right",-1)])],32),t[93]||(t[93]=l("div",{class:"vr"},null,-1)),l("div",{class:"toolbar-dropdown",onKeydown:t[4]||(t[4]=Xt(h(o=>Z.value=!1,["stop","prevent"]),["esc"]))},[l("button",{onMousedown:t[0]||(t[0]=h(()=>{},["stop"])),onClick:Ie,class:"btn btn-sm btn-outline-secondary d-flex align-items-center",title:"Cor do texto"},[...t[57]||(t[57]=[l("span",{class:"material-symbols-outlined"},"format_color_text",-1),l("span",{class:"material-symbols-outlined caret"},"arrow_drop_down",-1)])],32),Z.value?(O(),R("div",{key:0,class:"dropdown-menu-like color-menu",onMousedown:t[3]||(t[3]=h(()=>{},["stop"]))},[l("div",No,[l("button",{class:"btn btn-link p-0 small",onClick:t[1]||(t[1]=o=>Ut(void 0))},"Redefinir")]),l("div",Ro,[(O(),R(ut,null,ct(ae,o=>l("button",{key:"tc-"+o,class:"swatch",style:ft({background:o}),onClick:r=>Ut(o)},null,12,Oo)),64))]),t[58]||(t[58]=l("div",{class:"menu-subtitle"},"Padrão",-1)),l("div",To,[(O(),R(ut,null,ct(Qt,o=>l("button",{key:"tcs-"+o,class:"swatch",style:ft({background:o}),onClick:r=>Ut(o)},null,12,Io)),64))]),t[59]||(t[59]=l("div",{class:"menu-subtitle"},"Cores personalizadas",-1)),l("div",Bo,[l("input",{type:"color",class:"form-control form-control-color form-control-sm",style:{width:"40px",padding:"0"},onInput:t[2]||(t[2]=o=>Ut(o.target.value))},null,32)]),t[60]||(t[60]=l("div",{class:"menu-divider"},null,-1)),l("button",{class:"menu-item",onClick:ie},"Formatação condicional"),l("button",{class:"menu-item",onClick:ue},"Cores alternadas")],32)):W("",!0)],32),l("div",{class:"toolbar-dropdown",onKeydown:t[9]||(t[9]=Xt(h(o=>J.value=!1,["stop","prevent"]),["esc"]))},[l("button",{onMousedown:t[5]||(t[5]=h(()=>{},["stop"])),onClick:Be,class:"btn btn-sm btn-outline-secondary d-flex align-items-center",title:"Cor de fundo"},[...t[61]||(t[61]=[l("span",{class:"material-symbols-outlined"},"format_color_fill",-1),l("span",{class:"material-symbols-outlined caret"},"arrow_drop_down",-1)])],32),J.value?(O(),R("div",{key:0,class:"dropdown-menu-like color-menu",onMousedown:t[8]||(t[8]=h(()=>{},["stop"]))},[l("div",Fo,[l("button",{class:"btn btn-link p-0 small",onClick:t[6]||(t[6]=o=>$t(void 0))},"Redefinir")]),l("div",Do,[(O(),R(ut,null,ct(ae,o=>l("button",{key:"bg-"+o,class:"swatch",style:ft({background:o}),onClick:r=>$t(o)},null,12,Lo)),64))]),t[62]||(t[62]=l("div",{class:"menu-subtitle"},"Padrão",-1)),l("div",Uo,[(O(),R(ut,null,ct(Qt,o=>l("button",{key:"bgs-"+o,class:"swatch",style:ft({background:o}),onClick:r=>$t(o)},null,12,$o)),64))]),t[63]||(t[63]=l("div",{class:"menu-subtitle"},"Cores personalizadas",-1)),l("div",Po,[l("input",{type:"color",class:"form-control form-control-color form-control-sm",style:{width:"40px",padding:"0"},onInput:t[7]||(t[7]=o=>$t(o.target.value))},null,32)]),t[64]||(t[64]=l("div",{class:"menu-divider"},null,-1)),l("button",{class:"menu-item",onClick:ie},"Formatação condicional"),l("button",{class:"menu-item",onClick:ue},"Cores alternadas")],32)):W("",!0)],32),t[94]||(t[94]=l("div",{class:"vr"},null,-1)),l("select",{class:"form-select form-select-sm",style:{width:"160px"},onChange:t[10]||(t[10]=o=>Je(o))},[...t[65]||(t[65]=[l("option",{value:"general"},"Geral",-1),l("option",{value:"currency"},"Moeda (R$)",-1),l("option",{value:"number"},"Número",-1),l("option",{value:"percent"},"Percentual",-1)])],32),l("button",{onClick:Qe,class:"btn btn-sm btn-outline-secondary",title:"Aumentar casas decimais"},".0+"),l("button",{onClick:Ye,class:"btn btn-sm btn-outline-secondary",title:"Diminuir casas decimais"},".0-"),t[95]||(t[95]=l("div",{class:"vr"},null,-1)),l("div",{class:"toolbar-dropdown",onKeydown:t[24]||(t[24]=Xt(h(o=>K.value=!1,["stop","prevent"]),["esc"]))},[l("button",{onMousedown:t[11]||(t[11]=h(()=>{},["stop"])),onClick:Fe,class:"btn btn-sm btn-outline-secondary d-flex align-items-center",title:"Bordas"},[...t[66]||(t[66]=[l("span",{class:"material-symbols-outlined"},"border_all",-1),l("span",{class:"material-symbols-outlined caret"},"arrow_drop_down",-1)])],32),K.value?(O(),R("div",{key:0,class:"dropdown-menu-like border-menu",onMousedown:t[23]||(t[23]=h(()=>{},["stop"]))},[l("div",Vo,[l("button",{class:"btn icon-btn",title:"Todas",onMousedown:h(k,["stop"]),onClick:t[12]||(t[12]=o=>_("all"))},[...t[67]||(t[67]=[l("span",{class:"material-symbols-outlined"},"border_all",-1)])],32),l("button",{class:"btn icon-btn",title:"Externa",onMousedown:h(k,["stop"]),onClick:t[13]||(t[13]=o=>_("outer"))},[...t[68]||(t[68]=[l("span",{class:"material-symbols-outlined"},"border_outer",-1)])],32),l("button",{class:"btn icon-btn",title:"Interna",onMousedown:h(k,["stop"]),onClick:t[14]||(t[14]=o=>_("inner"))},[...t[69]||(t[69]=[l("span",{class:"material-symbols-outlined"},"border_inner",-1)])],32),l("button",{class:"btn icon-btn",title:"Superior",onMousedown:h(k,["stop"]),onClick:t[15]||(t[15]=o=>_("top"))},[...t[70]||(t[70]=[l("span",{class:"material-symbols-outlined"},"border_top",-1)])],32),l("button",{class:"btn icon-btn",title:"Direita",onMousedown:h(k,["stop"]),onClick:t[16]||(t[16]=o=>_("right"))},[...t[71]||(t[71]=[l("span",{class:"material-symbols-outlined"},"border_right",-1)])],32),l("button",{class:"btn icon-btn",title:"Inferior",onMousedown:h(k,["stop"]),onClick:t[17]||(t[17]=o=>_("bottom"))},[...t[72]||(t[72]=[l("span",{class:"material-symbols-outlined"},"border_bottom",-1)])],32),l("button",{class:"btn icon-btn",title:"Esquerda",onMousedown:h(k,["stop"]),onClick:t[18]||(t[18]=o=>_("left"))},[...t[73]||(t[73]=[l("span",{class:"material-symbols-outlined"},"border_left",-1)])],32),l("button",{class:"btn icon-btn",title:"Sem borda",onMousedown:h(k,["stop"]),onClick:t[19]||(t[19]=o=>_("none"))},[...t[74]||(t[74]=[l("span",{class:"material-symbols-outlined"},"border_clear",-1)])],32)]),t[75]||(t[75]=l("div",{class:"menu-subtitle mt-2"},"Espessura (px)",-1)),l("div",jo,[U(l("input",{type:"number",min:"1",max:"20",step:"1",class:"form-control form-control-sm w-auto","onUpdate:modelValue":t[20]||(t[20]=o=>X.value=o),onMousedown:h(k,["stop"]),onInput:re},null,544),[[G,X.value,void 0,{number:!0}]]),U(l("input",{type:"range",min:"1",max:"20",step:"1",class:"form-range",style:{width:"150px"},"onUpdate:modelValue":t[21]||(t[21]=o=>X.value=o),onMousedown:h(k,["stop"]),onInput:re},null,544),[[G,X.value,void 0,{number:!0}]]),l("span",Ho,et(X.value)+" px",1)]),t[76]||(t[76]=l("div",{class:"menu-subtitle mt-2"},"Cor",-1)),l("div",Go,[(O(),R(ut,null,ct(Qt,o=>l("button",{key:"bd-"+o,class:"swatch",style:ft({background:o}),onMousedown:h(k,["stop"]),onClick:r=>Le(o)},null,44,zo)),64)),U(l("input",{type:"color",class:"form-control form-control-color form-control-sm ms-2",style:{width:"40px",padding:"0"},"onUpdate:modelValue":t[22]||(t[22]=o=>Nt.value=o),onMousedown:h(k,["stop"])},null,544),[[G,Nt.value]])])],32)):W("",!0)],32),t[96]||(t[96]=l("div",{class:"vr"},null,-1)),l("button",{onMousedown:h(k,["stop"]),onClick:_e,class:"btn btn-sm btn-outline-secondary",title:"Inserir linha"},[...t[77]||(t[77]=[l("span",{class:"material-symbols-outlined"},"table_rows",-1)])],32),l("button",{onMousedown:h(k,["stop"]),onClick:to,class:"btn btn-sm btn-outline-secondary",title:"Inserir coluna"},[...t[78]||(t[78]=[l("span",{class:"material-symbols-outlined"},"view_column",-1)])],32),l("button",{onMousedown:h(k,["stop"]),onClick:eo,class:"btn btn-sm btn-outline-secondary",title:"Excluir linha"},[...t[79]||(t[79]=[l("span",{class:"material-symbols-outlined"},"delete",-1)])],32),l("button",{onMousedown:h(k,["stop"]),onClick:oo,class:"btn btn-sm btn-outline-secondary",title:"Excluir coluna"},[...t[80]||(t[80]=[l("span",{class:"material-symbols-outlined"},"delete",-1)])],32),t[97]||(t[97]=l("div",{class:"vr"},null,-1)),l("button",{onClick:bo,class:"btn btn-sm btn-outline-secondary",title:"Mesclar células"},[...t[81]||(t[81]=[l("span",{class:"material-symbols-outlined"},"merge_type",-1)])]),l("button",{onClick:po,class:"btn btn-sm btn-outline-secondary",title:"Desfazer mesclagem"},[...t[82]||(t[82]=[l("span",{class:"material-symbols-outlined"},"call_split",-1)])]),t[98]||(t[98]=l("div",{class:"vr"},null,-1)),t[99]||(t[99]=l("div",{class:"vr"},null,-1)),l("button",{class:"btn btn-sm btn-outline-secondary",onClick:Se,title:"Limpar valores"},[...t[83]||(t[83]=[l("span",{class:"material-symbols-outlined"},"backspace",-1)])]),l("button",{class:"btn btn-sm btn-outline-secondary",onClick:Me,title:"Limpar formatação"},[...t[84]||(t[84]=[l("span",{class:"material-symbols-outlined"},"format_clear",-1)])]),t[100]||(t[100]=l("div",{class:"vr"},null,-1)),l("button",{class:dt(["btn btn-sm btn-outline-secondary",{active:kt.value>0}]),onClick:Ae,title:"Fixar 1ª linha"},[...t[85]||(t[85]=[l("span",{class:"material-symbols-outlined"},"push_pin",-1)])],2),l("button",{class:dt(["btn btn-sm btn-outline-secondary",{active:xt.value>0}]),onClick:Ee,title:"Fixar 1ª coluna"},[...t[86]||(t[86]=[l("span",{class:"material-symbols-outlined"},"push_pin",-1)])],2),t[101]||(t[101]=l("div",{class:"vr"},null,-1)),l("button",{class:"btn btn-sm btn-outline-secondary",onClick:ke,title:"Exportar CSV"},[...t[87]||(t[87]=[l("span",{class:"material-symbols-outlined"},"file_export",-1)])]),l("input",{ref_key:"csvInputRef",ref:Lt,type:"file",accept:".csv,text/csv",class:"d-none",onChange:t[25]||(t[25]=o=>xe(o))},null,544),l("button",{class:"btn btn-sm btn-outline-secondary",onClick:t[26]||(t[26]=()=>{var o;return(o=Lt.value)==null?void 0:o.click()}),title:"Importar CSV"},[...t[88]||(t[88]=[l("span",{class:"material-symbols-outlined"},"file_upload",-1)])]),l("button",{onClick:Et,class:"btn btn-sm btn-outline-secondary",title:"Reaplicar bordas salvas"},[...t[89]||(t[89]=[l("span",{class:"material-symbols-outlined"},"grid_on",-1)])]),l("button",{onClick:B,class:dt(["btn btn-sm btn-outline-secondary",{active:q.value}]),title:"Toggle debug seleção"},[...t[90]||(t[90]=[l("span",{class:"material-symbols-outlined"},"bug_report",-1)])],2)])],32),l("div",{class:"formula-bar bg-white border-bottom px-2 py-1 d-flex align-items-center gap-2",onMousedownCapture:k},[t[108]||(t[108]=l("span",{class:"text-muted small"},"fx",-1)),U(l("input",{ref_key:"formulaInputRef",ref:bt,class:"form-control form-control-sm","onUpdate:modelValue":t[27]||(t[27]=o=>$.value=o),onFocus:so,onInput:ro,onKeydown:Xt(h(lo,["prevent"]),["enter"]),onBlur:ao,placeholder:"Valor ou fórmula (ex.: =A1+B1)",list:"formula-ptbr-list"},null,40,Ko),[[G,$.value]]),t[109]||(t[109]=Ne('<datalist id="formula-ptbr-list" data-v-b466c10d><option value="SOMA" data-v-b466c10d></option><option value="MÉDIA" data-v-b466c10d></option><option value="MINIMO" data-v-b466c10d></option><option value="MÁXIMO" data-v-b466c10d></option><option value="CONTSE" data-v-b466c10d></option><option value="SE" data-v-b466c10d></option><option value="E" data-v-b466c10d></option><option value="OU" data-v-b466c10d></option><option value="NÃO" data-v-b466c10d></option><option value="CONCATENAR" data-v-b466c10d></option><option value="TEXTO" data-v-b466c10d></option><option value="PROCV" data-v-b466c10d></option><option value="PROCH" data-v-b466c10d></option><option value="HOJE" data-v-b466c10d></option><option value="AGORA" data-v-b466c10d></option><option value="ARRED" data-v-b466c10d></option><option value="ABS" data-v-b466c10d></option><option value="MAIOR" data-v-b466c10d></option><option value="MENOR" data-v-b466c10d></option><option value="SUBSTITUIR" data-v-b466c10d></option><option value="EXT.TEXTO" data-v-b466c10d></option><option value="ESQUERDA" data-v-b466c10d></option><option value="DIREITA" data-v-b466c10d></option><option value="NÚM.CARACT" data-v-b466c10d></option><option value="NÚMERO" data-v-b466c10d></option><option value="VALOR" data-v-b466c10d></option><option value="SOMASE" data-v-b466c10d></option></datalist><div class="vr" data-v-b466c10d></div>',2)),l("button",{class:"btn btn-sm btn-outline-secondary",onClick:Se,title:"Limpar valores"},[...t[102]||(t[102]=[l("span",{class:"material-symbols-outlined"},"backspace",-1)])]),l("button",{class:"btn btn-sm btn-outline-secondary",onClick:Me,title:"Limpar formatação"},[...t[103]||(t[103]=[l("span",{class:"material-symbols-outlined"},"format_clear",-1)])]),t[110]||(t[110]=l("div",{class:"vr"},null,-1)),l("button",{class:dt(["btn btn-sm btn-outline-secondary",{active:kt.value>0}]),onClick:Ae,title:"Fixar 1ª linha"},[...t[104]||(t[104]=[l("span",{class:"material-symbols-outlined"},"push_pin",-1)])],2),l("button",{class:dt(["btn btn-sm btn-outline-secondary",{active:xt.value>0}]),onClick:Ee,title:"Fixar 1ª coluna"},[...t[105]||(t[105]=[l("span",{class:"material-symbols-outlined"},"push_pin",-1)])],2),t[111]||(t[111]=l("div",{class:"vr"},null,-1)),l("button",{class:"btn btn-sm btn-outline-secondary",onClick:ke,title:"Exportar CSV"},[...t[106]||(t[106]=[l("span",{class:"material-symbols-outlined"},"file_export",-1)])]),l("input",{ref_key:"csvInputRef",ref:Lt,type:"file",accept:".csv,text/csv",class:"d-none",onChange:t[28]||(t[28]=o=>xe(o))},null,544),l("button",{class:"btn btn-sm btn-outline-secondary",onClick:t[29]||(t[29]=()=>{var o;return(o=Lt.value)==null?void 0:o.click()}),title:"Importar CSV"},[...t[107]||(t[107]=[l("span",{class:"material-symbols-outlined"},"file_upload",-1)])])],32),l("div",Wo,[(O(!0),R(ut,null,ct(Y.value,o=>(O(),R("button",{key:o,class:dt(["btn btn-sm",o===z.value?"btn-primary":"btn-outline-secondary"]),onClick:r=>oe(o)},et(o),11,qo))),128)),l("button",{class:"btn btn-sm btn-outline-primary",onClick:de},"+ Nova Aba")]),l("main",Xo,[a.value?W("",!0):(O(),R("div",Zo,[...t[112]||(t[112]=[l("div",{class:"spinner-border text-primary",role:"status"},[l("span",{class:"visually-hidden"},"Carregando planilha...")],-1),l("p",{class:"mt-2"},"Carregando planilha...",-1)])])),l("div",Jo,[lt.value.show?(O(),R("div",{key:0,class:"range-overlay",style:ft({top:lt.value.top+"px",left:lt.value.left+"px",width:lt.value.width+"px",height:lt.value.height+"px"})},null,4)):W("",!0),T.value.show?(O(),R("div",{key:1,class:"fn-suggest",style:ft({top:T.value.top+"px",left:T.value.left+"px"}),onMousedown:t[30]||(t[30]=h(()=>{},["stop"]))},[(O(!0),R(ut,null,ct(T.value.items,(o,r)=>(O(),R("div",{class:dt(["fn-suggest-item",{active:r===T.value.index}]),key:o,onMousedown:h(s=>we(r),["prevent"])},et(o),43,Qo))),128))],36)):W("",!0)])]),Jt.value?(O(),R("div",Yo,et(Jt.value),1)):W("",!0),yt.value?(O(),R("div",{key:1,class:"modal-overlay",onMousedown:t[41]||(t[41]=h(o=>yt.value=!1,["self"]))},[l("div",_o,[l("div",tl,[t[113]||(t[113]=l("strong",null,"Formatação condicional",-1)),l("button",{class:"btn-close",onClick:t[31]||(t[31]=o=>yt.value=!1),"aria-label":"Fechar"})]),l("div",el,[l("div",ol,[l("div",ll,[U(l("select",{class:"form-select form-select-sm","onUpdate:modelValue":t[32]||(t[32]=o=>I.value.type=o)},[...t[114]||(t[114]=[Ne('<option value="greaterThan" data-v-b466c10d>Maior que</option><option value="lessThan" data-v-b466c10d>Menor que</option><option value="equalTo" data-v-b466c10d>Igual a</option><option value="between" data-v-b466c10d>Entre</option><option value="textContains" data-v-b466c10d>Texto contém</option><option value="isEmpty" data-v-b466c10d>Está vazio</option><option value="notEmpty" data-v-b466c10d>Não está vazio</option>',7)])],512),[[Mo,I.value.type]])]),I.value.type==="between"?(O(),R("div",nl,[l("div",sl,[U(l("input",{class:"form-control form-control-sm","onUpdate:modelValue":t[33]||(t[33]=o=>I.value.value=o),placeholder:"mín"},null,512),[[G,I.value.value]]),U(l("input",{class:"form-control form-control-sm","onUpdate:modelValue":t[34]||(t[34]=o=>I.value.value2=o),placeholder:"máx"},null,512),[[G,I.value.value2]])])])):I.value.type!=="isEmpty"&&I.value.type!=="notEmpty"?(O(),R("div",al,[U(l("input",{class:"form-control form-control-sm","onUpdate:modelValue":t[35]||(t[35]=o=>I.value.value=o),placeholder:"valor ou texto"},null,512),[[G,I.value.value]])])):W("",!0)]),l("div",rl,[t[117]||(t[117]=l("div",{class:"col-auto small text-muted"},"Estilo:",-1)),l("div",il,[U(l("input",{type:"color",class:"form-control form-control-color form-control-sm","onUpdate:modelValue":t[36]||(t[36]=o=>I.value.bgColor=o),title:"Cor de fundo"},null,512),[[G,I.value.bgColor]])]),l("div",ul,[U(l("input",{type:"color",class:"form-control form-control-color form-control-sm","onUpdate:modelValue":t[37]||(t[37]=o=>I.value.textColor=o),title:"Cor do texto"},null,512),[[G,I.value.textColor]])]),l("div",cl,[U(l("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[38]||(t[38]=o=>I.value.bold=o),id:"cf-bold"},null,512),[[le,I.value.bold]]),t[115]||(t[115]=l("label",{class:"form-check-label",for:"cf-bold"},"Negrito",-1))]),l("div",dl,[U(l("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[39]||(t[39]=o=>I.value.italic=o),id:"cf-italic"},null,512),[[le,I.value.italic]]),t[116]||(t[116]=l("label",{class:"form-check-label",for:"cf-italic"},"Itálico",-1))])])]),l("div",fl,[l("button",{class:"btn btn-outline-danger btn-sm",onClick:$e},"Limpar regras da seleção"),l("div",vl,[l("button",{class:"btn btn-outline-secondary btn-sm",onClick:t[40]||(t[40]=o=>yt.value=!1)},"Cancelar"),l("button",{class:"btn btn-primary btn-sm",onClick:Ue},"Aplicar")])])])],32)):W("",!0),gt.value?(O(),R("div",{key:2,class:"modal-overlay",onMousedown:t[47]||(t[47]=h(o=>gt.value=!1,["self"]))},[l("div",ml,[l("div",bl,[t[118]||(t[118]=l("strong",null,"Cores alternadas",-1)),l("button",{class:"btn-close",onClick:t[42]||(t[42]=o=>gt.value=!1),"aria-label":"Fechar"})]),l("div",pl,[l("div",yl,[t[119]||(t[119]=l("div",{class:"col-auto small text-muted"},"Cores:",-1)),l("div",gl,[U(l("input",{type:"color",class:"form-control form-control-color form-control-sm","onUpdate:modelValue":t[43]||(t[43]=o=>nt.value.color1=o)},null,512),[[G,nt.value.color1]])]),l("div",wl,[U(l("input",{type:"color",class:"form-control form-control-color form-control-sm","onUpdate:modelValue":t[44]||(t[44]=o=>nt.value.color2=o)},null,512),[[G,nt.value.color2]])])]),l("div",hl,[U(l("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[45]||(t[45]=o=>nt.value.hasHeader=o),id:"alt-hdr"},null,512),[[le,nt.value.hasHeader]]),t[120]||(t[120]=l("label",{class:"form-check-label",for:"alt-hdr"},"Primeira linha é cabeçalho",-1))])]),l("div",Cl,[l("button",{class:"btn btn-outline-danger btn-sm",onClick:Ve},"Remover alternância da seleção"),l("div",Sl,[l("button",{class:"btn btn-outline-secondary btn-sm",onClick:t[46]||(t[46]=o=>gt.value=!1)},"Cancelar"),l("button",{class:"btn btn-primary btn-sm",onClick:Pe},"Aplicar")])])])],32)):W("",!0),l("footer",Ml,[l("div",Al,[l("div",El,[t[121]||(t[121]=l("div",{class:"col-md-6"},[l("small",{class:"text-muted"},[l("span",{class:"me-2"},"💾"),Re(" Salvamento automático ativado ")])],-1)),l("div",kl,[l("small",xl,[Re(" Último salvamento: "+et(Ft.value)+" ",1),l("span",Nl,"Σ "+et(mt.value.sum)+" | média "+et(mt.value.avg)+" | n="+et(mt.value.count),1)])])])])])]))}}),Ol=(Bt,vt)=>{const Q=Bt.__vccOpts||Bt;for(const[q,B]of vt)Q[q]=B;return Q},Tl=Ol(Rl,[["__scopeId","data-v-b466c10d"]]),Il=document.getElementById("sheets-vue-app")||document.getElementById("app");Ao(Tl).mount(Il);
